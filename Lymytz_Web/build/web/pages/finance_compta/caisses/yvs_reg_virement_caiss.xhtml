<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"> 
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Virements caisses','modCompta', 'smenRegVirement', true)}
    </ui:define>        
    <ui:define name="content" >
        <script type="text/javascript">
            $(function() {
                collapseForm('pieceCaissVir');
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 135);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height());
            });
        </script>       
        #{managedVente.doNothing()} 
        #{managedSaisiePiece.doNothing()}

        #{managedAgence.loadAllUsable()}
        #{managedCaisses.loadCaissesByAgence()}
        #{managedVirement.loadAll()}
        #{managedModeReglement.loadActifMode()}
        #{managedTypeCout.loadTypeByType(constantes.MOD_COFI)}
        #{managedCentreAnalytique.loadAllByNamedQuery()}

        <h:form prependId="false" id="form_pptes_compta">
            <p:dialog  width="60%" widgetVar="dlgPpteCompta" closeOnEscape="true" header="Pièces comptable">
                <ui:include src="../../finance_compta/compta_general/yvs_schema_compta.xhtml" />
                <f:facet name="footer">
                    &copy;Lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_agence_find">
            <p:dialog  width="20%" widgetVar="dlgAgenceFind" closeOnEscape="true" header="Agences">
                <h:selectOneMenu value="#{managedCaisses.agenceFind}" >
                    <f:selectItem itemValue="#{null}" itemLabel=" " />
                    <f:selectItems value="#{managedAgence.listAgence}" var="iag"
                                   itemLabel="#{iag.designation}" itemValue="#{iag.id}"/>
                    <p:ajax event="valueChange" listener="#{managedCaisses.loadCaissesByAgence()}" 
                            update=":form-search_virement:zone-search_virement_caisse-source" />
                </h:selectOneMenu>
                <f:facet name="footer">
                    &copy;Lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>

        <h:form prependId="false" id="main-agence">
            <p:dialog widgetVar="dlgAgenceForCaisse" header="Selectionner une agence" width="50%" closeOnEscape="true"> 
                <p:dataTable value="#{managedAgence.agences}" var="ag" rowKey="#{ag.id}" selectionMode="single" id="table_agence" rowIndexVar="line_ag">
                    <p:ajax event="rowSelect" listener="#{managedCaisses.onSelectAgenceForAction}" update=":main_form_virement_caiss:select_source_virement" oncomplete="dlgAgenceForCaisse.hide()"/>
                    <p:column headerText="#{lab.L_code}" width="200">
                        <h:outputText value="#{ag.codeagence}"/>
                    </p:column>                                
                    <p:column headerText="#{lab.L_designation}">
                        <h:outputText value="#{ag.designation}"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des section analytique du contenu
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main-analytique_virement">
            <p:dialog header="#{lab.LCF_PVC_sections_analytique_cout}" widgetVar="dlgSectionAnalytique" modal="true" closeOnEscape="true" width="40%"> 
                <p:outputPanel id="blog-analytique_virement">
                    <h:panelGrid id="form-analytique_virement" columns="5" cellpadding="0" cellspacing="0">
                        <h:outputText value="#{lab.LCF_PVC_centre} : "/>
                        <h:selectOneMenu value="#{managedVirement.analytique.centre.id}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedCentreAnalytique.centres}" var="iCa" itemLabel="#{iCa.designation}" itemValue="#{iCa.id}"/>
                            <p:ajax event="valueChange" global="false" listener="#{managedVirement.chooseCentre()}"/>
                        </h:selectOneMenu>
                        <h:outputText value="#{lab.LCF_PVC_coefficient} : " style="margin-left: 5px"/>
                        <h:inputText value="#{managedVirement.analytique.taux}" style="width: 50px;text-align: center"/>
                        <p:commandButton icon="ui-icon-disk" value="#{lab.L_enregistrer}" style="margin-left: 10px" actionListener="#{managedVirement.saveNewAnalytique()}"/>
                    </h:panelGrid>
                    <p:dataTable value="#{managedVirement.selectCout.analytiques}" var="iAA" rowIndexVar="iAAx" id="data-analytique_virement" selectionMode="single"
                                 rowKey="#{iAA.id}" paginator="true" rows="10" paginatorAlwaysVisible="false">
                        <p:ajax event="rowSelect" listener="#{managedVirement.loadOnViewAnalytique}" />
                        <p:ajax event="rowUnselect" listener="#{managedVirement.unLoadOnViewAnalytique}" />
                        <p:column headerText="Centre">
                            <span>#{iAA.centre.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PVC_coefficient}" style="text-align: right">
                            <h:outputText value="#{iAA.coefficient}" converter="DNA"/>%
                        </p:column>
                        <p:column style="text-align: center;width: 5%">
                            <p:contextMenu for="btn_option-analytique_virement" styleClass="context_menu" event="left click" style="font-size: 0.8em">
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedVirement.deleteAnalytique(iAA, false)}"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option-analytique_virement" type="button"/>
                        </p:column>  
                    </p:dataTable>  
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des journées de vente
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LCF_PVC_liste_journee}" widgetVar="dlgListHeaders" modal="true" width="50%"  closeOnEscape="true"> 
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:panelGroup>
                        <h:inputText value="#{managedVente.codeVendeur_}" style="margin-left: -10px">
                            <p:ajax event="valueChange" listener="#{managedVente.addParamVendeur()}" update="data-header_virement_caisse"/>
                        </h:inputText>
                    </h:panelGroup>  
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedVente.init(false)}" global="false" update="data-header_virement_caisse" icon="ui-icon-circle-triangle-w" disabled="#{managedVente.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedVente.paginator.currentPage}/#{managedVente.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedVente.init(true)}" global="false" update="data-header_virement_caisse" icon="ui-icon-circle-triangle-e" disabled="#{managedVente.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedVente.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedVente.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedVente.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data-header_virement_caisse"/>
                        </p:selectOneMenu>
                    </p:outputPanel>                    
                </h:panelGrid>
                <p:dataTable id="data-header_virement_caisse" value="#{managedVente.documents}" var="bon" rowIndexVar="bonIdx"
                             rowKey="#{bon.id}" selectionMode="single" paginator="true" rows="20" paginatorAlwaysVisible="false">
                    <p:ajax event="rowSelect" listener="#{managedVirement.loadOnViewHeader}" oncomplete="dlgListHeaders.hide()"/>
                    <p:column width="35" headerText="N°" styleClass="statut_#{bon.etat}">
                        <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{bon.cloturer}"/>  
                        <span>#{bonIdx+1}</span>
                        <h:panelGroup style="float: right">
                            <h:outputText title="#{lab.LCF_PVC_comptabiliser}" value="C" rendered="#{bon.comptabilised}" styleClass="style_statut"/>
                        </h:panelGroup>
                    </p:column>
                    <p:column headerText="#{lab.LCF_PVC_vendeur}" styleClass="statut_#{bon.etat}">
                        [<span style="font-weight: bold">#{bon.creneau.users.codeUsers}</span>]
                        <span>#{bon.creneau.users.nomUsers}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_point_vente}" styleClass="statut_#{bon.etat}">
                        [<span style="font-weight: bold">#{bon.creneau.creneauPoint.point.code}</span>]
                        <span>#{bon.creneau.creneauPoint.point.libelle}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_date}" style="text-align: center;width: 12%" styleClass="statut_#{bon.etat}">
                        <h:outputText value="#{bon.dateEntete}" converter="DDMMYYYY"/>
                    </p:column>
                    <p:column headerText="#{lab.L_tranche}" style="text-align: center;width: 12%" styleClass="statut_#{bon.etat}">
                        <h:outputText value="#{bon.creneau.creneauPoint.tranche.heureDebut}" converter="TIME"/>
                        -
                        <h:outputText value="#{bon.creneau.creneauPoint.tranche.heureFin}" converter="TIME"/>
                    </p:column> 
                </p:dataTable> 
            </p:dialog>
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue de type cout
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LCF_PVC_creation_type}" widgetVar="dlgAddTypeCout" modal="true" width="25%"  closeOnEscape="true"> 
                <h:panelGrid id="form_type_cout_virement" columns="1" cellpadding="0" cellspacing="0" style="width: 100%">
                    <h:inputText value="#{managedTypeCout.typeCout.libelle}" style="width: 100%"/>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddTypeCout.hide()" actionListener="#{managedTypeCout.saveNew()}" 
                                 update=":main_form_virement_caiss:select_type_cout_virement"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dglEtatComptabilised" closeOnEscape="true" resizable="false" width="25%">
                <p:commandButton value="#{lab.LCF_PVC_tous_virements}" actionListener="#{managedVirement.verifyComptabilised(null)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LCF_PVC_virements_comptabiliser}" actionListener="#{managedVirement.verifyComptabilised(true)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LCF_PVC_virements_non_comptabiliser}" actionListener="#{managedVirement.verifyComptabilised(false)}" style="width: 99%"/>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteAnalytique" closeOnEscape="true"
                             message="#{lab.LCF_PVC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedVirement.deleteAnalytique(managedVirement.selectAnalytique, true)}"  oncomplete="dlgConfirmDeleteAnalytique.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteAnalytique.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuleDoc" closeOnEscape="true"
                             message="#{lab.LCF_PVC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton type="button" value="#{lab.L_oui}" onclick="dlgConfirmAnnuleDoc.hide()" />
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnuleDoc.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.LCF_PVC_changer_statut}" message="#{lab.LCF_PVC_text2}" widgetVar="dlgCancelPiece" width="50%" >
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedVirement.changeStatutPiece()}" oncomplete="dlgCancelPiece.hide()" icon="ui-icon-circle-check"
                                 update=":main_form_virement_caiss:table_all_pieceCaisse_virement :main_form_virement_caiss:grp_btn_etat_virement"/>
                <p:commandButton value="#{lab.L_non}" type="button" onclick="dlgCancelPiece.hide()" icon="ui-icon-circle-close" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.LCF_PVC_supprimer_versement}" message="#{lab.LCF_PVC_confirmer}" widgetVar="dlgRemoveVersement" width="50%" >
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedVirement.removeVersement()}" oncomplete="dlgRemoveVersement.hide()" icon="ui-icon-circle-check"
                                 update=":main_form_virement_caiss:table_all_pieceCaisse_virement :main_form_virement_caiss:grp_btn_etat_virement"/>
                <p:commandButton value="#{lab.L_non}" type="button" onclick="dlgRemoveVersement.hide()" icon="ui-icon-circle-close" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_supprimer} !" message="#{lab.LCF_PVC_text3}" widgetVar="dlgDelPiece" width="50%" >
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedVirement.deleteOneBean()}" oncomplete="dlgDelPiece.hide()" icon="ui-icon-circle-check"
                                 update=":main_form_virement_caiss:table_all_pieceCaisse_virement"/>
                <p:commandButton value="#{lab.L_non}" type="button" onclick="dlgDelPiece.hide()" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnulePiece" closeOnEscape="true"
                             message="#{lab.LCF_PVC_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedVirement.changeStatutPiece()}" oncomplete="dlgConfirmAnnulePiece.hide()" 
                                 update=":main_form_virement_caiss:head_edit_pieceCaiss_virement :main_form_virement_caiss:table_all_pieceCaisse_virement :main_form_virement_caiss:grp_btn_etat_virement"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnulePiece.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabiliseDoc" message="#{lab.LCF_PVC_text5}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.comptabiliserCaisseVirement(managedVirement.entity, true, true)}"
                                 update=":main_form_virement_caiss:head_edit_pieceCaiss_virement" oncomplete="dlgComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabiliseDoc.hide()" />
            </p:confirmDialog>
        </h:form >
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabiliseDoc" message="#{lab.LCF_PVC_text6}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.unComptabiliserCaisseVirement(managedVirement.entity, true)}"
                                 update=":main_form_virement_caiss:head_edit_pieceCaiss_virement" oncomplete="dlgUnComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabiliseDoc.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LCF_PVC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedVirement.deleteBean()}" oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false" id="main_form_virement_caiss">  
            <div class="part_fix">
                <p:outputPanel autoUpdate="true" style="float: left; " layout="block">         
                    <p:splitButton id="save_pieceCaissVir" value="#{lab.L_enregistrer}" update="form_edit_pieceCaiss_virement :main_form_virement_caiss:table_all_pieceCaisse_virement"
                                   icon="ui-icon-disk" actionListener="#{managedVirement.saveNew()}" >              
                        <p:menuitem id="cancel_pieceCaissVir" value="#{lab.L_nouveau}" update="form_edit_pieceCaiss_virement :main_form_virement_caiss:form_edit_pieceCaiss_virement"
                                    actionListener="#{managedVirement.resetFiche()}" icon="ui-icon-document"/>   
                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" oncomplete="dlgConfirmDelete.show()"/> 
                    </p:splitButton>
                    <p:splitButton value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" id="delete_pieceCaissVir" oncomplete="dlgConfirmDelete.show()" >              
                        <p:menuitem value="#{lab.LP_PSO_mettre_en_attente}" icon="ui-icon-arrowreturnthick-1-s"  actionListener="#{managedVirement.changeStatuVirements()}"/> 
                    </p:splitButton>
                    <h:panelGroup id="etapes_valide_pc_vir" style="position: relative; left: 15%">                         
                        <ui:repeat value="#{managedPieceCaisse.pieceCaisse.etapesValidation}" var="etapeM" >
                            <p:commandLink value="#{etapeM.etape.labelStatut}" disabled="#{(!etapeM.etapeActive or etapeM.etapeValid)}" title="#{etapeM.etape.titreEtape}" 
                                           styleClass="#{(etapeM.etapeValid)?'statu_valide':'etat_formation_true'}" actionListener="#{managedPieceCaisse.validEtapePieceCaisseMission(etapeM)}" />                        
                        </ui:repeat>
                    </h:panelGroup>
                </p:outputPanel> 
                <p:outputPanel style="margin-left: 30%" autoUpdate="true">     
                    <p:commandButton actionListener="#{managedVirement.parcoursInAllResult(false)}" update="txt_parc_linear_pieceCaissVir"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('pieceCaissVir');"/>
                    <h:inputText value="#{managedVirement.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_pieceCaissVir"/>                   
                    <p:outputLabel value="/#{managedVirement.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                    <p:commandButton actionListener="#{managedVirement.parcoursInAllResult(true)}" update="txt_parc_linear_pieceCaissVir"  icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('pieceCaissVir');"/>                    
                </p:outputPanel>
                <div style="float: right">                     
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('pieceCaissVir');
                            return false;">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>          
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('pieceCaissVir');
                            return false;" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>                                   
                </div> 
                <div style="clear: right"/>
            </div>
            <div class="part_scroll">
                <div class="yvs_form_pieceCaissVir" style="margin: auto; background: white;">                    
                    <h:panelGrid columns="4" styleClass="yvs_table" cellpadding="0" cellspacing="0"
                                 style="width: 100%" id="form_edit_pieceCaiss_virement">
                        <f:facet name="header">
                            <h:panelGroup id="head_edit_pieceCaiss_virement">
                                <div style="float: left;margin-top: 5px">
                                    <h:outputText value="#{managedVirement.pieceCaisse.id}" title="#{lab.LDB_PPC_identifiant_element_courant}" styleClass="style_identifiant" rendered="#{managedVirement.pieceCaisse.id gt 0}" />
                                    <span  class="style_reference">#{managedVirement.pieceCaisse.numPiece}</span>
                                </div>
                                <div style="float: left;margin-top: 5px; margin-left: 30%; border-radius: 15px; background: #666; padding: 5px; font-size: 0.9em; color: #FFF">
                                    <span>#{lab.LCF_PVC_solde_espece} :</span>
                                    <h:outputText value="#{managedVirement.pieceCaisse.caisse.solde}" converter="DN" id="zone_solde_caiss_source"/>
                                </div>
                                <p:outputPanel style="float: right;padding: 5px">     
                                    <p:outputPanel id="grp_btn_etat_virement" styleClass="yvs_form_of" rendered="#{managedVirement.pieceCaisse.id gt 0}">  
                                        <p:commandLink value="#{lab.L_en_attente}" styleClass="#{(managedVirement.pieceCaisse.statutPiece == constantes.STATUT_DOC_ATTENTE)?'statut_valide':'etat_formation_true'}" 
                                                       disabled="#{!(managedVirement.pieceCaisse.statutPiece == constantes.STATUT_DOC_PAYER
                                                                   or managedVirement.pieceCaisse.statutPiece == constantes.STATUT_DOC_ANNULE or managedVirement.pieceCaisse.statutPiece == constantes.STATUT_DOC_SOUMIS)}" 
                                                       actionListener="#{managedVirement.openDlgToCancel()}" process="@this" update="grp_btn_etat_virement" />                                 
                                        <p:commandLink value="#{(managedVirement.pieceCaisse.statutPiece eq constantes.STATUT_DOC_SOUMIS or managedVirement.pieceCaisse.statutPiece eq constantes.STATUT_DOC_PAYER)?'SOUMIS':'SOUMETTRE'}"
                                                       styleClass="#{(managedVirement.pieceCaisse.statutPiece == constantes.STATUT_DOC_SOUMIS or managedVirement.pieceCaisse.statutPiece eq constantes.STATUT_DOC_PAYER)?'statut_valide':'etat_formation_true'}" 
                                                       disabled="#{(managedVirement.pieceCaisse.statutPiece != constantes.STATUT_DOC_ATTENTE)}" 
                                                       actionListener="#{managedVirement.soumettreCaisse()}" process="@this" update="grp_btn_etat_virement" />
                                        <p:commandLink value="#{(managedVirement.pieceCaisse.statutPiece eq constantes.STATUT_DOC_PAYER)?'ENCAISS&Eacute;':'ENCAISSER'}"
                                                       styleClass="#{(managedVirement.pieceCaisse.statutPiece == constantes.STATUT_DOC_PAYER)?'statut_valide':'etat_formation_true'}" 
                                                       disabled="#{(managedVirement.pieceCaisse.statutPiece != constantes.STATUT_DOC_SOUMIS) or !managedVirement.canValide()}" 
                                                       actionListener="#{managedVirement.payerPieceCaisse()}" process="@this" update="grp_btn_etat_virement" />
                                        <p:commandLink value="#{(managedVirement.isComptabiliseBean(managedVirement.pieceCaisse)?'COMPTABILIS&Eacute;':'COMPTABILISER')}"
                                                       type="button" styleClass="#{(managedVirement.pieceCaisse.comptabilise)?'statut_valide':'etat_formation_true'}"
                                                       onclick="dlgComptabiliseDoc.show()" global="false" id="btn_comptabilised_virement"
                                                       rendered="#{managedVirement.pieceCaisse.statutPiece==constantes.STATUT_DOC_PAYER}"/>
                                        <p:contextMenu for="btn_comptabilised_virement" style="font-size: 0.7em">
                                            <p:menuitem icon="ui-icon-eject" value="#{lab.LC_PFA_proprietes}" actionListener="#{managedSaisiePiece.displayPieceComptable(managedVirement.pieceCaisse.id, constantes.SCR_VIREMENT)}" 
                                                        update=":form_pptes_compta:table_pptes_compta" oncomplete="dlgPpteCompta.show()"/>
                                            <p:separator style="width: 100%" />
                                            <p:menuitem icon="ui-icon-circle-arrow-w" value="Annuler" onclick="dlgUnComptabiliseDoc.show()" disabled="#{!managedVirement.pieceCaisse.comptabilise}"/>
                                        </p:contextMenu>
                                    </p:outputPanel> 
                                </p:outputPanel>
                            </h:panelGroup>
                        </f:facet>
                        <span>#{lab.LCF_PVC_date_emission}</span>
                        <p:calendar value="#{managedVirement.pieceCaisse.datePaiementPrevu}" size="8" pattern="dd-MM-yyyy"
                                    disabled="#{managedVirement.pieceCaisse.statutPiece!=constantes.STATUT_DOC_ATTENTE}">
                            <p:ajax event="dateSelect" global="false"/>
                        </p:calendar>
                        <span>#{lab.L_montant}</span>
                        <pe:inputNumber value="#{managedVirement.pieceCaisse.montant}" style="text-align: right" decimalPlaces="0" maxValue="9999999999999999999999" emptyValue="0"
                                        disabled="#{managedVirement.pieceCaisse.statutPiece!=constantes.STATUT_DOC_ATTENTE}"/>
                        <h:outputText value="#{lab.LCF_PVC_date_encaissement}" rendered="#{managedVirement.pieceCaisse.id gt 0}"/>
                        <p:calendar value="#{managedVirement.pieceCaisse.datePaiement}" size="8" pattern="dd-MM-yyyy"
                                    disabled="#{managedVirement.pieceCaisse.statutPiece==constantes.STATUT_DOC_PAYER}"
                                    rendered="#{managedVirement.pieceCaisse.id gt 0}"/>
                        <h:outputText value="#{lab.LC_PES_montant_total}" rendered="#{managedVirement.pieceCaisse.id gt 0}"/>
                        <h:inputText value="#{managedVirement.pieceCaisse.montant + managedVirement.pieceCaisse.montantCout}" converter="DNA" 
                                     id="txt_total_virement" disabled="true" rendered="#{managedVirement.pieceCaisse.id gt 0}" style="text-align: right"/>
                        <span>#{lab.LCF_PVC_source}</span>
                        <h:panelGroup>
                            <h:selectOneMenu value="#{managedVirement.pieceCaisse.caisse.id}" disabled="#{managedVirement.pieceCaisse.statutPiece!=constantes.STATUT_DOC_ATTENTE}"
                                             valueChangeListener="#{managedVirement.buildCaisses}" style="min-width: 140px" id="select_source_virement">
                                <f:selectItem itemLabel="" itemValue="0" />
                                <f:selectItems value="#{managedCaisses.caisses}" var="itemCaiss" itemLabel="#{itemCaiss.intitule}" itemValue="#{itemCaiss.id}" />
                                <p:ajax event="valueChange" update="chmp_caiss_cible chmp_caissier_source"/>
                            </h:selectOneMenu>
                            <p:commandLink value="Selectionner agence" onclick="dlgAgenceForCaisse.show()" global="false" rendered="#{managedAgence.agences.size() gt 1}"/>
                        </h:panelGroup>
                        <span>#{lab.LCF_PVC_cible}</span>
                        <h:selectOneMenu value="#{managedVirement.pieceCaisse.otherCaisse.id}" disabled="#{managedVirement.pieceCaisse.statutPiece!=constantes.STATUT_DOC_ATTENTE}"
                                         valueChangeListener="#{managedVirement.chooseCible}" id="chmp_caiss_cible" style="min-width: 140px">
                            <f:selectItem itemLabel="" itemValue="0" />
                            <f:selectItems value="#{managedVirement.caisseCible}" var="itemCaiss" itemLabel="#{itemCaiss.intitule}" itemValue="#{itemCaiss.id}" />
                            <p:ajax event="valueChange" update="chmp_caissier_cible"/>
                        </h:selectOneMenu>
                        <span>#{lab.LCF_PVC_auteur_source}</span>
                        <h:selectOneMenu value="#{managedVirement.pieceCaisse.caissier.id}" disabled="#{!accesRessource.compta_virement_up_users_source}" 
                                         valueChangeListener="#{managedVirement.chooseCaissier}" id="chmp_caissier_source" style="width: 100%">
                            <f:selectItem itemLabel="" itemValue="0" />
                            <f:selectItems value="#{managedVirement.caissiers}" var="iCaissier" itemLabel="#{iCaissier.nomUsers}" itemValue="#{iCaissier.id}" />
                            <p:ajax event="valueChange" />
                        </h:selectOneMenu>
                        <span>#{lab.LCF_PVC_auteur_cible}</span>
                        <h:inputText readonly="true" value="#{managedVirement.pieceCaisse.caissierCible.nomUsers}" id="chmp_caissier_cible" style="font-size: 0.8em; width: 100%; background: #009999"/>
                        <f:facet name="footer">
                            <span>#{lab.LCF_PVC_motif}</span>
                            <h:panelGroup style="float: right">
                                <span>#{lab.LCF_PVC_mode} </span>
                                <h:selectOneMenu value="#{managedVirement.pieceCaisse.mode.id}" disabled="#{managedVirement.pieceCaisse.statutPiece!=constantes.STATUT_DOC_ATTENTE}" style="min-width: 140px">
                                    <f:selectItem itemLabel="" itemValue="0" />
                                    <f:selectItems value="#{managedModeReglement.modes}" var="modelm" itemLabel="#{modelm.designation}" itemValue="#{modelm.id}" 
                                                   itemDisabled="#{!modelm.typeReglement.equals(constantes.MODE_PAIEMENT_ESPECE)}"/> 
                                    <p:ajax event="valueChange" global="false" listener="#{managedVirement.chooseModeReglement()}"/>
                                </h:selectOneMenu>
                            </h:panelGroup>
                            <div style="clear: right"/>
                            <h:inputTextarea value="#{managedVirement.pieceCaisse.description}" rows="3" style="width: 100%" />                 
                            <h:outputText value="#{lab.LCF_PVC_pour_journee_vente} "/>           
                            <h:panelGroup id="txt-header_virement_caisse">
                                <h:outputText value="#{managedVirement.pieceCaisse.enteteDoc.reference}" style="color: #006666;margin-right: 10px"/>
                                <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white" title="#{lab.LCF_PVC_liste_journal_vente}" global="false"
                                                 actionListener="#{managedVirement.initHeaders()}"/>
                            </h:panelGroup>   
                        </f:facet>
                    </h:panelGrid>
                    <div style="width: 60%;float: left">
                        <h:panelGrid style="width: 100%" columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0"  id="zone_bielletage">
                            <f:facet name="header">#{lab.LCF_PVC_enregistrer_bielletage}</f:facet>
                            <h:panelGrid columns="2" cellpadding="0" cellspacing="0" style="float: left; width: 100%" styleClass="yvs_table" >
                                <f:facet name="header">#{lab.LCF_PVC_billets}</f:facet>
                                <ui:repeat value="#{managedVirement.pieceCaisse.bielletageBillet}" var="bil_" >
                                    <dir>
                                        <span  style="font-weight: bold">#{bil_.formatMonai} >> </span>
                                        <h:inputText value="#{bil_.quantite}" style="float: right; text-align: right" >
                                            <p:ajax event="blur" update=":main_form_virement_caiss:zone_bielletage" global="false"/>
                                        </h:inputText>
                                    </dir>
                                </ui:repeat>
                                <f:facet name="footer">
                                    <div style="background: #828c95" align="center">
                                        #{lab.L_total}: 
                                        <h:outputText style="font-weight: bold; text-align: center; width: 100%" value="#{managedVirement.soeBielletage(managedVirement.pieceCaisse.bielletageBillet)}"  converter="DN"/>
                                        Fcfa
                                    </div>
                                </f:facet>
                            </h:panelGrid>
                            <h:panelGrid columns="2"  cellpadding="0" style="float: right; width: 100%" cellspacing="0" styleClass="yvs_table" >
                                <f:facet name="header">#{lab.LCF_PVC_pieces}</f:facet>
                                <ui:repeat value="#{managedVirement.pieceCaisse.bielletagePiece}" var="piec_" >
                                    <dir>
                                        <span >#{piec_.formatMonai} >> </span>
                                        <h:inputText value="#{piec_.quantite}" style="float: right; text-align: right">
                                            <p:ajax event="blur" update=":main_form_virement_caiss:zone_bielletage" global="false"/>
                                        </h:inputText>
                                    </dir>
                                </ui:repeat>
                                <f:facet name="footer">
                                    <div style="background: #828c95" align="center">
                                        #{lab.L_total}: 
                                        <h:outputText style="font-weight: bold; text-align: center; width: 100%" value="#{managedVirement.soeBielletage(managedVirement.pieceCaisse.bielletagePiece)}"  converter="DN"/>
                                        Fcfa
                                    </div>
                                </f:facet>
                            </h:panelGrid> 
                            <f:facet name="footer">
                                <div style="background: #828c95" align="center">
                                    #{lab.L_total}: 
                                    <h:outputText style="font-weight: bold; text-align: center; width: 100%" value="#{managedVirement.soeBielletage(managedVirement.pieceCaisse.bielletagePiece)+managedVirement.soeBielletage(managedVirement.pieceCaisse.bielletageBillet)}"  converter="DN"/>
                                    Fcfa
                                </div>
                            </f:facet>
                        </h:panelGrid>
                    </div>
                    <div  class="block_slide" style="width: 39%; margin-left: 60.5%;margin-top: 5px;height: 300px">
                        <span class="block_slide_title">
                            #{lab.LCF_PVC_couts} 
                            <div style="float: right">
                                #{lab.L_total} : 
                                <div style="float: right">
                                    <h:outputText id="txt_couts_virement" value="#{managedVirement.pieceCaisse.montantCout}" converter="DNA" style="font-weight: bold"/> 
                                    Fcfa
                                </div>
                            </div>
                        </span>
                        <div class="zone_slide">
                            <h:panelGrid id="form_cout_virement" columns="5" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                <h:outputText value="#{lab.LCF_PVC_cout}" />
                                <h:selectOneMenu value="#{managedVirement.cout.type.id}" style="min-width: 120px" id="select_type_cout_virement" 
                                                 valueChangeListener="#{managedVirement.chooseTypeCout}">
                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                    <f:selectItems value="#{managedTypeCout.types}" var="_ct" itemLabel="#{_ct.libelle}" itemValue="#{_ct.id}"/>
                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                    <f:selectItem itemLabel="#{lab.L_creer}" itemValue="-1"/>
                                    <p:ajax event="valueChange" global="false"/>
                                </h:selectOneMenu>
                                <h:outputText value="#{lab.L_montant}" />
                                <h:inputText value="#{managedVirement.cout.montant}" style="text-align: right">
                                    <p:ajax event="valueChange" global="false" />
                                </h:inputText>
                                <p:commandButton icon="ui-icon-disk" style="width: 22px; height: 22px;float: right"
                                                 actionListener="#{managedVirement.saveNewCout()}" title="#{lab.L_enregistrer}"/>
                            </h:panelGrid>
                            <p:dataTable id="date_cout_virement" value="#{managedVirement.pieceCaisse.couts}" var="ct" rowKey="#{ct.id}" rowIndexVar="yCou" selectionMode="single">
                                <p:ajax event="rowSelect" global="false" listener="#{managedVirement.loadOnViewCout}" update=":main_form_virement_caiss:form_cout_virement"/>
                                <p:ajax event="rowUnselect" global="false" listener="#{managedVirement.unLoadOnViewCout}" update=":main_form_virement_caiss:form_cout_virement"/>
                                <p:column headerText="N°" style="width: 12%;text-align: center">
                                    <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{ct.new_}"/>
                                    <span>#{yCou+1}</span>
                                </p:column>  
                                <p:column headerText="#{lab.L_designation}">
                                    <h:outputText value="#{ct.typeCout.libelle}"/>
                                </p:column>   
                                <p:column headerText="#{lab.L_montant}" width="50" style="text-align: right">
                                    <h:outputText value="#{ct.montant}" converter="DN"/>
                                </p:column>   
                                <p:column width="20" style="text-align: center">
                                    <p:contextMenu for="btn_option_cout_virement" event="left click" style="font-size: 0.8em" styleClass="context_menu">  
                                        <p:menuitem value="#{lab.LC_PFA_sections_analytique}" icon="ui-icon-bookmark" actionListener="#{managedVirement.loadSections(ct)}" oncomplete="dlgSectionAnalytique.show()"/>
                                        <p:separator style="width: 98%;margin: auto"/>  
                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedVirement.deleteBeanCout(ct)}"/>
                                    </p:contextMenu>                           
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_cout_virement" type="button"/>
                                </p:column> 
                            </p:dataTable>
                        </div>  
                    </div>
                    <div style="clear: both"/>
                </div>
                <div class="yvs_list_pieceCaissVir" style="background: white;">
                    <h:inputHidden id="input_hide_pieceCaissVir" value="#{managedVirement.tabIds}"/>
                    <p:dataTable selectionMode="single" value="#{managedVirement.listAllVirement}" var="mvtVir"
                                 rowKey="#{mvtVir.id}" rowIndexVar="line_M" id="table_all_pieceCaisse_virement">
                        <p:ajax event="rowSelect" listener="#{managedVirement.loadOnView}"
                                oncomplete="collapseForm('pieceCaissVir')" update=":main_form_virement_caiss:form_edit_pieceCaiss_virement :main_form_virement_caiss:input_hide_pieceCaissVir :main_form_virement_caiss:zone_bielletage" />
                        <p:column headerText="N°" width="25" style="text-align: center" styleClass="etat_#{mvtVir.statutPiece}">
                            #{line_M+1}
                            <h:graphicImage library="img" rendered="#{mvtVir.new_}" name="redo.png" width="15" height="15" />
                            <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{mvtVir.id eq managedVirement.pieceCaisse.id}"/>
                        </p:column>
                        <p:column headerText="#{lab.L_numero}" width="180" styleClass="etat_#{mvtVir.statutPiece}">
                            #{mvtVir.numeroPiece}
                            <h:panelGroup style="float: right">
                                <h:outputText title="#{lab.LCF_PVC_comptabiliser}" value="C" rendered="#{managedVirement.isComptabilise(mvtVir)}" styleClass="style_statut"/>
                            </h:panelGroup>
                        </p:column>   
                        <p:column headerText="#{lab.L_date}" width="100" styleClass="etat_#{mvtVir.statutPiece}" style="text-align: center">
                            <h:outputText value="#{mvtVir.datePiece}" converter="DATE" />
                        </p:column>                        
                        <p:column headerText="#{lab.LCF_PVC_source}" styleClass="etat_#{mvtVir.statutPiece}">
                            #{mvtVir.source.intitule}
                        </p:column>
                        <p:column headerText="#{lab.LCF_PVC_cible}" styleClass="etat_#{mvtVir.statutPiece}" >
                            #{mvtVir.cible.intitule}
                        </p:column>
                        <p:column headerText="#{lab.L_montant}" width="100" styleClass="etat_#{mvtVir.statutPiece}" style="text-align: right">
                            <h:outputText value="#{mvtVir.montant + mvtVir.montantCout}" converter="#{managedVirement.converter}" />
                        </p:column>
                        <p:column headerText="#{lab.LCF_PVC_virement_par}" width="100" styleClass="etat_#{mvtVir.statutPiece}" style="text-align: center">
                            <h:outputText value="#{mvtVir.model.designation}" />
                        </p:column>
                        <p:column headerText="#{lab.LCF_PVC_date_paiement}" width="100" styleClass="etat_#{mvtVir.statutPiece}" style="text-align: center">
                            <h:outputText value="#{(!mvtVir.statutPiece.equals(constantes.STATUT_DOC_PAYER))?mvtVir.datePaimentPrevu:mvtVir.datePaiement}" converter="DATE" 
                                          title="#{(!mvtVir.statutPiece.equals(constantes.STATUT_DOC_PAYER))?'Date de paiement prévu':'Date de paiement'}"/>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PVC_caissier}" styleClass="etat_#{mvtVir.statutPiece}">
                            #{mvtVir.caissierSource.nomUsers}
                        </p:column>    
                        <p:column width="20" style="text-align: center" styleClass="etat_#{mvtVir.statutPiece}">
                            <p:commandLink global="false" actionListener="#{managedVirement.print(mvtVir)}" style="margin-top: 5px" ajax="false">
                                <h:graphicImage title="#{lab.L_imprimer}" library="img" name="pdf.png" width="15" height="15"/>                                        
                            </p:commandLink>
                        </p:column>
                        <p:column headerText="" width="20" style="text-align: center" >                                                           
                            <f:facet name="header">
                                <p:contextMenu for="btn_option_head_virement" event="left click" styleClass="context_menu" style="width: 210px"> 
                                    <p:menuitem icon="ui-icon-link" value="#{lab.LC_PFA_etat_comptabiliser}" global="false" onclick="dglEtatComptabilised.show()"/>
                                </p:contextMenu>
                                <p:commandButton icon="ui-icon-gear" styleClass="button_gear" id="btn_option_head_virement" type="button"/>
                            </f:facet>
                            <p:contextMenu for="btn_option_pcm2" event="left click" style="font-size: 0.9em">
                                <p:menuitem value="#{!mvtVir.comptabilise?'Comptabiliser':'Annuler Comptabilité'}" actionListener="#{managedVirement.setEntity(mvtVir)}" 
                                            oncomplete="#{!mvtVir.comptabilise?'dlgComptabiliseDoc.show()':'dlgUnComptabiliseDoc.show()'}" icon="ui-icon-arrowthick-2-e-w" 
                                            rendered="#{mvtVir.statutPiece == constantes.STATUT_DOC_PAYER}"/> 
                                <p:menuitem value="#{lab.LC_PES_reconstruire_reference}" icon="ui-icon-refresh" actionListener="#{managedVirement.reBuildNumero(mvtVir, true, true)}" global="false" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"/>
                                <p:menuitem value="#{lab.LC_PCV_valider}" icon="ui-icon-circle-check" actionListener="#{managedVirement.payerPieceCaisse(mvtVir)}" rendered="#{managedVirement.canValide(mvtVir)}" update="table_all_pieceCaisse_virement"/>
                                <p:menuitem value="#{(mvtVir.statutPiece==constantes.STATUT_DOC_ATTENTE)?'Annuler':'Mettre en attente'}" icon="#{(mvtVir.statutPiece==constantes.STATUT_DOC_ATTENTE)?'ui-icon-circle-close':'ui-icon-circle-check'}" 
                                            actionListener="#{managedVirement.openConfirmrPaiement(mvtVir)}" />
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedVirement.openDlgToDelete(mvtVir)}" />
                                <p:separator  />
                                <p:menuitem value="#{lab.LCF_PVC_sup_versement}" icon="ui-icon-circle-close" actionListener="#{managedVirement.removeVersement(mvtVir)}" oncomplete="dlgRemoveVersement.show()"
                                            rendered="#{mvtVir.versement.id gt 0}"/>
                            </p:contextMenu>
                            <p:commandButton icon="ui-icon-gear" styleClass="button_gear" id="btn_option_pcm2" type="button"/>
                        </p:column>
                        <p:column width="25" style="text-align: center" styleClass="statut_#{oth.statutDoc}">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_pieceCaissVir" value="false"
                                                         onclick="selectionAllLineTab(#{managedVirement.listAllVirement.size()}, 'pieceCaissVir')">
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox  styleClass="chek_line_pieceCaissVir" 
                                                      onclick="selectionLineTab(#{line_M}, 'pieceCaissVir')">
                            </h:selectBooleanCheckbox>
                        </p:column> 
                    </p:dataTable>
                    <span class="nbSelectpieceC aissVir" style="font-size: .8em; font-style: italic; color: #828c95;"></span>                   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block" >
                        <p:commandButton actionListener="#{managedVirement.paginer(false)}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement" icon="ui-icon-circle-triangle-w" disabled="#{managedVirement.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedVirement.paginator.currentPage}/#{managedVirement.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton action="#{managedVirement.paginer(true)}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement" icon="ui-icon-circle-triangle-e" disabled="#{managedVirement.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedVirement.imax}"  valueChangeListener="#{managedVirement.changeMaxResult}"
                                         label="#{lab.L_nombre_max_resultat}" style="float: right; font-size: 0.9em;width: 50px" >
                            <f:selectItems value="#{managedVirement.paginations}" />
                            <p:ajax event="valueChange" update=":main_form_virement_caiss:table_all_pieceCaisse_virement" />
                        </p:selectOneMenu>
                    </p:outputPanel>
                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" id="form-search_virement">
            <div class="zone_find" style="font-size: 0.8em"> 
                <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative" width="20" height="20"
                                styleClass="img_slide" title="#{lab.L_cacher}"/>  
                <div class="yvs_form_pieceCaissVir display_auteur" align="right"  style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedVirement.entity.dateSave}" converter="LD"  styleClass="valeur" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedVirement.entity.dateUpdate}" converter="LD" styleClass="valeur" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedVirement.entity.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>                  
                <h:panelGrid id="zone-search_virement_caisse" columns="9" style="font-size: 0.9em">
                    <span>&nbsp;</span>
                    <h:panelGroup>
                        <h:outputText value="#{lab.L_dates}" />
                        <h:selectBooleanCheckbox value="#{managedVirement.paramDate}" valueChangeListener="#{managedVirement.addParamDate}">
                            <p:ajax event="valueChange" update="zone_pcv_search_date :main_form_virement_caiss:table_all_pieceCaisse_virement" />
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:outputText value="#{lab.L_statut}" />
                    <h:outputText value="#{lab.LCF_PVC_source}" />
                    <h:outputText value="#{lab.LC_PVTS_destination}" />
                    <h:outputText value="#{lab.L_montant}" />                    
                    <h:outputText value="#{lab.LCF_PVC_caissier}" />
                    <h:outputText value="#{lab.LCF_PVC_num_ref}" />
                    <h:outputText value="#{lab.LCF_PVC_versement}" />
                    <p:commandButton icon="ui-icon-bullet" title="#{lab.LCF_PVC_reset_filtre_recherche}" style="width: 22px; height: 22px"
                                     actionListener="#{managedVirement.clearParams()}" update="zone-search_virement_caisse :main_form_virement_caiss:table_all_pieceCaisse_virement"/>
                    <h:panelGroup id="zone_pcv_search_date">                        
                        <p:calendar value="#{managedVirement.debutF}" pattern="dd-MM-yyyy" navigator="true" disabled="#{!managedVirement.paramDate}" size="8">
                            <p:ajax event="dateSelect" listener="#{managedVirement.addParamDateF}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"   />
                        </p:calendar>
                        <p:calendar value="#{managedVirement.finF}" pattern="dd-MM-yyyy" navigator="true" disabled="#{!managedVirement.paramDate}" size="8">
                            <p:ajax event="dateSelect" listener="#{managedVirement.addParamDateF}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"  />
                        </p:calendar>
                    </h:panelGroup>
                    <h:selectOneMenu value="#{managedVirement.statut_}">
                        <f:selectItem itemValue="#{null}" itemLabel="#{lab.L_tout}" />
                        <f:selectItem itemValue="#{'W'}" itemLabel="#{lab.LCF_PVC_en_attente}" />
                        <f:selectItem itemValue="#{'U'}" itemLabel="#{lab.LCF_PVC_soumis}" />
                        <f:selectItem itemValue="#{'P'}" itemLabel="#{lab.LCF_PVC_payer}" />
                        <f:selectItem itemValue="#{'S'}" itemLabel="#{lab.LCF_PVC_suspendu}" />
                        <p:ajax event="valueChange" listener="#{managedVirement.addParamStatut()}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"  />
                    </h:selectOneMenu>
                    <h:selectOneMenu value="#{managedVirement.caisseSF}" valueChangeListener="#{managedVirement.addParamCaisseS}" 
                                     style="width: 180px" id="zone-search_virement_caisse-source">
                        <f:selectItem itemValue="#{0}" itemLabel="#{lab.L_tout}" />
                        <f:selectItems value="#{managedCaisses.caisses}" var="ca" itemValue="#{ca.id}" itemLabel="#{ca.intitule}" />
                        <f:selectItem itemValue="#{0}" itemLabel="-" />
                        <f:selectItem itemValue="#{-1}" itemLabel="Plus..." />
                        <p:ajax event="valueChange" update=":main_form_virement_caiss:table_all_pieceCaisse_virement" />
                    </h:selectOneMenu>
                    <h:selectOneMenu value="#{managedVirement.caisseDF}" valueChangeListener="#{managedVirement.addParamCaisseD}" style="width: 180px">
                        <f:selectItem itemValue="#{0}" itemLabel="#{lab.L_tout}" />
                        <f:selectItems value="#{managedCaisses.caisses}" var="ca1" itemValue="#{ca1.id}" itemLabel="#{ca1.intitule}" />
                        <p:ajax event="valueChange" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"   />
                    </h:selectOneMenu>                    
                    <h:panelGroup>
                        <h:inputText value="#{managedVirement.montantMinF}" style="width: 100px; display: inline">
                            <p:ajax event="blur" listener="#{managedVirement.addParamMontant()}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"   />
                        </h:inputText>
                        <h:inputText value="#{managedVirement.montantMaxF}" style="width: 100px;display: inline">
                            <p:ajax event="blur" listener="#{managedVirement.addParamMontant()}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"  />
                        </h:inputText>
                    </h:panelGroup>
                    <h:inputText value="#{managedVirement.caissierF}" >
                        <p:ajax event="valueChange" listener="#{managedVirement.addParamCaissier(managedVirement.caissierF)}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement" />
                    </h:inputText>
                    <h:inputText value="#{managedVirement.numPieceF}" >
                        <p:ajax event="valueChange" listener="#{managedVirement.addParamNumeroPiece()}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement" />
                    </h:inputText>
                    <h:selectOneMenu value="#{managedVirement.forVersement}">
                        <f:selectItem itemValue="#{null}" itemLabel="#{lab.L_tout}" />
                        <f:selectItem itemValue="#{true}" itemLabel="#{lab.L_oui}" />
                        <f:selectItem itemValue="#{false}" itemLabel="#{lab.L_non}" />
                        <p:ajax event="valueChange" listener="#{managedVirement.addParamVersement()}" update=":main_form_virement_caiss:table_all_pieceCaisse_virement"   />
                    </h:selectOneMenu>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
