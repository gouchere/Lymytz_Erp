<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui" 
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Postes Charge','modProduction', 'smenDtPosteCharge', true)}
    </ui:define>  
    <ui:define name="contents">
        #{managedPosteCharge.loadAll()}
        #{managedSiteProduction.loadAll()}
        #{managedTypeEtat.loadAll()}
        #{managedCentreCharge.loadAll()}
        #{managedSectionValorisation.loadAll()}
        #{managedUniteMesure.loadByType(constantes.UNITE_TEMPS)}
        #{managedCalendrier.loadByModule(constantes.MOD_PROD)}
        <script type="text/javascript">
            $(function() {
                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 120);
                collapseForm('poste_charge');
                collapseList('etat_ressource');
                collapseList('unite_poste_charge');
            });
        </script>  

        <!-->
        *****************************************************************************
        Boite de dialogue des etats de ressource
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_etat_ressource">
            <p:dialog header="#{lab.LP_PPC_creer_type_etat}" widgetVar="dlgAddTypeEtat" modal="true" width="30%" closeOnEscape="true">
                <h:panelGrid id="form_type_etat_ressource" columns="1" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText value="#{typeEtat.libelle}" style="width: 100%"/>
                    <span>#{lab.L_description}</span>
                    <h:inputTextarea value="#{typeEtat.description}" rows="5" style="width: 100%"/>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" actionListener="#{managedTypeEtat.saveNew()}"
                                 update="form_type_etat_ressource select_type_etat_ressource" oncomplete="dlgAddTypeEtat.hide()"/>
            </p:dialog>
            <p:dialog header="#{lab.LP_PPC_etat_ressource}" widgetVar="dlgEtatRessource" width="70%" closeOnEscape="true"> 
                <div class="dlg_part_fixe">
                    <h:panelGrid columns="2" style="width: 100%;margin-top: -5px" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                        <h:panelGroup>
                            <p:commandButton value="#{lab.L_enregistrer}" id="save_etat_ressource" actionListener="#{managedPosteCharge.saveNewEtat()}" update="form_etat_ressource data_etat_ressource" style="font-size: 0.8em;"/>
                            <p:commandButton value="#{lab.L_nouveau}"  id="cancel_etat_ressource" process="@this" actionListener="#{managedPosteCharge.resetFicheEtat()}" global="false" update="form_etat_ressource"/>   
                        </h:panelGroup>
                        <h:panelGroup style="float: right">
                            <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('etat_ressource');
                                    return false">
                                <h:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                            </h:link>               
                            <h:link onclick="collapseList('etat_ressource');
                                    return false" title="#{lab.L_mode_liste}" >
                                <h:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                            </h:link>
                        </h:panelGroup>
                    </h:panelGrid>
                </div>
                <div class="dlg_part_scroll">
                    <div class="yvs_form_etat_ressource" >
                        <h:panelGrid id="form_etat_ressource" columns="4" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                            <f:facet name="header">
                                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                    <h:panelGroup>
                                        <span>#{lab.L_type} </span>
                                        <h:selectOneMenu value="#{managedPosteCharge.etat.typeEtat.id}" style="min-width: 120px"
                                                         onchange="openDialog(dlgAddTypeEtat, $(this))" id="select_type_etat_ressource">
                                            <f:selectItem itemLabel="--" itemValue="#{0}"/>
                                            <f:selectItems value="#{managedTypeEtat.types}" var="typ" 
                                                           itemLabel="#{typ.libelle}" itemValue="#{typ.id}"/>
                                            <f:selectItem itemLabel="--" itemValue="0"/>
                                            <f:selectItem itemLabel="#{lab.L_creer}" itemValue="-1"/>   
                                        </h:selectOneMenu>
                                    </h:panelGroup>
                                    <h:panelGroup style="float: right;margin-top: 3px">
                                        <span>#{labLP_PPC_taux_obsolescence} </span>
                                        <h:inputText value="#{managedPosteCharge.etat.tauxObsolescence}" style="width: 30%;text-align: right"/>
                                        %
                                    </h:panelGroup>
                                </h:panelGrid>
                            </f:facet>
                            <span>#{lab.LP_PPC_capacite_horaire}</span>
                            <h:inputText value="#{managedPosteCharge.etat.capaciteH}" style="width: 98%;text-align: right">
                                <p:ajax event="blur" listener="#{managedPosteCharge.blurCapaciteEtatRessource(true)}"
                                        update="txt_charge_h_etat_ressource" global="false"/>
                            </h:inputText>
                            <span>#{lab.LP_PPC_capacite_quantite} </span>
                            <h:inputText value="#{managedPosteCharge.etat.capaciteQ}" style="width: 98%;text-align: right">
                                <p:ajax event="blur" listener="#{managedPosteCharge.blurCapaciteEtatRessource(false)}"
                                        update="txt_charge_q_etat_ressource" global="false"/>                            
                            </h:inputText>
                            <span>#{lab.LP_PPC_charge_horaire} </span>
                            <h:inputText id="txt_charge_h_etat_ressource" value="#{managedPosteCharge.etat.chargeH}" readonly="true"
                                         style="width: 98%;text-align: right;color: #{managedPosteCharge.etat.chargeH lt 1 and managedPosteCharge.etat.chargeH != 0?'red':''}"/>
                            <span>#{lab.LP_PPC_charge_quantite}</span>
                            <h:inputText id="txt_charge_q_etat_ressource" value="#{managedPosteCharge.etat.chargeQ}" readonly="true"
                                         style="width: 98%;text-align: right;color: #{managedPosteCharge.etat.chargeQ lt 1 and managedPosteCharge.etat.chargeQ != 0?'red':''}"/>
                        </h:panelGrid> 
                    </div>
                    <div class="yvs_list_etat_ressource" >
                        <p:dataTable value="#{managedPosteCharge.selectPoste.etats}" var="etat" rowKey="#{etat.id}" rowIndexVar="eIdx"
                                     selectionMode="single" id="data_etat_ressource">
                            <p:ajax event="rowSelect" global="false" listener="#{managedPosteCharge.loadOnViewEtat}" update=":main_etat_ressource:form_etat_ressource"
                                    oncomplete="collapseForm('etat_ressource')"/>
                            <p:ajax event="rowUnselect" global="false" listener="#{managedPosteCharge.unLoadOnViewEtat}" update=":main_etat_ressource:form_etat_ressource"/>
                            <p:column headerText="N°" width="20">
                                <span>#{eIdx+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.LP_PPC_etat}" width="100">
                                <span>#{etat.typeEtat.libelle}</span>                 
                            </p:column>                                
                            <p:column headerText="#{lab.LP_PPC_capacite_h}" width="50" style="text-align: right">
                                <h:outputText value="#{etat.capaciteH}" converter="DNA"/>
                            </p:column>
                            <p:column headerText="#{lab.LP_PPC_capacite_q}" width="50" style="text-align: right">
                                <h:outputText value="#{etat.capaciteQ}" converter="DNA"/>
                            </p:column>
                            <p:column headerText="#{lab.LP_PPC_charge_h}" width="50" style="text-align: right;color: #{etat.chargeH lt 1 and etat.chargeH != 0?'red':''}">
                                <h:outputText value="#{etat.chargeH}" converter="DNS"/>
                            </p:column>
                            <p:column headerText="#{lab.LP_PPC_charge_q}" width="50" style="text-align: right;color: #{etat.chargeQ lt 1 and etat.chargeQ != 0?'red':''}">
                                <h:outputText value="#{etat.chargeQ}" converter="DNS"/>
                            </p:column>
                            <p:column width="20" style="text-align: center">
                                <h:graphicImage library="img" name="#{(etat.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                            </p:column>
                            <p:column width="20" style="text-align: center">
                                <p:contextMenu for="btn_option_etat_ressource" event="left click" style="font-size: 0.8em">
                                    <p:menuitem value="#{(etat.actif)?'Desactiver':'Activer'}" icon="#{(etat.actif)?'ui-icon-locked':'ui-icon-unlocked'}" actionListener="#{managedPosteCharge.setActiveEtat(etat)}" 
                                                global="false" update="data_etat_ressource :main_poste_charge:data_poste_charge"/>
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPosteCharge.deleteBeanEtat_(etat)}" oncomplete="dlgConfirmDeleteEtat_.show()"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_etat_ressource" type="button"/>
                            </p:column>
                        </p:dataTable>
                    </div>
                </div>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des employes 
        *****************************************************************************
        <-->  
        <h:form prependId="false" >
            <p:dialog header="#{lab.LP_PPC_selectionner_employer}" widgetVar="dlgListEmployes" modal="true" width="55%" height="450" closeOnEscape="true" footer="#{lab.L_copy}">
                <p:watermark for="txt_tiers_ressource_employe" value="Rechercher..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:panelGroup>
                        <h:inputText value="#{MEmps.numSearch}" style="margin-left: -10px" id="txt_tiers_ressource_employe">
                            <p:ajax event="keyup" global="false" update="data_temployes_ressource_poste" listener="#{MEmps.searchEmployeActif(false)}"/>
                        </h:inputText>
                    </h:panelGroup>                    
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{MEmps.pagineResult(false)}" global="false" update="data_temployes_ressource_poste" icon="ui-icon-circle-triangle-w" disabled="#{MEmps.pa.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{MEmps.pa.currentPage}/#{MEmps.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{MEmps.pagineResult(true)}" global="false" update="data_temployes_ressource_poste" icon="ui-icon-circle-triangle-e" disabled="#{MEmps.pa.disNext}"/>
                        <p:selectOneMenu value="#{MEmps.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{MEmps._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{MEmps.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_temployes_ressource_poste"/>
                        </p:selectOneMenu>
                    </p:outputPanel>  
                </h:panelGrid>
                <p:dataTable id="data_temployes_ressource_poste" value="#{MEmps.listEmployes}" var="empl" rowKey="#{empl.id}"
                             rowIndexVar="emplIdx" selectionMode="single" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedPosteCharge.loadOnViewEmploye}" oncomplete="dlgListEmployes.hide()"
                            update=":main_poste_charge:blog_ressource_poste"/>
                    <p:column headerText="N°" style="width: 1%;text-align: center">
                        <span>#{emplIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_nom}" style="width: 4%">
                        <span>#{empl.nom}</span>                 
                    </p:column>
                    <p:column headerText="#{lab.L_prenom}" style="width: 7%">
                        <span>#{empl.prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_agence}" style="width: 7%">
                        <span>#{empl.agence.designation}</span>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des tiers
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog widgetVar="dlgListTiers" width="60%" closeOnEscape="true" modal="true" footer="&copy; Lymytz" height="450">
                <p:watermark for="txt_tiers_ressource_poste" value="#{lab.L_rechercher}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText value="#{managedTiers.numSearch_}" style="font-size: 0.7em" id="txt_tiers_ressource_poste">
                        <p:ajax event="keyup" listener="#{managedTiers.searchByNum()}" update="data_tiers_ressource_poste" />
                    </h:inputText>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedTiers.init(false)}" global="false" update="data_tiers_ressource_poste" icon="ui-icon-circle-triangle-w" disabled="#{managedTiers.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedTiers.paginator.currentPage}/#{managedTiers.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedTiers.init(true)}" global="false" update="data_tiers_ressource_poste" icon="ui-icon-circle-triangle-e" disabled="#{managedTiers.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedTiers.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedTiers.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedTiers.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_tiers_ressource_poste"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>
                <p:dataTable id="data_tiers_ressource_poste" value="#{managedTiers.listTiers}" var="clt" rowKey="#{clt.id}" rowIndexVar="cltIdx"
                             selectionMode="single" emptyMessage="Aucun tiers" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" listener="#{managedPosteCharge.loadOnViewTiers}" oncomplete="dlgListTiers.hide()" 
                            update=":main_poste_charge:blog_ressource_poste"/>
                    <p:column width="10">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" width="50">
                        <span>#{clt.codeTiers}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_nom}" width="100">
                        <span>#{clt.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_region}" width="80">
                        <span>#{clt.region}</span>
                    </p:column>
                    <p:column width="20" headerText="#{lab.L_actif}" style="text-align: center">
                        <h:graphicImage library="img"  name="#{(clt.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                    </p:column>
                </p:dataTable>   
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des unites de mesure
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LP_PN_unites_mesure}" widgetVar="dlgListUnite" modal="true" width="70%" closeOnEscape="true" height="550"> 
                <div class="dlg_part_fixe">
                    <h:panelGrid columns="2" style="width: 100%;margin-top: -5px" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                        <h:panelGroup>
                            <p:commandButton value="#{lab.L_enregistrer}" id="save_unite_poste_charge" actionListener="#{managedUniteMesure.saveNew()}" update="form_unite_poste_charge data_unite_poste_charge" style="font-size: 0.8em;"/>
                            <p:commandButton value="#{lab.L_nouveau}"  id="cancel_unite_poste_charge" process="@this" actionListener="#{managedUniteMesure.resetFiche()}" global="false" update="form_unite_poste_charge"/>                 
                            <p:outputPanel id="search_unite_poste_charge">
                                <p:watermark for="txt_search_unite_poste_charge" value="#{lab.LP_PN_reference_unite}..." />
                                <p:outputPanel autoUpdate="true" style="float: left;margin-left: -5px" layout="block">
                                    <p:commandButton actionListener="#{managedUniteMesure.loadAll(false, false)}" global="false" update="data_unite_poste_charge" icon="ui-icon-circle-triangle-w" disabled="#{managedUniteMesure.paginator.disPrev}"/>
                                    <p:outputLabel value="#{managedUniteMesure.paginator.currentPage}/#{managedUniteMesure.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                                    <p:commandButton actionListener="#{managedUniteMesure.loadAll(true, false)}" global="false" update="data_unite_poste_charge" icon="ui-icon-circle-triangle-e" disabled="#{managedUniteMesure.paginator.disNext}"/>
                                    <p:selectOneMenu value="#{managedUniteMesure.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedUniteMesure.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                        <f:selectItems value="#{managedUniteMesure.paginations}"/>
                                        <p:ajax event="valueChange" global="false" update="data_unite_poste_charge"/>
                                    </p:selectOneMenu>
                                </p:outputPanel>
                                <p:spacer width="15"/>
                                <h:inputText id="txt_search_unite_poste_charge" value="#{managedUniteMesure.numSearch}" style="text-align: center;margin-top: 2px">
                                    <p:ajax event="keyup" global="false" listener="#{managedUniteMesure.addParamReference()}" update="data_unite_poste_charge"/>
                                </h:inputText> 
                            </p:outputPanel>
                        </h:panelGroup>
                        <h:panelGroup style="float: right">
                            <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('unite_poste_charge');
                                    return false">
                                <h:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                            </h:link>               
                            <h:link onclick="collapseList('unite_poste_charge');
                                    return false" title="#{lab.L_mode_liste}" >
                                <h:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                            </h:link>
                        </h:panelGroup>
                    </h:panelGrid>
                </div>
                <div class="dlg_part_scroll">
                    <div class="yvs_form_unite_poste_charge" >
                        <h:panelGrid id="form_unite_poste_charge" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                            <span>#{lab.L_reference}</span>
                            <h:inputText value="#{uniteMesure.reference}" style="width: 98%"/>
                            <span>#{lab.L_libelle}</span>
                            <h:inputText value="#{uniteMesure.libelle}" style="width: 98%"/>
                            <span>#{lab.L_type}</span>
                            <h:selectOneMenu value="#{uniteMesure.type}" style="width: 98%">
                                <f:selectItems value="#{constantes.UNITES_MESURE}"/>
                            </h:selectOneMenu>
                            <f:facet name="footer">
                                <span>#{lab.L_description}</span>
                                <h:inputTextarea value="#{uniteMesure.description}" rows="5" style="width: 98%"/>
                            </f:facet>
                        </h:panelGrid> 
                    </div>
                    <div class="yvs_list_unite_poste_charge" >
                        <p:dataTable value="#{managedUniteMesure.unites}" var="unite" rowKey="#{unite.id}" rowIndexVar="yIdx"
                                     selectionMode="single" id="data_unite_poste_charge">
                            <p:ajax event="rowSelect" global="false" listener="#{managedPosteCharge.loadOnViewUnite}" oncomplete="dlgListUnite.hide()"
                                    update=":main_poste_charge:tabview_poste_charge:txt_unite_centre_poste_charge"/>
                            <p:column headerText="N°" width="20">
                                <span>#{yIdx+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" width="50">
                                <span>#{unite.reference}</span>                 
                            </p:column>                                
                            <p:column headerText="#{lab.L_designation}" width="100">
                                <span>#{unite.libelle}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_type}" width="80">
                                <span>#{managedUniteMesure.giveNameUnite(unite.type)}</span>
                            </p:column>
                            <p:column width="20" style="text-align: center">
                                <p:contextMenu for="btn_option_unite_poste_charge" event="left click" style="font-size: 0.8em">
                                    <p:menuitem value="#{lab.LP_PN_generer_table}" icon="ui-icon-newwin" actionListener="#{managedUniteMesure.genererTable(unite, true)}"/>
                                    <p:menuitem value="#{lab.LP_PN_inserer_equivalence}" icon="ui-icon-arrowthick-2-e-w" global="false" actionListener="#{managedUniteMesure.insertAllEquivalence(unite)}"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_unite_poste_charge" type="button"/>
                            </p:column>
                        </p:dataTable>
                    </div>
                </div>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_liste_article}" widgetVar="dlgListArticle" modal="true" width="70%" closeOnEscape="true" height="450"> 
                <p:watermark for="txt_search_article_capacite_poste" value="Reference article..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_article_capacite_poste" value="#{Marticle.article.refArt}" style="text-align: center">
                        <p:ajax event="keyup" global="false" listener="#{Marticle.searchArticleActif(false)}" update="data_article_capacite_poste"/>
                    </h:inputText> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(false, false)}" global="false" update="data_article_capacite_poste" icon="ui-icon-circle-triangle-w" disabled="#{Marticle.pa.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{Marticle.pa.currentPage}/#{Marticle.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(true, false)}" global="false" update="data_article_capacite_poste" icon="ui-icon-circle-triangle-e" disabled="#{Marticle.pa.disNext}"/>
                        <p:selectOneMenu value="#{Marticle.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{Marticle._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{Marticle.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_article_capacite_poste"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable value="#{Marticle.articlesResult}" var="art" rowKey="#{art.id}" rowIndexVar="artIdx"
                             selectionMode="single" scrollable="true" scrollHeight="385" id="data_article_capacite_poste">
                    <p:ajax event="rowSelect" global="false" listener="#{managedPosteCharge.loadOnViewArticle}" oncomplete="dlgListArticle.hide()"
                            update=":main_poste_charge:tabview_poste_charge:form_capacite_poste_charge"/>
                    <p:column headerText="N°" width="20">
                        <span title="#{art.designation}">#{artIdx+1}</span>
                    </p:column>
                    <p:column width="80">
                        <span title="#{art.designation}">#{art.refArt}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_desigantion}" width="100">
                        <span title="#{art.designation}">#{art.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" width="80">
                        <span title="#{art.designation}">#{art.categorie}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_prix_a}" width="80" style="text-align: right">
                        <h:outputText value="#{art.pua}" title="#{art.designation}" converter="DN" />
                    </p:column>
                    <p:column headerText="#{lab.L_prix_v}" width="80" style="text-align: right">
                        <h:outputText value="#{art.puv}" title="#{art.designation}" converter="DN" />
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide();collapseForm('poste_charge')"
                                 update=":main_poste_charge:blog_form_poste_charge :main_poste_charge:data_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBean()}" oncomplete="dlgConfirmDelete.hide();collapseForm('poste_charge')"
                                 update=":main_poste_charge:blog_form_poste_charge :main_poste_charge:data_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCapacite_" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBeanCapacite_()}" oncomplete="dlgConfirmDeleteCapacite_.hide();collapseForm('capacite_poste_charge')"
                                 update=":main_poste_charge:tabview_poste_charge:form_capacite_poste_charge :main_poste_charge:tabview_poste_charge:data_capacite_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCapacite_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCapacite" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBeanCapacite()}" oncomplete="dlgConfirmDeleteCapacite.hide();collapseForm('capacite_poste_charge')"
                                 update=":main_poste_charge:tabview_poste_charge:form_capacite_poste_charge :main_poste_charge:tabview_poste_charge:data_capacite_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCapacite.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCentre_" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBeanCentre_()}" oncomplete="dlgConfirmDeleteCentre_.hide();collapseForm('centre_poste_charge')"
                                 update=":main_poste_charge:tabview_poste_charge:form_centre_poste_charge :main_poste_charge:tabview_poste_charge:data_centre_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCentre_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCentre" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBeanCentre()}" oncomplete="dlgConfirmDeleteCentre.hide();collapseForm('centre_poste_charge')"
                                 update=":main_poste_charge:tabview_poste_charge:form_centre_poste_charge :main_poste_charge:tabview_poste_charge:data_centre_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCentre.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteEtat_" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBeanEtat_()}" oncomplete="dlgConfirmDeleteEtat_.hide();collapseList('etat_ressource')"
                                 update=":main_etat_ressource:form_etat_ressource :main_etat_ressource:data_etat_ressource :main_poste_charge:data_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteEtat_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteEtat" closeOnEscape="true"
                             message="#{lab.LP_PPC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.deleteBeanEtat()}" oncomplete="dlgConfirmDeleteEtat.hide();collapseList('etat_ressource')"
                                 update=":main_etat_ressource:form_etat_ressource :main_etat_ressource:data_etat_ressource :main_poste_charge:data_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteEtat.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmActiveEtat" closeOnEscape="true"
                             message="#{lab.LP_PPC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPosteCharge.forceActiveEtat()}" oncomplete="dlgConfirmActiveEtat.hide();collapseList('etat_ressource')"
                                 update=":main_etat_ressource:data_etat_ressource :main_poste_charge:data_poste_charge"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmActiveEtat.hide()"/>
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_poste_charge">       
            <div class="part_fix">
                <p:splitButton value="#{lab.L_enregistrer}" id="save_poste_charge" actionListener="#{managedPosteCharge.saveNew()}" oncomplete="collapseForm('poste_charge')"
                               update="select_poste_equivalent data_poste_charge">
                    <p:menuitem value="#{lab.L_nouveau}"  id="cancel_poste_charge" actionListener="#{managedPosteCharge.resetFiche()}" update="blog_form_poste_charge"/>                        
                    <p:menuitem value="#{lab.L_supprimer}" global="false" icon="ui-icon-trash" onclick="dlgConfirmDelete.show()"/>
                </p:splitButton>
                <p:commandButton value="#{lab.L_supprimer}" id="delete_poste_charge" global="false" icon="ui-icon-trash" onclick="dlgConfirmDelete.show()"/>
                <h:panelGroup style="margin-left: 25%">
                    <p:commandButton actionListener="#{managedPosteCharge.parcoursInAllResult(false)}" update="txt_parc_linear_poste_charge" global="false"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('poste_charge')"/>
                    <h:inputText value="#{managedPosteCharge.offset}" style="width: 35px; text-align: center;"  title="Aller au N°..." id="txt_parc_linear_poste_charge"/>
                    <p:outputPanel autoUpdate="true">                        
                        <p:outputLabel value="/#{managedPosteCharge.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedPosteCharge.parcoursInAllResult(true)}" update="txt_parc_linear_poste_charge" global="false" icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('poste_charge')"/>
                </h:panelGroup>
                <div style="float: right">
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('poste_charge');
                            return false">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>               
                    <p:spacer />
                    <h:link  onclick="collapseList('poste_charge');
                            return false" title="#{lab.L_mode_liste}" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>                   
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_poste_charge">    
                    <p:outputPanel id="blog_form_poste_charge">
                        <h:panelGrid id="form_poste_charge" columns="4" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                            <f:facet name="header">
                                <h:panelGrid columns="2" style="width: 100%;font-weight: bold;margin-bottom: -5px" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                    <h:panelGroup>
                                        <span>#{lab.L_type} </span>
                                        <h:selectOneMenu value="#{posteCharge.type}">
                                            <f:selectItem itemLabel="#{lab.LP_PPC_machine}" itemValue="M"/>
                                            <f:selectItem itemLabel="#{lab.LP_PPC_main_oeuvre}" itemValue="H"/>
                                            <f:selectItem itemLabel="#{lab.LP_PPC_sous_traitant}" itemValue="S"/>
                                            <p:ajax event="valueChange" global="false" listener="#{managedPosteCharge.chooseType()}" update="blog_ressource_poste"/>
                                        </h:selectOneMenu>
                                    </h:panelGroup>
                                    <h:panelGrid id="blog_ressource_poste" style="float: right" columns="4" cellpadding="0" cellspacing="0">
                                        <h:outputText value="#{posteCharge.type == 'H'?'Employe':'Tiers'}" rendered="#{posteCharge.type == 'H' or posteCharge.type == 'S'}" style="float: left"/>
                                        <h:panelGroup rendered="#{posteCharge.type == 'H' or posteCharge.type == 'S'}">
                                            <h:inputText value="#{posteCharge.tiers.codeTiers}" title="#{posteCharge.tiers.nom_prenom}" rendered="#{posteCharge.type == 'S'}"
                                                         style="color: #{posteCharge.tiers.error?'red':'normal'}">
                                                <p:ajax event="blur" global="false" listener="#{managedPosteCharge.searchTiers()}" update="blog_ressource_poste"/>
                                            </h:inputText>
                                            <h:inputText value="#{posteCharge.employe.matricule}" title="#{posteCharge.employe.nom_prenom}" rendered="#{posteCharge.type == 'H'}"
                                                         style="color: #{posteCharge.employe.error?'red':'normal'}">
                                                <p:ajax event="blur" global="false" listener="#{managedPosteCharge.searchEmploye()}" update="blog_ressource_poste"/>
                                            </h:inputText>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{posteCharge.type == 'H' or posteCharge.type == 'S'}" style="margin-left: -10px">
                                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white" title="Liste Tiers" global="false"
                                                             actionListener="#{managedPosteCharge.initTiers()}" oncomplete="dlgListTiers.show()" rendered="#{posteCharge.type == 'S'}"/>
                                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white" title="Liste Employe" global="false"
                                                             actionListener="#{managedPosteCharge.initEmployes()}" oncomplete="dlgListEmployes.show()" rendered="#{posteCharge.type == 'H'}"/>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{posteCharge.type == 'H' or posteCharge.type == 'S'}" style="margin-left: -20px">
                                            <h:outputText value="#{posteCharge.tiers.nom_prenom}" style="margin-left: 10px;color: #009999" rendered="#{posteCharge.type == 'S'}"/>  
                                            <h:outputText value="#{posteCharge.employe.nom_prenom}" style="margin-left: 10px;color: #009999" rendered="#{posteCharge.type == 'H'}"/> 
                                        </h:panelGroup>
                                    </h:panelGrid>
                                </h:panelGrid>
                            </f:facet>
                            <span>#{lab.L_reference} </span>
                            <h:inputText value="#{posteCharge.reference}" style="width: 98%"/>
                            <span>#{lab.L_designation} </span>
                            <h:inputText value="#{posteCharge.designation}" style="width: 98%"/>
                            <span>#{lab.LP_PPC_capacite_max}</span>
                            <h:inputText value="#{posteCharge.capaciteQ}" style="width: 98%"/>
                            <span>#{lab.LP_PPC_poste_equivalent} </span>
                            <h:selectOneMenu id="select_poste_equivalent" value="#{posteCharge.posteEquivalent}" style="width: 98%">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedPosteCharge.postes}" var="p" 
                                               itemLabel="#{p.designation}" itemValue="#{p.id}"/>
                            </h:selectOneMenu>
                            <span>#{lab.LP_PPC_site_rattachement} </span>
                            <h:selectOneMenu value="#{posteCharge.site.id}" style="width: 98%">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedSiteProduction.sites}" var="sit" 
                                               itemLabel="#{sit.designation}" itemValue="#{sit.id}"/>
                            </h:selectOneMenu>
                            <span>#{lab.LP_PPC_calendrier} </span>
                            <h:selectOneMenu value="#{posteCharge.calendrier.id}" style="width: 98%">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedCalendrier.calendriers}" var="cal" 
                                               itemLabel="#{cal.reference}" itemValue="#{cal.id}"/>
                            </h:selectOneMenu>
                            <span>#{lab.LP_PPC_centre_charge} </span>
                            <h:selectOneMenu value="#{posteCharge.centre.id}" style="width: 98%">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedCentreCharge.centres}" var="centr" 
                                               itemLabel="#{centr.designation}" itemValue="#{centr.id}"/>
                            </h:selectOneMenu>
                            <span>#{lab.LP_PPC_centre_valorisation} </span>
                            <h:selectOneMenu value="#{posteCharge.centreVal.id}" style="width: 98%">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedSectionValorisation.centres}" var="cV" 
                                               itemLabel="#{cV.designation}" itemValue="#{cV.id}"/>
                                <p:ajax event="valueChange" global="false" listener="#{managedPosteCharge.chooseCentreValorisation()}" />
                            </h:selectOneMenu>
                            <f:facet name="footer">
                                <span>#{lab.L_description}</span>
                                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: right" cellpadding="0" cellspacing="0">
                                    <span>#{lab.LP_PPC_type_valeur}</span>
                                    <h:selectOneMenu value="#{posteCharge.typeValeur}" style="min-width: 200px">
                                        <f:selectItem itemLabel="#{constantes.DIRECT_NAME}" itemValue="#{constantes.DIRECT}"/>
                                        <f:selectItem itemLabel="#{constantes.CALCULE_NAME}" itemValue="#{constantes.CALCULE}"/>
                                    </h:selectOneMenu>                                    
                                </h:panelGrid>
                                <h:inputTextarea value="#{posteCharge.description}" rows="2" style="width: 100%;margin-bottom: 5px;clear: right"/>
                            </f:facet>
                        </h:panelGrid>
                        <h:panelGrid id="form_detail_poste_charge" columns="6" style="width: 100%;background: #c2dfef" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                            <f:facet name="header">
                                <span style="float: left">#{lab.LP_PPC_details_execution} </span>
                            </f:facet>
                            <span>#{lab.LP_PPC_taux_reglement} </span>
                            <h:panelGroup>
                                <h:inputText value="#{posteCharge.tauxRendement}" style="text-align: right;width: 50%"/>
                                <span>%</span>
                            </h:panelGroup>
                            <span>#{lab.LP_PPC_temps_execution} </span>
                            <h:panelGroup>
                                <h:inputText value="#{posteCharge.tempsExecution}" style="text-align: right;width: 50%"/>
                                <span>h</span>
                            </h:panelGroup>
                            <span>#{lab.LP_PPC_temps_rebus}</span>
                            <h:panelGroup>
                                <h:inputText value="#{posteCharge.tempsRebus}" style="text-align: right;width: 50%"/>
                                <span>h</span>
                            </h:panelGroup>
                            <span>#{lab.LP_PPC_temps_attente} </span>
                            <h:panelGroup>
                                <h:inputText value="#{posteCharge.tempsAttente}" style="text-align: right;width: 50%"/>
                                <span>h</span>
                            </h:panelGroup>
                            <span>#{lab.LP_PPC_temps_reglage} </span>
                            <h:panelGroup>
                                <h:inputText value="#{posteCharge.tempsReglage}" style="text-align: right;width: 50%"/>
                                <span>h</span>
                            </h:panelGroup>
                            <span>#{lab.LP_PPC_temps_transfert} </span>
                            <h:panelGroup>
                                <h:inputText value="#{posteCharge.tempsTransfert}" style="text-align: right;width: 50%"/>
                                <span>h</span>
                            </h:panelGroup>
                        </h:panelGrid>
                        <p:tabView id="tabview_poste_charge">
                            <p:tab title="#{lab.LP_PPC_capacites}">
                                <p:outputPanel id="blog_form_capacite_poste_charge">
                                    <div style="width: 30%;float: left">
                                        <h:panelGrid id="form_capacite_poste_charge" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                            <f:facet name="header">
                                                <h:outputText id="txt_article_capacite_poste_charge" value="#{managedPosteCharge.capacite.article.designation}" style="color: #003399;float: right"/>
                                            </f:facet>
                                            <span>#{lab.L_article} </span>
                                            <h:panelGroup style="float: left;width: 100%">
                                                <h:inputText value="#{managedPosteCharge.capacite.article.refArt}" style="color: #{managedPosteCharge.capacite.article.error?'red':''};width: 90%">
                                                    <p:ajax event="blur" global="false" listener="#{managedPosteCharge.searchArticle()}" update="@this txt_article_capacite_poste_charge"/>
                                                </h:inputText>                                                      
                                                <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="Liste Articles" global="false"
                                                                 actionListener="#{managedPosteCharge.initArticles()}" oncomplete="dlgListArticle.show()"/>
                                            </h:panelGroup> 
                                            <span>Capacité </span>
                                            <h:inputText value="#{managedPosteCharge.capacite.capaciteQ}" style="width: 98%;text-align: right"/>
                                            <f:facet name="footer">
                                                <p:commandButton value="#{lab.L_nouveau}" actionListener="#{managedPosteCharge.resetFicheCapacite()}"
                                                                 update="form_capacite_poste_charge"/>
                                                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedPosteCharge.saveNewCapacite()}"
                                                                 update="data_capacite_poste_charge form_capacite_poste_charge" style="float: right"/>
                                            </f:facet>
                                        </h:panelGrid>
                                    </div>
                                    <div style="width: 69%;margin-left: 31%">
                                        <p:dataTable id="data_capacite_poste_charge" value="#{posteCharge.capacites}" var="cap" rowKey="#{cap.id}"
                                                     rowIndexVar="cIdx" selectionMode="single">
                                            <p:ajax event="rowSelect" global="false" listener="#{managedPosteCharge.loadOnViewCapacite}"
                                                    update=":main_poste_charge:tabview_poste_charge:form_capacite_poste_charge"/>
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedPosteCharge.unLoadOnViewCapacite}"
                                                    update=":main_poste_charge:tabview_poste_charge:form_capacite_poste_charge"/>
                                            <p:column headerText="N°" style="width: 10%">
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{cap.new_}"/>
                                                <span>#{cIdx+1}</span>
                                            </p:column>
                                            <p:column filterBy="#{cap.articles.refArt}" style="width: 20%">
                                                <span>#{cap.articles.refArt}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.L_article}">
                                                <span>#{cap.articles.designation}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LP_PPC_capacite}" style="width: 15%;text-align: right">
                                                <h:outputText value="#{cap.capaciteQ}" converter="DNS"/>
                                            </p:column>
                                            <p:column width="22" style="text-align: center">
                                                <p:contextMenu for="btn_option_capacite_poste_charge" event="left click" style="font-size: 0.8em">
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPosteCharge.deleteBeanCapacite_(cap)}" oncomplete="dlgConfirmDeleteCapacite_.show()"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_capacite_poste_charge" type="button"/>
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                </p:outputPanel>
                                <div style="clear: both"/>
                            </p:tab>
                            <p:tab title="#{lab.LP_PPC_valorisation}" rendered="false">
                                <p:outputPanel>
                                    <div style="width: 30%;float: left">
                                        <h:panelGrid id="form_centre_poste_charge" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                            <span>#{lab.LP_PPC_centre} </span>
                                            <h:selectOneMenu value="#{managedPosteCharge.centre.centre.id}" style="width: 98%">
                                                <f:selectItem itemLabel="--" itemValue="0"/>
                                                <f:selectItems value="#{managedSectionValorisation.centres}" var="cent" 
                                                               itemLabel="#{cent.designation}" itemValue="#{cent.id}"/>
                                            </h:selectOneMenu>
                                            <span>#{lab.LP_PPC_periode} </span>     
                                            <h:panelGroup id="txt_unite_centre_poste_charge">
                                                <h:inputText value="#{managedPosteCharge.centre.periode.reference}" style="color: #{managedPosteCharge.centre.periode.error?'red':''};width: 30%">
                                                    <p:ajax event="blur" global="false" listener="#{managedPosteCharge.searchUniteMesure()}" update="txt_unite_centre_poste_charge"/>
                                                </h:inputText>    
                                                <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LDB_PA_liste_unites}" global="false"
                                                                 actionListener="#{managedPosteCharge.initUnites()}" oncomplete="dlgListUnite.show()" />
                                                <h:outputText value="#{managedPosteCharge.centre.periode.libelle}" style="color: #003399"/>
                                            </h:panelGroup> 
                                            <span>#{lab.LP_PPC_valeur}</span>
                                            <h:inputText value="#{managedPosteCharge.centre.valeur}" style="width: 98%;text-align: right"/>
                                            <span>#{lab.LP_PPC_direct}</span>
                                            <h:selectBooleanCheckbox value="#{managedPosteCharge.centre.direct}"/>
                                            <f:facet name="footer">
                                                <p:commandButton value="#{lab.L_nouveau}" actionListener="#{managedPosteCharge.resetFicheCentre()}"
                                                                 update="form_centre_poste_charge"/>
                                                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedPosteCharge.saveNewCentre()}"
                                                                 update="form_centre_poste_charge data_centre_poste_charge" style="float: right"/>
                                            </f:facet>
                                        </h:panelGrid>
                                    </div>
                                    <div style="width: 69%;margin-left: 31%">
                                        <p:dataTable id="data_centre_poste_charge" value="#{posteCharge.centres}" var="cen" rowKey="#{cen.id}"
                                                     rowIndexVar="cIdx" selectionMode="single">
                                            <p:ajax event="rowSelect" global="false" listener="#{managedPosteCharge.loadOnViewCentre}"
                                                    update=":main_poste_charge:tabview_poste_charge:form_centre_poste_charge"/>
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedPosteCharge.unLoadOnViewCentre}"
                                                    update=":main_poste_charge:tabview_poste_charge:form_centre_poste_charge"/>
                                            <p:column headerText="N°" style="width: 10%">
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{cen.new_}"/>
                                                <span>#{cIdx+1}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LP_PPC_centre}">
                                                <span>#{cen.centreValorisation.designation}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LP_PPC_valeur}" style="width: 15%;text-align: right">
                                                <h:outputText value="#{cen.valeur}" converter="DNS"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LP_PPC_periode}" style="width: 20%;text-align: center">
                                                <h:outputText value="#{cen.periode.libelle}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LP_PPC_direct}" style="width: 10%;text-align: center">
                                                <h:graphicImage library="img" name="#{(cen.direct)?'yes.png':'no.png'}" width="15" height="15"/>
                                            </p:column>
                                            <p:column width="22" style="text-align: center">
                                                <p:contextMenu for="btn_option_centre_poste_charge" event="left click" style="font-size: 0.8em">
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPosteCharge.deleteBeanCentre_(cen)}" oncomplete="dlgConfirmDeleteCentre_.show()"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_centre_poste_charge" type="button"/>
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                </p:outputPanel>
                                <div style="clear: both"/>
                            </p:tab>
                        </p:tabView>
                    </p:outputPanel>
                </div>
                <!-->
                   *****************************************************************************
                   Vue Liste
                   *****************************************************************************
                 <-->
                <div class="yvs_list_poste_charge">
                    <h:inputHidden id="input_hide_poste_charge" value="#{managedPosteCharge.tabIds}"/>

                    <p:dataTable id="data_poste_charge" value="#{managedPosteCharge.postes}" var="postC" 
                                 rowIndexVar="postCLIne" rowKey="#{postC.id}" selectionMode="single" >
                        <p:ajax event="rowSelect" listener="#{managedPosteCharge.loadOnView}" update=":main_poste_charge:blog_form_poste_charge :main_poste_charge:input_hide_poste_charge"
                                oncomplete="collapseForm('poste_charge')"/>
                        <p:column headerText="N°" style="width: 5%">
                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{postC.new_}"/>
                            <span>#{postCLIne+1}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}">
                            <span>#{postC.reference}</span>        
                            <h:panelGroup style="float: right">
                                <h:outputText title="#{lab.LP_PPC_valeur_directe}" value="D" rendered="#{postC.typeValeur == constantes.DIRECT}" styleClass="style_statut"/>
                            </h:panelGroup>         
                        </p:column>
                        <p:column headerText="#{lab.L_designation}">
                            <span>#{postC.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_type}" style="text-align: center;width: 15%">
                            <span>#{postC.typeName}</span>
                        </p:column>
                        <p:column headerText="#{lab.LP_PPC_production}" style="width: 15%">
                            <span>#{postC.siteProduction.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.LP_PPC_capacite}" style="text-align: right;width: 10%">
                            <h:outputText value="#{postC.capaciteH}" converter="DNS"/>
                            <span>h/mois</span>
                        </p:column>
                        <p:column headerText="#{lab.LP_PPC_rendement}" style="text-align: right;width: 8%">
                            <h:outputText value="#{postC.tauxRendement}" converter="DNS"/>
                            <span>%</span>
                        </p:column>
                        <p:column width="22" style="text-align: center">
                            <p:contextMenu for="btn_option_poste_charge" event="left click" style="font-size: 0.8em">
                                <p:menuitem value="#{lab.LP_PPC_etats}" icon="ui-icon-info" global="false" actionListener="#{managedPosteCharge.managedEtatRessource(postC)}"
                                            update=":main_etat_ressource:data_etat_ressource" oncomplete="dlgEtatRessource.show()"/>
                                <p:separator />
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPosteCharge.deleteBean_(postC)}" oncomplete="dlgConfirmDelete_.show()"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_poste_charge" type="button"/>
                        </p:column>
                        <p:column width="22" style="text-align: center">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_poste_charge" value="false"
                                                         onclick="selectionAllLineTab(#{managedPosteCharge.postes.size()}, 'poste_charge')">
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox  value="#{postC.select}" styleClass="chek_line_poste_charge" 
                                                      onclick="selectionLineTab(#{postCLIne}, 'poste_charge')">
                            </h:selectBooleanCheckbox>
                        </p:column>
                    </p:dataTable>   
                    <span class="nbSelectposte_charge" style="font-size: .8em; font-style: italic; color: #828c95;"></span>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedPosteCharge.init(false)}" global="false" update="data_poste_charge" icon="ui-icon-circle-triangle-w" disabled="#{managedPosteCharge.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedPosteCharge.paginator.currentPage}/#{managedPosteCharge.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedPosteCharge.init(true)}" global="false" update="data_poste_charge" icon="ui-icon-circle-triangle-e" disabled="#{managedPosteCharge.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedPosteCharge.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedPosteCharge.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedPosteCharge.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_poste_charge"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">            
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative; bottom: -20px" width="20" height="20"
                            styleClass="img_slide" title="#{lab.L_cacher}"/>  
            <div class="zone_find">
                <h:panelGrid id="blog_search_poste_charge" columns="2" style="width: 100%; font-size: 1.0em" cellpadding="0" cellspacing="0">
                    <h:panelGrid columns="6" style="float: left; font-size: 0.8em" cellpadding="0" cellspacing="0">
                        <h:outputText value="" />
                        <h:outputText value="#{lab.L_type}" />
                        <h:outputText value="#{lab.LP_PPC_site}" />
                        <h:outputText value="#{lab.LP_PPC_centre}" />
                        <h:outputText value="#{lab.LP_PPC_calendrier}" />
                        <h:outputText value="#{lab.L_reference}" />
                        <p:commandButton icon="ui-icon-bullet" actionListener="#{managedPosteCharge.clearParams()}" title="Reinitialiser les paramètres" style="width: 20px; height: 22px" update="blog_search_poste_charge"/>                    
                        <h:selectOneMenu value="#{managedPosteCharge.typeSearch}">
                            <f:selectItem itemLabel="--" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.LP_PPC_machine}" itemValue="M"/>
                            <f:selectItem itemLabel="#{lab.LP_PPC_main_oeuvre}" itemValue="H"/>
                            <f:selectItem itemLabel="#{lab.LP_PPC_sous_traitant}" itemValue="S"/>
                            <p:ajax event="valueChange" listener="#{managedPosteCharge.addParamType()}" oncomplete="collapseList('poste_charge')" 
                                    update=":main_poste_charge:data_poste_charge"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedPosteCharge.siteSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedSiteProduction.sites}" var="sit" 
                                           itemLabel="#{sit.designation}" itemValue="#{sit.id}"/>
                            <p:ajax event="valueChange" listener="#{managedPosteCharge.addParamSite()}" oncomplete="collapseList('poste_charge')" 
                                    update=":main_poste_charge:data_poste_charge"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedPosteCharge.centreSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedCentreCharge.centres}" var="centr" 
                                           itemLabel="#{centr.designation}" itemValue="#{centr.id}"/>
                            <p:ajax event="valueChange" listener="#{managedPosteCharge.addParamCentre()}" oncomplete="collapseList('poste_charge')" 
                                    update=":main_poste_charge:data_poste_charge"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedPosteCharge.calSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedCalendrier.calendriers}" var="cal" 
                                           itemLabel="#{cal.reference}" itemValue="#{cal.id}"/>
                            <p:ajax event="valueChange" listener="#{managedPosteCharge.addParamCalendier()}" oncomplete="collapseList('poste_charge')" 
                                    update=":main_poste_charge:data_poste_charge"/>
                        </h:selectOneMenu>  
                        <h:inputText value="#{managedPosteCharge.numSearch}">
                            <p:ajax event="blur" listener="#{managedPosteCharge.addParamReference()}" oncomplete="collapseList('poste_charge')"
                                    update=":main_poste_charge:data_poste_charge"/>
                        </h:inputText>
                    </h:panelGrid>
                    <h:panelGroup style="float: right">

                    </h:panelGroup>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>

