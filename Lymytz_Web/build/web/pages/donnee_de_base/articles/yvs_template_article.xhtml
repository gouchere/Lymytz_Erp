<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core">                
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Template Article','modDonneBase', 'smenTemplateProd', true,managedTemplateArticle)}
    </ui:define>               
    <ui:define name="contents">
        #{Marticle.doNothing()}
        #{managedCompte.loadAllActif(true)}        
        #{managedTemplateArticle.loadAll()}
        #{managedUniteMesure.loadAll(constantes.UNITE_QUANTITE)} 
        #{managedCategorieClt.loadAll()}
        #{managedTiers.loadTiersByType('B', true)}
        #{managedCatCompt.loadAll()}
        #{managedTaxes.loadAll()}

        #{managedFamilleArticle.loadAll()}
        #{managedGroupeArticle.loadAll()}
        #{managedClasseStat.loadAll()}

        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - 180);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('template_article');
                collapseList('unite_temp_art');
            });
        </script>         


        <!-->
        *****************************************************************************
        Boite de dialogue de creation des catégories comptable
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LDB_PTA_liste_compte}" widgetVar="dlgListComptes" modal="true" width="50%" closeOnEscape="true" style="max-height: 450px">
                <p:dataTable id="data_comptes_template_article_categorie" value="#{managedCompte.listComptes}" var="cpt" rowKey="#{cpt.id}" 
                             rowIndexVar="cltIdx" selectionMode="single" paginator="true" rows="20" paginatorAlwaysVisible="false">
                    <p:ajax event="rowSelect" global="false" listener="#{managedTemplateArticle.loadOnViewCompte}"  oncomplete="dlgListComptes.hide()" update=":main_template_article:tabview_temp_art:data_compte_template_article"/>
                    <p:column width="15">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column filterBy="#{cpt.numCompte}" width="50" headerText="#{lab.LDB_PTA_numero_g}">
                        <span>#{cpt.numCompte}</span>
                    </p:column>
                    <p:column filterBy="#{cpt.numCompte}" width="50" headerText="#{lab.LDB_PTA_compte_general}">
                        <span>#{cpt.compteGeneral.numCompte}</span>
                    </p:column>
                    <p:column headerText="#{lab.LDB_PTA_intitule}" width="80">
                        <span>#{cpt.intitule}</span>
                    </p:column>
                </p:dataTable>
                <p:outputPanel style="float: right" layout="block" autoUpdate="true">
                    <p:commandButton actionListener="#{managedCompte.pagineDataCompte(false)}" update="data_comptes_template_article_categorie" icon="ui-icon-circle-triangle-w" disabled="#{managedCompte.paginator.disPrev}"/>
                    <p:outputPanel ><p:outputLabel value="#{managedCompte.paginator.currentPage}/#{managedCompte.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedCompte.pagineDataCompte(true)}" update="data_comptes_template_article_categorie" icon="ui-icon-circle-triangle-e" disabled="#{managedCompte.paginator.disNext}"/>
                    <p:selectOneMenu value="#{managedCompte.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCompte.changeMaxResult}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                        <f:selectItems value="#{managedCompte.paginations}"/>
                        <p:ajax event="valueChange" update="data_comptes_template_article_categorie"/>
                    </p:selectOneMenu>
                </p:outputPanel>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog widgetVar="dlgCategorieC" header="Catégorie clients" width="30%" closeOnEscape="true" modal="true">
                <h:panelGrid id="form_art_categorie_client" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <span>#{lab.LDB_PTA_code} </span>
                    <h:inputText value="#{categorieClient.code}"/>
                    <span>#{lab.LDB_PTA_libelle} </span>
                    <h:inputText value="#{categorieClient.libelle}"/>
                    <span>#{lab.LDB_PTA_parent} </span>
                    <h:selectOneMenu value="#{categorieClient.parent.id}" id="select_art_cat_parent_client" style="min-width: 200px">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{managedCategorieClt.categoriesParent}" var="catClt_" 
                                       itemLabel="#{catClt_.libelle}" itemValue="#{catClt_.id}" />                          
                    </h:selectOneMenu> 
                    <span>#{lab.LDB_PTA_defaut} </span>
                    <h:panelGroup>
                        <h:selectBooleanCheckbox value="#{categorieClient.defaut}"/>
                        <h:panelGroup style="float: right">
                            <h:selectBooleanCheckbox value="#{categorieClient.actif}"/>
                            <span>#{lab.L_actif}</span>
                        </h:panelGroup>
                    </h:panelGroup>
                    <f:facet name="footer">
                        <span>#{lab.LDB_PTA_description} </span>
                        <h:inputTextarea value="#{categorieClient.description}" rows="5" style="width: 98%"/>
                    </f:facet>
                </h:panelGrid>
                <div style="margin-top: 5px">
                    <p:commandButton style="float: left" value="#{lab.L_nouveau}" global="false" actionListener="#{managedCategorieClt.resetFiche()}" update="form_art_categorie_client"/>
                    <p:commandButton style="float: right" value="#{lab.L_enregistrer}" actionListener="#{managedCategorieClt.saveNew()}" oncomplete="dlgCategorieC.hide()"
                                     update="form_art_categorie_client :main_template_article:tabview_temp_art:select_catclt_temp_art"
                                     />
                </div>
                <f:facet name="footer">
                    &copy; Lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de gestion des groupes
        *****************************************************************************
        <-->        
        <h:form prependId="false" id="main_grp_temp_art">
            <p:dialog header="#{lab.LDB_PTA_liste_groupes_articles}" widgetVar="dlgArtGroupeArt" modal="true" width="45%" closeOnEscape="true">
                <div class="dlg_part_fixe">
                    <div align="right">
                        <p:inputText value="#{managedGroupeArticle.numSearch}" style="float:left">
                            <p:ajax event="valueChange" global="false"  listener="#{managedGroupeArticle.addParamReference()}" partialSubmit="true" process="@this"
                                    update="art_tab_grp_temp_art" oncomplete="collapseList('grp_temp_art')"/>
                        </p:inputText>
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('grp_temp_art');
                                return false">
                            <p:graphicImage library="icones" name="newDoc.png" width="15" height="22" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>               
                        <p:spacer />
                        <h:link onclick="collapseList('grp_temp_art');
                                return false" title="#{lab.L_mode_liste}" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="15" height="22" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>                                
                    </div>
                    <div style="clear: left" />
                </div>                        
                <div style="height: 93%; overflow-y: auto" class="dlg_part_scroll">
                    <div class="yvs_form_grp_temp_art">
                        <h:panelGrid columns="2" styleClass="yvs_table" style="width: 100%" id="form_grp_temp_art">
                            <span>#{lab.LDB_PTA_references}</span>
                            <h:inputText value="#{groupeArticle.reference}" style="width: 98%"/>
                            <span>#{lab.LDB_PTA_designation}</span>
                            <h:inputText value="#{groupeArticle.designation}" style="width: 98%"/>                                                                
                            <span>#{lab.LDB_PTA_parents}</span>
                            <h:selectOneMenu value="#{groupeArticle.parent.id}" style="width: 98%">
                                <f:selectItem itemLabel=" " itemValue="0" noSelectionOption="true"/>
                                <f:selectItems value="#{managedGroupeArticle.parents}" var="parentg" 
                                               itemLabel="#{parentg.designation}" itemValue="#{parentg.id}" />
                            </h:selectOneMenu>
                            <f:facet name="footer">
                                <span>#{lab.LDB_PTA_description}</span>
                                <h:inputTextarea value="#{groupeArticle.description}" rows="5" style="width: 98%"/>
                            </f:facet>
                        </h:panelGrid>
                        <div>
                            <p:commandButton value="#{lab.L_nouveau}" style="float: left" actionListener="#{managedGroupeArticle.resetFiche()}" 
                                             update=":main_template_article:select_group_temp_art form_grp_temp_art"/>
                            <p:commandButton value="#{lab.L_enregistrer}" style="float: right" actionListener="#{managedGroupeArticle.saveNew()}"
                                             update=":main_template_article:select_group_temp_art art_tab_grp_temp_art form_grp_temp_art"
                                             />
                        </div>
                    </div>
                    <div class="yvs_list_grp_temp_art">                             
                        <p:dataTable id="art_tab_grp_temp_art" value="#{managedGroupeArticle.groupes}" var="groupe" rowIndexVar="groupeLine"
                                     selectionMode="single" rowKey="#{groupe.id}" style="max-height: 400px;overflow-y: auto">
                            <p:ajax event="rowSelect"  listener="#{managedGroupeArticle.loadOnView}"  
                                    oncomplete="collapseForm('grp_temp_art')" update=":main_grp_temp_art:form_grp_temp_art"/>
                            <p:column width="20">
                                #{groupeLine+1}
                            </p:column>
                            <p:column headerText="#{lab.LDB_PTA_reference}">
                                #{groupe.refgroupe}                    
                            </p:column>
                            <p:column headerText="#{lab.LDB_PTA_designation}">
                                #{groupe.designation}                                        
                            </p:column>
                            <p:column headerText="#{lab.LDB_PTA_parent}">
                                #{groupe.groupeParent.refgroupe}
                            </p:column>
                            <p:column width="20" style="text-align: center">
                                <p:commandButton icon="ui-icon-trash" title="#{lab.L_supprimer}" id="delete_grp_temp_art" actionListener="#{managedGroupeArticle.deleteBean_(groupe, false)}" 
                                                 update="art_tab_grp_temp_art" style="width: 22px; height: 22px">
                                </p:commandButton>
                            </p:column>                                    
                        </p:dataTable>     
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                            <p:commandButton actionListener="#{managedGroupeArticle.init(false)}" global="false" update="art_tab_grp_temp_art" icon="ui-icon-circle-triangle-w" disabled="#{managedGroupeArticle.paginator.disPrev}"/>
                            <p:outputPanel ><p:outputLabel value="#{managedGroupeArticle.paginator.currentPage}/#{managedGroupeArticle.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                            <p:commandButton actionListener="#{managedGroupeArticle.init(true)}" global="false" update="art_tab_grp_temp_art" icon="ui-icon-circle-triangle-e" disabled="#{managedGroupeArticle.paginator.disNext}"/>
                            <p:selectOneMenu value="#{managedGroupeArticle.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedGroupeArticle.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                <f:selectItems value="#{managedGroupeArticle.paginations}"/>
                                <p:ajax event="valueChange" global="false" update="art_tab_grp_temp_art"/>
                            </p:selectOneMenu>
                        </p:outputPanel>                            
                    </div>
                </div>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet>
            </p:dialog>  <!-->End Boite de dialogue de gestion des groupe<-->
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue de gestion des familles
        *****************************************************************************
        <-->
        <h:form prependId="false" id="main_fam_temp_art">
            <p:dialog header="#{lab.LDB_PTA_liste_familles_articles}" widgetVar="dlgArtFamArt" modal="true" width="45%" closeOnEscape="true" >
                <div class="dlg_part_fixe">
                    <div align="right">
                        <h:inputText value="#{managedFamilleArticle.numSearch}" style="float: left;">
                            <p:ajax event="valueChange" global="false"  listener="#{managedFamilleArticle.addParamReference()}" update="art_tab_fam_temp_art" />
                        </h:inputText>
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('fam_temp_art');
                                return false">
                            <p:graphicImage library="icones" name="newDoc.png" width="15" height="22" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>               
                        <p:spacer />
                        <h:link onclick="collapseList('fam_temp_art');
                                return false" title="#{lab.L_mode_liste}" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="15" height="22" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>                                
                    </div>             
                    <div style="clear: left" />      
                </div>                        
                <div style="height: 93%; overflow-y: auto" class="dlg_part_scroll">                                        
                    <div class="yvs_form_fam_temp_art">
                        <h:panelGrid columns="2" styleClass="yvs_table" style="width: 100%" id="form_fam_temp_art" cellpadding="0" cellspacing="0">
                            <span>#{lab.LDB_PTA_references}</span>
                            <h:inputText value="#{familleArticle.reference}" style="width: 98%"/>
                            <span>#{lab.LDB_PTA_description}</span>
                            <h:inputTextarea style="width: 99%" rows="5" value="#{familleArticle.description}" />                                                                   
                            <span>#{lab.LDB_PTA_familles_parents}</span>
                            <h:selectOneMenu value="#{familleArticle.parentFamille.id}" style="width: 98%">
                                <f:selectItem itemLabel=" " itemValue="0"/>
                                <f:selectItems value="#{managedFamilleArticle.parents}" var="parentf" 
                                               itemLabel="#{parentf.designation}" itemValue="#{parentf.id}" />
                            </h:selectOneMenu>
                            <f:facet name="footer">
                                <span>#{lab.LDB_PTA_description}</span>
                                <h:inputTextarea value="#{familleArticle.description}" rows="5" style="width: 98%"/>
                            </f:facet>
                        </h:panelGrid>
                        <div>
                            <p:commandButton value="#{lab.L_nouveau}" actionListener="#{managedFamilleArticle.resetFiche()}" update="form_fam_temp_art" style="float: left"/>
                            <p:commandButton value="#{lab.L_enregistrer}" icon="ui-icon-disk" actionListener="#{managedFamilleArticle.saveNew()}" style="float: right" 
                                             update="art_tab_fam_temp_art :main_template_article:txt_fam_temp_art form_fam_temp_art"
                                             />
                        </div>
                    </div>
                    <div class="yvs_list_fam_temp_art">                                
                        <p:dataTable value="#{managedFamilleArticle.familles}" var="famArt_" rowIndexVar="familleLine" id="art_tab_fam_temp_art"
                                     selectionMode="single" rowKey="#{famArt_.id}" style="max-height: 400px;overflow-y:auto">                                     
                            <p:ajax event="rowSelect" listener="#{managedFamilleArticle.loadOnView}" oncomplete="collapseForm('fam_temp_art')"
                                    update=":main_template_article:txt_fam_temp_art :main_fam_temp_art:form_fam_temp_art"  />
                            <p:column width="15" headerText="N°" style="text-align: center">
                                #{familleLine+1}
                            </p:column>
                            <p:column  headerText="#{lab.LDB_PTA_reference}" width="120">
                                #{famArt_.referenceFamille}             
                            </p:column>
                            <p:column  headerText="#{lab.LDB_PTA_designation}" width="220">
                                #{famArt_.designation}
                            </p:column>
                            <p:column headerText="#{lab.LDB_PTA_parent}" width="120">
                                #{famArt_.familleParent.referenceFamille}
                            </p:column>
                            <p:column headerText="" width="20" style="text-align: center">
                                <p:commandButton icon="ui-icon-trash" actionListener="#{managedFamilleArticle.deleteBean_(famArt_, false)}" 
                                                 update="art_tab_fam_temp_art" style="width: 22px; height: 22px;">
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>   
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                            <p:commandButton actionListener="#{managedFamilleArticle.init(false)}" global="false" update="art_tab_fam_temp_art" icon="ui-icon-circle-triangle-w" disabled="#{managedFamilleArticle.paginator.disPrev}"/>
                            <p:outputPanel ><p:outputLabel value="#{managedFamilleArticle.paginator.currentPage}/#{managedFamilleArticle.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                            <p:commandButton actionListener="#{managedFamilleArticle.init(true)}" global="false" update="art_tab_fam_temp_art" icon="ui-icon-circle-triangle-e" disabled="#{managedFamilleArticle.paginator.disNext}"/>
                            <p:selectOneMenu value="#{managedFamilleArticle.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedFamilleArticle.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                <f:selectItems value="#{managedFamilleArticle.paginations}"/>
                                <p:ajax event="valueChange" global="false" update="art_tab_fam_temp_art"/>
                            </p:selectOneMenu>
                        </p:outputPanel> 
                    </div>
                </div>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}  
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        End boîte de dialogue de gestion des conditionnement
        *****************************************************************************
        <-->  
        <!-->Boite de dialogue pour les catégorie<-->
        <h:form prependId="false">
            <p:dialog header="#{lab.LDB_PTA_categorie_comptable}" widgetVar="dlgAddCategorie" closeOnEscape="true" width="40%" footer="&copy;Lymytz 2014">
                <p:panelGrid columns="2" style="width: 98%;margin: auto" id="form_categorie_temp_art_taxe">
                    <span>#{lab.LDB_PTA_code_appel}</span>
                    <h:inputText value="#{categorieComptable.codeAppel}"/>
                    <span>#{lab.LDB_PTA_code_categorie}</span>
                    <h:inputText value="#{categorieComptable.codeCategorie}"/>
                    <span>#{lab.LDB_PTA_nature}</span>
                    <h:selectOneMenu value="#{categorieComptable.nature}">
                        <f:selectItem itemLabel="#{constantes.ACHAT}" itemValue="#{constantes.ACHAT}" />
                        <f:selectItem itemLabel="#{constantes.VENTE}" itemValue="#{constantes.VENTE}" />
                        <f:selectItem itemLabel="#{constantes.STOCK}" itemValue="#{constantes.STOCK}" />
                        <f:selectItem itemLabel="#{constantes.VSTOCK}" itemValue="#{constantes.VSTOCK}" />
                    </h:selectOneMenu> 
                </p:panelGrid>
                <p:commandButton actionListener="#{managedCatCompt.saveNew()}" style="float: right"
                                 update="form_categorie_temp_art_taxe" oncomplete="dlgAddCategorie.hide()"
                                 value="Enregistrer" />
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="#{lab.LDB_PTA_classe_statistique}" widgetVar="dlgAddClasseStat" closeOnEscape="true" width="40%" footer="&copy;Lymytz 2014">
                <p:panelGrid columns="2" style="width: 98%;margin: auto" id="form_classe_stat_temp_art_taxe">
                    <span>#{lab.LDB_PTA_reference}</span>
                    <h:inputText value="#{classesStat.codeRef}"/>
                    <span>#{lab.LDB_PTA_designation}</span>
                    <h:inputText value="#{classesStat.designation}"/>
                    <span>#{lab.L_actif}</span>
                    <p:selectBooleanCheckbox value="#{classesStat.actif}" />
                    <span>#{lab.LDB_PTA_visible_sur_journal_vente}</span>
                    <p:selectBooleanCheckbox value="#{classesStat.visibleJournal}" />
                    <span>#{lab.LDB_PTA_visible_etat_synthese}</span>
                    <p:selectBooleanCheckbox value="#{classesStat.visibleSynthese}" />
                </p:panelGrid>
                <div>
                    <p:commandButton value="#{lab.L_nouveau}" update="form_classe_stat_temp_art_taxe" global="false"
                                     actionListener="#{managedClasseStat.resetFiche()}" style="float: left"/>
                    <p:commandButton value="#{lab.L_enregistrer}" update="form_classe_stat_temp_art_taxe :main_template_article:select_class_temp_art"
                                     actionListener="#{managedClasseStat.saveNew()}" style="float: right"/>
                </div>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="Liste des articles" widgetVar="dlgArticles" width="80%" height="600">
                <div class="dlg_part_fixe">
                    <h:panelGrid columns="6" style="float: left; font-size: 0.8em">
                        <h:outputText value="#{lab.L_categorie}" />
                        <h:outputText value="#{lab.L_famille}" />
                        <h:outputText value="#{lab.L_groupe}" />
                        <h:outputText value="#{lab.L_designation}" />
                        <h:outputText value="" />
                        <span>&nbsp;</span>
                        <h:selectOneMenu value="#{Marticle.categorieSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="" noSelectionOption="true"/>
                            <f:selectItems value="#{constantes.CATEGORIES}" var="cat" itemValue="#{cat.valeur}" itemLabel="#{cat.libelle}" />
                            <p:ajax event="valueChange" listener="#{Marticle.addParamCategorie()}"  
                                    process="@form" update="tab_article"/>                              
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{Marticle.familleSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                            <f:selectItems value="#{managedFamilleArticle.familles}" var="fam" 
                                           itemLabel="#{fam.designation}" itemValue="#{fam.id}" />
                            <p:ajax event="valueChange" listener="#{Marticle.addParamFamille()}"  
                                    process="@form" update="tab_article"/>                              
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{Marticle.groupeSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                            <f:selectItems value="#{managedGroupeArticle.groupes}" var="grp" 
                                           itemLabel="#{grp.designation}" itemValue="#{grp.id}" />
                            <p:ajax event="valueChange" listener="#{Marticle.addParamGroupe()}"  
                                    process="@form" update="tab_article"/>                              
                        </h:selectOneMenu>                        
                        <p:inputText value="#{Marticle.searchArticle}" id="txt_find_article">
                            <p:ajax event="valueChange" listener="#{Marticle.findArticle()}"  
                                    process="@form" update="tab_article"/>
                        </p:inputText>  
                    </h:panelGrid> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{Marticle.loadAllArticle(false,false)}"  update="tab_article " icon="ui-icon-circle-triangle-w" disabled="#{Marticle.paginator.disPrev}" oncomplete=" collapseList('nav_article');"/>
                        <p:outputPanel >
                            <p:inplace label="#{Marticle.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                <pe:inputNumber value="#{Marticle.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                    <p:ajax event="blur" listener="#{Marticle.gotoPagePaginator()}" update="tab_article"/>
                                </pe:inputNumber>
                            </p:inplace><p:outputLabel value="/#{Marticle.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        </p:outputPanel>
                        <p:commandButton actionListener="#{Marticle.loadAllArticle(true,false)}"   update="tab_article" icon="ui-icon-circle-triangle-e" disabled="#{Marticle.paginator.disNext}" oncomplete=" collapseList('nav_article');"/>
                        <p:selectOneMenu value="#{Marticle.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{Marticle.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{Marticle.paginations}"/>
                            <p:ajax event="valueChange" update="tab_article" oncomplete=" collapseList('nav_article');"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </div>
                <div style="clear: both"/>
                <div  style="padding-bottom: -100px!important">
                    <p:commandButton value="Appliquer..." icon="ui-icon-circle-check" actionListener="#{managedTemplateArticle.applyArticleOnTemplate}"
                                     style="float: right"/>
                    <p:dataTable id="tab_article" value="#{Marticle.listArticle}" var="art" rowIndexVar="artLine" rowKey="#{art.id}"
                                 selection="#{managedTemplateArticle.selectArticles}">
                        <p:column headerText="N°" width="20" style="text-align: center">                                
                            <h:outputText value="#{Marticle.displayId?art.id:artLine+1}" />
                            <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{art.id eq articles.id}"/>
                        </p:column>                                                        
                        <p:column headerText="#{lab.L_reference}" width="120">                             
                            <h:graphicImage library="img" name="#{(art.actif)?'connecte.png':'deconnecte.png'}" width="10" height="10" title="#{(art.actif)?lab.L_actif:lab.L_inactif}"/>
                            <span> #{art.refArt}  </span>
                        </p:column>
                        <p:column  headerText="#{lab.L_designation}" > 
                            <span title="#{art.designation}">#{art.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_categorie}" width="100" style="text-align: center">
                            #{art.categorie}
                        </p:column>
                        <p:column  headerText="#{lab.L_famille}" style="text-align: left" width="150">
                            <span title="#{art.famille.designation}">#{art.famille.designation}</span>
                        </p:column>  
                        <p:column  headerText="Groupes" style="text-align: left" width="150">
                            #{art.groupe.designation}
                        </p:column>  
                        <p:column selectionMode="multiple" width="10" style="text-align: center"/>
                    </p:dataTable>    
                </div>
            </p:dialog>
        </h:form>

        <!--><-->
        <!--> Boite de dialogue pour les catégorie taxes<-->
        <h:form prependId="false" id="main_taxe_temp">
            <p:dialog header="#{lab.LDB_PTA_taxes_articles}" widgetVar="dlgListCatTaxes" closeOnEscape="true" width="60%" footer="&copy;Lymytz 2014">
                <p:commandButton icon="ui-icon-circle-plus" type="button" onclick="dlgAddTaxes.show()" style="float: right" title="#{lab.LDB_PTA_ajouter_nouvelle_taxe}"/>
                <p:dataTable value="#{managedTemplateArticle.selectCompte.taxes}" var="artT" id="data_taxe_template_article_categorie">
                    <p:column headerText="#{lab.LDB_PTA_code_taxe}">
                        #{artT.taxe.codeTaxe}
                        <h:graphicImage library="img" name="R_on.png" width="12" height="12" rendered="#{artT.appRemise}" style="float: right"
                                        title="#{lab.LDB_PTA_taxe_appliquee_remise}"/>
                    </p:column>
                    <p:column headerText="#{lab.LDB_PTA_designation}">
                        #{artT.taxe.designation}
                    </p:column>
                    <p:column headerText="#{lab.LDB_PTA_taux}" style="text-align: right;width: 20%">
                        <h:outputText value="#{artT.taxe.taux}" converter="DNS"/>
                        %
                    </p:column>                                                                                   
                    <p:column  width="20" style="text-align: center">
                        <p:commandButton icon="ui-icon-minusthick" style="width: 20px;height: 20px" rendered="#{!artT.new_}"
                                         actionListener="#{managedTemplateArticle.removeTaxeToCategorie(artT)}" title="#{lab.LDB_PTA_retirer_taxe}"                                         
                                         update="data_taxe_template_article_categorie :main_template_article:tabview_temp_art:data_compte_template_article"/>
                        <p:commandButton icon="ui-icon-plusthick" style="width: 20px;height: 20px" rendered="#{artT.new_}" 
                                         actionListener="#{managedTemplateArticle.addTaxeToCategorie(artT)}" title="#{lab.LDB_PTA_ajouter_taxe}"                                          
                                         update="data_taxe_template_article_categorie :main_template_article:tabview_temp_art:data_compte_template_article"/>
                    </p:column>  
                    <p:column style="text-align: center;width: 8%">
                        <p:contextMenu for="btn_option_taxe_template_article_categorie" event="left click" style="font-size: 0.8em;width: 200px">
                            <p:menuitem value="#{(artT.appRemise)?'Desactiver sur la remise':'Activer sur la remise'}" icon="ui-icon-star" global="false" 
                                        title="#{(artT.appRemise)?'Desactiver l application de la taxe sur la remise':'Activer l application de la taxe sur la remise'}"
                                        actionListener="#{managedTemplateArticle.activeAppRemiseTaxe(artT)}" update="data_taxe_template_article_categorie"/>
                        </p:contextMenu>                           
                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_taxe_template_article_categorie" type="button" disabled="#{artT.new_}"/>
                    </p:column>
                </p:dataTable>                     
            </p:dialog>
            <p:dialog header="Ajouter les Taxes" widgetVar="dlgAddTaxes" closeOnEscape="true" width="35%" footer="&copy;Lymytz 2014">
                <h:panelGrid columns="2" style="width: 98%;margin: auto" id="form_art_taxe_temp_art" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <span>#{lab.LDB_PTA_appel}</span>
                    <h:inputText value="#{taxes.codeAppel}"/>
                    <span>#{lab.LDB_PTA_code}</span>
                    <h:inputText value="#{taxes.codeTaxe}"/>
                    <span>#{lab.LDB_PTA_designation}</span>
                    <h:inputText value="#{taxes.designation}"/>
                    <span>#{lab.LDB_PTA_taux}</span>
                    <pe:inputNumber value="#{taxes.taux}" symbol=" %" symbolPosition="suffixe"/>
                </h:panelGrid>
                <p:commandButton actionListener="#{managedTemplateArticle.saveNewTaxe()}" style="float: right" value="#{lab.L_enregistrer}" global="false"
                                 update="data_taxe_template_article_categorie form_art_taxe_temp_art" oncomplete="dlgAddTaxes.hide()"/>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmPropagation" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.propagation(true, false, false)}" oncomplete="dlgConfirmPropagation.hide();"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmPropagation.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmPropagationCompte" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.propagation(false, true, false)}" oncomplete="dlgConfirmPropagationCompte.hide();"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmPropagationCompte.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmPropagationPlan" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.propagation(false, false, true)}" oncomplete="dlgConfirmPropagationPlan.hide();"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmPropagationPlan.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.deleteBean()}" oncomplete="dlgConfirmDelete.hide();"
                                 update=":main_template_article:blog_form_template_article :main_template_article:data_template_article"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text3}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide();"
                                 update=":main_template_article:blog_form_template_article :main_template_article:data_template_article"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCompte" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.deleteBeanCompte(true)}" oncomplete="dlgConfirmDeleteCompte.hide();"
                                 update=":main_template_article:blog_form_template_article :main_template_article:data_template_article"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmDeleteCompte.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCompte_" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.deleteBeanCompte(false)}" oncomplete="dlgConfirmDeleteCompte_.hide();"
                                 update=":main_template_article:blog_form_template_article :main_template_article:data_template_article"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmDeleteCompte_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePlan" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.deleteBeanPlan(true)}" oncomplete="dlgConfirmDeletePlan.hide();"
                                 update=":main_template_article:blog_form_template_article :main_template_article:data_template_article"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmDeletePlan.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePlan_" closeOnEscape="true"
                             message="#{lab.LDB_PTA_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTemplateArticle.deleteBeanPlan(false)}" oncomplete="dlgConfirmDeletePlan_.hide();"
                                 update=":main_template_article:blog_form_template_article :main_template_article:data_template_article"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmDeletePlan_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_template_article">   
            <div class="part_fix">
                <p:splitButton value="#{managedTemplateArticle.getNameBtn('T')}" id="save_template_article" 
                               actionListener="#{managedTemplateArticle.saveNew()}"
                               update="data_template_article @this" >
                    <p:menuitem value="#{lab.L_nouveau}" id="cancel_template_article" actionListener="#{managedTemplateArticle.resetFiche()}" 
                                process="@this"  />                            
                    <p:menuitem value="#{lab.L_supprimer}" global="false"   oncomplete="dlgConfirmDelete.show()"/>   
                </p:splitButton>
                <p:commandButton value="#{lab.L_supprimer}" update="input_hide_template_article" global="false" id="delete_template_article"  onclick="dlgConfirmDelete.show()"/>   
                <h:panelGroup style="margin-left: 25%">
                    <p:commandButton actionListener="#{managedTemplateArticle.parcoursInAllResult(false)}" update="txt_parc_linear_tempArt" global="false"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('template_article')"/>
                    <h:inputText value="#{managedTemplateArticle.offset}" style="width: 35px; text-align: center;"  title="Aller au N°..." id="txt_parc_linear_tempArt"/>
                    <p:outputPanel autoUpdate="true">                        
                        <p:outputLabel value="/#{managedTemplateArticle.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedTemplateArticle.parcoursInAllResult(true)}" update="txt_parc_linear_tempArt" global="false" icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('template_article')"/>
                </h:panelGroup>  
                <div style="float: right">
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('template_article');
                            return false">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>               
                    <p:spacer />
                    <h:link onclick="collapseList('template_article');
                            return false" title="#{lab.L_mode_liste}" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>
                </div>
            </div>
            <div class="part_scroll">
                <div class="yvs_form_template_article" style="width: 100%">
                    <p:outputPanel id="blog_form_template_article">
                        <div style="width: 70%;float: left;background: #828c95">
                            <p:outputPanel id="fiche_template_articles">
                                <h:panelGrid columns="4" styleClass="yvs_table"  cellpadding="0" cellspacing="0" style="width: 100%;">   
                                    <f:facet name="header">
                                        <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                            <h:inputText value="#{templateArticles.libelle}" style="width: 100%" title="Titre"/>
                                            <p:selectBooleanCheckbox value="#{templateArticles.actif}" style="float: right" itemLabel="Actif"/>
                                        </h:panelGrid>
                                    </f:facet>
                                    <span>#{lab.LDB_PTA_prefixe_reference}</span>
                                    <h:inputText value="#{templateArticles.refArt}" style="width: 95%"/>
                                    <span>#{lab.LDB_PTA_famille}</span>
                                    <h:selectOneMenu value="#{templateArticles.famille.id}" title="Select one" styleClass="select"
                                                     id="txt_fam_temp_art" onchange="openDialog(dlgArtFamArt, $(this));
                                                             collapseList('fam_temp_art')" >
                                        <f:selectItem itemLabel="" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedFamilleArticle.familles}" var="famA" 
                                                       itemLabel="#{famA.designation}" itemValue="#{famA.id}" />
                                        <f:selectItem itemLabel="" itemValue="0" noSelectionOption="true" />
                                        <f:selectItem itemValue="-1" itemLabel="#{lab.L_plus_option}" />
                                    </h:selectOneMenu>  
                                    <span>#{lab.LDB_PTA_categorie}</span>
                                    <h:selectOneMenu value="#{templateArticles.categorie}" style="width: 95%">
                                        <f:selectItems value="#{constantes.CATEGORIES}" var="cat" itemValue="#{cat.valeur}" itemLabel="#{cat.libelle}" /> 
                                    </h:selectOneMenu>          
                                    <span>#{lab.LDB_PTA_valorisation}</span>
                                    <h:selectOneMenu value="#{templateArticles.methodeVal}" style="width: 95%">
                                        <f:selectItems value="#{constantes.METHODES_VAL}" var="mval" itemValue="#{mval.valeur}" itemLabel="#{mval.libelle}" />                                          
                                    </h:selectOneMenu> 
                                    <span>#{lab.LDB_PTA_classse_stat}</span>
                                    <h:selectOneMenu value="#{templateArticles.classe.id}" title="Select one" styleClass="select" style="width: 95%" id="select_class_temp_art"
                                                     onchange="openDialog(dlgAddClasseStat, $(this));">
                                        <f:selectItem itemLabel="----" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedClasseStat.classesStat}" var="clasA" itemLabel="#{clasA.designation}" itemValue="#{clasA.id}"/>
                                        <f:selectItem itemLabel="----" noSelectionOption="true"/>
                                        <f:selectItem itemValue="-1" itemLabel="#{lab.L_plus_option}" />
                                    </h:selectOneMenu> 
                                    <span>#{lab.LDB_PTA_groupes}</span>
                                    <h:selectOneMenu value="#{templateArticles.groupe.id}" title="Select one" styleClass="select" style="width: 95%"
                                                     onchange="openDialog(dlgArtGroupeArt, $(this));
                                                             collapseList('grp_temp_art')" id="select_group_temp_art">
                                        <f:selectItem itemLabel="----" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedGroupeArticle.groupes}" var="gpeA" itemLabel="#{(gpeA.designation==null)?'':gpeA.designation}" itemValue="#{gpeA.id}"/>
                                        <f:selectItem itemLabel="----" noSelectionOption="true"/>
                                        <f:selectItem itemValue="-1" itemLabel="#{lab.L_plus_option}" />
                                    </h:selectOneMenu> 
                                    <span>#{lab.LDB_PTA_suivi_stock}</span>
                                    <h:selectBooleanCheckbox value="#{templateArticles.suiviEnStock}" />
                                    <span>#{lab.LDB_PTA_puv_variable}</span> 
                                    <h:selectBooleanCheckbox value="#{templateArticles.changePrix}"/>  
                                    <f:facet name="footer">                                        
                                        <span>#{lab.LDB_PTA_description}</span>
                                        <h:inputTextarea value="#{templateArticles.description}" style="width: 100%" rows="3"/>
                                    </f:facet>
                                </h:panelGrid>
                            </p:outputPanel>
                        </div>
                        <div style="margin-left: 71%;width: 29%">
                            <p:dataTable value="#{templateArticles.articles}" var="at" rowKey="#{at.id}" rowIndexVar="atIdx"
                                         selection="#{managedTemplateArticle.articles}" style="max-height: 200px;overflow-y: auto">
                                <f:facet name="header">
                                    <div>
                                        #{lab.LDB_PTA_article_lies}
                                        <p:commandButton icon="ui-icon-plus" title="Ajouter un article" styleClass="button_gear"  type="button"
                                                         style="float: right" onclick="dlgArticles.show()"/>
                                    </div>
                                </f:facet>
                                <p:column selectionMode="multiple" style="width:16px;text-align:center"/>                                                    
                                <p:column headerText="#{lab.LDB_PTA_reference}" width="120">
                                    #{at.refArt}                                                                             
                                </p:column>
                                <p:column headerText="#{lab.LDB_PTA_designation}" width="150"> 
                                    #{at.designation}
                                </p:column>
                            </p:dataTable>
                        </div>
                        <p:tabView style="clear: left; font-size: 0.9em" id="tabview_temp_art">                        
                            <p:tab title="#{lab.LDB_PTA_comptabilite}">                                                                                
                                <p:commandLink value="#{lab.LDB_PTA_associer_categories_comptable}" process="@this" actionListener="#{managedTemplateArticle.addAllCategoriesComptable()}" update="data_compte_template_article" style="border: 2px solid #666; border-radius: 5px;padding: 3px"/>     
                                <p:dataTable value="#{templateArticles.comptes}" var="artCT" rowIndexVar="artCT_" id="data_compte_template_article"
                                             editable="true" paginator="true" rows="10" paginatorAlwaysVisible="false">
                                    <p:ajax event="rowEdit" listener="#{managedTemplateArticle.onCompteEdit}" />
                                    <p:column headerText="#{lab.LDB_PTA_categorie}">
                                        <span>#{artCT.categorie.designation}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LDB_PTA_compte}" style="width: 30%">                                   
                                        <div style="margin-right: 10px; display: inline; float: right" align="right"> 
                                            <p:cellEditor >
                                                <f:facet name="output">
                                                    <h:outputText value="#{artCT.compte.numCompte} [#{artCT.compte.intitule}]" rendered="#{artCT.compte.id gt 0}"/>                     
                                                </f:facet>
                                                <f:facet name="input">
                                                    <h:panelGroup>
                                                        <h:inputText id="txt_compte_template_article_categorie" value="#{artCT.numCompte}" style="color: #{artCT.error?'red':''}">
                                                            <p:ajax event="blur" global="false" listener="#{managedTemplateArticle.ecouteSaisieCG(artCT)}" update="@this"/>
                                                        </h:inputText>    
                                                    </h:panelGroup>
                                                </f:facet>
                                            </p:cellEditor>  
                                        </div>
                                        <p:rowEditor />
                                    </p:column>
                                    <p:column headerText="#{lab.LDB_PTA_taxes}">
                                        <span>#{artCT.viewNumTaxe(false)}</span>
                                    </p:column>
                                    <p:column style="text-align: center;width: 5%">
                                        <p:contextMenu for="btn_option_taxe_template_article" event="left click" style="font-size: 0.8em">
                                            <p:menuitem value="#{lab.LDB_PTA_gerer_taxes}" icon="ui-icon-folder-collapsed" actionListener="#{managedTemplateArticle.initTaxes(artCT)}"
                                                        oncomplete="dlgListCatTaxes.show()" global="false"/>
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" oncomplete="dlgConfirmDeleteCompte_.show()"
                                                        actionListener="#{managedTemplateArticle.setSelectCompte(artCT)}"/>
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_taxe_template_article" type="button"/>
                                    </p:column>  
                                </p:dataTable>                                                                                                
                            </p:tab>
                            <p:tab title="#{lab.LDB_PTA_categorie_tarifaire}">
                                <div style="width: 30%;float: left">
                                    <h:panelGrid id="blog_form_plan_template_article" columns="2" style="width: 100%" cellpadding="0" cellspacing="0" styleClass="yvs_table">
                                        <f:facet name="header">
                                            <h:panelGroup>
                                                <span>#{lab.LDB_PTA_categories} </span>
                                                <p:spacer width="5"/>
                                                <h:panelGroup>
                                                    <h:selectOneMenu value="#{managedTemplateArticle.plan.categorie.id}" onchange="openDialog(dlgCategorieC, $(this))" id="select_catclt_temp_art">
                                                        <f:selectItem itemValue="0" itemLabel=""  noSelectionOption="true"/>
                                                        <f:selectItems value="#{managedCategorieClt.categories}" var="catC" itemValue="#{catC.id}" itemLabel="#{catC.libelle}"/>
                                                        <f:selectItem itemValue="0" itemLabel=""  noSelectionOption="true"/>
                                                        <f:selectItem itemValue="-1" itemLabel="#{lab.LDB_PTA_creer}"  noSelectionOption="true"/>
                                                    </h:selectOneMenu>      
                                                    <p:commandLink actionListener="#{managedTemplateArticle.addAllCategories()}" title="#{lab.LDB_PTA_ajouter_toutes_categories}" global="false"
                                                                   style="float: right;border: 2px solid #666; border-radius: 5px;padding: 3px" update="data_plan_template_article">
                                                        <h:graphicImage library="icones" name="db_update.png" width="20" height="20"/>    
                                                    </p:commandLink>
                                                </h:panelGroup>
                                            </h:panelGroup>
                                        </f:facet>
                                        <span>#{lab.LDB_PTA_prix_vente} </span>
                                        <h:panelGroup>
                                            <pe:inputNumber value="#{managedTemplateArticle.plan.puv}" decimalPlaces="0" style="width: 50%;text-align: right"/>   
                                            <h:selectOneMenu value="#{managedTemplateArticle.plan.naturePrixMin}" style="font-size: 0.8em">
                                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                                            </h:selectOneMenu>
                                        </h:panelGroup>
                                        <span>#{lab.LDB_PTA_remise} </span>
                                        <h:panelGroup>
                                            <pe:inputNumber value="#{managedTemplateArticle.plan.remise}" style="width: 50%;text-align: right"/>
                                            <h:selectOneMenu value="#{managedTemplateArticle.plan.natureRemise}" style="font-size: 0.8em">
                                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                                            </h:selectOneMenu>
                                        </h:panelGroup>
                                        <span title="#{lab.LDB_PTA_coefficient_augmentation}">#{lab.LDB_PTA_coef} </span>                                    
                                        <h:panelGroup>
                                            <h:inputText value="#{managedTemplateArticle.plan.coefAugmentation}"  style="width: 50%;text-align: right"/> 
                                            <h:selectOneMenu value="#{managedTemplateArticle.plan.natureCoefAugmentation}" style="font-size: 0.8em">
                                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                                            </h:selectOneMenu>
                                        </h:panelGroup>
                                    </h:panelGrid>
                                    <div style="margin-top: 5px">
                                        <p:commandButton style="float: left" value="#{lab.L_nouveau}" actionListener="#{managedTemplateArticle.resetFichePlan()}" 
                                                         update="blog_form_plan_template_article save_plan_template_article"/>
                                        <p:commandButton style="float: right" value="#{managedTemplateArticle.getNameBtn('P')}" actionListener="#{managedTemplateArticle.saveNewPlan()}" 
                                                         update="blog_form_plan_template_article data_plan_template_article @this" id="save_plan_template_article" />
                                    </div>
                                </div>
                                <div style="width: 69%;margin-left: 31%">
                                    <p:dataTable value="#{templateArticles.tarifaires}" var="artp" rowKey="#{artp.id}" selectionMode="single" id="data_plan_template_article">
                                        <p:ajax event="rowSelect" listener="#{managedTemplateArticle.loadOnViewPlan}"  
                                                update=":main_template_article:tabview_temp_art:blog_form_plan_template_article :main_template_article:tabview_temp_art:save_plan_template_article"/>
                                        <p:ajax event="rowUnselect" listener="#{managedTemplateArticle.unLoadOnViewPlan}"  
                                                update=":main_template_article:tabview_temp_art:blog_form_plan_template_article :main_template_article:tabview_temp_art:save_plan_template_article"/>
                                        <p:column headerText="#{lab.LDB_PTA_categorie}">
                                            <span>#{artp.categorie.designation}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PTA_coef}" style="text-align: right;width: 15%">
                                            <h:outputText value="#{artp.coefAugmentation}" converter="DNS" title="#{lab.LDB_PTA_coefficient_augmentation}"/>
                                            <h:outputText value="%" rendered="#{artp.natureCoefAugmentation == constantes.NATURE_TAUX}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PTA_puv}" style="text-align: right;width: 15%">
                                            <h:outputText value="#{artp.puv}" converter="DN"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PTA_remise}" style="text-align: right;width: 15%">
                                            <h:outputText value="#{artp.remise}" converter="DNS"/>
                                            <h:outputText value="%" rendered="#{artp.natureRemise == constantes.NATURE_TAUX}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_actif}" style="width: 7%;text-align: center">
                                            <p:commandLink title="#{(artp.actif)?'Desactiver':'Activer'}" global="false" actionListener="#{managedTemplateArticle.activePlan(artp)}" update="data_plan_template_article" style="margin-top: 5px">
                                                <h:graphicImage library="img"  name="#{(artp.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                                            </p:commandLink>
                                        </p:column> 
                                        <p:column style="text-align: center;width: 5%">
                                            <p:commandButton actionListener="#{managedTemplateArticle.setSelectPlan(artp)}" icon="ui-icon-circle-minus"
                                                             global="false"  style="width: 20px; height: 20px" oncomplete="dlgConfirmDeletePlan_.show()"/>
                                        </p:column>
                                    </p:dataTable>
                                </div>
                                <div style="clear: both"/>
                            </p:tab>                            
                        </p:tabView> 
                    </p:outputPanel>
                </div>
                <!-->
                ******************************
                dataTable
                **********************************
                <-->
                <div class="yvs_list_template_article" style="height: 95%;"> 
                    <div class="part_list">
                        <h:inputHidden id="input_hide_template_article" value="#{managedTemplateArticle.tabIds}"/>
                        <p:dataTable id="data_template_article" value="#{managedTemplateArticle.templates}" var="art" rowIndexVar="artLine"
                                     rowKey="#{art.id}" selectionMode="single">
                            <p:ajax event="rowSelect" listener="#{managedTemplateArticle.loadOnView}" 
                                    update=":main_template_article:blog_form_template_article :main_template_article:save_template_article :main_template_article:input_hide_template_article" />
                            <p:column headerText="N°" style="width: 5%">
                                <h:graphicImage library="img" name="drapeau_vert.png" rendered="#{!art.suiviEnStock}" width="15" height="15"/>                                 
                                <span title="#{lab.LDB_PTA_famille} : #{art.famille.designation}">#{artLine+1}</span>
                            </p:column>    
                            <p:column  headerText="#{lab.LDB_PTA_intitule}">
                                <span title="#{lab.LDB_PTA_famille} : #{art.famille.designation}" style="font-weight: bold">#{art.libelle}</span>
                            </p:column>
                            <p:column headerText="#{lab.LDB_PTA_pref_reference}" style="width: 12%">
                                <span title="#{lab.LDB_PTA_famille} : #{art.famille.designation}">#{art.refArt}</span>                                                                           
                            </p:column>                                                    
                            <p:column headerText="#{lab.LDB_PTA_pref_designation}">
                                <span title="#{lab.LDB_PTA_famille} : #{art.famille.designation}">#{art.designation}</span>                                                                           
                            </p:column>
                            <p:column headerText="#{lab.LDB_PTA_categorie}" style="width: 15%;text-align: center">
                                <span title="#{lab.LDB_PTA_famille} : #{art.famille.designation}">#{art.categorie}</span>
                            </p:column>                                                                                        
                            <p:column style="width: 5%;text-align: center">
                                <h:graphicImage library="img" name="#{(art.actif)?'vu.png':'vu_non.png'}" width="10" height="10"/>
                            </p:column>
                            <p:column style="width: 5%;text-align: center">
                                <p:contextMenu for="btn_option_template_article" event="left click" style="font-size: 0.8em">
                                    <p:menuitem value="#{art.actif?'Désactiver':'Activer'}" icon="#{art.actif?'ui-icon-circle-close':'ui-icon-circle-check'}"
                                                actionListener="#{managedTemplateArticle.active(art)}" update="data_template_article"/>                               
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedTemplateArticle.setSelecTemplate(art)}" 
                                                oncomplete="dlgConfirmDelete_.show()"/>
                                </p:contextMenu>
                                <p:commandButton type="button" icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_template_article"/>
                            </p:column>
                            <p:column style="width: 5%;text-align: center">
                                <f:facet name="header">
                                    <h:selectBooleanCheckbox styleClass="chek_all_line_template_article" value="false" onclick="selectionAllLineTab(#{managedTemplateArticle.templates.size()}, 'template_article')" />
                                </f:facet>
                                <h:selectBooleanCheckbox styleClass="chek_line_template_article"  value="false" onclick="selectionLineTab(#{artLine}, 'template_article')" />
                            </p:column>
                        </p:dataTable>                                                    
                        <span style="margin-left: 35%; font-size: .8em; font-style: italic; color: #828c95" class="nbSelecttemplate_article"></span>
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                            <p:commandButton actionListener="#{managedTemplateArticle.init(false)}" global="false" update="data_template_article" icon="ui-icon-circle-triangle-w" disabled="#{managedTemplateArticle.paginator.disPrev}"/>
                            <p:outputPanel >
                                <p:inplace label="#{managedTemplateArticle.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                    <pe:inputNumber value="#{managedTemplateArticle.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                        <p:ajax event="blur" listener="#{managedTemplateArticle.gotoPagePaginator()}" update="data_template_article"/>
                                    </pe:inputNumber>
                                </p:inplace><p:outputLabel value="/#{managedTemplateArticle.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                            </p:outputPanel>
                            <p:commandButton actionListener="#{managedTemplateArticle.init(true)}" global="false" update="data_template_article" icon="ui-icon-circle-triangle-e" disabled="#{managedTemplateArticle.paginator.disNext}"/>
                            <p:selectOneMenu value="#{managedTemplateArticle.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedTemplateArticle.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                <f:selectItems value="#{managedTemplateArticle.paginations}"/>
                                <p:ajax event="valueChange" global="false" update="data_template_article"/>
                            </p:selectOneMenu>
                        </p:outputPanel>   
                    </div>
                </div>
            </div>  
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false">
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative" width="20" height="20"
                            styleClass="img_slide" title="cacher"/>                    
            <div class="zone_find">           
                <div class="yvs_form_template_article display_auteur" align="right" style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">Enregistré Le <h:outputText value="#{managedTemplateArticle.selecTemplate.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/> </span>
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedTemplateArticle.selecTemplate.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedTemplateArticle.selecTemplate.author.users.nomUsers}" styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <h:panelGrid columns="2" style="width: 100%; font-size: 0.8em">
                    <h:panelGrid columns="7" style="float: left; font-size: 1.0em">
                        <h:outputText value="#{lab.LDB_PTA_categorie}" />
                        <h:outputText value="#{lab.LDB_PTA_famille}" />
                        <h:outputText value="#{lab.LDB_PTA_groupes}" />
                        <h:outputText value="#{lab.LDB_PTA_conditionnement}" />
                        <h:outputText value="#{lab.L_actif}" />
                        <h:outputText value="#{lab.LDB_PTA_designation}" />
                        <span>&nbsp;</span>
                        <h:selectOneMenu value="#{managedTemplateArticle.categorieSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="" noSelectionOption="true"/>
                            <f:selectItems value="#{constantes.CATEGORIES}" var="cat" itemValue="#{cat.valeur}" itemLabel="#{cat.libelle}" />
                            <p:ajax event="valueChange" listener="#{managedTemplateArticle.addParamCategorie()}" oncomplete="collapseList('template_article')"
                                    process="@form" update=":main_template_article:data_template_article"/>                              
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{managedTemplateArticle.familleSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                            <f:selectItems value="#{managedFamilleArticle.parents}" var="fam" 
                                           itemLabel="#{fam.designation}" itemValue="#{fam.id}" />
                            <p:ajax event="valueChange" listener="#{managedTemplateArticle.addParamFamille()}" oncomplete="collapseList('template_article')"
                                    process="@form" update=":main_template_article:data_template_article"/>                              
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{managedTemplateArticle.groupeSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                            <f:selectItems value="#{managedGroupeArticle.parents}" var="grp" 
                                           itemLabel="#{grp.designation}" itemValue="#{grp.id}" />
                            <p:ajax event="valueChange" listener="#{managedTemplateArticle.addParamGroupe()}" oncomplete="collapseList('template_article')"
                                    process="@form" update=":main_template_article:data_template_article"/>                              
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{managedTemplateArticle.uniteSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                            <f:selectItems value="#{managedUniteMesure.unites}" var="condt" 
                                           itemLabel="#{condt.libelle}" itemValue="#{condt.id}" />
                            <p:ajax event="valueChange" listener="#{managedTemplateArticle.addParamConditionnement()}" oncomplete="collapseList('template_article')"
                                    process="@form" update=":main_template_article:data_template_article"/>                              
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{managedTemplateArticle.actifSearch}" style="width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>                            
                            <f:selectItem itemLabel="#{lab.L_actif}" itemValue="#{true}"/>                            
                            <f:selectItem itemLabel="#{lab.L_inactif}" itemValue="#{false}"/>                            
                            <p:ajax event="valueChange" listener="#{managedTemplateArticle.addParamActif()}" oncomplete="collapseList('template_article')"
                                    process="@form" update=":main_template_article:data_template_article"/>
                        </h:selectOneMenu> 
                        <p:inputText value="#{managedTemplateArticle.numSearch}">
                            <p:ajax event="blur" listener="#{managedTemplateArticle.addParamReference()}" oncomplete="collapseList('template_article')"
                                    process="@form" update=":main_template_article:data_template_article"/>
                        </p:inputText>   
                    </h:panelGrid>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>

