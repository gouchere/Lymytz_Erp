<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Catégories Client','modGescom', 'smenCategorieClient', true,managedCategorieClt)}
    </ui:define> 
    <ui:define name="contents">
        #{managedCategorieClt.loadAll()}
        #{managedModeReglement.loadModels('C')}
        #{Marticle.loadActifArticle(true, true)}
        #{managedFamilleArticle.loadAllActif()}
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 180);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('categorie_client');
                collapseForm('plan_tarifaire_client');
                collapseList('model_categorie');
                collapseForm('tranche_model_categorie');
                collapseForm('grille_plan_tarifaire_client');
            });
        </script>
        <h:form>
            <p:remoteCommand name="updateBeanCaisse_" actionListener="#{managedCategorieClt.updateBean()}"/>
        </h:form>
        <h:form>
            <p:remoteCommand name="updateDataArticleCategorieClient_" global="false" 
                             actionListener="#{managedCategorieClt.update('data_articles_categorie_client')}"/>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue d'ajout des coefficients
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCC_coefficient}" widgetVar="dlgAddCoefficient" modal="true" width="25%"  closeOnEscape="true"> 
                <h:panelGroup style="width: 100%" id="form_add_tranche_plan_tarifaire_client">
                    <pe:inputNumber value="#{managedCategorieClt.coefficient}" style="width: 55%;text-align: right"/>
                    <h:selectOneMenu value="#{managedCategorieClt.natureCoefficient}" title="#{lab.LC_PCC_nature_coefficient}">
                        <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                        <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                    </h:selectOneMenu>  
                </h:panelGroup>
                <p:commandButton actionListener="#{managedCategorieClt.addCoefficient()}" style="width: 99%"
                                 oncomplete="dlgAddCoefficient.hide()" value="#{lab.L_enregistrer}" update="form_add_tranche_plan_tarifaire_client"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCC_definir_prix_min}" widgetVar="dlgFixePrixMin" modal="true" width="25%"  closeOnEscape="true"
                      > 
                <h:panelGrid style="width: 100%" columns="3">
                    <span style="font-weight: bold"> PUV -</span>
                    <pe:inputNumber value="#{managedCategorieClt.planTarif.puvMin}" style="text-align: right; width: 100px"/>
                    <h:selectOneMenu value="#{managedCategorieClt.planTarif.naturePrixMin}" title="#{lab.LC_PCC_nature_diminution}">
                        <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                        <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                    </h:selectOneMenu>  
                </h:panelGrid>
                <p:commandButton actionListener="#{managedCategorieClt.applyPrixMinToAllSelection()}" style="float: right"
                                 oncomplete="dlgFixePrixMin.hide()" value="#{lab.L_enregistrer}" />
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des grilles tarifaire
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="dlg_grille_plan_tarifaire_client">
            <p:dialog header="#{lab.LC_PCC_grilles} #{managedCategorieClt.grille.reference}" widgetVar="dlgGrillePlanTarifaire" modal="true" width="50%" closeOnEscape="true"> 
                <p:outputPanel id="blog_form_grille_plan_tarifaire_client">
                    <h:panelGrid id="form_grille_plan_tarifaire_client" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                        <f:facet name="header">
                            <h:panelGrid columns="2" style="float: left;font-weight: bold" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                <span>#{lab.LC_PR_base}</span>
                                <h:selectOneRadio value="#{managedCategorieClt.grille.base}" layout="grid" styleClass="yvs_nostyle">
                                    <f:selectItem itemLabel="#{constantes.BASE_QTE} " itemValue="#{constantes.BASE_QTE}" />
                                    <f:selectItem itemLabel="#{constantes.BASE_CA} " itemValue="#{constantes.BASE_CA}" />
                                </h:selectOneRadio>
                            </h:panelGrid>
                        </f:facet>
                        <span>#{lab.LC_PR_interval} </span>
                        <h:panelGrid columns="2" style="width: 100%;margin-left: -10px" styleClass="yvs_nostyle">
                            <h:selectBooleanCheckbox value="#{managedCategorieClt.grille.unique}" style="float: right">
                                <p:ajax event="valueChange" global="false"  update="txt_intervale_montant_grille_plan_tarifaire_client"/>
                            </h:selectBooleanCheckbox>
                            <h:panelGroup id="txt_intervale_montant_grille_plan_tarifaire_client">
                                <pe:inputNumber value="#{managedCategorieClt.grille.montantMinimal}" disabled="#{managedCategorieClt.grille.unique}" style="width: 40%;text-align: right"/>
                                <p:spacer style="background: #000" width="5"/>
                                <pe:inputNumber value="#{managedCategorieClt.grille.montantMaximal}" disabled="#{managedCategorieClt.grille.unique}" style="width: 40%;text-align: right"/>                                                                
                            </h:panelGroup>
                        </h:panelGrid>
                        <span>#{lab.LC_PCC_prix_vente} </span>
                        <pe:inputNumber value="#{managedCategorieClt.grille.valeur}" style="text-align: right"/>
                        <span>#{lab.LC_PCC_nature_remise} </span>
                        <h:selectOneRadio value="#{managedCategorieClt.grille.natureMontant}" layout="grid" styleClass="yvs_nostyle">
                            <f:selectItem itemLabel="#{constantes.NATURE_MTANT} " itemValue="#{constantes.NATURE_MTANT}" />
                            <f:selectItem itemLabel="#{constantes.NATURE_TAUX} " itemValue="#{constantes.NATURE_TAUX}" />
                        </h:selectOneRadio>
                        <span>#{lab.LC_PCC_remise} </span>
                        <pe:inputNumber value="#{managedCategorieClt.grille.montantRabais}" style="text-align: right"/>
                    </h:panelGrid>
                    <div style="margin-top: 5px">
                        <p:commandButton value="#{lab.L_nouveau}" id="cancel_grille_plan_tarifaire_client"  actionListener="#{managedCategorieClt.resetFicheTranchePlanTarifaire()}"
                                         update="form_grille_plan_tarifaire_client" oncomplete="collapseForm('grille_plan_tarifaire_client')"/>
                        <p:commandButton value="#{lab.L_enregistrer}" id="save_grille_plan_tarifaire_client" actionListener="#{managedCategorieClt.saveNewTranchePlanTarifaire()}"
                                         update="blog_form_grille_plan_tarifaire_client" oncomplete="collapseForm('grille_plan_tarifaire_client')" style="float: right"/>
                    </div>
                    <p:outputPanel>
                        <h:inputHidden id="input_hide_grille_plan_tarifaire_client" value="#{managedCategorieClt.tabIds_grille}"/>
                        <p:dataTable id="data_grille_plan_tarifaire_client" value="#{managedCategorieClt.grilles}" scrollHeight="200" var="gril"
                                     rowKey="#{gril.id}" rowIndexVar="comIdx_" selectionMode="single" scrollable="true">
                            <p:ajax event="rowSelect" global="false" listener="#{managedCategorieClt.loadOnViewTranchePlanTarif}" update=":dlg_grille_plan_tarifaire_client:form_grille_plan_tarifaire_client"/>
                            <p:ajax event="rowUnselect" global="false" listener="#{managedCategorieClt.unLoadOnViewTranchePlanTarif}" update=":dlg_grille_plan_tarifaire_client:form_grille_plan_tarifaire_client"/>
                            <p:column headerText="N°" style="width: 0.25%">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{gril.new_}"/>
                                <span>#{comIdx_+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.LC_PCC_valeur_min}" style="text-align: right;width: 1%">
                                <h:outputText rendered="#{gril.valeurMin >0}" value="#{gril.valeurMin}" converter="DNS" title="Prix de vente = #{gril.puv}"/>
                                <h:outputText rendered="#{0>=gril.valeurMin}" value=" #{lab.LC_PRB_min}" title="#{lab.LC_PCC_prix_vente} = #{gril.puv}"/> 
                            </p:column>
                            <p:column headerText="#{lab.LC_PCC_valeur_max}" style="text-align: right;width: 1.5%">
                                <h:outputText rendered="#{constantes.MAX_DOUBLE > gril.valeurMax}" value="#{gril.valeurMax}" converter="DNS" title="#{lab.LC_PCC_prix_vente} = #{gril.puv}"/>
                                <h:outputText rendered="#{gril.valeurMax >= constantes.MAX_DOUBLE}" value=" #{lab.LC_PRB_max}" title="#{lab.LC_PCC_prix_vente}= #{gril.puv}"/> 
                            </p:column>
                            <p:column headerText="#{lab.LC_PCC_remise}" style="text-align: right;width: 2%">
                                <h:outputText value="#{gril.remise}" converter="DNS" title="#{lab.LC_PCC_prix_vente}= #{gril.puv}"/>
                                <h:outputText value="#{gril.natureRemise == constantes.NATURE_MTANT?'':'%'}" title="#{lab.LC_PCC_prix_vente}= #{gril.puv}"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PR_base}" style="text-align: right;width: 1.5%">
                                <h:outputText value="#{gril.base}" title="#{lab.LC_PCC_prix_vente} = #{gril.puv}"/>
                            </p:column>
                            <p:column style="width: 1%;text-align: center">
                                <p:contextMenu for="btn_option_grille_plan_tarifaire_client" event="left click" styleClass="context_menu">
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedCategorieClt.deleteBeanTranchePlanTarif_(gril)}" oncomplete="dlgConfirmDeleteTrancheTarif_.show()"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_grille_plan_tarifaire_client" type="button"/>
                            </p:column> 
                            <p:column style="width: 1%;text-align: center" rendered="false">
                                <f:facet name="header">
                                    <h:selectBooleanCheckbox styleClass="chek_all_line_grille_plan_tarifaire_client" value="false"
                                                             onclick="selectionAllLineTab(#{managedCategorieClt.grilles.size()}, 'grille_plan_tarifaire_client')">
                                    </h:selectBooleanCheckbox>
                                </f:facet>
                                <h:selectBooleanCheckbox  value="#{gril.selectActif}" styleClass="chek_line_grille_plan_tarifaire_client" onclick="selectionLineTab(#{gril.id}, 'grille_plan_tarifaire_client')"/>
                            </p:column>
                        </p:dataTable>
                        <p:commandButton value="#{lab.L_supprimer}" id="delete_grille_plan_tarifaire_client" global="false" onclick="dlgConfirmDeleteTrancheTarif.show()" style="float: right"/>
                    </p:outputPanel>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de creation des tarifs
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="dlg_add_tarif_categorie">
            <p:dialog header="#{lab.LC_PCC_ajout_tarif}" widgetVar="dlgAddTarifCategorie" width="35%"  closeOnEscape="true"> 
                <p:outputPanel id="blog_form_plan_tarifaire_client">
                    <h:panelGrid id="form_plan_tarifaire_client" styleClass="yvs_table" cellpadding="0" cellspacing="0" columns="2" style="width: 100%">
                        <f:facet name="header">
                            <div align="right">
                                <p:selectBooleanCheckbox value="#{managedCategorieClt.planTarif.forArticle}" itemLabel="#{lab.LC_PCC_par_article} ?">
                                    <p:ajax event="valueChange" listener="#{managedCategorieClt.changeByElement()}" update="form_plan_tarifaire_client"/>
                                </p:selectBooleanCheckbox>
                            </div>
                        </f:facet>
                        <h:outputText value="#{managedCategorieClt.planTarif.forArticle?'Article':'Famille'}"/>
                        <h:panelGroup>
                            <h:panelGroup rendered="#{managedCategorieClt.planTarif.forArticle}">
                                <h:inputText id="txt_article_categorie_client" value="#{managedCategorieClt.planTarif.article.refArt}" style="color: #{managedCategorieClt.planTarif.article.error?'red':''};min-width: 90%">
                                    <p:ajax event="valueChange" global="false" listener="#{managedCategorieClt.searchArticle()}" update="blog_form_plan_tarifaire_client"/>
                                </h:inputText>    
                                <p:commandButton icon="ui-icon-note" style="float: right; width: 20px;height: 22px" title="#{lab.LC_PCC_liste_article}" global="false"
                                                 actionListener="#{managedCategorieClt.initArticles()}" oncomplete="dlgListArticle.show()"/>
                            </h:panelGroup>
                            <h:selectOneMenu value="#{managedCategorieClt.planTarif.famille.id}" style="width: 100%" rendered="#{!managedCategorieClt.planTarif.forArticle}" >
                                <f:selectItem itemLabel="" itemValue="0" noSelectionOption="true"/>
                                <f:selectItems value="#{managedFamilleArticle.familles}" var="famA"  itemLabel="#{famA.designation}" itemValue="#{famA.id}" />
                                <p:ajax event="valueChange" global="false" listener="#{managedCategorieClt.chooseFamille()}"/>
                            </h:selectOneMenu> 
                        </h:panelGroup>
                        <h:outputText value="#{lab.L_designation}" rendered="#{managedCategorieClt.planTarif.forArticle}"/>
                        <h:inputText value="#{managedCategorieClt.planTarif.article.designation}" id="txt_design_categ_client" style="background: #009999;width: 100%" readonly="true" rendered="#{managedCategorieClt.planTarif.forArticle}"/>
                        <h:outputText value="#{lab.LC_PCC_conditionnement}" rendered="#{managedCategorieClt.planTarif.forArticle}"/>
                        <h:selectOneMenu value="#{managedCategorieClt.planTarif.conditionnement.id}" id="chmp_categ_client_conditionnement" style="width: 100%" rendered="#{managedCategorieClt.planTarif.forArticle}">
                            <f:selectItem itemValue="0" itemLabel="--"  noSelectionOption="true"/>
                            <f:selectItems value="#{managedCategorieClt.planTarif.article.conditionnements}" var="catU" itemValue="#{catU.id}" itemLabel="#{catU.unite.libelle}"/>
                            <p:ajax event="valueChange" global="false" listener="#{managedCategorieClt.chooseConditionnementTarif()}" update="txt_puv_planTarif txt_puv_min_planTarif txt_remise_planTarif"/>
                        </h:selectOneMenu>
                        <h:outputText title="#{lab.LC_PCC_coefficient_augmentation}" value="#{lab.LC_PCC_coef}."/>
                        <h:panelGroup>
                            <pe:inputNumber value="#{managedCategorieClt.planTarif.coefAugmentation}" style="width: 40%;text-align: right" title="#{lab.LC_PCC_coefficient_augmentation}"/>  
                            <h:selectOneMenu value="#{managedCategorieClt.planTarif.natureCoefAugmentation}" title="#{lab.LC_PCC_nature_coefficient}">
                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                            </h:selectOneMenu>  
                            <p:commandButton icon="ui-icon-arrowthick-2-n-s" style="float: right; width: 20px;height: 22px" title="#{lab.LC_PCC_appliquer_coef_toute_selection}" 
                                             actionListener="#{managedCategorieClt.applyCoefToAllSelection()}" update="txt_puv_planTarif txt_puv_min_planTarif"/>
                        </h:panelGroup>
                        <span>#{lab.LC_PCC_prix_vente} </span>
                        <h:panelGroup>
                            <pe:inputNumber value="#{managedCategorieClt.planTarif.puv}" id="txt_puv_planTarif" style="min-width: 70%;text-align: right"/>
                            <p:commandButton icon="ui-icon-arrowthick-2-n-s" style="float: right; width: 20px;height: 22px" title="#{lab.LC_PCC_generation_prix}" global="false"
                                             actionListener="#{managedCategorieClt.genererPrix()}" update="txt_puv_planTarif txt_puv_min_planTarif"/>
                        </h:panelGroup>
                        <span>#{lab.LC_PCC_prix_min} </span>
                        <h:panelGroup id="txt_puv_min_planTarif">
                            <pe:inputNumber value="#{managedCategorieClt.planTarif.puvMin}" style="width: 40%;text-align: right"/>
                            <h:selectOneMenu value="#{managedCategorieClt.planTarif.naturePrixMin}" title="#{lab.LC_PCC_nature_prix_vente_minimal}">
                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <span>#{lab.LC_PCC_remise} </span>
                        <h:panelGroup id="txt_remise_planTarif">
                            <pe:inputNumber value="#{managedCategorieClt.planTarif.remise}" style="width: 40%;text-align: right"/> 
                            <h:selectOneMenu value="#{managedCategorieClt.planTarif.natureRemise}" title="#{lab.LC_PCC_nature_remise}">
                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <h:outputText value="#{lab.LC_PCC_appliquer_sur_article}" rendered="#{!managedCategorieClt.planTarif.forArticle}"/>
                        <p:selectBooleanCheckbox value="#{managedCategorieClt.planTarif.applyOnArticle}" rendered="#{!managedCategorieClt.planTarif.forArticle}"/>
                        <f:facet name="footer">
                            <div class="display_auteur" align="right"  style="font-style: italic;width: 95%">
                                <p:outputPanel autoUpdate="true">
                                    <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedCategorieClt.tarifSelect.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span> 
                                    <span>#{lab.L_modifier_le} <h:outputText value="#{managedCategorieClt.tarifSelect.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                                    <span>#{lab.L_par} <h:outputText value="#{managedCategorieClt.tarifSelect.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                                </p:outputPanel>
                            </div>
                            <p:commandButton value="#{lab.L_nouveau}" update="blog_form_plan_tarifaire_client" global="false"
                                             actionListener="#{managedCategorieClt.resetFichePlanTarifaire()}" style="float: left"
                                             oncomplete="collapseForm('plan_tarifaire_client')"/>
                            <p:commandButton value="#{lab.L_enregistrer}" update="blog_form_plan_tarifaire_client :form_categorie_client:data_plan_tarifaire_client"
                                             actionListener="#{managedCategorieClt.saveNewPlanTarifaire()}" style="float: right"
                                             oncomplete="collapseForm('plan_tarifaire_client')"/>
                        </f:facet>
                    </h:panelGrid>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de mode de paiement
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCC_liaison_client}" widgetVar="dlgLiaisonClient" modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGrid id="form_categorie_tarifaire_categorie" columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">                    
                    <span>#{lab.LC_PR_permanent}</span>
                    <h:selectBooleanCheckbox value="#{managedCategorieClt.tarifaire.permanent}">
                        <p:ajax event="valueChange" global="false" update="date_debut_tarifaire_categorie date_fin_tarifaire_categorie"/>
                    </h:selectBooleanCheckbox>
                    <span>#{lab.L_date_debut} </span>
                    <p:calendar id="date_debut_tarifaire_categorie" value="#{managedCategorieClt.tarifaire.dateDebut}" navigator="true" pattern="dd-MM-yyyy" disabled="#{managedCategorieClt.tarifaire.permanent}"/>
                    <span>#{lab.L_date_fin} </span>
                    <p:calendar id="date_fin_tarifaire_categorie" value="#{managedCategorieClt.tarifaire.dateFin}" navigator="true" pattern="dd-MM-yyyy" disabled="#{managedCategorieClt.tarifaire.permanent}"/>
                    <span>#{lab.LC_PCC_priorite}</span>
                    <h:selectOneMenu value="#{managedCategorieClt.tarifaire.priorite}">
                        <f:selectItems value="#{managedCategorieClt.priorites}" var="prio" itemLabel="#{prio}" itemValue="#{prio}" />                         
                    </h:selectOneMenu> 
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgLiaisonClient.hide()" actionListener="#{managedCategorieClt.saveLiaisonClient()}" />
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de mode de paiement
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgAddModePaiement_">
            <p:dialog id="dlgAddModePaiement_" header="Création Model" widgetVar="dlgAddModePaiement" modal="true" width="25%"  closeOnEscape="true"> 
                <h:panelGrid id="blog_form_mode_paiement_model_categorie" columns="1" cellpadding="0" cellspacing="0" style="width: 100%">
                    <span>#{lab.L_designation} </span>
                    <h:inputText value="#{managedModeReglement.mode.designation}" style="width: 100%"/>
                    <span>#{lab.L_description} </span>
                    <h:inputTextarea value="#{managedModeReglement.mode.description}" rows="5" style="width: 100%"/>
                    <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddModePaiement.hide()" actionListener="#{managedModeReglement.saveNew()}"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false" >
            <p:dialog header="#{lab.LC_PCC_liste_article}" widgetVar="dlgListArticle" modal="true" width="70%"  closeOnEscape="true"
                      height="600"> 
                <div class="dlg_part_fixe" >
                    <h:inputText value="#{Marticle.searchArticle}" >
                        <p:ajax event="valueChange" listener="#{Marticle.searchArticleActif('V', Marticle.searchArticle,false)}"  update="data_articles_categorie_client"/>
                    </h:inputText> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(false,false)}" global="false" update="data_articles_categorie_client" icon="ui-icon-circle-triangle-w" disabled="#{Marticle.pa.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{Marticle.pa.currentPage}/#{Marticle.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(true,false)}" global="false" update="data_articles_categorie_client" icon="ui-icon-circle-triangle-e" disabled="#{Marticle.pa.disNext}"/>
                        <p:selectOneMenu value="#{Marticle.pa.rows}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{Marticle._choosePaginator}" style="float: right; font-size: 0.9em;min-width: 50px">
                            <f:selectItems value="#{Marticle.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_articles_categorie_client"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                    <div style="clear: right"/>
                </div>
                <div class="dlg_part_scroll" >
                    <p:dataTable id="data_articles_categorie_client" value="#{Marticle.articlesResult}" var="art" rowKey="#{art.id}"
                                 rowIndexVar="artCatCltIdx" selectionMode="multiple" 
                                 selection="#{managedCategorieClt.artiolesSelect}">
                        <p:ajax event="rowSelect" global="false" listener="#{managedCategorieClt.loadOnViewArticle}" update=":dlg_add_tarif_categorie:blog_form_plan_tarifaire_client @this"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedCategorieClt.unloadOnViewArticle}" update=":dlg_add_tarif_categorie:blog_form_plan_tarifaire_client @this"/>
                        <p:column style="text-align:center;width: 1%">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox value="#{managedCategorieClt.addAllArt}">
                                    <p:ajax event="valueChange" global="false" listener="#{managedCategorieClt.addAllArticle()}" update="data_articles_categorie_client"/>
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox value="#{art.new_}">
                                <p:ajax event="valueChange" global="false" listener="#{managedCategorieClt.addOneArticle(art)}" update="data_articles_categorie_client"/>
                            </h:selectBooleanCheckbox>
                        </p:column>
                        <p:column headerText="N°" width="10" style="text-align: center">
                            <span title="#{art.designation}">#{artCatCltIdx+1}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}" width="80">
                            <span title="#{art.designation}">#{art.refArt}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_designation}" width="150">
                            <span title="#{art.designation}">#{art.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.LC_PCC_puv}" width="80" style="text-align: right">
                            <h:outputText value="#{art.puv}" title="#{art.designation}" converter="DN" />
                        </p:column>
                        <p:column headerText="#{lab.L_categorie}" width="80" style="text-align: center">
                            <span title="#{art.designation}">#{art.categorie}</span>
                        </p:column>
                    </p:dataTable>
                    <div align="center" style="clear: both">
                        <p:commandButton value="#{lab.LC_PCC_selectionner}" oncomplete="dlgListArticle.hide()" actionListener="#{managedCategorieClt.addArticles()}"
                                         update=":form_categorie_client:data_plan_tarifaire_client"/>
                    </div>
                </div>                                
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des models de reglement
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="dlg_model_reglement">
            <p:dialog header="Models Reglement" widgetVar="dlgAddModelReglement" modal="true" width="35%" closeOnEscape="true" minHeight="100"> 
                <div class="part_fix">
                    <p:commandButton value="#{lab.L_enregistrer}" id="save_model_categorie" actionListener="#{managedModeReglement.saveNewModel()}" update="blog_form_model_categorie data_model_categorie" oncomplete="collapseForm('tranche_model_categorie')"/>
                    <p:commandButton value="#{lab.L_nouveau}" id="cancel_model_categorie" global="false" actionListener="#{managedModeReglement.resetFicheModel()}" update="blog_form_model_categorie" oncomplete="collapseForm('tranche_model_categorie')"/>
                    <p:commandButton value="#{lab.L_supprimer}" id="delete_model_categorie" onclick="dlgConfirmDeletePlanReglementClt.show()"/>
                    <div style="float: right">     
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('model_categorie');
                                collapseForm('tranche_model_categorie');
                                return false">
                            <p:graphicImage library="icones" name="newDoc.png" width="25" height="30" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>               
                        <p:spacer />
                        <h:link title="#{lab.L_mode_liste}" onclick="collapseList('model_categorie');
                                return false" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="25" height="30" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>   
                    </div>
                </div>
                <div class="part_scroll">
                    <div class="yvs_form_model_categorie">
                        <p:outputPanel id="blog_form_model_categorie">
                            <h:panelGrid id="form_model_categorie" columns="1" cellpadding="0" cellspacing="0" style="width: 100%" styleClass="yvs_nostyle">
                                <span>#{lab.L_reference} </span>
                                <h:panelGroup>
                                    <h:inputText value="#{managedModeReglement.model.designation}" style="width: 60%" title="#{lab.LC_PCC_reference_model}"/>
                                    <h:selectOneMenu value="#{managedModeReglement.model.type}">
                                        <f:selectItem itemLabel="#{lab.LC_PCC_fournisseur}" itemValue="F"/>                       
                                        <f:selectItem itemLabel="#{lab.LC_PCC_client}" itemValue="C"/>                       
                                        <f:selectItem itemLabel="#{lab.LC_PCC_autre}" itemValue="A"/>                       
                                        <f:selectItem itemLabel="#{lab.LC_PCC_mixte}" itemValue="M"/>                      
                                    </h:selectOneMenu> 
                                </h:panelGroup>                                
                                <h:outputText value="#{lab.LDB_PCB_code_acces}"/>
                                <h:inputText value="#{managedModeReglement.model.codeAcces}" style="background: #99ccff;width: 100%">
                                    <p:ajax event="valueChange" global="false" />
                                </h:inputText>
                                <h:inputTextarea value="#{managedModeReglement.model.description}" rows="3" style="width: 100%" title="#{lab.LC_PCC_description_model}"/>
                            </h:panelGrid>
                            <p:outputPanel id="blog_form_tranche_model_categorie" style="width: 98%">
                                <p:outputPanel rendered="#{managedModeReglement.model.update}">
                                    <div style="width: 100%;background: #666;margin: auto;color: white ">
                                        <span style="font-weight: bold">#{lab.LC_PCC_tranches}</span>
                                    </div>
                                    <div style=";border: 1px solid black;padding: 5px">
                                        <h:panelGrid id="form_tranche_model_categorie" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                            <span>N°</span>
                                            <h:inputText value="#{managedModeReglement.tranche.numero}" readonly="true" converter="DN" style="width: 30%"/>
                                            <span>#{lab.LC_PCC_taux} </span>
                                            <pe:inputNumber value="#{managedModeReglement.tranche.taux}" symbol="%" symbolPosition="suffixe" style="width: 50%;text-align: right"/>
                                            <span>#{lab.LC_PR_interval}</span>
                                            <pe:inputNumber value="#{managedModeReglement.tranche.intervalJour}" symbol=" #{lab.L_jour}(s)" symbolPosition="suffixe" decimalPlaces="0" style="width: 90%;text-align: right"/>
                                            <span>#{lab.LC_PCC_mode}</span>
                                            <h:selectOneMenu value="#{managedModeReglement.tranche.mode.id}" id="select_mode_tranche_model_categorie" 
                                                             title="#{lab.LC_PCC_mode_reglement}" style="min-width: 120px" onchange="openDialog(dlgAddModePaiement, $(this))">
                                                <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                                <f:selectItems value="#{managedModeReglement.modes}" var="mo" 
                                                               itemLabel="#{mo.designation}" itemValue="#{mo.id}" /> 
                                                <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                                <f:selectItem itemLabel="#{lab.L_plus_option}" itemValue="-1"/>    
                                            </h:selectOneMenu> 
                                        </h:panelGrid>
                                        <div style="margin-top: 5px">
                                            <p:commandButton id="cancel_tranche_model_categorie" value="#{lab.L_nouveau}" style="float: left" oncomplete="collapseForm('tranche_model_categorie')"
                                                             update="form_tranche_model_categorie" actionListener="#{managedModeReglement.resetFicheTranche()}" global="false"/>
                                            <p:commandButton id="save_tranche_model_categorie" value="#{lab.L_enregistrer}" style="float: right"
                                                             actionListener="#{managedModeReglement.saveNewTranche()}" oncomplete="collapseForm('tranche_model_categorie')"
                                                             update="blog_form_tranche_model_categorie"/>
                                        </div>
                                        <p:outputPanel style="margin-top: 10px">
                                            <h:inputHidden id="input_hide_tranche_model_categorie" value="#{managedModeReglement.tabIds_tranche}"/>
                                            <p:dataTable id="data_tranche_model_categorie" value="#{managedModeReglement.model.tranches}" var="tran" rowKey="#{tran.id}"
                                                         rowIndexVar="tranIdx" selectionMode="single" rows="5" paginator="true" paginatorAlwaysVisible="false">
                                                <p:ajax event="rowSelect" global="false" listener="#{managedModeReglement.loadOnViewTranche}" update=":dlg_model_reglement:form_tranche_model_categorie"/>
                                                <p:ajax event="rowUnselect" global="false" listener="#{managedModeReglement.unLoadOnViewTranche}" update=":dlg_model_reglement:form_tranche_model_categorie"/>
                                                <p:column headerText="N°" style="width: 12%;text-align: center">
                                                    <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{tran.new_}"/>
                                                    <span>#{tran.numero}</span>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PCC_taux}" style="width: 20%">
                                                    <h:outputText value="#{tran.taux}" converter="DNS"/>
                                                    <span> %</span>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PR_interval}">
                                                    <h:outputText value="#{tran.intervalJour}" converter="DN"/>
                                                    <span> Jours</span>
                                                </p:column>
                                                <p:column width="20" style="text-align: center">
                                                    <p:contextMenu for="btn_option_tranche_model_categorie" event="left click" styleClass="context_menu">
                                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedModeReglement.deleteBeanTranche_(tran)}" oncomplete="dlgConfirmDeleteTranche_.show()"/>
                                                    </p:contextMenu>                           
                                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_tranche_model_categorie" type="button"/>
                                                </p:column> 
                                                <p:column width="20" style="text-align: center">
                                                    <f:facet name="header">
                                                        <h:selectBooleanCheckbox styleClass="chek_all_line_tranche_model_categorie" value="false"
                                                                                 onclick="selectionAllLineTab(#{managedModeReglement.model.tranches.size()}, 'tranche_model_categorie')">
                                                        </h:selectBooleanCheckbox>
                                                    </f:facet>
                                                    <h:selectBooleanCheckbox  value="#{tran.select}" styleClass="chek_line_tranche_model_categorie" 
                                                                              onclick="selectionLineTab(#{tran.id}, 'tranche_model_categorie')">
                                                    </h:selectBooleanCheckbox>
                                                </p:column>
                                            </p:dataTable>
                                            <p:commandButton id="delete_tranche_model_categorie" value="#{lab.L_supprimer}" style="float: right"
                                                             onclick="dlgConfirmDeleteTranche.show()" global="false"/>
                                        </p:outputPanel>
                                        <div style="clear: both"/>
                                    </div>            
                                </p:outputPanel>                
                            </p:outputPanel>                
                        </p:outputPanel>
                    </div>
                </div>
                <div class="yvs_list_model_categorie">
                    <div class="part_list">
                        <h:inputHidden id="input_hide_model_categorie" value="#{managedModeReglement.tablIds}"/> 
                        <p:dataTable id="data_model_categorie" value="#{managedModeReglement.models}" var="mods" rowKey="#{mods.id}"
                                     rowIndexVar="modsIdx" selectionMode="single">
                            <p:ajax event="rowSelect" global="false" listener="#{managedCategorieClt.loadOnViewModel}" oncomplete="dlgAddModelReglement.hide()"/>
                            <p:ajax event="rowUnselect" global="false" listener="#{managedModeReglement._unLoadOnView}" oncomplete="collapseForm('model_categorie');collapseForm('tranche_model_categorie')"/>
                            <p:column headerText="N°" style="width: 0.5%">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{mods.new_}"/>
                                <span>#{modsIdx+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" style="width: 2.5%">
                                <h:outputText value="#{mods.reference}"/>
                            </p:column>
                            <p:column headerText="#{lab.L_actif}" style="width: 1.5%;text-align: center">
                                <p:commandLink style="margin-top: 10px" global="false" actionListener="#{managedModeReglement.activeModel(mods)}" update="data_model_categorie">
                                    <h:graphicImage library="img"  name="#{(mods.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                                </p:commandLink>
                            </p:column>
                            <p:column style="width: 1.5%;text-align: center">
                                <p:contextMenu for="btn_option_model_categorie" event="left click" styleClass="context_menu">
                                    <p:menuitem value="#{lab.L_modifier}" icon="ui-icon-pencil" global="false" actionListener="#{managedCategorieClt.selectModel(mods)}" oncomplete="collapseForm('model_categorie');collapseForm('tranche_model_categorie')"/>
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedModeReglement.deleteBeanModel_(mods)}" oncomplete="dlgConfirmDeletePlanReglementClt_.show()"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_model_categorie" type="button"/>
                            </p:column> 
                            <p:column style="width: 1.25%;text-align: center">
                                <f:facet name="header">
                                    <h:selectBooleanCheckbox styleClass="chek_all_line_model_categorie" value="false"
                                                             onclick="selectionAllLineTab(#{managedModeReglement.models.size()}, 'model_categorie')">
                                    </h:selectBooleanCheckbox>
                                </f:facet>
                                <h:selectBooleanCheckbox  value="#{mods.select}" styleClass="chek_line_model_categorie" 
                                                          onclick="selectionLineTab(#{mods.id}, 'model_categorie')">
                                </h:selectBooleanCheckbox>
                            </p:column>
                        </p:dataTable>
                    </div>
                </div>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteTranche" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedModeReglement.deleteBeanTranche()}" update=":dlg_model_reglement:blog_form_tranche_model_categorie"
                                 oncomplete="dlgConfirmDeleteTranche.hide();collapseForm('tranche_model_categorie')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteTranche.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteTranche_" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedModeReglement.deleteBeanTranche_()}" update=":dlg_model_reglement:blog_form_tranche_model_categorie"
                                 oncomplete="dlgConfirmDeleteTranche_.hide();collapseForm('tranche_model_categorie')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteTranche_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePlanReglementClt" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedModeReglement.deleteBeanModel()}" update=":dlg_model_reglement:data_model_categorie :dlg_model_reglement:form_model_categorie"
                                 oncomplete="dlgConfirmDeletePlanReglementClt.hide();collapseForm('model_categorie')"
                                 />
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeletePlanReglementClt.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePlanReglementClt_" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedModeReglement.deleteBeanModel_()}" update=":dlg_model_reglement:data_model_categorie :dlg_model_reglement:form_model_categorie"
                                 oncomplete="dlgConfirmDeletePlanReglementClt_.hide();collapseForm('model_categorie')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeletePlanReglementClt_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteTrancheTarif" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCategorieClt.deleteBeanTranchePlanTarif()}" oncomplete="dlgConfirmDeleteTrancheTarif.hide();collapseForm('grille_plan_tarifaire_client')"
                                 />
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteTranche.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteTrancheTarif_" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCategorieClt.deleteBeanTranchePlanTarif_()}" oncomplete="dlgConfirmDeleteTrancheTarif_.hide();collapseForm('grille_plan_tarifaire_client')"
                                 />
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteTrancheTarif_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePlanTarifaireClt" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCategorieClt.deleteBeanPlanTarif()}" oncomplete="dlgConfirmDeletePlanTarifaireClt.hide();collapseForm('plan_tarifaire_client')"
                                 update=":form_categorie_client:data_plan_tarifaire_client"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeletePlanTarifaireClt.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePlanTarifaireClt_" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCategorieClt.deleteBeanPlanTarif_()}" oncomplete="dlgConfirmDeletePlanTarifaireClt_.hide();collapseForm('plan_tarifaire_client')"
                                 update=":form_categorie_client:data_plan_tarifaire_client"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeletePlanTarifaireClt_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCategorieClt.deleteBean()}" oncomplete="dlgConfirmDelete.hide();collapseForm('categorie_client')"
                                 update=":form_categorie_client:data_categorie_client :form_categorie_client:select_categorie_parent_client"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LC_PCC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCategorieClt.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide();collapseForm('categorie_client')"
                                 update=":form_categorie_client:data_categorie_client :form_categorie_client:select_categorie_parent_client"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmClone" closeOnEscape="true"
                             message="#{lab.LC_PCC_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCategorieClt.cloneTarifsParent(true)}" oncomplete="dlgConfirmClone.hide();collapseForm('categorie_client')"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedCategorieClt.cloneTarifsParent(false)}" oncomplete="dlgConfirmClone.hide();collapseForm('categorie_client')"/>
            </p:confirmDialog>
        </h:form>

        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="form_categorie_client">      
            <div class="part_fix">
                <p:splitButton value="#{lab.L_enregistrer}" id="save_categorie_client" actionListener="#{managedCategorieClt.saveNew()}" icon="ui-icon-disk">
                    <p:menuitem value="#{lab.L_nouveau}" id="cancel_categorie_client" icon="ui-icon-document" actionListener="#{managedCategorieClt.resetFiche()}" update="blog_form_categorie_client" oncomplete="collapseForm('categorie_client')"/>
                    <p:menuitem value="#{lab.L_supprimer}" global="false" oncomplete="dlgConfirmDelete.show()" icon="ui-icon-trash"/>
                </p:splitButton>
                <p:commandButton value="#{lab.L_supprimer}" global="false" icon="ui-icon-trash" rendered="false" id="delete_categorie_client_" type="button"/>
                <div style="float: right;display: none">     
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('categorie_client');
                            return false">
                        <p:graphicImage library="icones" name="newDoc.png" width="25" height="30" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>               
                    <p:spacer />
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('categorie_client');
                            return false" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="25" height="30" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>   
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_categorie_client" style="width: 99%; margin: auto; background: white">
                    <p:outputPanel style="width: 99%; margin: auto; background: white">
                        <div style="float: left;width: 30%">
                            <p:outputPanel id="blog_form_categorie_client">
                                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                    <f:facet name="header">
                                        <h:panelGroup>
                                            <div style="float: left;margin-left: 10px">
                                                <span>#{lab.L_defaut} </span>
                                                <h:selectBooleanCheckbox value="#{categorieClient.defaut}"/>                                            
                                            </div>
                                            <div style="float: right;font-weight: normal;margin-right: 5px">
                                                <p:selectBooleanCheckbox value="#{categorieClient.actif}" itemLabel="Actif" tabindex="7"/>
                                                <p:selectBooleanCheckbox value="#{categorieClient.venteOnline}" itemLabel="Vente en ligne ? " style="float: right" rendered="#{managedCategorieClt.currentScte.venteOnline}"/>                                       
                                            </div>
                                        </h:panelGroup>
                                    </f:facet>
                                    <span>#{lab.L_code} </span>
                                    <h:inputText value="#{categorieClient.code}" style="width: 100%"/>
                                    <span>#{lab.L_libelle} </span>
                                    <h:inputText value="#{categorieClient.libelle}" style="width: 100%"/>
                                    <span>#{lab.L_parent} </span>
                                    <h:selectOneMenu value="#{categorieClient.parent.id}" id="select_categorie_parent_client" style="width: 100%">
                                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedCategorieClt.categoriesParent}" var="catClt_" 
                                                       itemLabel="#{catClt_.libelle}" itemValue="#{catClt_.id}" />                         
                                    </h:selectOneMenu> 
                                    <span>#{lab.LC_PCC_model} </span>
                                    <h:selectOneMenu value="#{categorieClient.model.id}" id="select_model_categorie" style="width: 100%"
                                                     onchange="openDialog(dlgAddModelReglement, $(this))" title="#{lab.LC_PCC_model_reglement}">
                                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedModeReglement.models}" var="model" 
                                                       itemLabel="#{model.reference}" itemValue="#{model.id}" />    
                                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItem itemLabel="#{lab.L_plus_option}" itemValue="-1"/>                     
                                    </h:selectOneMenu> 
                                    <f:facet name="footer">
                                        <span>#{lab.L_description} </span>
                                        <h:inputTextarea value="#{categorieClient.description}" rows="5" style="width: 100%" id="txt_desc_cat_clt"/>                                        
                                    </f:facet>
                                </h:panelGrid>
                            </p:outputPanel>
                        </div>
                        <div style="margin-left: 31%; width: 69%">
                            <h:inputHidden id="input_hide_categorie_client" value="#{managedCategorieClt.tabIds}"/>
                            <p:dataTable id="data_categorie_client" value="#{managedCategorieClt.categories}" var="catClt" scrollable="true" scrollHeight="185"
                                         rowKey="#{catClt.id}" rowIndexVar="catCltIdx" selectionMode="single" selection="#{managedCategorieClt.categorieSelect}">
                                <p:ajax event="rowSelect" listener="#{managedCategorieClt.loadOnView}" update=":form_categorie_client:data_plan_tarifaire_client :form_categorie_client:delete_plan_tarifaire_client :form_categorie_client:input_hide_categorie_client" oncomplete="collapseForm('plan_tarifaire_client');collapseForm('model_categorie')"/>
                                <p:ajax event="rowUnselect" listener="#{managedCategorieClt.unLoadOnView}" update=":form_categorie_client:data_plan_tarifaire_client :form_categorie_client:delete_plan_tarifaire_client" oncomplete="collapseForm('plan_tarifaire_client');collapseForm('model_categorie')"/>
                                <p:column width="20" headerText="N°">
                                    <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{catClt.new_}"/>
                                    <span>#{catCltIdx+1}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_code}">
                                    <span>#{catClt.code}</span>
                                    <h:outputText value="#{lab.L_defaut}" rendered="#{catClt.defaut}" style="float: right;font-weight: bold;font-size: 0.8em;font-style: italic;color: blue"/>
                                </p:column>
                                <p:column headerText="#{lab.L_designation}">
                                    <span>#{catClt.libelle}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_parent}">
                                    <span>#{catClt.parent.libelle}</span>
                                </p:column>
                                <p:column headerText="#{lab.LC_PCC_model}">
                                    <span>#{catClt.model.reference}</span>
                                </p:column>
                                <p:column width="20" style="text-align: center">
                                    <p:contextMenu for="btn_option_categorie_client" event="left click" styleClass="context_menu">
                                        <p:menuitem value="#{lab.L_set_defaut}" icon="ui-icon-star" global="false" actionListener="#{managedCategorieClt.activeDefaut(catClt)}" update="data_categorie_client"/>
                                        <p:menuitem value="#{lab.LC_PCC_lier_a_tous_clients}" icon="ui-icon-disk" actionListener="#{managedCategorieClt.initLiaison(catClt)}" oncomplete="dlgLiaisonClient.show()"/>
                                        <p:separator style="width: 100%"/>
                                        <p:menuitem value="#{lab.LC_PCC_copier_parent}" icon="ui-icon-arrowreturnthick-1-n" actionListener="#{managedCategorieClt.copierTarifsParent(catClt)}" rendered="#{catClt.parent != null}" update=":form_categorie_client:data_plan_tarifaire_client"/>
                                        <p:menuitem value="#{lab.LC_PCC_clone_parent}" icon="ui-icon-arrowreturnthick-1-s" actionListener="#{managedCategorieClt.setCategorieSelect(catClt)}" rendered="#{catClt.fils.size()>0}" oncomplete="dlgConfirmClone.show()"/>
                                        <p:menuitem value="#{lab.LC_PCC_propager_prix}" icon="ui-icon-newwin" actionListener="#{managedCategorieClt.getProgatationPrix(catClt)}" rendered="#{catClt.fils.size()>0}"/>
                                        <p:menuitem value="#{lab.LC_PCC_recalculer_prix}" icon="ui-icon-newwin" actionListener="#{managedCategorieClt.getRecalculerPrix(catClt)}" rendered="#{catClt.parent != null}"/>
                                        <p:separator style="width: 100%"/>
                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedCategorieClt.deleteBean_(catClt)}" oncomplete="dlgConfirmDelete_.show()"/>
                                    </p:contextMenu>                           
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_categorie_client" type="button"/>
                                </p:column> 
                                <p:column width="20" style="text-align: center">
                                    <f:facet name="header">
                                        <h:selectBooleanCheckbox styleClass="chek_all_line_categorie_client" value="false"
                                                                 onclick="selectionAllLineTab(#{managedCategorieClt.categories.size()}, 'categorie_client')">
                                        </h:selectBooleanCheckbox>
                                    </f:facet>
                                    <h:selectBooleanCheckbox value="#{catClt.selectActif}" styleClass="chek_line_categorie_client" onclick="selectionLineTab(#{catClt.id}, 'categorie_client')">
                                    </h:selectBooleanCheckbox>
                                </p:column>
                            </p:dataTable>
                            <div class="display_auteur" align="right"  style="font-style: italic;width: 95%">
                                <p:outputPanel autoUpdate="true">
                                    <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedCategorieClt.categorieSelect.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span> 
                                    <span>#{lab.L_modifier_le} <h:outputText value="#{managedCategorieClt.categorieSelect.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                                    <span>#{lab.L_par} <h:outputText value="#{managedCategorieClt.categorieSelect.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                                </p:outputPanel>
                            </div>
                            <p:commandButton value="#{lab.L_supprimer}" id="delete_categorie_client" global="false" onclick="dlgConfirmDelete.show()" 
                                             style="float: right"/>
                        </div>
                        <div style="clear: left"/>
                    </p:outputPanel>
                    <h:panelGrid columns="1" style="width: 100%;margin-top: 5px" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                        <f:facet name="header">
                            <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                <b><span>Plan Tarifaire</span></b>
                                <p:commandButton icon="ui-icon-plusthick" style="float: right;width: 20px;height: 20px" onclick="dlgAddTarifCategorie.show()"
                                                 title="#{lab.LC_PCC_ajouter_plan_tarifaire}" type="button"/>
                            </h:panelGrid>
                        </f:facet>
                        <p:outputPanel>
                            <h:inputHidden id="input_hide_plan_tarifaire_client" value="#{managedCategorieClt.tabIds_tarif}"/>
                            <p:dataTable id="data_plan_tarifaire_client" value="#{managedCategorieClt.tarifs}" selection="#{managedCategorieClt.tarifSelect}"
                                         var="planTClt" rowKey="#{planTClt.id}" rowIndexVar="planTCltIdx" selectionMode="single">
                                <p:ajax event="rowSelect" global="false" listener="#{managedCategorieClt.loadOnViewPlanTarif}" update=":dlg_add_tarif_categorie:form_plan_tarifaire_client" oncomplete="dlgAddTarifCategorie.show()"/>
                                <p:ajax event="rowUnselect" global="false" listener="#{managedCategorieClt.unLoadOnViewPlanTarif}" update=":dlg_add_tarif_categorie:form_plan_tarifaire_client"/>
                                <p:column style="width: 3%" headerText="N°">
                                    <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{planTClt.new_}"/>
                                    <span>#{planTCltIdx+1}</span>
                                </p:column>
                                <p:column style="width: 12%" headerText="#{lab.L_reference}">
                                    <h:outputText value="#{planTClt.article ne null ? planTClt.article.refArt : planTClt.famille.referenceFamille}"/>
                                    <h:outputText value="#{planTClt.article ne null ? 'A' : 'F'}" title="#{planTClt.article ne null ? 'Article' : 'Famille'}" style="float: right"
                                                  styleClass="style_statut_blue"/>

                                </p:column>
                                <p:column headerText="#{lab.LC_PCC_elemnt}">
                                    <h:outputText value="#{planTClt.article ne null ? planTClt.article.designation : planTClt.famille.designation}"/>
                                    <div style="float: right;display: #{planTClt.conditionnement eq null?'none':'inline'}">
                                        [<span style="font-weight: bold" title="#{planTClt.conditionnement.unite.libelle}">#{planTClt.conditionnement.unite.reference}</span>]
                                    </div>
                                </p:column>
                                <p:column headerText="#{lab.LC_PCC_coef}" style="text-align: right;width: 8%">
                                    <h:outputText value="#{planTClt.coefAugmentation}" converter="DN" title="#{lab.LC_PCC_coefficient_augmentation_zone}"/>
                                    <h:outputText value="%" rendered="#{planTClt.natureCoefAugmentation == constantes.NATURE_TAUX}"/>
                                </p:column>
                                <p:column  style="text-align: right;width: 15%">
                                    <f:facet name="header">   
                                        <p:contextMenu styleClass="context_menu" for="heau_puv_tarif_" event="left click">
                                            <p:menuitem value="#{lab.LC_PCC_fixer_prix}" onclick="dlgFixePrixMin.show()"/>
                                        </p:contextMenu>
                                        <h:outputText value="#{lab.LC_PCC_puv}" id="heau_puv_tarif_" style="cursor: pointer"/>
                                    </f:facet>
                                    <h:panelGroup style="float: left;font-size: 0.8em;font-style: italic;margin-top: 2px">
                                        <span>Min :</span>
                                        <h:outputText value="#{planTClt.puvMin}" converter="DNS" style="color: blue" title="#{lab.LC_PCC_prix_minimal}"/>
                                        <h:outputText value="%" style="color: blue" rendered="#{planTClt.naturePrixMin == constantes.NATURE_TAUX}"/>
                                    </h:panelGroup>
                                    <h:outputText value="#{planTClt.puv}" converter="DNS" style="font-weight: bold" rendered="#{0>=planTClt.grilles.size()}"/>
                                    <h:outputText value="#{lab.LC_PCC_grilles}" style="font-weight: bold" rendered="#{planTClt.grilles.size()>0}"/>
                                </p:column>
                                <p:column headerText="#{lab.LC_PCC_prix_parent}" style="text-align: right;width: 10%">
                                    <h:outputText value="#{planT-Clt.parent.puv}" converter="DNS"/>
                                </p:column>
                                <p:column headerText="#{lab.LC_PCC_remise}" style="text-align: right;width: 8%">
                                    <h:panelGroup rendered="#{0>=planTClt.grilles.size()}">
                                        <h:outputText value="#{planTClt.remise}" converter="DNS"/>
                                        <h:outputText value="%" rendered="#{planTClt.natureRemise == constantes.NATURE_TAUX}"/>
                                    </h:panelGroup>
                                    <h:outputText value="#{lab.LC_PCC_grilles}" style="font-weight: bold" rendered="#{planTClt.grilles.size()>0}"/>
                                </p:column>
                                <p:column headerText="#{lab.L_actif}" style="width: 5%;text-align: center">
                                    <p:commandLink style="margin-top: 10px" title="#{(planTClt.actif)?'Desactiver':'Activer'}" global="false" actionListener="#{managedCategorieClt.activePlanTarifaire(planTClt)}" update="data_plan_tarifaire_client">
                                        <h:graphicImage library="img"  name="#{(planTClt.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                                    </p:commandLink>
                                </p:column>
                                <p:column style="width: 5%;text-align: center">
                                    <p:contextMenu for="btn_option_plan_tarifaire_client" event="left click" styleClass="context_menu">
                                        <p:menuitem value="#{lab.LC_PCC_grille}" icon="ui-icon-calculator" global="false" actionListener="#{managedCategorieClt.initGrille(planTClt)}" oncomplete="collapseForm('grille_plan_tarifaire_client');dlgGrillePlanTarifaire.show()" update=":dlg_grille_plan_tarifaire_client"/>
                                        <p:separator style="width: 100%"/>
                                        <p:menuitem value="#{lab.LC_PCC_propager_prix}" icon="ui-icon-newwin" global="false" actionListener="#{managedCategorieClt._getProgatationPrix(planTClt)}" rendered="#{managedCategorieClt.categorieSelect.fils.size()>0}"/>
                                        <p:menuitem value="#{lab.LC_PCC_recalculer_prix}" icon="ui-icon-newwin" global="false" actionListener="#{managedCategorieClt._getRecalculerPrix(planTClt)}" rendered="#{managedCategorieClt.categorieSelect.parent != null}"/>
                                        <p:separator style="width: 100%"/>
                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedCategorieClt.deleteBeanPlanTarif_(planTClt)}" oncomplete="dlgConfirmDeletePlanTarifaireClt_.show()"/>
                                    </p:contextMenu>                           
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_plan_tarifaire_client" type="button"/>
                                </p:column> 
                                <p:column style="width: 3%;text-align: center">
                                    <f:facet name="header">
                                        <h:selectBooleanCheckbox styleClass="chek_all_line_plan_tarifaire_client" value="false"
                                                                 onclick="selectionAllLineTab(#{managedCategorieClt.tarifs.size()}, 'plan_tarifaire_client')">
                                        </h:selectBooleanCheckbox>
                                    </f:facet>
                                    <h:selectBooleanCheckbox  value="#{planTClt.selectActif}" styleClass="chek_line_plan_tarifaire_client" 
                                                              onclick="selectionLineTab(#{planTClt.id}, 'plan_tarifaire_client')">
                                    </h:selectBooleanCheckbox>
                                </p:column>
                            </p:dataTable>
                            <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0"> 
                                <h:panelGrid columns="2" cellpadding="0" cellspacing="0" style="margin-left: -15px">
                                    <h:inputText value="#{managedCategorieClt.artSearch}">
                                        <p:ajax event="valueChange" global="false" listener="#{managedCategorieClt.addParamArticleOnTarif()}" update="data_plan_tarifaire_client"/>
                                    </h:inputText>
                                    <h:panelGroup>
                                        <p:contextMenu for="delete_plan_tarifaire_client" event="left click" styleClass="context_menu">
                                            <p:menuitem value="#{lab.LC_PCC_ajouter_coef}" icon="ui-icon-eject" global="false" onclick="dlgAddCoefficient.show()"/>
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" onclick="dlgConfirmDeletePlanTarifaireClt.show()"/>
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" value="Options"  id="delete_plan_tarifaire_client" type="button"/>
                                    </h:panelGroup>
                                </h:panelGrid>
                                <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                                    <p:commandButton actionListener="#{managedCategorieClt.loadTarif(false, false)}" global="false" update="data_plan_tarifaire_client" icon="ui-icon-circle-triangle-w" disabled="#{managedCategorieClt.pa.disPrev}"/>
                                    <p:outputPanel ><p:outputLabel value="#{managedCategorieClt.pa.currentPage}/#{managedCategorieClt.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                                    <p:commandButton actionListener="#{managedCategorieClt.loadTarif(true, false)}" global="false" update="data_plan_tarifaire_client" icon="ui-icon-circle-triangle-e" disabled="#{managedCategorieClt.pa.disNext}"/>
                                    <p:selectOneMenu value="#{managedCategorieClt.max}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCategorieClt._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                        <f:selectItems value="#{managedCategorieClt.paginations}"/>
                                        <p:ajax event="valueChange" global="false" update="data_plan_tarifaire_client"/>
                                    </p:selectOneMenu>
                                </p:outputPanel> 
                            </h:panelGrid>
                        </p:outputPanel>  
                    </h:panelGrid>                    
                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="yvs_list_categorie_client" style="width: 99%; margin: auto; background: white">

                </div> 
            </div>
        </h:form>
    </ui:define>
</ui:composition>

