<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Commerciaux','modGescom', 'smenPersonnel', true,managedCommerciaux)}
    </ui:define>
    <ui:define name="contents">
        #{acces.doNothing()}
        #{managedNiveauAcces.doNothing()}
        #{managedDepot.doNothing()}
        #{managedPointVente.doNothing()}
        #{managedCreneauEmploye.doNothing()}
        #{managedUser.doNothing()}
        #{managedNiveauAcces.doNothing()}
        #{managedCompte.doNothing()}

        #{managedCaisses.init()}
        #{managedTiers.loadSetting()}

        #{Mdico.loadPays()}
        #{managedAgence.loadAgence()}
        #{managedCategoriePerso.loadAll()}
        #{managedTypeCreneau.loadAll()}
        #{managedSociete.loadByGroupe()}
        #{managedCaisses.loadAllCaisses()}
        #{managedModeReglement.loadAllMode()}
        #{managedJournaux.loadAllActif()}
        #{managedCatCompt.loadAllCategorie()}
        #{managedEquipeProduction.loadAllEqFromPlanif()}
        #{managedTiersTemplate.loadTemplate(true, true)}

        #{managedCommerciaux.loadAllCommerciaux(true, true)}
        #{managedCommerciaux.initView()}
        #{managedCommission.loadPlans()}
        <script type="text/javascript">
            $(function () {
                collapseList('personnel');
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
            });
        </script>
        <h:form>
            <p:remoteCommand name="updateBeanCaisse_" actionListener="#{managedCommerciaux.updateBean()}"/>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LDB_PCB_gestion_compte}" widgetVar="dlgCmpteG" width="80%" height="600"
                      closeOnEscape="true" footer="&copy; Lymytz">
                <script type="text/javascript">
                    $(function () {
                        collapseList('plan_compte');
                    });
                </script>
                <div class="dlg_part_fixe">
                    <div style="float: left">
                        <p:commandButton id="save_plan_compte" value="#{lab.L_enregistrer}"
                                         actionListener="#{managedCompte.saveNew()}" icon="ui-icon-disk"/>
                        <p:commandButton id="cancel_plan_compte" value="#{lab.L_nouveau}"
                                         actionListener="#{managedCompte.resetFiche()}" icon="ui-icon-document"/>
                        <h:panelGroup id="find_plan_compte">
                            <p:watermark value="#{lab.LDB_PCB_saisir_compte_g}" for="txt_cmpte_find_caisss"/>
                            <p:watermark value="#{alab.LDB_PCB_saisir_nature_compte}" for="txt_nature_find_caisss"/>
                            <h:panelGrid columns="3" style="font-size: 0.7em; float: left">
                                <h:inputText value="#{managedCompte.numCompteF}" id="txt_cmpte_find_caisss">
                                    <p:ajax event="valueChange"
                                            listener="#{managedCompte.addParamNumCompte(managedCompte.numCompteF)}"
                                            update="table_plan_compte"/>
                                </h:inputText>
                                <h:inputText value="#{managedCompte.natureCompteF}" id="txt_nature_find_caisss">
                                    <p:ajax event="valueChange"
                                            listener="#{managedCompte.addParamNatureCompte(managedCompte.natureCompteF)}"
                                            update="table_plan_compte"/>
                                </h:inputText>
                                <p:outputPanel autoUpdate="true">
                                    <h:panelGrid columns="4" cellpadding="0" cellspacing="0">
                                        <p:commandButton actionListener="#{managedCompte.pagineDataCompte(false)}"
                                                         update="table_plan_compte" icon="ui-icon-circle-triangle-w"
                                                         disabled="#{managedCompte.paginator.disPrev}"/>
                                        <p:outputLabel
                                                value="#{managedCompte.paginator.currentPage}/#{managedCompte.paginator.nbPage}"
                                                style="margin-top: 15px; font-size: 0.8em; font-weight: bold"/>
                                        <p:commandButton actionListener="#{managedCompte.pagineDataCompte(true)}"
                                                         update="table_plan_compte" icon="ui-icon-circle-triangle-e"
                                                         disabled="#{managedCompte.paginator.disNext}"/>
                                        <p:selectOneMenu value="#{managedCompte.imax}"
                                                         label="#{lab.L_nombre_max_resultat}"
                                                         valueChangeListener="#{managedCompte.changeMaxResult}"
                                                         style="font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                            <f:selectItems value="#{managedCompte.paginations}"/>
                                            <p:ajax event="valueChange" update="table_plan_compte"/>
                                        </p:selectOneMenu>
                                    </h:panelGrid>
                                </p:outputPanel>
                            </h:panelGrid>
                        </h:panelGroup>
                    </div>
                    <div style="float: right">
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('plan_compte');
                                return false;">
                            <p:graphicImage library="icones" name="newDoc.png" width="18" height="25"
                                            style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>
                        <h:link title="#{lab.L_mode_liste}" onclick="collapseList('plan_compte');
                                return false;">
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25"
                                            style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>
                    </div>
                    <div style="clear: both"/>
                </div>
                <div class="dlg_part_scroll">
                    <div class="yvs_form_plan_compte">
                        <p:outputPanel id="form_edit_compte">
                            <ui:include src="../../finance_compta/base/compte/form.xhtml"/>
                        </p:outputPanel>
                    </div>
                    <div class="yvs_list_plan_compte">
                        <p:outputPanel id="table_plan_compte">
                            <ui:include src="../../finance_compta/base/compte/list.xhtml"/>
                        </p:outputPanel>
                    </div>
                </div>
            </p:dialog>
        </h:form>

        <h:form prependId="false" id="main-statut">
            <p:dialog header="Activer / Désactiver" closeOnEscape="true" widgetVar="dlgConfirmChangeStatut"
                      resizable="false" modal="true">
                <h:panelGrid id="blog_active_commerciaux" columns="1" style="width: 100%" styleClass="yvs_nostyle"
                             cellpadding="0" cellspacing="0">
                    <h:outputText value="#{managedCommerciaux.selectCommercial.nom_prenom}" style="font-weight: bold"/>
                    <p:selectBooleanCheckbox value="true"
                                             itemLabel="#{managedCommerciaux.selectCommercial.actif?' - Désactiver le commercial':' - Activer le commercial'}"
                                             disabled="true"/>
                    <p:selectBooleanCheckbox value="#{managedCommerciaux.actionTiers}"
                                             itemLabel="#{managedCommerciaux.selectCommercial.actif?' - Désactiver le tiers':' - Activer le tiers'}"/>
                    <p:selectBooleanCheckbox value="#{managedCommerciaux.actionClient}"
                                             itemLabel="#{managedCommerciaux.selectCommercial.actif?' - Désactiver le client':' - Activer le client'}"
                                             rendered="#{managedCommerciaux.selectCommercial.tiers.clients.size() gt 0}"/>
                    <p:selectBooleanCheckbox value="#{managedCommerciaux.actionFournisseur}"
                                             itemLabel="#{managedCommerciaux.selectCommercial.actif?' - Désactiver le fournisseur':' - Activer le fournisseur'}"
                                             rendered="#{managedCommerciaux.selectCommercial.tiers.fournisseurs.size() gt 0}"/>
                    <p:selectBooleanCheckbox value="#{managedCommerciaux.actionEmploye}"
                                             itemLabel="#{managedCommerciaux.selectCommercial.actif?' - Désactiver l\'employé':' - Activer l\'employé'}"
                                             rendered="#{managedCommerciaux.selectCommercial.tiers.employes.size() gt 0}"/>
                    <f:facet name="footer">
                        <div align="right">
                            <p:commandButton value="#{managedCommerciaux.selectCommercial.actif?'Désactiver':'Activer'}"
                                             icon="#{managedCommerciaux.selectCommercial.actif?'ui-icon-cancel':'ui-icon-check'}"
                                             actionListener="#{managedCommerciaux.activeTiers(managedCommerciaux.selectCommercial)}"
                                             update="blog_active_commerciaux"/>
                        </div>
                    </f:facet>
                </h:panelGrid>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de creation de plan commission 
        *****************************************************************************
        <-->
        <h:form prependId="false" id="form_dlgAddPlanCommission_">
            <p:dialog id="dlgAddPlanCommission_" header="#{lab.LC_PC_creation_plan_commission}" footer="#{lab.L_copy}"
                      modal="true" width="40%" closeOnEscape="true" widgetVar="dlgAddPlanCommission">
                <p:panelGrid id="blog_form_plan_commission0" columns="1" style="width: 100%">
                    <p:panelGrid columns="2" style="width: 98%;margin: auto">
                        <span>#{lab.L_reference} </span>
                        <h:inputText value="#{managedCommission.plan.reference}"/>
                        <span>#{lab.L_libelle} </span>
                        <h:inputText value="#{managedCommission.plan.intitule}"/>
                        <span>#{lab.L_actif} </span>
                        <h:selectBooleanCheckbox value="#{managedCommission.plan.actif}"/>
                    </p:panelGrid>
                    <p:commandButton value="#{lab.L_enregistrer}"
                                     update="blog_form_plan_commission0 :main_commerciaux:select_plan_com  :main_commerciaux:view:select_plan_com"
                                     actionListener="#{managedCommission.saveNew()}" style="width: 100%"
                                     oncomplete="dlgAddPlanCommission.hide()"/>
                </p:panelGrid>
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des utilisateurs
        *****************************************************************************
        <-->
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCP_liste_users}" widgetVar="dlgListUsers" closeOnEscape="true" width="50%"
                      height="450" modal="true" dynamic="true">
                <p:watermark for="txt_search_users_commercial" value="Recherche..."/>
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_users_commercial" value="#{managedUser.numSearch}"
                                 style="margin-left: -10px">
                        <p:ajax event="valueChange" update="data-users_commercial"
                                listener="#{managedUser.searchUsersActif(false)}"/>
                    </h:inputText>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedUser.loadAll(false,false)}" global="false"
                                         update="data-users_commercial" icon="ui-icon-circle-triangle-w"
                                         disabled="#{managedUser.paginator.disPrev}"/>
                        <p:outputPanel><p:outputLabel
                                value="#{managedUser.paginator.currentPage}/#{managedUser.paginator.nbPage}"
                                style="margin-top: 15px; font-size: 0.8em; font-weight: bold"/></p:outputPanel>
                        <p:commandButton actionListener="#{managedUser.loadAll(true,false)}" global="false"
                                         update="data-users_commercial" icon="ui-icon-circle-triangle-e"
                                         disabled="#{managedUser.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedUser.imax}" label="#{lab.L_nombre_max_resultat}"
                                         valueChangeListener="#{managedUser.choosePaginator}"
                                         style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedUser.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data-users_commercial"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable id="data-users_commercial" value="#{managedUser.listUser}" var="art" rowKey="#{art.id}"
                             selectionMode="single" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" listener="#{managedCommerciaux.loadOnViewUsers}"
                            oncomplete="dlgListUsers.hide()"/>
                    <p:column style="width: 2%">
                        <span>#{art.codeUsers}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCP_noms}" style="width: 6%">
                        <span>#{art.nomUsers}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCP_groupe}" style="width: 4%">
                        <span>#{art.categorie.libelle}</span>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des tiers
        *****************************************************************************
        <-->
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PC_liste_clients}" widgetVar="dlgListTiers" closeOnEscape="true" width="50%"
                      height="450" modal="true" dynamic="true">
                <p:watermark for="txt_search_tiers_commercial" value="#{lab.LC_PC_code_client}"/>
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_tiers_commercial" value="#{managedTiers.numSearch_}"
                                 style="float: left;text-align: center;margin-left: -10px">
                        <p:ajax event="valueChange" listener="#{managedTiers.searchByNum()}"
                                update="data_tiers_commercial"/>
                    </h:inputText>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedTiers.init(false)}" global="false"
                                         update="data_tiers_commercial" icon="ui-icon-circle-triangle-w"
                                         disabled="#{managedTiers.paginator.disPrev}"/>
                        <p:outputPanel><p:outputLabel
                                value="#{managedTiers.paginator.currentPage}/#{managedTiers.paginator.nbPage}"
                                style="margin-top: 15px; font-size: 0.8em; font-weight: bold"/></p:outputPanel>
                        <p:commandButton actionListener="#{managedTiers.init(true)}" global="false"
                                         update="data_tiers_commercial" icon="ui-icon-circle-triangle-e"
                                         disabled="#{managedTiers.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedTiers.imax}" label="#{lab.L_nombre_max_resultat}"
                                         valueChangeListener="#{managedTiers.choosePaginator}"
                                         style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedTiers.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_tiers_commercial"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable id="data_tiers_commercial" value="#{managedTiers.listTiers}" var="clt_" rowKey="#{clt_.id}"
                             selectionMode="single" rowIndexVar="cltIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" listener="#{managedCommerciaux.loadOnViewTiers}"
                            oncomplete="dlgListTiers.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{clt_.codeTiers}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PC_nom}">
                        <span>#{clt_.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PC_zone}">
                        <span>#{clt_.region}</span>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de creation des catégories comptable
        *****************************************************************************
        <-->
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PC_liste_template}" widgetVar="dlgListTemplate" modal="true" width="75%"
                      closeOnEscape="true">
                <p:dataTable id="data_template_tiers_wizard" value="#{managedTiersTemplate.templates}" var="clt"
                             rowKey="#{clt.id}"
                             rowIndexVar="cltIdx" selectionMode="single" selection="#{managedTiers.selectTemplate}">
                    <p:ajax event="rowSelect" global="false" listener="#{managedTiers.loadOnViewTemplate}"
                            oncomplete="dlgListTemplate.hide()"
                            update=":main_commerciaux:blog_secteur_tiers"/>
                    <p:ajax event="rowUnselect" global="false" listener="#{managedTiers.unLoadOnViewTemplate}"/>
                    <p:column width="15">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_apercu}" width="100">
                        <span>#{clt.apercu}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PC_compte}" width="100">
                        <span>#{clt.compteCollectif.numCompte}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_pays}" width="100">
                        <span>#{clt.pays.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_ville}" width="100">
                        <span>#{clt.ville.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_secteur}" width="100">
                        <span>#{clt.secteur.libele}</span>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer">
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedTiersTemplate.init(false)}" global="false"
                                         update="data_template_tiers_wizard" icon="ui-icon-circle-triangle-w"
                                         disabled="#{managedTiersTemplate.paginator.disPrev}"/>
                        <p:outputPanel><p:outputLabel
                                value="#{managedTiersTemplate.currentPage}/#{managedTiersTemplate.paginator.nbPage}"
                                style="margin-top: 15px; font-size: 0.8em; font-weight: bold"/></p:outputPanel>
                        <p:commandButton actionListener="#{managedTiersTemplate.init(true)}" global="false"
                                         update="data_template_tiers_wizard" icon="ui-icon-circle-triangle-e"
                                         disabled="#{managedTiersTemplate.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedTiersTemplate.nbMax}" label="#{lab.L_nombre_max_resultat}"
                                         valueChangeListener="#{managedTiersTemplate.choosePaginator}"
                                         style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedTiersTemplate.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_template_tiers_wizard"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </f:facet>
            </p:dialog>
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue de creation categorie personnel
        *****************************************************************************
        <-->
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCommerciaux.deleteBean()}"
                                 oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgImportEmploye" closeOnEscape="true"
                             message="#{lab.LC_PC_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCommerciaux.importPersonnel()}"
                                 oncomplete="dlgImportEmploye.hide()"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgImportEmploye.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false" id="main-more_infos">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgImportEmploye" closeOnEscape="true"
                             message="#{lab.LC_PC_text2}" header="#{lab.L_confirmation}" id="form-more_infos">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCommerciaux.importPersonnel()}"
                                 oncomplete="dlgImportEmploye.hide()"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgImportEmploye.hide()"/>
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_commerciaux">
            <div class="part_fix">
                <p:commandButton value="#{lab.L_enregistrer}" id="save_personnel"
                                 actionListener="#{managedCommerciaux.saveNew()}"
                                 icon="ui-icon-disk"/>
                <p:commandButton value="#{lab.L_nouveau}" id="cancel_personnel" global="false"
                                 actionListener="#{managedCommerciaux.resetFiche()}" update="blog_form_personnel"
                                 oncomplete="collapseForm('personnel')"
                                 icon="ui-icon-document"/>
                <p:commandButton value="#{lab.L_modifier}" rendered="false" id="update_personnel"
                                 actionListener="#{managedCommerciaux.updateBean()}"
                                 oncomplete="collapseForm('personnel');return false"/>
                <p:commandButton value="#{lab.L_supprimer}" id="delete_personnel" onclick="dlgConfirmDelete.show()"/>
                <p:commandButton icon="ui-icon-document" value="#{lab.L_nouveau}"
                                 actionListener="#{managedCommerciaux.reset()}"
                                 oncomplete="wiz.loadStep (wiz.cfg.steps [0], true)" id="find_personnel"/>
                <div style="float: right">
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('personnel');
                            return false">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25"
                                        style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>
                    <p:spacer/>
                    <h:link title="#{lab.L_mode_creation_assistee}" onclick="collapseList('personnel');
                            return false">
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25"
                                        style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_personnel" style="width: 99%; margin: auto; background: white">
                    <p:outputPanel>
                        <div style="width: 39%;float: left">
                            <ui:include src="commerciaux/form.xhtml"/>
                            <div style="clear: both"/>
                        </div>
                        <div style="width: 60%;margin-left: 40%">
                            <p:dataTable value="#{managedUser.listUser}" var="usr" rowKey="#{usr.id}"
                                         rowIndexVar="line_user"
                                         id="tab_user_00_commerciaux" selectionMode="single">
                                <p:ajax event="rowSelect" listener="#{managedCommerciaux.loadOnView}"/>
                                <p:ajax event="rowUnselect" listener="#{managedCommerciaux.unLoadOnView}"/>
                                <p:column headerText="N°" style="width:16px">
                                    #{line_user+1}
                                </p:column>
                                <p:column headerText="#{lab.LC_PC_civilite}" width="30">
                                    <h:outputText value="#{usr.civilite}"/>
                                </p:column>
                                <p:column headerText="#{lab.L_code}"
                                          styleClass="#{(usr.commercial ne null and usr.commercial.actif)?'line_actiftrue':'_'}">
                                    <h:outputText value="#{usr.codeUsers}"/>
                                </p:column>
                                <p:column headerText="#{lab.LC_PC_nom}">
                                    <h:outputText value="#{usr.nomUsers}"/>
                                </p:column>
                                <p:column headerText="#{lab.L_agence}" style="text-align: center" width="100">
                                    <h:outputText value="#{usr.agence.designation}"/>
                                </p:column>
                                <p:column width="50" headerText="#{lab.L_actif}" style="text-align: center">
                                    <h:graphicImage library="img" name="#{(usr.actif)?'yes.png':'no.png'}" width="15"
                                                    height="15"/>
                                </p:column>
                                <p:column width="50" headerText="#{lab.L_defaut}" style="text-align: center">
                                    <h:graphicImage library="img"
                                                    name="#{(usr.commercial ne null and usr.commercial.defaut)?'vu.png':'vu_non.png'}"
                                                    width="15" height="15"/>
                                </p:column>
                                <p:column width="20" style="text-align: center">
                                    <p:commandButton update="tab_user_00_commerciaux"
                                                     icon="#{((usr.commercial eq null) or !usr.commercial.actif)?'ui-icon-circle-plus':'ui-icon-circle-minus'}"
                                                     style="width: 22px; height: 22px" id="btn_option_users"
                                                     actionListener="#{managedCommerciaux.saveNewOrRemoveCommerciale(usr, (usr.commercial eq null))}"/>
                                </p:column>
                                <p:column style="width: 5%;text-align: center">
                                    <p:contextMenu for="btn_option_commerciaux" event="left click"
                                                   style="font-size: 0.8em">
                                        <p:menuitem value="#{usr.commercial.actif?'Désactiver':'Activer'}"
                                                    icon="#{usr.commercial.actif?'ui-icon-cancel':'ui-icon-check'}"
                                                    actionListener="#{managedCommerciaux.setSelectCommercial(usr.commercial)}"
                                                    oncomplete="dlgConfirmChangeStatut.show()"
                                                    update=":main-statut:blog_active_commerciaux"/>
                                    </p:contextMenu>
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px"
                                                     id="btn_option_commerciaux" type="button"/>
                                </p:column>
                            </p:dataTable>
                            <h:inputText value="#{managedUser.numSearch}" style="float: left">
                                <p:ajax event="valueChange" listener="#{managedUser.addParamUsers()}"
                                        update="tab_user_00_commerciaux"/>
                            </h:inputText>
                            <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                                <p:commandButton actionListener="#{managedUser.loadAll(false,false)}" global="false"
                                                 update="tab_user_00_commerciaux" icon="ui-icon-circle-triangle-w"
                                                 disabled="#{managedUser.paginator.disPrev}"/>
                                <p:outputPanel>
                                    <p:inplace label="#{managedUser.paginator.currentPage}"
                                               style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                        <pe:inputNumber value="#{managedUser.paginator.gotoPage}"
                                                        style="width: 30px;text-align: center" decimalPlaces="0">
                                            <p:ajax event="blur" listener="#{managedUser.gotoPagePaginator()}"
                                                    update="tab_user_00_commerciaux"/>
                                        </pe:inputNumber>
                                    </p:inplace><p:outputLabel value="/#{managedUser.paginator.nbPage}"
                                                               style="margin-top: 15px; font-size: 0.8em; font-weight: bold"/>
                                </p:outputPanel>
                                <p:commandButton actionListener="#{managedUser.loadAll(true,false)}" global="false"
                                                 update="tab_user_00_commerciaux" icon="ui-icon-circle-triangle-e"
                                                 disabled="#{managedUser.paginator.disNext}"/>
                                <p:selectOneMenu value="#{managedUser.imax}" label="#{lab.L_nombre_max_resultat}"
                                                 valueChangeListener="#{managedUser.choosePaginator}"
                                                 style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                    <f:selectItems value="#{managedUser.paginations}"/>
                                    <p:ajax event="valueChange" global="false" update="tab_user_00_commerciaux"/>
                                </p:selectOneMenu>
                            </p:outputPanel>
                        </div>
                    </p:outputPanel>
                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="yvs_list_personnel" style="width: 99%; margin: auto; background: white">
                    <p:wizard id="wizard-personnel" widgetVar="wiz" flowListener="#{managedCommerciaux.onFlowProcess}"
                              backLabel="#{lab.LC_PC_precedent}" nextLabel="#{lab.LC_PC_suivant}"
                              step="#{managedCommerciaux.step}">
                        <p:tab id="profil" title="#{lab.LRH_PE_profil}">
                            <h:panelGrid id="form-profil_commercial" columns="1" columnClasses="label, value"
                                         style="width: 100%">
                                <h:panelGroup>
                                    <p>
                                        <span><b>Assistant de création de profil</b></span><br/>
                                        <span>Ici vous pouvez effectuer les actions suivantes :</span><br/>
                                        <ul>
                                            <li>Créer un utilisateur</li>
                                            <li>Créer le tiers rattaché à un utilisateur <h:selectBooleanCheckbox
                                                    value="#{managedCommerciaux.profil.generedTiers}"><p:ajax
                                                    event="valueChange" global="false"/></h:selectBooleanCheckbox></li>
                                            <li>Créer le dépôt de transaction d'un utilisateur <h:selectBooleanCheckbox
                                                    value="#{managedCommerciaux.profil.generedDepot}"><p:ajax
                                                    event="valueChange" global="false" update="txt-prefixe_code_depot"/></h:selectBooleanCheckbox>
                                            </li>
                                            <li>Créer le point de vente d'action d'un utilisateur
                                                <h:selectBooleanCheckbox
                                                        value="#{managedCommerciaux.profil.generedPoint}"><p:ajax
                                                        event="valueChange" global="false"
                                                        update="txt-prefixe_code_point"/></h:selectBooleanCheckbox></li>
                                            <li>Créer le la caisse de versement d'un utilisateur
                                                <h:selectBooleanCheckbox
                                                        value="#{managedCommerciaux.profil.generedCaisse}"><p:ajax
                                                        event="valueChange" global="false"
                                                        update="txt-prefixe_code_caisse"/></h:selectBooleanCheckbox>
                                            </li>
                                            <li>Définir un planning à un utilisateur <h:selectBooleanCheckbox
                                                    value="#{managedCommerciaux.profil.generedPlanning}"><p:ajax
                                                    event="valueChange" global="false"/></h:selectBooleanCheckbox></li>
                                            <li>Promovoir un utilisateur en tant que commercial <h:selectBooleanCheckbox
                                                    value="#{managedCommerciaux.profil.generedCommercial}"><p:ajax
                                                    event="valueChange" global="false"/></h:selectBooleanCheckbox></li>
                                        </ul>
                                    </p>
                                    <p>
                                        <span>Vous avez des options de personalisation <i>(cliquer sur l'élément pour le modifier...)</i></span>
                                        <ul>
                                            <li>
                                                Le préfixe du code du dépôt :
                                                <p:inplace id="txt-prefixe_code_depot"
                                                           label="#{managedCommerciaux.profil.modelDepot}"
                                                           style="font-weight: bold"
                                                           disabled="#{!managedCommerciaux.profil.generedDepot}">
                                                    <h:inputText value="#{managedCommerciaux.profil.modelDepot}"
                                                                 style="width: 100px;text-align: center"
                                                                 disabled="#{!managedCommerciaux.profil.generedDepot}">
                                                        <p:ajax event="valueChange" global="false"/>
                                                    </h:inputText>
                                                </p:inplace>
                                            </li>
                                            <li>
                                                Le préfixe du code du point de vente :
                                                <p:inplace id="txt-prefixe_code_point"
                                                           label="#{managedCommerciaux.profil.modelPoint}"
                                                           style="font-weight: bold"
                                                           disabled="#{!managedCommerciaux.profil.generedPoint}">
                                                    <h:inputText value="#{managedCommerciaux.profil.modelPoint}"
                                                                 style="width: 100px;text-align: center"
                                                                 disabled="#{!managedCommerciaux.profil.generedPoint}">
                                                        <p:ajax event="valueChange" global="false"/>
                                                    </h:inputText>
                                                </p:inplace>
                                            </li>
                                            <li>
                                                Le préfixe du code de la caisse :
                                                <p:inplace id="txt-prefixe_code_caisse"
                                                           label="#{managedCommerciaux.profil.modelCaisse}"
                                                           style="font-weight: bold"
                                                           disabled="#{!managedCommerciaux.profil.generedCaisse}">
                                                    <h:inputText value="#{managedCommerciaux.profil.modelCaisse}"
                                                                 style="width: 100px;text-align: center"
                                                                 disabled="#{!managedCommerciaux.profil.generedCaisse}">
                                                        <p:ajax event="valueChange" global="false"/>
                                                    </h:inputText>
                                                </p:inplace>
                                            </li>
                                        </ul>
                                    </p>
                                </h:panelGroup>
                            </h:panelGrid>
                        </p:tab>
                        <p:tab id="utilisateur" title="#{lab.LC_PC_utilisateur}" closable="true">
                            <p:commandLink onclick="dlgListUsers.show()" global="false"
                                           style="float: right;margin-right: 5px;font-style: italic">
                                Selectionner un utilisateur
                            </p:commandLink>
                            <p:outputPanel>
                                <ui:include src="../../donnee_de_base/users/users/form.xhtml"/>
                            </p:outputPanel>
                            <div align="right" style="margin-top: 5px;">
                                <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.skip}"
                                                         itemLabel="Aller à la dernière étape"/>
                            </div>
                        </p:tab>
                        <p:tab id="tiers" title="#{lab.LC_PC_tiers}" closable="true">
                            <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.generedTiers}"
                                                     itemLabel="Rattacher à un tiers"
                                                     style="float: left;font-weight: bold">
                                <p:ajax event="valueChange" global="false"/>
                            </p:selectBooleanCheckbox>
                            <p:commandLink actionListener="#{managedCommerciaux.setWizard(true)}"
                                           oncomplete="dlgListTiers.show()" global="false"
                                           style="float: right;margin-right: 5px;font-style: italic">
                                Selectionner un tiers
                            </p:commandLink>
                            <p:outputPanel>
                                <ui:include src="../../gescom/tiers/tiers/form.xhtml"/>
                            </p:outputPanel>
                            <div align="right" style="margin-top: 5px;">
                                <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.skip}"
                                                         itemLabel="Aller à la dernière étape"/>
                            </div>
                        </p:tab>
                        <p:tab id="depot" title="#{lab.LC_PC_depot}" closable="true">
                            <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.generedDepot}"
                                                     itemLabel="Générer un dépôt" style="float: left;font-weight: bold">
                                <p:ajax event="valueChange" global="false"/>
                            </p:selectBooleanCheckbox>
                            <p:outputPanel>
                                <ui:include src="depot/form.xhtml"/>
                                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: left" cellpadding="0"
                                             cellspacing="0">
                                    <h:outputText value="#{lab.LC_PC_tranches}"/>
                                    <h:selectOneMenu value="#{managedCommerciaux.profil.trancheDepot}"
                                                     style="width: 100%">
                                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedTypeCreneau.tranches}" var="trh"
                                                       itemLabel="#{trh.titre}" itemValue="#{trh.id}"/>
                                        <p:ajax event="valueChange" global="false"/>
                                    </h:selectOneMenu>
                                </h:panelGrid>
                            </p:outputPanel>
                            <div align="right" style="margin-top: 5px;clear: both">
                                <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.skip}"
                                                         itemLabel="Aller à la dernière étape"/>
                            </div>
                        </p:tab>
                        <p:tab id="point_vente" title="#{lab.LC_PC_point_vente}" closable="true">
                            <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.generedPoint}"
                                                     itemLabel="Générer un point de vente"
                                                     style="float: left;font-weight: bold">
                                <p:ajax event="valueChange" global="false"/>
                            </p:selectBooleanCheckbox>
                            <p:outputPanel>
                                <ui:include src="point_vente/form.xhtml"/>
                                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: left" cellpadding="0"
                                             cellspacing="0">
                                    <h:outputText value="#{lab.LC_PC_tranches}"/>
                                    <h:selectOneMenu value="#{managedCommerciaux.profil.tranchePoint}"
                                                     style="width: 100%">
                                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedTypeCreneau.tranches}" var="trh"
                                                       itemLabel="#{trh.titre}" itemValue="#{trh.id}"/>
                                        <p:ajax event="valueChange" global="false"/>
                                    </h:selectOneMenu>
                                </h:panelGrid>
                            </p:outputPanel>
                            <div align="right" style="margin-top: 5px;clear: both">
                                <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.skip}"
                                                         itemLabel="Aller à la dernière étape"/>
                            </div>
                        </p:tab>
                        <p:tab id="caisse" title="#{lab.LC_PC_caisses}" closable="true">
                            <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.generedCaisse}"
                                                     itemLabel="Générer une caisse"
                                                     style="float: left;font-weight: bold">
                                <p:ajax event="valueChange" global="false"/>
                            </p:selectBooleanCheckbox>
                            <p:outputPanel>
                                <ui:include src="../../finance_compta/base/caisse/form.xhtml"/>
                            </p:outputPanel>
                            <div align="right" style="margin-top: 5px;">
                                <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.skip}"
                                                         itemLabel="Aller à la dernière étape"/>
                            </div>
                        </p:tab>
                        <p:tab id="planning" title="Planning" closable="true">
                            <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.generedPlanning}"
                                                     itemLabel="Planifier l'utilisateur"
                                                     style="float: left;font-weight: bold">
                                <p:ajax event="valueChange" global="false"/>
                            </p:selectBooleanCheckbox>
                            <p:outputPanel>
                                <ui:include src="creneau_horaire/form.xhtml"/>
                            </p:outputPanel>
                            <div align="right" style="margin-top: 5px;">
                                <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.skip}"
                                                         itemLabel="Aller à la dernière étape"/>
                            </div>
                        </p:tab>
                        <p:tab id="confirm" title="#{lab.LC_PC_commercial}" closable="true">
                            <p:selectBooleanCheckbox value="#{managedCommerciaux.profil.generedCommercial}"
                                                     itemLabel="Définir en tant que commercial"
                                                     style="float: left;font-weight: bold">
                                <p:ajax event="valueChange" global="false"/>
                            </p:selectBooleanCheckbox>
                            <p:outputPanel>
                                <f:subview id="view">
                                    <ui:include src="commerciaux/form.xhtml"/>
                                </f:subview>
                            </p:outputPanel>
                            <h:panelGroup style="float: right">
                                <p:commandButton icon="ui-icon-disk" value="#{lab.LC_PC_creer}"
                                                 actionListener="#{managedCommerciaux.save()}"/>
                            </h:panelGroup>
                        </p:tab>
                    </p:wizard>
                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function () {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">
            <h:graphicImage library="img" name="pointe_.png" style="border: none; position: relative; bottom: -20px"
                            width="20" height="20"
                            styleClass="img_slide" title="#{lab.L_cacher}"/>
            <div class="zone_find">
                <div class="yvs_form_personnel display_auteur" align="right" style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText
                                value="#{managedCommerciaux.selectCommercial.dateSave}" converter="LD"
                                styleClass="valeur" style="font-weight: bold"/></span>
                        <span>#{lab.L_modifier_le}<h:outputText
                                value="#{managedCommerciaux.selectCommercial.dateUpdate}" converter="LD"
                                styleClass="valeur" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText
                                value="#{managedCommerciaux.selectCommercial.author.users.nomUsers}" styleClass="valeur"
                                style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <h:panelGrid columns="2" style="width: 100%; font-size: 0.8em;" cellpadding="0" cellspacing="0">
                    <h:panelGrid columns="8" style="float: left; font-size: 1.0em" cellpadding="0" cellspacing="0">

                    </h:panelGrid>

                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>

