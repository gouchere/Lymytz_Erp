<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Factures Vente V2.0','modGescom', 'smenFactureVenteV2', true,managedFactureVenteV2)}
    </ui:define> 
    <ui:define name="contents">  
        <style type="text/css">
            .zone_find{
                height: 22px;
            }
        </style>
        #{managedReservation.doNothing(null)}
        #{managedVente.doNothing()}  
        #{managedSaisiePiece.doNothing()}  
        #{managedRetenue.doNothing()}  
        #{managedClient.doNothing()}        
        #{navigations.doNothing()}
        #{managedTiers.doNothing()}
        #{managedBonVente.doNothing()}
        #{managedLivraisonVente.doNothing()}
        #{managedCommerciaux.doNothing()}     
        #{managedRemise.doNothing()}
        #{managedStockArticle.load(false)}       
        #{managedCaisses.doNothing()}   
        #{managedTypeCout.doNothing()} 

        #{managedReglementVente.doNothing()} 
        #{managedReglementAchat.doNothing()}
        #{managedPointVente.doNothing()}  
        #{managedModeReglement.doNothing()}
        #{managedCatCompt.doNothing()}
        #{Mdico.doNothing()}  
        #{managedFactureVenteV2.initView(true, constantes.VENTE, 'V3')}      

        #{managedParamForm.loadParamFormulaire('EDITION_FACTURE_VENTE')}      
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height()- $('body').find('#bottom').height()-30);                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 135);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('facture_vente');
                collapseForm('mensualite_facture_vente');
                collapseForm('reglement_vente');
                collapseForm('remise_vente');
                collapseList('facture_vente_');
                slideShow('tabview_facture_vente', 245);
                slideZoneOnClick(null, 'zone_fv_net_a_payer');
            });

            function print(data) {
                window.open(data);
            }
        </script>
        <h:form prependId="false">
            <p:remoteCommand name="openPrintDialog" actionListener="#{managedFactureVenteV2.openPrintDialog()}"/>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmResetFiche" closeOnEscape="true"
                             message="#{lab.LC_PFV_vider_champs}" header="#{lab.L_confirmation}">
                <div >
                    <span>Mémoriser mon choix pour cette session</span>
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.needConfirmation}" />
                </div>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.resetFiche(true)}" update=":main_facture_vente:blog_form_facture_vente"
                                 oncomplete="dlgConfirmResetFiche.hide();collapseForm('facture_vente');collapseForm('contenu_facture_vente')"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.resetFiche(false)}" oncomplete="dlgConfirmResetFiche.hide()"/>            
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false" id="form_change_num_doc">
            <p:dialog header="#{lab.LC_PFV_model_numerotation}" widgetVar="dlgChangeNumDoc" width="40%" >
                <h:panelGrid columns="2" style="width: 100%" id="form_num_doc">                    
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.changeNumdocAuto}" itemLabel="#{lab.LC_PFV_automatique}">
                        <p:ajax event="valueChange" update="form_num_doc_"/>
                    </p:selectBooleanCheckbox>
                    <h:panelGrid columns="2" id="form_num_doc_">
                        <span>#{lab.LC_PFV_numero_actuel}</span>
                        <h:inputText value="#{managedFactureVenteV2.selectDoc.numDoc}" readonly="true"/>
                        <span>#{lab.LC_PFV_nouveau_numero}</span>
                        <h:inputText value="#{managedFactureVenteV2.selectDoc.numDoc}" disabled="#{managedFactureVenteV2.changeNumdocAuto}"/>
                    </h:panelGrid>
                    <p:commandButton value="#{lab.L_appliquer}" actionListener="#{managedFactureVenteV2.changeNumero()}" icon="ui-icon-arrowthickstop-1-s"
                                     style="margin-left: 60%"/>
                </h:panelGrid>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="dglnote">
            <p:dialog widgetVar="dlgAddNote" closeOnEscape="true" header="#{lab.LC_PFV_ajouter_note}" 
                      >
                <h:panelGrid columns="2">
                    <h:outputText value="#{lab.LC_PFV_note}" />
                    <h:inputTextarea value="#{managedFactureVenteV2.notes}" />

                </h:panelGrid>

                <p:commandButton value="#{lab.L_valider}"  icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.addNote()}" oncomplete="dlgAddNote.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgAddNote.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_text14}" modal="true" closeOnEscape="true"
                      widgetVar="dlgChoixTypeRet" width="70%" footer="&copy;Lymytz 2014"> 
                <h:panelGrid columns="6" style="width: 100%" id="zone_choix_retenu_vente">
                    <span>#{lab.LC_PFV_text15}</span>
                    <p:calendar size="8" pattern="dd-MM-yyyy" value="#{managedRetenue.debutPlanif}" >
                        <p:ajax global="false" event="dateSelect" />
                    </p:calendar>
                    <span>#{lab.LC_PFV_type_retenue}</span>
                    <h:selectOneMenu value="#{managedRetenue.elementAdd.typeElt.id}" >
                        <f:selectItem itemValue="0" itemLabel="" />
                        <f:selectItems value="#{managedRetenue.listTypesElts}" var="typE"
                                       itemValue="#{typE.id}" itemLabel="#{typE.libelle}" rendered="#{typE.visibleEnGescom}"/>
                        <p:ajax event="valueChange" update="tab_prelevement_detail_vente" listener="#{managedRetenue.placerRetenu(managedReglementVente.pieceVente.montant)}" />
                    </h:selectOneMenu>
                    <span>#{lab.LC_PFV_plan}</span>
                    <h:selectOneMenu value="#{managedRetenue.elementAdd.plan.id}">
                        <f:selectItem itemValue="0" itemLabel="" noSelectionOption="true" />
                        <f:selectItems value="#{managedRetenue.plansRetenues}" var="planR" itemValue="#{planR.id}" itemLabel="#{planR.referencePlan}" rendered="#{(planR.actif and planR.visibleEnGescom)}"/>
                        <p:ajax event="valueChange" update="tab_prelevement_detail_vente" listener="#{managedRetenue.placerRetenu(managedReglementVente.pieceVente.montant)}" />
                    </h:selectOneMenu>                    
                    <f:facet name="footer" >
                        <p:dataTable value="#{managedRetenue.elementAdd.listPrelevement}" var="det_" rowKey="#{det_.id}"
                                     widgetVar="tableauDetailPlanPrelevement" rowIndexVar="line_detailP"
                                     selectionMode="single" id="tab_prelevement_detail_vente" selection="#{managedRetenue.selectedDetailPrelevement}">
                            <p:column width="20" headerText="N°" style="text-align: center"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                #{line_detailP+1}
                                <p:graphicImage library="img" name="blocked.png" rendered="#{det_.retenuFixe}" />
                            </p:column>                                
                            <p:column headerText="#{lab.LC_PFV_date_prevelement}" width="100" style="text-align: left"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                <h:outputText value="#{det_.datePrelevement}" converter="LD"/>
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" width="200" style="text-align: center"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                <h:outputText value="#{det_.reference}" />
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_montant_prevelement}" width="100" style="text-align: right"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                <h:outputText value="#{det_.valeur}" converter="#{managedFactureVente.converter}"/>
                            </p:column>
                        </p:dataTable>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="float: right" actionListener="#{managedReglementVente.valideReglementFacture()}" 
                                 oncomplete="dlgChoixTypeRet.hide()" update=":form-reglement_vente:data_mensualite_facture_vente" />
            </p:dialog>            
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_lettrage_document}" widgetVar="dlgLettrage" width="80%" style="max-height: 400px">
                <ui:include src="../../finance_compta/compta_general/liste_contenu_journal.xhtml" />
                <f:facet name="footer">

                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_ppte_valid_fv">
            <p:dialog header="#{lab.LC_PFV_propriete_validation}" widgetVar="dlgppteValid" width="60%" dynamic="true">
                <p:dataTable value="#{managedFactureVenteV2.docVente.etapesValidations}" var="iValid" id="table_ppte_valid_fv">
                    <p:column headerText="#{lab.LC_PFV_etapes}" >#{iValid.etape.labelStatut}</p:column>
                    <p:column headerText="#{lab.LC_PFV_valider_par}" >
                        <h:outputText value="#{iValid.author.users.nomUsers}" rendered="#{iValid.etapeValid or iValid.motif != null}" />
                    </p:column>
                    <p:column headerText="#{lab.L_dates} " style="text-align: center">
                        <h:outputText value="#{iValid.dateUpdate}" converter="DATETIME" rendered="#{iValid.etapeValid}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_motif} " >
                        <h:outputText value="#{managedFactureVenteV2.resumeText(iValid.motif)}"/>
                    </p:column> 
                </p:dataTable>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_status}" widgetVar="dlgMoreStatuts" modal="true" closeOnEscape="true">                 
                <p:selectManyMenu value="#{managedFactureVenteV2.statuts}" showCheckbox="true" style="min-width: 120px;size: 20px">
                    <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                    <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                    <f:selectItem itemLabel="#{lab.L_annuler}" itemValue="#{constantes.ETAT_ANNULE}"/>
                    <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                    <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                    <f:selectItem itemLabel="#{lab.LC_PFV_terminer}" itemValue="#{constantes.ETAT_SOUMIS}"/>
                    <p:ajax event="valueChange" update=":form-data_facture:data_facture_vente" listener="#{managedFactureVenteV2.chooseStatuts()}"/>
                </p:selectManyMenu>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="select_fv_compensation">
            <p:dialog header="#{lab.LC_PFA_compensation_client_fournisseur}" width="70%" widgetVar="dlgCompensation" modal="true" closeOnEscape="true"
                      footer="&copy; Lymytz 2014">
                <div style="border: solid 2px; height: 170px; padding: 2px; border-radius: 5px;">
                    <span style="display: inline-block; background: #CCC; width: 100%; font-size: 0.9em">
                        <span style="font-weight: bold">Factures achats</span> 
                        <h:panelGroup style="float:right" id="total_achat_compensation">
                            <span>#{lab.LC_PFV_total_facture} : </span>
                            <h:outputText style="font-weight: bold" value="#{managedCompensation.achat.montantTotal}" converter="#{managedFactureVenteV2.converter}"/>
                            <span style="font-size:0.8em">Fcfa </span>
                        </h:panelGroup>
                    </span>
                    <div style="width: 99.5%; height: 130px; border: solid 1px; margin: auto;overflow-y: auto">
                        <p:dataTable value="#{managedCompensation.achats}" var="ac" rowKey="#{ac.id}" selectionMode="single" rowIndexVar="Idx" id="data_achat_compensation">
                            <p:ajax event="rowSelect" listener="#{managedCompensation.loadOnViewAchat}"
                                    update=":select_fv_compensation:total_achat_compensation :select_fv_compensation:blog_compensation_facture_vente"/>
                            <p:column width="30" headerText="N°" styleClass="statut_#{ac.statut}">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{ac.new_}"/> 
                                <span>#{Idx+1}</span>
                                <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{ac.cloturer}"/>      
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" style="width: 20%" styleClass="statut_#{ac.statut}">
                                <span>#{ac.numDoc}</span>
                                <h:outputText value="#{lab.LC_PFA_vide}" style="float: right;color: blue;font-style: italic;font-size: 0.8em" rendered="#{0>=ac.contenus.size()}"/>
                                <h:panelGroup style="float: right">
                                    <h:outputText title="#{lab.LC_PFA_facture_livrer}" value="L" rendered="#{ac.statutLivre == constantes.ETAT_LIVRE}"
                                                  styleClass="style_statut"/>
                                </h:panelGroup>
                            </p:column>
                            <p:column headerText="#{lab.L_date}" style="text-align: center;width: 15%" styleClass="statut_#{ac.statut}">
                                <h:outputText value="#{ac.dateDoc}" converter="DDMMYYYY"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_fournisseur}" styleClass="statut_#{ac.statut}">
                                <h:outputText value="#{ac.fournisseur.tiers.nom_prenom}"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_piece_externe}" style="width: 20%" styleClass="statut_#{ac.statut}">
                                <span>#{ac.numPiece}</span>
                            </p:column>
                            <p:column headerText="" width="15"  style="text-align: center" styleClass="statut_#{ac.statut}">
                                <p:contextMenu event="left click" for="btn_opt_nav_fa">
                                    <p:menuitem icon="ui-icon-arrowthick-1-e" actionListener="#{managedFactureVenteV2.onLoadFactureAchat(ac)}" value="Aller à" />
                                </p:contextMenu>
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px;" id="btn_opt_nav_fa" type="button"/>
                            </p:column>
                        </p:dataTable>
                    </div>
                    <div style="font-size:0.9em">
                        <h:panelGroup style="float: left">
                            <span>#{lab.LC_PFV_total_reglement} : </span>
                            <h:outputText style="font-weight: bold" value="#{managedCompensation.selectPieceVente.montant}" converter="#{managedFactureVenteV2.converter}"/>
                            <span style="font-size:0.8em">Fcfa </span>
                        </h:panelGroup>
                        <h:panelGroup style="float: right" id="total_achat_compensation_equilibre">
                            <span>#{lab.LC_PFV_total_equilibre} : </span>
                            <h:outputText style="font-weight: bold" value="#{managedCompensation.selectPieceVente.sommeAchat}" converter="#{managedFactureVenteV2.converter}"/>
                            <span style="font-size:0.8em">Fcfa </span>
                        </h:panelGroup>
                    </div>
                </div> 
                <p:separator/>
                <p:outputPanel id="blog_compensation_facture_vente">
                    <h:panelGrid id="form_compensation_facture_vente" columns="4" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" 
                                 style="padding-top: 2px;padding-bottom: -5px;background: #CCC;width: 100%; font-size: 0.9em">
                        <h:outputText value="#{lab.L_montant}" />
                        <h:outputText value="#{lab.LC_PFV_date_paiement}" />
                        <h:outputText value="#{lab.LC_PFV_caisse}" />
                        <h:outputText value="#{lab.L_reference}"/>
                        <pe:inputNumber value="#{managedCompensation.pieceAchat.montant}"  style="text-align: right"/>
                        <p:calendar value="#{managedCompensation.pieceAchat.datePaiementPrevu}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                        <h:selectOneMenu value="#{managedCompensation.pieceAchat.caisse.id}">
                            <f:selectItem itemLabel="" itemValue="0" />
                            <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}"
                                           itemValue="#{icaiss.id}" />
                        </h:selectOneMenu>
                        <h:panelGroup>
                            <h:inputText value="#{managedCompensation.pieceAchat.numRefExterne}" />
                            <p:commandButton icon="ui-icon-circle-plus" style="width: 22px; height: 22px;float: right"
                                             update="blog_compensation_facture_vente" actionListener="#{managedCompensation.saveNew()}"/>
                        </h:panelGroup> 
                    </h:panelGrid>                                            
                    <p:dataTable id="data_compensation_facture_vente" value="#{managedCompensation.selectPieceVente.compensations}" var="acc" rowKey="#{acc.id}" rowIndexVar="Idx" selectionMode="single">
                        <p:ajax event="rowSelect" global="false" listener="#{managedCompensation.loadOnView}" 
                                update=":select_fv_compensation:form_compensation_facture_vente :select_fv_compensation:total_achat_compensation :select_fv_compensation:data_achat_compensation"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedCompensation.unLoadOnView}" 
                                update=":select_fv_compensation:form_compensation_facture_vente :select_fv_compensation:total_achat_compensation"/>
                        <p:column headerText="N°" width="20" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{acc.achat.new_}"/>
                            <h:outputText value="#{Idx+1}"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_facture_numero}" filterBy="#{acc.achat.numeroPiece}" sortBy="#{acc.achat.datePiece}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            #{acc.achat.achat.numDoc}
                        </p:column>
                        <p:column headerText="#{lab.LC_PCV_piece_numero}"  sortBy="#{acc.achat.datePiece}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            #{acc.achat.numeroPiece}
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_date_edition}" sortBy="#{acc.achat.datePiece}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:outputText value="#{acc.achat.datePiece}" converter="DDMMYYYY"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_date_reglement}" sortBy="#{acc.achat.datePaimentPrevu}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:outputText value="#{(acc.achat.statutPiece eq constantes.STATUT_DOC_PAYER)?acc.achat.datePaiement:acc.achat.datePaimentPrevu}" converter="DDMMYYYY"/>
                        </p:column>
                        <p:column headerText="#{lab.L_montant}" style="width: 17%;text-align: right" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:outputText value="#{acc.achat.montant}" converter="#{managedFactureVenteV2.converter}"/>
                        </p:column>                                                                                    
                        <p:column style="width: 5%;text-align: center">
                            <p:commandButton icon="#{acc.id gt 0? 'ui-icon-minusthick':'ui-icon-plusthick'}" title="#{acc.id gt 0? 'Enlever':'Associer'}"
                                             style="width: 20px;height: 20px" actionListener="#{managedCompensation.addComprensation(acc)}" 
                                             update="data_compensation_facture_vente :select_fv_compensation:total_achat_compensation_equilibre"/>
                        </p:column>  
                    </p:dataTable>
                </p:outputPanel>
            </p:dialog>
        </h:form>

        <!-->
        Blog des remises sur facture directe
        <-->
        <h:form prependId="false" id="main_facture_vente_">
            <p:dialog width="50%" >
                <p:outputPanel id="blog_form_remise_vente">
                    <h:panelGrid columns="2" class="headline_data" styleClass="yvs_nostyle" style="width: 100%" cellpadding="0" cellspacing="0" rendered="#{accesRessource.fv_apply_rem_all}">
                        <b><span>#{lab.LC_PFV_remises}</span></b>
                        <p:commandButton id="btnRemiseVente" icon="ui-icon-circle-plus" type="button" 
                                         style="width: 22px; height: 22px;float: right;margin-top: 5px;float: right;background: white!important"/>                                            
                    </h:panelGrid>
                    <p:overlayPanel for="btnRemiseVente" hideEffect="fade" style="width: 15%">
                        <h:panelGrid id="form_remise_vente" columns="1" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                            <h:selectOneMenu value="#{managedFactureVenteV2.remise.remise.id}" id="select_remise_vente" style="width: 100%"
                                             title="#{lab.LC_PFV_selectionner_remise}">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedRemise.remises}" var="rem_" 
                                               itemLabel="#{rem_.refRemise}" itemValue="#{rem_.id}"/>
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItem itemLabel="#{lab.L_creer}" itemValue="-1"/>
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseRemise()}" update="txt_montant_remise"/>
                            </h:selectOneMenu>
                            <h:inputText id="txt_montant_remise" value="#{managedFactureVenteV2.remise.montant}" title="#{lab.LC_PFV_montant_remise}" 
                                         converter="#{managedFactureVenteV2.converter}" style="text-align: right; width: 100%" readonly="true"/>
                            <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="collapseForm('remise_vente')"
                                             actionListener="#{managedFactureVenteV2.saveNewRemise()}"/>
                        </h:panelGrid>
                    </p:overlayPanel>                                                
                    <p:outputPanel style="margin-top: -10px" rendered="#{accesRessource.fv_apply_rem_all}">                                                           
                        <h:inputHidden id="input_hide_remise_vente" value="#{managedFactureVenteV2.tabIds_remise}"/>
                        <p:dataTable id="data_remise_vente" value="#{managedFactureVenteV2.remisesFacture}" var="remD" rowKey="#{remD.id}" selectionMode="single"
                                     scrollable="true" scrollHeight="87">
                            <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewRemise}" oncomplete="collapseForm('remise_vente')"/>
                            <p:ajax event="rowUnselect" global="false" listener="#{managedFactureVenteV2.unLoadOnViewRemise}" oncomplete="collapseForm('remise_vente')"/>
                            <p:column headerText="#{lab.L_remise}" >
                                <span>#{remD.remise.refRemise}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_montant}" style="text-align: right">
                                <h:outputText value="#{remD.montant}" converter="#{managedFactureVenteV2.converter}"/>
                                Fcfa
                            </p:column>
                            <p:column style="width: 10%;text-align: center">
                                <p:contextMenu for="btn_option_remise_vente" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanRemise_(remD)}" oncomplete="dlgConfirmDeleteRemise_.show()"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_remise_vente" type="button"/>
                            </p:column> 
                        </p:dataTable>
                        <p:commandButton id="delete_remise_vente" value="#{lab.L_supprimer}" style="float: right" rendered="false"
                                         onclick="dlgConfirmDeleteRemise.show()" global="false"/>
                    </p:outputPanel> 
                </p:outputPanel>   
            </p:dialog>
        </h:form>
        <h:form>
            <p:remoteCommand name="updateBeanCaisse_" actionListener="#{managedFactureVenteV2.updateBean()}"/>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des livraisons liée au contenu
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_livraison_fv">
            <p:dialog header="#{lab.LC_PFV_modifier_quantite}"  widgetVar="dlgDefinedContenu" modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGroup id="form_defined_contenu" style="width: 100%">
                    <h:inputText value="#{managedLivraisonVente.quantite_livree}" style="width: 100px"/> 
                    <span> / </span>
                    <h:inputText value="#{managedLivraisonVente.selectContenu.qteRestant}"  style="width: 100px" disabled="true"/>                     
                    <p:commandButton value="#{lab.L_appliquer}" oncomplete="dlgDefinedContenu.hide()" icon="ui-icon-circle-check"
                                     actionListener="#{managedLivraisonVente.insertInLivraison()}" style="margin-left: 10px"/>
                </h:panelGroup>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PFV_liste_bon_livraison}" widgetVar="dlgOpenLivraison" modal="true" width="80%"  closeOnEscape="true"> 
                <p:dataTable id="data_livraison_content" value="#{managedLivraisonVente.livraisons}" var="bon" rowKey="#{bon.id}"
                             selectionMode="single" rowIndexVar="bonIdx">
                    <p:ajax event="rowSelect" global="false" listener="#{managedLivraisonVente.loadOnViewLivraison}" 
                            oncomplete="dlgDefinedContenu.show()" update=":main_livraison_fv:form_defined_contenu"/>
                    <p:ajax event="rowUnselect" global="false" listener="#{managedLivraisonVente.unLoadOnViewLivraison}" 
                            oncomplete="dlgDefinedContenu.show()" update=":main_livraison_fv:form_defined_contenu"/>
                    <p:column headerText="N°" width="30" styleClass="statut_#{bon.statut}">
                        <span>#{bonIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}">
                        <span>#{bon.numDoc}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_clients}" styleClass="statut_#{bon.statut}">
                        #{bon.client.nom_prenom}
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_depot}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.depotLivrer.designation}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_tranche}" styleClass="statut_#{bon.statut}" style="text-align: center">
                        <h:outputText value="#{bon.trancheLivrer.heureDebut}" converter="TIME"/>
                        -
                        <h:outputText value="#{bon.trancheLivrer.heureFin}" converter="TIME"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_date_livraison}" style="text-align: center;width: 10%" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.dateLivraison}" converter="DDMMYYYY"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_livreur}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.livreur.nomUsers}"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des depots du contenu
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_change_depot_contenu">
            <p:dialog header="#{lab.LC_PFV_depot_livraison_prevu}" widgetVar="dlgChangeDepot" modal="true" width="40%"  closeOnEscape="true"> 
                <h:panelGrid id="form_change_depot_contenu" columns="2" styleClass="yvs_table" style="width: 100%;margin: auto" cellpadding="0" cellspacing="0">
                    <span>#{lab.LC_PFV_depot} : </span>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{managedLivraisonVente.depotChange.id}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedLivraisonVente.depotsLivraison}" var="dpl" itemLabel="#{dpl.designation}" itemValue="#{dpl.id}" />    
                            <p:ajax event="valueChange" global="false" listener="#{managedLivraisonVente.chooseDepotContenu()}" update="txt_stock_article_in_depot"/>
                        </h:selectOneMenu> 
                        <h:panelGroup style="float: right;margin-top: 5px" id="txt_stock_article_in_depot">
                            <h:outputText value="#{managedLivraisonVente.depotChange.stock}" converter="#{managedFactureVenteV2.converterStock}" title="#{lab.PLUS} #{selectContenu.quantiteBonus} #{lab.L_bonus}"/>
                            <span title="#{managedLivraisonVente.selectContenu.conditionnement.unite.libelle}" 
                                  style="font-size: 0.6em;color: #003399">#{managedLivraisonVente.selectContenu.conditionnement.unite.reference}</span>
                        </h:panelGroup>
                    </h:panelGroup>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgChangeDepot.hide()"
                                 actionListener="#{managedFactureVenteV2.changeDepotContenu()}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des unites de mesure
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_zone_fv">
            <p:dialog header="#{lab.LC_PFV_creation_zone}" widgetVar="dlgAddZone" modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGrid id="form_zone_fv" columns="2" styleClass="yvs_table" style="width: 100%;margin: auto" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGroup style="float: left">
                            <span>#{lab.LC_PFV_titre} </span>
                            <h:selectOneMenu value="#{Mdico.dictionnaire.titre}">                   
                                <f:selectItem itemLabel="--" itemValue="#{null}"/>                    
                                <f:selectItem itemLabel="#{constantes.t_VILLES}" itemValue="#{constantes.t_VILLES}"/>                    
                                <f:selectItem itemLabel="#{constantes.t_SECTEURS}" itemValue="#{constantes.t_SECTEURS}"/>                    
                                <p:ajax event="valueChange" global="false" listener="#{Mdico.chooseTitre()}" update="txt_parent_zone_fv"/>
                            </h:selectOneMenu>    
                        </h:panelGroup>
                    </f:facet>
                    <span>#{lab.LC_PFV_abbreviation}</span>
                    <h:inputText value="#{Mdico.dictionnaire.abreviation}" style="width: 100%"/>
                    <span>#{lab.L_libelle}</span>
                    <h:inputText value="#{Mdico.dictionnaire.libelle}" style="width: 100%"/> 
                    <span>#{lab.L_parent}</span>
                    <h:selectOneMenu value="#{Mdico.dictionnaire.parent.id}" id="txt_parent_zone_fv" style="width: 100%">
                        <f:selectItem itemLabel="--" itemValue="0"/>                    
                        <f:selectItems value="#{Mdico.parents}" var="dP"
                                       itemLabel="#{dP.libele}" itemValue="#{dP.id}"/>                    
                    </h:selectOneMenu> 
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" update="form_zone_fv :main_facture_vente:txt_zone_client"
                                 actionListener="#{managedFactureVenteV2.saveZone()}" oncomplete="dlgAddZone.hide()"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv" closeOnEscape="true"
                             message="#{lab.LC_PFV_text2} ">
                <span>#{lab.LC_PFV_text11}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}"  icon="ui-icon-circle-check" actionListener="#{ReglementVente.cancelStatutPayeOfPCV()}" oncomplete="dlgCancelPcv.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv1" closeOnEscape="true"
                             message="#{lab.LC_PFV_text3} ">
                <span>La confirmation de cette action entrainera la suspension des phases même déjà validé</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedReglementVente.cancelStatutPayeOfPCVForBanque()}" oncomplete="dlgCancelPcv1.hide()" />
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv1.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv2" closeOnEscape="true"
                             message="#{lab.LC_PFV_text4} ">
                <span>#{lab.LC_PFV_text9}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedReglementVente.cancelStatutPayeOfPCVBySalaire()}" oncomplete="dlgCancelPcv2.hide()" />
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv2.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv3" closeOnEscape="true"
                             message="#{lab.LC_PFV_text5} ">
                <span>#{lab.LC_PFV_text9}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedReglementVente.cancelStatutPayeOfPCVByCompensation()}" oncomplete="dlgCancelPcv3.hide()" />
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv3.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeMode" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="#{lab.LC_PFV_text6} ">
                <span>#{lab.LC_PFV_text7}</span>
                <p:commandButton value="Ok" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeMode.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog widgetVar="dlgConfirmDeletePhase" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="#{lab.LC_PFV_text8} ">
                <span>#{lab.LC_PFV_text12}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.saveNewReglement(true)}" 
                                 update=":form-reglement_vente:form_mensualite_facture_vente" oncomplete="dlgConfirmDeletePhase.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmDeletePhase.hide()"/>
            </p:confirmDialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de type cout
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_creation_type}" widgetVar="dlgAddTypeCout" modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGrid id="form_type_cout_facture_vente" columns="4" cellpadding="0" cellspacing="0" style="width: 100%">
                    <p:commandLink actionListener="#{managedTypeCout.typeCout.setAugmentation(!managedTypeCout.typeCout.augmentation)}" global="false" update="@this">
                        <h:graphicImage title="#{managedTypeCout.typeCout.augmentation?'Augmente':'diminu'} le net à payer" library="img/icones" name="#{managedTypeCout.typeCout.augmentation?'plus.png':'moins.png'}"
                                        width="15" height="15" style="padding: 2px;margin-top: 3px;border: 2px solid black; border-radius: 5px;"/>  
                    </p:commandLink>
                    <h:inputText value="#{managedTypeCout.typeCout.libelle}" style="width: 100%"/>
                    <h:selectOneMenu value="#{managedTypeCout.typeCout.module}" style="width: 100%">
                        <f:selectItems value="#{constantes.COUTS(constantes.MOD_COM)}" var="mol" itemValue="#{mol.value}" itemLabel="#{mol.label}"/>
                    </h:selectOneMenu>
                    <p:commandButton icon="ui-icon-circle-plus" oncomplete="dlgAddTypeCout.hide()" actionListener="#{managedTypeCout.saveNew()}" 
                                     update=":form-couts_vente:select_type_cout_facture_vente"
                                     style="width: 22px; height: 22px;float: right;margin-top: 0px;float: right;background: white!important"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des taxes d'un contenu
        *****************************************************************************
        <-->  
        <h:form id="data_taxes_contenu_facture_vente" prependId="false">
            <p:dialog header="#{lab.LC_PFV_taxe_sur_article} '#{managedFactureVenteV2.contenu.name}'" widgetVar="dlgListTaxesContenu" modal="true" width="50%"  closeOnEscape="true"> 
                <p:dataTable value="#{managedFactureVenteV2.contenu.taxes}" var="tx" rowKey="#{tx.id}">
                    <p:column headerText="#{lab.L_taxe}" >
                        <span>#{tx.taxe.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_taux}" style="text-align: right;width: 15%">
                        <h:outputText value="#{tx.taxe.taux}" converter="DNS"/>
                        %
                    </p:column>
                    <p:column headerText="#{lab.L_montant}" style="text-align: right;width: 35%">
                        <h:outputText value="#{tx.montant}" converter="#{managedFactureVenteV2.converter}"/>
                        Fcfa
                    </p:column>
                </p:dataTable>  
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue d'ajout des commentaires
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_bonus}" widgetVar="dlgAddBonus" modal="true" width="40%"  closeOnEscape="true"> 
                <h:panelGrid id="txt_bonus_contenu_facture_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGrid columns="2" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" style="font-size: 0.8em;width: 100%" rendered="#{managedFactureAchat.bonus.articleBonus.selectArt}">
                            <h:panelGroup>
                                <span style="font-weight: bold;color: #000">#{managedFactureVenteV2.bonus.articleBonus.designation}</span>
                                <span> #{lab.LC_PFV_vendu_a} </span>
                                <h:outputText value="#{managedFactureVenteV2.bonus.articleBonus.puv}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold;color: #000"/>
                                <span>Fcfa  </span>
                            </h:panelGroup>
                            <h:panelGroup style="float: right">
                                <h:outputText value="#{managedFactureVenteV2.bonus.articleBonus.stock}" converter="#{managedFactureVenteV2.converterStock}" style="font-weight: bold;color: #000"/>
                                <h:outputText value=" #{managedFactureVenteV2.bonus.conditionnementBonus.unite.reference}"/>
                                <span> #{lab.LC_PFV_en_stock}</span>
                            </h:panelGroup>
                        </h:panelGrid>
                    </f:facet>
                    <span>#{lab.L_article}</span>
                    <h:panelGroup id="blog_bonus_facture_vente">
                        <h:panelGroup style="float: left">
                            <h:inputText value="#{managedFactureVenteV2.bonus.articleBonus.refArt}" style="color: #{managedFactureVenteV2.bonus.articleBonus.error?'red':''}; width: 120px">
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchArticle(true)}" update="blog_bonus_facture_vente chp_bonus_facture_vente"/>
                            </h:inputText>    
                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="Liste Articles" global="false"
                                             actionListener="#{managedFactureVenteV2.initArticles(true)}" oncomplete="dlgListArticle.show()"/>
                        </h:panelGroup>
                        <div align="center" style="font-size: 0.9em;float: left;margin-top: 10px;margin-left: 5px">#{managedFactureVenteV2.bonus.articleBonus.designation}</div>
                    </h:panelGroup>   
                    <span>#{lab.L_conditionnement}</span>
                    <h:selectOneMenu id="chp_bonus_facture_vente" value="#{managedFactureVenteV2.bonus.conditionnementBonus.id}" title="#{lab.LC_PPV_selectionner_conditionnement}" tabindex="15" style="min-width: 120px">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedFactureVenteV2.bonus.articleBonus.conditionnements}" var="un" itemLabel="#{un.unite.reference}" itemValue="#{un.id}"/>
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseConditionnement(true)}"/>
                    </h:selectOneMenu>     
                    <span>#{lab.L_quantite}</span>
                    <h:inputText value="#{managedFactureVenteV2.bonus.quantiteBonus}" style="text-align: right"/>      
                    <f:facet name="footer">
                        <p:commandButton actionListener="#{managedFactureVenteV2.addBonusContenu()}" style="width: 99%"
                                         oncomplete="dlgAddBonus.hide()" value="#{lab.L_enregistrer}"/>                        
                    </f:facet>              
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_commentaire}" widgetVar="dlgAddCommentaire" modal="true" width="26%"  closeOnEscape="true"> 
                <h:inputTextarea value="#{managedFactureVenteV2.commentaire}" style="width: 99%" rows="5" id="txt_commentaire_contenu_facture_vente"/>
                <p:commandButton actionListener="#{managedFactureVenteV2.addCommentaireContenu()}" style="width: 99%"
                                 oncomplete="dlgAddCommentaire.hide()" value="#{lab.L_enregistrer}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="LC_PCV_numero_serie" widgetVar="dlgAddNumSerie" modal="true" width="26%"  closeOnEscape="true"> 
                <h:inputText value="#{managedFactureVenteV2.numSerie}" style="width: 99%;text-align: center" id="txt_num_serie_contenu_facture_vente"/>
                <p:commandButton actionListener="#{managedFactureVenteV2.addNumSerieContenu()}" style="width: 99%"
                                 oncomplete="dlgAddNumSerie.hide()" value="#{lab.L_enregistrer}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_montant_rabais}" widgetVar="dlgAddRabais" modal="true" width="40%"  closeOnEscape="true"> 
                <h:panelGrid id="txt_rabais_contenu_facture_vente" columns="2" style="width: 100%"
                             styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.LC_PFV_prix_unitaire}"/>
                    <h:outputText value="#{lab.LC_PFV_prix_total}"/>
                    <pe:inputNumber id="txt_rabais_contenu_fv_1" value="#{managedFactureVenteV2.montant_rabais}" style="width: 99%;text-align: right">
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onRabaisBlur(false)}" update="txt_rabais_contenu_fv_2"/>
                    </pe:inputNumber>
                    <pe:inputNumber id="txt_rabais_contenu_fv_2" value="#{managedFactureVenteV2.montant_rabais_total}" style="width: 99%;text-align: right">
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onRabaisBlur(true)}" update="txt_rabais_contenu_fv_1"/>
                    </pe:inputNumber>
                    <f:facet name="footer">
                        <span>#{lab.L_description}</span>
                        <h:inputTextarea value="#{managedFactureVenteV2.commentaire}" style="width: 99%" rows="5"/>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton actionListener="#{managedFactureVenteV2.addRabaisContenu()}" style="width: 99%"
                                 oncomplete="dlgAddRabais.hide()" value="#{lab.L_enregistrer}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_appliquer_remise}" widgetVar="dlgAddRemise" modal="true" width="45%"  closeOnEscape="true"> 
                <h:panelGrid id="txt_remise_contenu_facture_vente" columns="4" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_remise}" />
                    <h:outputText value="#{lab.LC_PFV_taux}" />
                    <h:outputText value="#{lab.LC_PFV_valeur}" />
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.docVente.propagerRemise}" title="#{lab.LC_PFV_propager_remise}"/>
                    <h:selectOneMenu id="value-select_remise_fv" value="#{managedFactureVenteV2.remiseContenu}" style="min-width: 120px" title="#{lab.LC_PFV_selectionner_remise}">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedRemise.remises}" var="rem_" 
                                       itemLabel="#{rem_.refRemise}" itemValue="#{rem_.id}"/>
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseRemiseContenu()}" 
                                update="txt_remise_contenu_facture_vente"/>
                    </h:selectOneMenu>                  
                    <h:inputText id="txt_remise_contenu_fv_2" value="#{managedFactureVenteV2.taux_remise}"  style="width: 100px;text-align: right" 
                                 title="#{lab.LC_PFA_remise_pourcentage}" readonly="true"/>   
                    <h:inputText id="txt_remise_contenu_fv_1" value="#{managedFactureVenteV2.montant_remise}" style="text-align: right"
                                 title="#{lab.LC_PFA_remise_valeur}" readonly="true"/>  
                    <p:commandButton icon="ui-icon-circle-check" value="Appliquer" actionListener="#{managedFactureVenteV2.addRemiseContenu()}" oncomplete="dlgAddRemise.hide()"
                                     style="float: right;margin-top: 0px;float: right;background: white!important"/>                 
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des commerciaux
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_liste_commerciaux}" widgetVar="dlgListCommerciaux" modal="true" width="70%" minHeight="300"
                      closeOnEscape="true" dynamic="true"> 
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText value="#{managedCommerciaux.numSearch}" style="float: left">
                        <p:ajax event="keyup" listener="#{managedCommerciaux.addParamCode()}" update="data_commerciaux_facture_vente"/>
                    </h:inputText>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedCommerciaux.loadAllCommerciaux(false, false)}" global="false" update="data_commerciaux_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedCommerciaux.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedCommerciaux.paginator.currentPage}/#{managedCommerciaux.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedCommerciaux.loadAllCommerciaux(true, false)}" global="false" update="data_commerciaux_facture_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedCommerciaux.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedCommerciaux.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCommerciaux.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedCommerciaux.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_commerciaux_facture_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable id="data_commerciaux_facture_vente" value="#{managedCommerciaux.commerciaux}" var="icomm" rowKey="#{icomm.id}"
                             selectionMode="single" rowIndexVar="line_art" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewCommercial}" oncomplete="dlgListCommerciaux.hide()"/>
                    <p:column headerText="N°" width="20">
                        <span>#{line_art+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" width="50">
                        <h:outputText value="#{icomm.codeRef}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_nom_prenom}" width="100">
                        <h:outputText value="#{icomm.nom_prenom}"/>
                    </p:column>                                                        
                    <p:column headerText="#{lab.L_agence}" style="text-align: center" width="75">
                        <h:outputText value="#{icomm.agence.designation}"/>
                    </p:column>                            
                    <p:column width="20" headerText="#{lab.L_actif}" style="text-align: center">
                        <h:graphicImage library="img" name="#{(icomm.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_listes_articles}" widgetVar="dlgListArticle" modal="true" width="70%" height="450" closeOnEscape="true"> 
                <p:watermark for="txt_search_article_fv" value="Reference article..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_article_fv" value="#{managedStockArticle.article.article.refArt}">
                        <p:ajax event="valueChange" listener="#{managedStockArticle.searchArticleActifByPoint(false)}" update="data_articles_facture_vente"/>
                    </h:inputText> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedStockArticle.loadActifArticleByPoint(false, false)}" update="data_articles_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedStockArticle.pv.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedStockArticle.pv.currentPage}/#{managedStockArticle.pv.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedStockArticle.loadActifArticleByPoint(true, false)}" update="data_articles_facture_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedStockArticle.pv.disNext}"/>
                        <p:selectOneMenu value="#{managedStockArticle.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedStockArticle._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedStockArticle.paginations}"/>
                            <p:ajax event="valueChange" update="data_articles_facture_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable id="data_articles_facture_vente" value="#{managedStockArticle.articles}" var="art" rowKey="#{art.id}"
                             selectionMode="single" rowIndexVar="line_art" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewArticle}" oncomplete="dlgListArticle.hide()"
                            update=":main_facture_vente:form_contenu_facture_vente"/>
                    <p:column headerText="N°" width="20">
                        <span title="#{art.designation}">#{line_art+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" width="80">
                        <span title="#{art.designation}">#{art.refArt}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}" width="150">
                        <span title="#{art.designation}">#{art.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" width="80">
                        <span title="#{art.designation}">#{art.categorie}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_prix_a}" width="50" style="text-align: right">
                        <h:outputText value="#{art.pua}" title="#{art.designation}" converter="#{managedFactureVenteV2.converter}" />
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_prix_v}" width="50" style="text-align: right">
                        <h:outputText value="#{art.puv}" title="#{art.designation}" converter="#{managedFactureVenteV2.converter}" />
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PCV_listes_articles}" widgetVar="dlgListConditionnement" modal="true" width="70%" height="450" closeOnEscape="true"> 
                <p:dataTable id="data_conditionnements_facture_vente" value="#{managedStockArticle.conditionnements}" var="art" rowIndexVar="artLine"
                             rowKey="#{art.id}" selectionMode="single">
                    <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewConditionnement}" oncomplete="dlgListConditionnement.hide()"
                            update=":main_facture_vente:form_contenu_facture_vente"/>
                    <p:column headerText="N°" width="20" style="text-align: center">
                        #{artLine+1}
                    </p:column>                                                        
                    <p:column headerText="#{lab.L_reference}" width="100">
                        <span style="font-weight: bold">#{art.article.refArt}</span>
                    </p:column>
                    <p:column  headerText="#{lab.L_designation}" width="150"> 
                        #{art.article.designation}
                    </p:column>
                    <p:column headerText="#{lab.L_unite}" width="100">
                        #{art.unite.libelle}                                
                        <span style="font-weight: bold">[#{art.unite.reference}]</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" width="100" style="text-align: center">
                        #{art.article.categorie}
                    </p:column>
                    <p:column  headerText="#{lab.LC_PCV_prix_v}" width="80"  style="text-align: right">                                                            
                        <h:outputText value="#{art.prix}"  converter="DN" />                                                            
                    </p:column>
                    <p:column  headerText="#{lab.LC_PCV_prix_a}" width="80"  style="text-align: right">                                                            
                        <h:outputText value="#{art.prixAchat}"  converter="DN" />                                                            
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de la commande liée a la facture
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="data_contenus_bcv_fv">
            <p:dialog widgetVar="dlgContenuBCVFV" width="80%"  closeOnEscape="true"> 
                <f:facet name="header">
                    <span>#{lab.LC_PFV_commande_numero} </span>           
                    <p:commandLink style="color:white" value="#{managedFactureVenteV2.selectDoc.documentLie.numDoc}" actionListener="#{managedFactureVenteV2.onSelectDistantObject(managedFactureVenteV2.selectDoc.documentLie)}"/>
                    <p:spacer width="5" height="5" styleClass="#{managedFactureVenteV2.selectDoc.documentLie.statutLivre}" title="Statut : #{managedFactureVenteV2.giveNameStatut(managedFactureVenteV2.selectDoc.documentLie.statutLivre)}"
                              style="border: 2px solid white; border-radius: 5px;padding: 3px;margin-top: 2px;margin-left: 10px;float: right;cursor: pointer"/>
                </f:facet>
                <p:dataTable value="#{managedFactureVenteV2.selectDoc.documentLie.contenus}" var="y" rowKey="#{y.id}" rowIndexVar="yIdx">
                    <p:column headerText="N°" style="width: 5%;color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <span title="#{lab.LC_PRA_numero_serie}: #{y.numSerie}">#{yIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRA_ref}. " style="width: 12%;color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <span title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}">#{y.article.refArt}</span>
                        <h:graphicImage library="img" name="comment.png" width="15" height="15" rendered="#{y.onComment}" style="float: right" title="#{lab.LC_PRA_commenté}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_article}" style="color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <span title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}">#{y.article.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_qte}" style="width: 8%;text-align: center;color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <h:outputText value="#{y.quantite}" converter="#{managedFactureVenteV2.converterStock}" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_prix}" style="width: 10%;text-align: right;color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <h:outputText value="#{(y.prix-y.rabais)}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_rem}" style="width: 10%;text-align: right;color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <h:outputText value="#{y.remise}" converter="DNS" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_taxe}" style="width: 10%;text-align: right;color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <h:outputText value="#{y.taxe}" converter="DNS" title="#{lab.LC_PRA_numero_serie}: #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_total}" style="width: 12%;text-align: right;color: #{y.etat()=='R'?'orange':(y.etat()=='P'?'red':'')};font-style: #{y.etat()!='E'?'italic':''}">
                        <h:outputText value="#{y.prixTotal}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des entetes de vente
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_plus_option}" width="40%"  closeOnEscape="true" widgetVar="dlgPlusOption" resizable="false"> 
                <h:panelGrid id="blog_entete_facture_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_agence}" />
                    <h:selectOneMenu value="#{managedFactureVenteV2.agence_}" id="_select_agence2" style="width: 100%">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedFactureVenteV2.agences_}" var="ag"
                                       itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2._chooseAgence()}" 
                                update="blog_entete_facture_vente :form-data_facture:data_facture_vente"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.L_point_vente}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.point_}" style="width: 100%">
                        <f:selectItem itemLabel="--#{lab.LDB_PPC_precedent}--" itemValue="-1"/>
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedPointVente.pointsvente}" var="_po" 
                                       itemLabel="#{_po.libelle}" itemValue="#{_po.id}" />  
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItem itemLabel="--#{lab.LDB_PPC_suivant}--" itemValue="-2"/>  
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2._choosePoint()}"
                                update=":form-data_facture:data_facture_vente @this"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PFV_vendeur}"/>                    
                    <h:inputText value="#{managedFactureVenteV2.codeVendeur_}" style="min-width: 120px">
                        <p:ajax event="valueChange"  listener="#{managedFactureVenteV2._searchVendeur()}" 
                                update=":form-data_facture:data_facture_vente @this"/>
                    </h:inputText>                      
                    <h:outputText value="#{lab.L_type}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.typeSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{constantes.TYPE_FV_NAME}" itemValue="#{constantes.TYPE_FV}"/>
                        <f:selectItem itemLabel="#{constantes.TYPE_BCV_NAME}" itemValue="#{constantes.TYPE_BCV}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamType()}" update=":form-data_facture:data_facture_vente"/>
                    </h:selectOneMenu> 
                    <h:outputText value="#{lab.LC_PCV_statut_liv}"/>
                    <h:panelGroup> 
                        <h:selectOneMenu value="#{managedFactureVenteV2.egaliteStatutL}">
                            <f:selectItem itemLabel="#{lab.LC_PBRA_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.LC_PBRA_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":form-data_facture:data_facture_vente" listener="#{managedFactureVenteV2.addParamStatutLivre()}"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVenteV2.statutLivre_}" valueChangeListener="#{managedFactureVenteV2.chooseStatutLivre}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_livrer}" itemValue="#{constantes.STATUT_DOC_LIVRER}"/>
                            <p:ajax event="valueChange" update=":form-data_facture:data_facture_vente"/>
                        </h:selectOneMenu>
                        <h:panelGroup style="float: right">
                            <h:outputText value="#{lab.LC_PFV_automatique} "/>
                            <h:selectOneMenu value="#{managedFactureVenteV2.autoLivreSearch}">
                                <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                                <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                                <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                                <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamAutoLivre()}" update=":form-data_facture:data_facture_vente"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:outputText value="#{lab.LC_PFV_statut_reg}"/>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{managedFactureVenteV2.egaliteStatutR}">
                            <f:selectItem itemLabel="#{lab.LC_PBRA_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.LC_PBRA_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":form-data_facture:data_facture_vente" listener="#{managedFactureVenteV2.addParamStatutRegle()}"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVenteV2.statutRegle_}" valueChangeListener="#{managedFactureVenteV2.chooseStatutRegle}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.STATUT_DOC_PAYER}"/>
                            <p:ajax event="valueChange" update=":form-data_facture:data_facture_vente"/>
                        </h:selectOneMenu> 
                    </h:panelGroup>                   
                    <h:outputText value="#{lab.LC_PCV_verrouille}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.cloturer_}" valueChangeListener="#{managedFactureVenteV2.chooseCloturer}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" update=":form-data_facture:data_facture_vente"/>
                    </h:selectOneMenu>                    
                    <h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_heures}"/>
                        <h:selectBooleanCheckbox value="#{managedFactureVenteV2.date_}" style="margin-top: 2px;float: right">
                            <p:ajax event="valueChange" listener="#{managedFactureVenteV2.chooseDateSearch()}"
                                    update="blog_date_search_facture_vente :form-data_facture:data_facture_vente"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_search_facture_vente">
                        <pe:timePicker value="#{managedFactureVenteV2.dateDebut_}" disabled="#{!managedFactureVenteV2.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedFactureVenteV2.chooseDateSearch()}" update=":form-data_facture:data_facture_vente"/>
                        </pe:timePicker>
                        <p:spacer width="5px" style="background: black"/>
                        <pe:timePicker value="#{managedFactureVenteV2.dateFin_}" disabled="#{!managedFactureVenteV2.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedFactureVenteV2.chooseDateSearch()}" update=":form-data_facture:data_facture_vente"/>
                        </pe:timePicker>
                    </h:panelGroup>                  
                    <h:outputText value="#{lab.LC_PFV_representant}" />
                    <h:inputText value="#{managedFactureVenteV2.otherSearch_}" style="width: 100%">
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.searchByRepr()}" update=":form-data_facture:data_facture_vente"/>
                    </h:inputText>  
                    <h:outputText value="#{lab.LC_PFV_commande}"/>
                    <h:inputText value="#{managedFactureVenteV2.numBon}" style="width: 100%" title="#{lab.LC_PFV_text16}">
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.chooseCommande()}" update=":form-data_facture:data_facture_vente"/>
                    </h:inputText>                   
                    <h:outputText value="#{lab.LC_PFV_associer_tiers}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.withTiersSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamWithTiers()}" update=":form-data_facture:data_facture_vente"/>
                    </h:selectOneMenu> 
                    <h:outputText value="#{lab.LC_PFV_comptabiliser}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.comptaSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamComptabilised()}" update=":form-data_facture:data_facture_vente"/>
                    </h:selectOneMenu>

                    <h:panelGroup>
                        <h:outputText value="#{lab.LDB_PC_dates}"  />
                        <h:selectBooleanCheckbox value="#{managedFactureVenteV2.date_up}" title="#{lab.LDB_PC_dates_last_modif}" style="float: right">
                            <p:ajax event="valueChange" global="false" update="blog_date_search_client" listener="#{managedFactureVenteV2.addParamDates()}"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_search_client">
                        <p:calendar value="#{managedFactureVenteV2.dateDebut_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedFactureVenteV2.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedFactureVenteV2.addParamDates}"   />
                        </p:calendar>
                        <p:spacer style="width: 5px;background: black"/>
                        <p:calendar value="#{managedFactureVenteV2.dateFin_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedFactureVenteV2.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedFactureVenteV2.addParamDates}"  />
                        </p:calendar>
                    </h:panelGroup>

                </h:panelGrid>                
                <f:facet name="footer">            
                    <h:panelGroup>
                        <h:panelGroup style="float:left">
                            <p:contextMenu for="btn_option_more_facture_vente" event="left click" style="font-size: 0.8em;width: 230px">
                                <p:menuitem value="#{lab.LC_PFV_listing_factures}" icon="ui-icon-print" title="#{lab.LC_PFV_telecharger_listing_factures_vente}"
                                            actionListener="#{managedFactureVenteV2.printListing()}" ajax="false"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_more_facture_vente" type="button"/>
                        </h:panelGroup>
                        <p:commandLink actionListener="#{managedFactureVenteV2.maintenanceComptable()}" style="border: 2px solid black; border-radius: 5px;padding: 2px;float: right">
                            <span>#{lab.LC_PFV_maintenance_comptable}</span>
                        </p:commandLink> 
                        <p:commandLink onclick="dlgCleanEntete.show()" global="false" style="border: 2px solid black; border-radius: 5px;padding: 2px;float: right" 
                                       title="#{lab.LC_PFV_nettoyage_entete_journal_vente}" rendered="#{accesRessource.fv_clean_header}">
                            <h:graphicImage library="img" name="clean.png" width="15" height="15"/>  
                        </p:commandLink>
                    </h:panelGroup>
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de bon de commande
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PBRA_liste_facture}" widgetVar="dlgListBonCommande" closeOnEscape="true" width="80%" height="450" modal="true">  
                <p:watermark for="txt_search_blc_fv" value="#{lab.LC_PFV_numero_commande}" />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_blc_fv" value="#{managedBonVente.numSearch_}">
                        <p:ajax event="valueChange" listener="#{managedBonVente.searchByNum()}" update="data_bon_commande_fv"/>
                    </h:inputText>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedBonVente.init(false)}" global="false" update="data_bon_commande_fv" icon="ui-icon-circle-triangle-w" disabled="#{managedBonVente.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedBonVente.paginator.currentPage}/#{managedBonVente.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedBonVente.init(true)}" global="false" update="data_bon_commande_fv" icon="ui-icon-circle-triangle-e" disabled="#{managedBonVente.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedBonVente.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedBonVente.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedBonVente.paginations}"/>
                            <p:ajax event="valueChange"  update="data_bon_commande_fv"/>
                        </p:selectOneMenu>
                    </p:outputPanel>  
                </h:panelGrid>                                
                <p:dataTable id="data_bon_commande_fv" value="#{managedBonVente.documents}" var="bon" rowKey="#{bon.id}"
                             selectionMode="single" rowIndexVar="bonIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewBon}" oncomplete="dlgListBonCommande.hide()"/>
                    <p:column headerText="N°" style="width: 5%" styleClass="statut_#{bon.statut}">
                        <span>#{bonIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}">
                        <span>#{bon.numDoc}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_date} " style="text-align: center" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.enteteDoc.dateEntete}" converter="DATE"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_client}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.client.tiers.nom_prenom}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_vendeur}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.enteteDoc.creneau.users.nomUsers}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_point}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.enteteDoc.creneau.creneauPoint.point.libelle}"/>
                    </p:column>
                </p:dataTable> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des articles du bon de commande
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_contenu_bon_commande}" widgetVar="dlgListContenuBon" modal="true" width="60%"  closeOnEscape="true" footer="#{lab.L_copy}"> 
                <p:dataTable id="data_contenu_bcv_fv" value="#{managedFactureVenteV2.contenus_bcv}" var="artb" rowKey="#{artb.id}" 
                             rowIndexVar="artb_" selectionMode="single">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewArticleBon}" oncomplete="dlgListContenuBon.hide()"/>
                    <p:column headerText="N°" width="30">
                        <span>#{artb_+1}</span>
                    </p:column>
                    <p:column style="width: 15%">
                        <span>#{artb.article.refArt}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_article}">
                        <span>#{artb.article.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_qte}" style="text-align: center;width: 10%">
                        <h:outputText value="#{artb.quantite}" converter="#{managedFactureVenteV2.converterStock}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_prix}" style="text-align: right;width: 12%">
                        <h:outputText value="#{artb.prix}" converter="#{managedFactureVenteV2.converter}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_rem}" style="text-align: right;width: 12%">
                        <h:outputText value="#{artb.remise}" converter="DNS"/>
                    </p:column>
                    <p:column headerText="#{lab.L_total}" style="text-align: right;width: 15%">
                        <h:outputText value="#{artb.prixTotal}" converter="#{managedFactureVenteV2.converter}"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des remises
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_creation_remise}" widgetVar="dlgAddPlanRemise"  modal="true" width="55%"  closeOnEscape="true"> 
                <h:panelGrid id="form_remise_fv" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGroup style="float: left;margin-left: 10px">
                            <span>#{lab.L_reference} : </span>
                            <p:autoComplete value="#{managedRemise.remise.reference}" completeMethod="#{managedRemise.completeRemise}"
                                            var="theme" itemLabel="#{theme}" itemValue="#{theme}" style="width: 80%">
                                <p:ajax event="itemSelect" listener="#{managedRemise.onReferenceRemiseSelect}" global="false" update="form_remise_fv data_grille_remise_fv"/>
                                <p:ajax event="valueChange" listener="#{managedRemise.onReferenceRemiseBlur()}" global="false" update="form_remise_fv data_grille_remise_fv"/>
                            </p:autoComplete>
                        </h:panelGroup>
                    </f:facet>
                    <h:panelGroup>
                        <span>#{lab.L_dates} </span>
                        <h:selectBooleanCheckbox value="#{managedRemise.remise.permanent}" title="Permanent" disabled="#{managedRemise.remise.update}" style="float: right">
                            <p:ajax event="valueChange" global="false" update="blog_date_remise_fv"/>
                        </h:selectBooleanCheckbox>  
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_remise_fv">
                        <span> #{lab.L_du} </span>
                        <p:calendar value="#{managedRemise.remise.dateDebut}" navigator="true" pattern="dd-MM-yyyy" size="10" disabled="#{managedRemise.remise.update or managedRemise.remise.permanent}"/>
                        <span> #{lab.L_au} </span>
                        <p:calendar value="#{managedRemise.remise.dateFin}" navigator="true" pattern="dd-MM-yyyy" size="10" disabled="#{managedRemise.remise.update or managedRemise.remise.permanent}"/>
                    </h:panelGroup>
                    <p:outputLabel for="base_com_fv" value="#{lab.LC_PFV_base} " />
                    <h:selectOneRadio id="base_com_fv" value="#{managedRemise.rabais.base}" layout="grid" styleClass="yvs_nostyle">
                        <f:selectItem itemLabel="#{constantes.BASE_CA}" itemValue="#{constantes.BASE_CA}" />
                        <f:selectItem itemLabel="#{constantes.BASE_QTE} " itemValue="#{constantes.BASE_QTE}" />
                    </h:selectOneRadio>
                    <h:panelGroup>
                        <span>#{lab.LDB_PA_interval} </span>
                        <h:selectBooleanCheckbox value="#{managedRemise.rabais.unique}" style="float: right">
                            <p:ajax event="valueChange" global="false" listener="#{managedRemise.activeUnique()}"
                                    update="txt_intervale_montant_plan_remise_fv"/>
                        </h:selectBooleanCheckbox>  
                    </h:panelGroup>
                    <h:panelGroup id="txt_intervale_montant_plan_remise_fv">
                        <span> #{lab.L_de} </span>
                        <pe:inputNumber value="#{managedRemise.rabais.montantMinimal}" disabled="#{managedRemise.rabais.unique}" style="width: 30%;text-align: right"/>
                        <span> #{lab.L_a} </span>
                        <pe:inputNumber value="#{managedRemise.rabais.montantMaximal}" disabled="#{managedRemise.rabais.unique}" style="width: 30%;text-align: right"/>                                                            
                    </h:panelGroup>
                    <p:outputLabel for="nature_com_fv" value="#{lab.LC_PFV_nature} " title="#{lab.LC_PFV_nature_montant}"/>
                    <h:selectOneRadio id="nature_com_fv" value="#{managedRemise.rabais.natureMontant}" layout="grid" styleClass="yvs_nostyle">
                        <f:selectItem itemLabel="#{constantes.NATURE_MTANT} " itemValue="#{constantes.NATURE_MTANT}" />
                        <f:selectItem itemLabel="#{constantes.NATURE_TAUX} " itemValue="#{constantes.NATURE_TAUX}" />
                    </h:selectOneRadio>
                    <span>#{lab.L_montant} </span>
                    <pe:inputNumber value="#{managedRemise.rabais.montantRabais}" id="txt_montant_plan_remise_fv" style="width: 30%;text-align: right"/>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedRemise.saveNewAll()}" oncomplete="dlgAddPlanRemise.hide()"
                                 update=":main_facture_vente_:txt_montant_remise :main_facture_vente_:select_remise_vente" style="width: 100%"/>
                <p:dataTable id="data_grille_remise_fv" value="#{managedRemise.grilles}" var="gRem" rowKey="#{gRem.id}" style="margin-top: 10px">
                    <p:column headerText="Nature">
                        <h:outputText value="#{gRem.natureMontant}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_Mtant_min}" style="text-align: right">
                        <h:outputText value="#{gRem.montantMinimal}" converter="#{managedFactureVenteV2.converter}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_Mtant_max}" style="text-align: right">
                        <h:outputText value="#{gRem.montantMaximal}" converter="#{managedFactureVenteV2.converter}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_valeur}" style="text-align: right">
                        <h:outputText value="#{gRem.montantRemise}" converter="#{managedFactureVenteV2.converter}"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des reglements
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_reglement}" widgetVar="dlgAddRegelement" modal="true" width="25%"  closeOnEscape="true"> 
                <p:panelGrid id="form_reglement_vente" columns="1" style="width: 98%;margin: auto">
                    <span>#{lab.L_montant} </span>
                    <pe:inputNumber value="#{managedFactureVenteV2.reglement.montant}" style="width: 98%"
                                    symbol=" Fcfa" symbolPosition="suffixe"/>                                             
                </p:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddRegelement.hide()"
                                 actionListener="#{managedFactureVenteV2.saveNewReglement_()}" update="form_reglement_vente"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue details taxes
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_details_taxes}" widgetVar="dlgDetailTaxe"  modal="true" width="50%"  closeOnEscape="true"> 
                <p:dataTable id="data_taxe_facture_vente0" value="#{managedFactureVenteV2.docVente.taxes}" var="tax" rowKey="#{tax.id}">
                    <p:column headerText="Taxe">
                        <span>#{tax.codeTaxe}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_base}" style="text-align:  right">
                        <h:outputText value="#{tax.totalMontant}" converter="#{managedFactureVenteV2.converter}"/>
                        <span> Fcfa</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_taux}" style="text-align:  right">
                        <h:outputText value="#{tax.taux}" converter="DNS"/>
                        <span> %</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_value}" style="text-align:  right">
                        <h:outputText value="#{tax.totalTaux}" converter="DNS"/>
                        <span> Fcfa</span>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue du contenu
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgInfosContenu_">
            <p:dialog id="dlgInfosContenu_" header="#{lab.LC_PCV_infos_contenu}" widgetVar="dlgInfosContenu"  modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGrid columns="2" id="blog_form_infos_contenu" style="width: 100%; font-size: 0.8em" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:panelGroup>
                        <span>#{lab.L_article}</span>
                        <div style="float:right">[<span style="font-weight: bold">#{managedFactureVenteV2.selectContenu.article.refArt}</span>]</div>
                    </h:panelGroup>
                    <h:inputText value="#{managedFactureVenteV2.selectContenu.article.designation}" readonly="true" style="width:100%"/>
                    <span>#{lab.L_prix}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.prix}" symbol=" Fcfa" symbolPosition="suffix" style="width:100%;text-align: right"/>
                    <span>#{lab.L_quantite}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.quantite}" symbol=" #{managedFactureVenteV2.selectContenu.conditionnement.unite.libelle}"
                                    symbolPosition="suffix" style="width:100%;text-align: right"/>
                    <span>#{lab.LC_PFV_rabais}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.rabais}" symbol=" Fcfa" symbolPosition="suffix" style="width:100%;text-align: right"/>
                    <span>#{lab.L_remise}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.remise}" symbol=" Fcfa" symbolPosition="suffix" style="width:100%;text-align: right"/>
                    <span>#{lab.LC_PFV_ristourne}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.ristourne}" symbol=" Fcfa" symbolPosition="suffix" style="width:100%;text-align: right"/>
                    <span>#{lab.LC_PCV_commission}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.comission}" symbol=" Fcfa" symbolPosition="suffix" style="width:100%;text-align: right"/>
                    <span>#{lab.L_taxe}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.taxe}" symbol=" Fcfa" symbolPosition="suffix" style="width:100%;text-align: right"/>
                    <h:outputText value="#{lab.L_bonus}" rendered="#{managedFactureVenteV2.selectContenu.quantiteBonus gt 0}"/>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.quantiteBonus}" symbol=" #{managedFactureVenteV2.selectContenu.conditionnementBonus.unite.libelle}"
                                    symbolPosition="suffix" style="width:100%;text-align: right" rendered="#{managedFactureVenteV2.selectContenu.quantiteBonus gt 0}"/>
                    <span>#{lab.LC_PCV_total_contenu}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.prixTotal}" symbol=" Fcfa" symbolPosition="suffix" style="width:100%;text-align: right;font-weight: bold"/>
                    <span>#{lab.LC_PFV_quantite_livrer}</span>
                    <pe:inputNumber value="#{managedFactureVenteV2.selectContenu.qteLivree}" symbol=" #{managedFactureVenteV2.selectContenu.conditionnement.unite.libelle}"
                                    symbolPosition="suffix" style="width:100%;text-align: right"/>
                </h:panelGrid> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de montant versé
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgAddVerse_">
            <p:dialog id="dlgAddVerse_" header="#{lab.LC_PFV_montant_verser}" widgetVar="dlgAddVerse" 
                      modal="true" width="20%"  closeOnEscape="true"> 
                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%">
                    <pe:inputNumber value="#{managedFactureVenteV2.reglement.montant}" symbol=" Fcfa" symbolPosition="suffixe"/>
                    <p:commandLink title="#{lab.L_enregistrer}" actionListener="#{managedFactureVenteV2.regleFacture()}" oncomplete="dlgAddVerse.hide()" global="false">
                        <p:graphicImage library="icones" name="ok.png" width="50" height="30"/>
                    </p:commandLink>   
                </h:panelGrid>
            </p:dialog>
        </h:form>

        <h:form prependId="false" id="main_update_header">
            <p:dialog header="#{lab.LC_PFV_date_entete}" widgetVar="dlgUpdateHeader" modal="true" width="20%"  closeOnEscape="true"> 
                <h:panelGrid id="date_update_header" columns="1" style="width: 100%" styleClass="yvs_nostyle"> 
                    <p:selectBooleanCheckbox itemLabel="#{lab.LC_PFV_actualiser_reference}" value="#{managedFactureVenteV2.changeNumeroWhenChangeDate}"/>
                    <h:panelGroup>
                        <p:calendar value="#{managedFactureVenteV2.dateEntete}" pattern="dd-MM-yyyy" size="8" navigator="true"/>
                        <p:commandButton value="#{lab.L_modifier}" actionListener="#{managedFactureVenteV2.updateEntete()}" icon="ui-icon-disk" 
                                         oncomplete="dlgUpdateHeader.hide()" style="float: right;margin-top: -5px"/> 
                    </h:panelGroup>
                </h:panelGrid>  
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de client
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_client_fv">
            <p:dialog header="#{lab.LC_PCV_liste_template}" widgetVar="dlgListTemplate" modal="true" width="85%" height="450" closeOnEscape="true">
                <p:watermark for="txt_search_template_tiers_client_fv" value="#{lab.LC_PFV_libelle_template}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_template_tiers_client_fv" value="#{managedTiersTemplate.nameSearch}">
                        <p:ajax event="valueChange" listener="#{managedTiersTemplate.addParamName()}" update="data_template_tiers_client_fv"/>
                    </h:inputText>   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedTiersTemplate.init(false)}" global="false" update="data_template_tiers_client_fv" icon="ui-icon-circle-triangle-w" disabled="#{managedTiersTemplate.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedTiersTemplate.paginator.currentPage}/#{managedTiersTemplate.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedTiersTemplate.init(true)}" global="false" update="data_template_tiers_client_fv" icon="ui-icon-circle-triangle-e" disabled="#{managedTiersTemplate.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedTiersTemplate.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedTiersTemplate.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedTiersTemplate.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_template_tiers_client_fv"/>
                        </p:selectOneMenu>
                    </p:outputPanel>  
                </h:panelGrid>
                <p:dataTable value="#{managedTiersTemplate.templates}" var="clt" rowKey="#{clt.id}" id="data_template_tiers_client_fv" scrollable="true"
                             rowIndexVar="cltIdx" selectionMode="single" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedClient.loadOnViewTemplate}"  oncomplete="dlgListTemplate.hide()" update=":main_client_fv:infos_tiers_facture_vente"/>
                    <p:column style="width: 0.25%">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_libelle}" style="width: 1%">
                        <span>#{clt.libelle}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_compte}" style="width: 1%;text-align: center">
                        <span>#{clt.compteCollectif.numCompte}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_pays}" style="width: 1.5%">
                        <span>#{clt.pays.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_ville}" style="width: 1.75%">
                        <span>#{clt.ville.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_secteur}" style="width: 2%">
                        <span>#{clt.secteur.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_apercu}" style="width: 1.75%">
                        <span>#{clt.apercu}</span>
                    </p:column>
                </p:dataTable> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PCV_creation_client}" widgetVar="dlgAddClient" modal="true" width="40%" closeOnEscape="true"> 
                <h:panelGrid id="infos_tiers_facture_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%" cellpadding="0" cellspacing="0">
                            <h:panelGrid columns="2" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                <span>Societe </span>  
                                <h:selectBooleanCheckbox value="#{client.tiers.societe}" tabindex="1">
                                    <p:ajax event="valueChange" global="false" update="infos_tiers_facture_vente"/>
                                </h:selectBooleanCheckbox>                                                    
                            </h:panelGrid> 
                            <h:panelGroup id="txt_code_client_facture_vente" style="float: right">
                                <h:inputText  value="#{client.codeClient}" tabindex="3" style="background: #009999;font-weight: bold" title="#{lab.LC_PCV_code_client}">
                                    <p:ajax event="valueChange" global="false"/>
                                </h:inputText>
                                <p:commandLink title="#{lab.LC_PCV_template}" actionListener="#{managedTiersTemplate.loadTemplate(true, true)}" oncomplete="dlgListTemplate.show()" global="false" style="float: right"
                                               update=":main_client_fv:data_template_tiers_client_fv">
                                    <p:graphicImage library="icones" name="ico_facture2.png" width="20" height="22" style="border: 2px solid #666; border-radius: 5px;"/>
                                </p:commandLink>  
                            </h:panelGroup>                            
                        </h:panelGrid>
                    </f:facet>
                    <h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_nom}" rendered="#{!client.tiers.societe}"/>
                        <h:outputText value="#{lab.L_designation}" rendered="#{client.tiers.societe}"/>    
                        <p:commandLink title="#{managedClient.generation?'Déactiver':'Activer'} #{lab.LC_PCV_generation_code_tiers}" actionListener="#{managedClient.activeGenerationCode()}" 
                                       global="false" style="float: right;margin-top: 4px" update="@this">
                            <p:graphicImage library="img" name="#{managedClient.generation?'connecte.png':'deconnecte.png'}" width="12" height="12"/>
                        </p:commandLink>                                                     
                    </h:panelGroup>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{client.tiers.civilite}" rendered="#{!client.tiers.societe}" tabindex="5">
                            <f:selectItem itemLabel="Mme" itemValue="Mme"/>
                            <f:selectItem itemLabel="M." itemValue="M."/>
                        </h:selectOneMenu>
                        <p:spacer width="2"/>
                        <h:inputText value="#{client.nom}" tabindex="7" style="width: 75%">
                            <p:ajax event="valueChange" global="false" listener="#{managedClient.changeName()}" update="txt_code_client_facture_vente"/>
                        </h:inputText>
                    </h:panelGroup>
                    <h:outputText value="#{lab.LC_PCV_prenom}" rendered="#{!client.tiers.societe}"/>  
                    <h:inputText value="#{client.prenom}" rendered="#{!client.tiers.societe}" tabindex="9" style="width: 90%">
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.changeName()}" update="txt_code_client_facture_vente"/>
                    </h:inputText>
                    <span>#{lab.LC_PBRA_categorie_comptable}</span>
                    <h:selectOneMenu value="#{client.categorieComptable.id}" tabindex="11" style="width: 90%">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{managedCatCompt.categoriesVente}" var="catC" itemLabel="#{catC.designation}" itemValue="#{catC.id}" />                                
                    </h:selectOneMenu> 
                    <span>#{lab.LC_PFV_adresse} </span>
                    <h:inputText value="#{client.tiers.adresse}" tabindex="13" style="width: 90%"/>
                    <span>#{lab.LC_PCV_email} </span>
                    <h:inputText value="#{client.tiers.email}" converter="EMAIL" tabindex="15" style="width: 90%"/>
                    <span>#{lab.LC_PCV_code_postal} </span>
                    <h:inputText value="#{client.tiers.codePostal}" tabindex="17" style="width: 90%"/>
                    <span>#{lab.LC_PCV_telephones} </span>
                    <h:inputText value="#{client.tiers.telephone}"  style="width: 90%" tabindex="19" title="#{lab.LC_PCV_separer_numeros} (/)"/>
                    <span>#{lab.L_pays} </span>
                    <h:selectOneMenu value="#{client.tiers.pays.id}" id="pays_client_facture_vente"  style="width: 90%" tabindex="21">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{Mdico.pays}" var="pys" itemLabel="#{pys.libele}" itemValue="#{pys.id}" />                                
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.choosePays()}" update="ville_client_facture_vente secteur_client_facture_vente"/>
                    </h:selectOneMenu>
                    <span>#{lab.L_ville} </span>
                    <h:selectOneMenu value="#{client.tiers.ville.id}" id="ville_client_facture_vente"  style="width: 90%" tabindex="23">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{Mdico.villes}" var="dic" itemLabel="#{dic.libele}" itemValue="#{dic.id}" />                          
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.chooseVille()}" update="secteur_client_facture_vente"/>
                    </h:selectOneMenu> 
                    <span>#{lab.L_secteur} </span>
                    <h:selectOneMenu value="#{client.tiers.secteur.id}" id="secteur_client_facture_vente"  style="width: 90%" tabindex="25">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{Mdico.secteurs}" var="sec"  itemLabel="#{sec.libele}" itemValue="#{sec.id}" />                                  
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.chooseSecteur()}"/>
                    </h:selectOneMenu> 
                    <f:facet name="footer">
                        <span>#{lab.LDB_PC_representant} : </span>
                        <h:outputText style="font-weight: bold" value="#{client.representant.nomUsers}"/>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddClient.hide()"
                                 actionListener="#{managedClient.saveNewAll()}"  tabindex="27"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy;
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des clients
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PCV_liste_clients}" widgetVar="dlgListClients" closeOnEscape="true" width="60%" height="550"
                      modal="true" dynamic="true">   
                <p:watermark for="txt_search_client_facture_vente" value="#{lab.LC_PCV_code_client}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_client_facture_vente" value="#{managedClient.numSearch_}" style="float: left;text-align: center;margin-left: -10px">
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.searchByNum()}" update="data_client_facture_vente"/>
                    </h:inputText>   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedClient.init(false)}" global="false" update="data_client_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedClient.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedClient.paginator.currentPage}/#{managedClient.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedClient.init(true)}" global="false" update="data_client_facture_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedClient.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedClient.max}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedClient.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedClient.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_client_facture_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>                               
                <p:dataTable id="data_client_facture_vente"  value="#{managedClient.clients}" var="clt_" rowKey="#{clt_.id}"
                             selectionMode="single" rowIndexVar="cltIdx" style="max-height: 500px; overflow-y: auto">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewClient}" oncomplete="dlgListClients.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{clt_.codeClient}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_nom}">
                        <span>#{clt_.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PTBC_zone}">
                        <span>#{clt_.tiers.region}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PFV_liste_categories_comptable}" widgetVar="dlgListCategorieVente" closeOnEscape="true" width="50%" height="450" modal="true" dynamic="true">                             
                <p:dataTable id="data_categorie_vente_facture_vente"  value="#{managedCatCompt.categoriesVente}" var="catV" rowKey="#{catV.id}"
                             selectionMode="single" rowIndexVar="xCat" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewCategorie}" oncomplete="dlgListCategorieVente.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{xCat+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{catV.code}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}">
                        <span>#{catV.designation}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PFV_liste_point_vente}" widgetVar="dlgListPointVente" closeOnEscape="true" width="60%" 
                      height="500" modal="true" dynamic="true" >                             
                <p:dataTable id="data_point_vente_facture_vente"  value="#{managedPointVente.pointsvente}" var="poi" rowKey="#{poi.id}"
                             selectionMode="single" rowIndexVar="xPt" style="max-height: 450px; overflow-y: auto">
                    <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewPointVente}" oncomplete="dlgListPointVente.hide()"/>
                    <p:column headerText="N°" width="10">
                        <span>#{xPt+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" width="120">
                        <span>#{poi.code}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}">
                        <span>#{poi.libelle}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PA_liste_depots}" widgetVar="dlgListDepots" closeOnEscape="true" width="60%" height="500" modal="true" dynamic="true">                             
                <p:dataTable id="data_depot_facture_vente"  value="#{managedFactureVenteV2.depotsLivraison}" var="dpl" rowKey="#{dpl.id}"
                             selectionMode="single" rowIndexVar="xDep" style="max-height: 450px; overflow-y: auto">
                    <p:ajax event="rowSelect"  listener="#{managedFactureVenteV2.loadOnViewDepot}" oncomplete="dlgListDepots.hide()"/>
                    <p:column headerText="N°" width="15">
                        <span>#{xDep+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" width="120">
                        <span>#{dpl.code}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}">
                        <span>#{dpl.designation}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PA_liste_model_reglement}" widgetVar="dlgListModels" closeOnEscape="true" width="50%" height="450" modal="true" dynamic="true">                             
                <p:dataTable id="data_model_reglement_facture_vente"  value="#{managedModeReglement.models}" var="moR" rowKey="#{moR.id}"
                             selectionMode="single" rowIndexVar="xMod" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewModel}" oncomplete="dlgListModels.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{xMod+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}">
                        <span>#{moR.reference}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dgvTraitementLot" closeOnEscape="true" header="Traitement par lot" width="35%"
                      height="100">
                <h:panelGrid id="main-traitement-lot" columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0"> 
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.lotFV}"> 
                        <p:ajax event="valueChange" update="traitement-lot-fv"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-fv">
                        <span style="font-weight: bold">Facture </span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedFactureVenteV2.statutLotFV}" disabled="#{!managedFactureVenteV2.lotFV}">
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.lotBL}"> 
                        <p:ajax event="valueChange" update="traitement-lot-bl"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-bl">
                        <span style="font-weight: bold">Bon de livraison </span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedFactureVenteV2.statutLotBL}" disabled="#{!managedFactureVenteV2.lotBL}">
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.lotPiece}"> 
                        <p:ajax event="valueChange" update="traitement-lot-piece"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-piece">
                        <span style="font-weight: bold">Pièce de règlement</span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedFactureVenteV2.statutLotPiece}" disabled="#{!managedFactureVenteV2.lotPiece}">
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.ETAT_REGLE}"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                </h:panelGrid>
                <f:facet name="footer">
                    <h:panelGroup style="float: right">
                        <p:commandButton value="#{lab.LC_PFV_lancer}" actionListener="#{managedFactureVenteV2.traitementLot()}" oncomplete="dgvTraitementLot.hide();"/>
                        <p:commandButton type="button"  value="#{lab.LC_PFV_annuler}" onclick="dgvTraitementLot.hide()"/>
                    </h:panelGroup>
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="main-motif_etape_vente">
            <p:dialog hideEffect="explode" widgetVar="dglMotifCancelEtape" closeOnEscape="true" header="Motif d'annulation d'étape" width="35%">
                <h:panelGrid id="value_motif_etape_vente" columns="1" cellpadding="0" cellspacing="0" style="width: 100%">
                    <h:inputTextarea value="#{managedFactureVenteV2.motifEtape}" style="width: 100%" rows="4"/>                
                    <f:facet name="footer">
                        <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedFactureVenteV2.annulEtapeFacture()}" oncomplete="dglMotifCancelEtape.hide();" style="float: right" rendered="#{!managedFactureVenteV2.lastEtape}"
                                         update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                    </f:facet>
                </h:panelGrid>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dglEtatComptabilised" closeOnEscape="true" resizable="false" width="25%">
                <p:commandButton value="#{lab.LC_PFV_toutes_factures}" actionListener="#{managedFactureVenteV2.verifyComptabilised(null)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LC_PFA_factures_comptabilise}" actionListener="#{managedFactureVenteV2.verifyComptabilised(true)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LC_PFV_factures_non_comptabiliser}" actionListener="#{managedFactureVenteV2.verifyComptabilised(false)}" style="width: 99%"/>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmChangeCategorie" closeOnEscape="true"
                             message="#{lab.LC_PFV_text43}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.updatePrixArticle()}" oncomplete="dlgConfirmChangeCategorie.hide()"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.noChangeCategorie()}" oncomplete="dlgConfirmChangeCategorie.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmContinueWithOutStock" closeOnEscape="true"
                             message="#{lab.LC_PFV_text42}" header="#{lab.L_confirmation}">
                <div >
                    <span>Mémoriser mon choix pour cette session</span>
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.rememberChoixWithOutStock}" />
                </div>
                <p:commandButton value="#{lab.L_oui}" global="false" actionListener="#{managedFactureVenteV2.continueWithOutStock(true)}" oncomplete="dlgConfirmContinueWithOutStock.hide()"/>
                <p:commandButton value="#{lab.L_non}" global="false" actionListener="#{managedFactureVenteV2.continueWithOutStock(false)}" oncomplete="dlgConfirmContinueWithOutStock.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCout" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanCout()}" oncomplete="dlgConfirmDeleteCout.hide();collapseForm('cout_facture_vente')"
                                 update=":form-couts_vente:blog_form_cout_facture_vente :main_facture_vente:chp_fv_net_a_payer"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCout.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCout_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanCout_()}" oncomplete="dlgConfirmDeleteCout_.hide();collapseForm('cout_facture_vente')" 
                                 update=":form-couts_vente:blog_form_cout_facture_vente :main_facture_vente:chp_fv_net_a_payer"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCout_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCommercial" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanCommercial()}" oncomplete="dlgConfirmDeleteCommercial.hide()"
                                 update=":form-commercial_vente:blog_commercial_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCommercial.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCommercial_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanCommercial_()}" oncomplete="dlgConfirmDeleteCommercial_.hide()" 
                                 update=":form-couts_vente:blog_form_cout_facture_vente :main_facture_vente:chp_fv_net_a_payer"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCommercial_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteRemise" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanRemise()}" oncomplete="dlgConfirmDeleteRemise.hide();collapseForm('remise_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteRemise.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteRemise_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanRemise_()}" oncomplete="dlgConfirmDeleteRemise_.hide();collapseForm('remise_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteRemise_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteReglement" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanReglement()}" oncomplete="dlgConfirmDeleteReglement.hide();collapseForm('reglement_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteReglement.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteReglement_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="Oui" actionListener="#{managedFactureVenteV2.deleteBeanReglement_()}" oncomplete="dlgConfirmDeleteReglement_.hide();collapseForm('reglement_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteReglement_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteMensualite" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanReglement()}" oncomplete="dlgConfirmDeleteMensualite.hide();collapseForm('mensualite_facture_vente')"
                                 update=":form-reglement_vente:form_mensualite_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteMensualite.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteMensualite_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanReglement_()}" oncomplete="dlgConfirmDeleteMensualite_.hide();collapseForm('mensualite_facture_vente')"
                                 update=":form-reglement_vente:form_mensualite_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteMensualite_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAddClient" closeOnEscape="true"
                             message="Il n'existe pas de client par défaut! Créer?" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.saveDefautClient()}" oncomplete="dlgConfirmAddClient.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAddClient.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanContenu()}" oncomplete="dlgConfirmDeleteArticle.hide();"
                                 update=":main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanContenu_()}" oncomplete="dlgConfirmDeleteArticle_.hide();"
                                 update=":main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog id="dlg_confirm_rabais_fv" hideEffect="explode" widgetVar="dlgConfirmAlertRabais" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="Vous essayez de vendre l'article '#{managedFactureVenteV2.contenu.article.designation}' au prix '#{managedFactureVenteV2.contenu.prix}' inferieur au prix minimal '#{managedFactureVenteV2.contenu.prixMin}'. Appliquer un rabais?">
                <p:commandButton type="button" value="#{lab.L_oui}" onclick="dlgConfirmAlertRabais.hide();
                        dlgAddCommentaire.show()"/>
                <p:commandButton value="#{lab.L_non}" oncomplete="dlgConfirmAlertRabais.hide()" actionListener="#{managedFactureVenteV2.saveNewContenu(true)}"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBean()}" oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">            
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteLie" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanLie()}" oncomplete="dlgConfirmDeleteLie.hide()"
                                 update=":form-document_lie_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteLie.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
        </h:form >
        <h:form prependId="false">
            <p:confirmDialog id="id_confirm_close_fv" hideEffect="explode" widgetVar="dlgConfirmClose" closeOnEscape="true"
                             message="Êtes-vous sûr de vouloir #{managedFactureVenteV2.selectDoc.cloturer?'déverrouiller':'verrouiller'}?" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cloturer()}" oncomplete="dlgConfirmClose.hide()" update=":form-data_facture:data_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmClose.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_details_annulation}" widgetVar="dlgAnnuleCommande" modal="true" closeOnEscape="true"> 
                <h:panelGrid columns="3" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_date}"/>
                    <h:outputText value="#{lab.LC_PFV_caisse}"/>
                    <h:outputText value=""/>
                    <p:calendar value="#{managedBonVente.dateAnnule}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                    <h:selectOneMenu value="#{managedBonVente.caisseAnnule.id}" style="min-width: 160px">
                        <f:selectItem itemLabel="" itemValue="0" />
                        <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}" itemValue="#{icaiss.id}" />
                        <p:ajax event="valueChange" listener="#{managedBonVente.chooseCaisseAnnule()}"/>
                    </h:selectOneMenu>  
                    <p:commandButton icon="ui-icon-disk" value="#{lab.L_enregistrer}" actionListener="#{managedBonVente.refuserOrder()}" oncomplete="dlgAnnuleCommande.hide()"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dlgConfirmAnnulerCmde" closeOnEscape="true" header="#{lab.L_confirmation}" resizable="false">
                <span>#{lab.LC_PCV_text13}</span>
                <h:panelGrid id="blog-annule_bcv_fv" columns="3" styleClass="yvs_nostyle">
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleCmde}" label="#{lab.LC_PFV_annuler_commande}" rendered="#{managedBonVente.visibleCmde}"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_commande}" rendered="#{managedBonVente.visibleCmde}"/>
                    <p:outputLabel rendered="#{managedBonVente.visibleCmde}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleFact}" label="#{lab.LC_PFV_annuler_facture}" rendered="#{managedBonVente.visibleFact}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_facture}" rendered="#{managedBonVente.visibleFact}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteFact}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleFact}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleLivr}" label="#{lab.LC_PFV_annuler_livraison}" rendered="#{managedBonVente.visibleLivr}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_livraison}" rendered="#{managedBonVente.visibleLivr}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteLivr}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleLivr}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleRegl}" label="#{lab.LC_PFV_annuler_reglement}" rendered="#{managedBonVente.visibleRegl}"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_reglement}" rendered="#{managedBonVente.visibleRegl}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteRegl}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleRegl}"/>
                </h:panelGrid>
                <f:facet name="footer">
                    <div align="right">
                        <p:commandButton value="Oui" actionListener="#{managedBonVente.annulerOrderForce()}" oncomplete="dlgConfirmAnnulerCmde.hide();collapseForm('commande_vente')"/>
                        <p:commandButton type="button"  value="Non" onclick="dlgConfirmAnnulerCmde.hide()"/>                        
                    </div>
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form-commercial_vente"> 
            <p:dialog hideEffect="explode" widgetVar="dlgCommerciauxFv" closeOnEscape="true" header="#{lab.LC_PFV_commerciaux_facture}" resizable="false" style="width: 50%">
                <p:outputPanel id="blog_commercial_vente">
                    <h:inputHidden id="input_hide_commercial_vente" value="#{managedFactureVenteV2.tabIds_commercial}"/>
                    <h:panelGrid id="form_commercial_vente" columns="4">
                        <h:outputText value=""/>
                        <h:outputText value="#{lab.LC_PFV_commercial}"/>
                        <h:outputText value="#{lab.LC_PFV_taux}" title="#{lab.LC_PFV_taux_participations}"/>
                        <h:outputText value=""/>
                        <p:commandButton icon="ui-icon-person" style="width: 20px;height: 20px"  title="#{lab.LC_PFV_inserer_vendeur_comme_commercial}" actionListener="#{managedFactureVenteV2.saveCurrentCommercial(true)}"/>
                        <h:panelGroup id="select_commercial_vente">
                            <h:inputText value="#{managedFactureVenteV2.commercial.commercial.nomPrenom}" style="color: #{managedFactureVenteV2.commercial.commercial.error?'red':''}"
                                         title="#{lab.LC_PFV_saisir_entrer_commerciaux}">
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchCommercial()}"/>
                            </h:inputText> 
                            <h:outputText value="#{managedFactureVenteV2.commercial.commercial.code}" style="font-size: 0.7em;font-weight: bold"/>
                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PFV_liste_commerciaux}" global="false" onclick="dlgListCommerciaux.show()"/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:inputText id="txt-taux_commercial_vente" value="#{managedFactureVenteV2.commercial.taux}" style="width: 100px;text-align: center" title="#{lab.LC_PFV_taux_participation}">
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onTauxCommercialBlur()}"/>
                            </h:inputText>%
                        </h:panelGroup>
                        <p:commandButton icon="ui-icon-circle-plus" actionListener="#{managedFactureVenteV2.saveNewCommercial()}" style="width: 22px; height: 22px;margin-left: 50px"/>
                    </h:panelGrid>
                    <p:dataTable id="data_commercial_vente" value="#{managedFactureVenteV2.docVente.commerciaux}" var="com" rowKey="#{com.id}" selectionMode="single">
                        <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewCommercialVente}" 
                                oncomplete="collapseForm('commercial_vente')" update=":form-commercial_vente:form_commercial_vente"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedFactureVenteV2.unLoadOnViewCommercialVente}" 
                                oncomplete="collapseForm('commercial_vente')" update=":form-commercial_vente:form_commercial_vente"/>
                        <p:column headerText="#{lab.LC_PFV_commercial}" >
                            <span>#{com.commercial.nom_prenom}</span>
                            <h:graphicImage library="img" name="connecte.png" rendered="#{com.responsable}" width="15" height="15" title="#{lab.LC_PFV_responsable_principale_facture}" style="float: right"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_taux}" style="text-align: right;width: 15%">
                            <h:outputText value="#{com.taux}" converter="DNS"/>
                            %
                        </p:column>                             
                        <p:column width="20" style="text-align: center">
                            <p:contextMenu for="btn_option_commercial_vente" event="left click" style="font-size: 0.8em">
                                <p:menuitem value="#{lab.LC_PFV_set_responsable}" icon="ui-icon-star" global="false" actionListener="#{managedFactureVenteV2.definedResponsable(com)}" update="data_commercial_vente"/>
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanCommercial_(com)}" oncomplete="dlgConfirmDeleteCommercial_.show()"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_commercial_vente" type="button"/>
                        </p:column> 
                    </p:dataTable>
                    <p:commandButton id="delete_commercial_vente" value="#{lab.L_supprimer}" style="float: right" rendered="false"
                                     onclick="dlgConfirmDeleteCommercial.show()" global="false"/>
                </p:outputPanel> 
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form-couts_vente"> 
            <p:dialog hideEffect="explode" widgetVar="dlgCoutServiceFv" closeOnEscape="true" header="#{lab.LC_PFV_couts_service_supplementaire_facture}" resizable="false" style="width: 50%">
                <p:outputPanel id="blog_form_cout_facture_vente">
                    <h:inputHidden id="input_hide_cout_facture_vente" value="#{managedFactureVenteV2.tabIds_cout}"/>
                    <h:panelGrid id="form_cout_facture_vente" columns="4">  
                        <h:outputText value="#{lab.L_type}"/>
                        <h:outputText value="#{lab.LC_PFV_cout}"/>
                        <h:outputText value="#{lab.L_montant}"/>
                        <h:outputText value=""/>
                        <h:selectOneMenu value="#{managedFactureVenteV2.cout.service}" title="#{lab.LC_PFV_service_participent_au_ca}">
                            <f:selectItem itemLabel="#{lab.LC_PFV_services}" itemValue="#{true}"/>                           
                            <f:selectItem itemLabel="#{lab.LC_PFV_couts}" itemValue="#{false}"/>                           
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVenteV2.cout.type.id}" id="select_type_cout_facture_vente" style="min-width: 120px" onchange="openDialog(dlgAddTypeCout, $(this))">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedTypeCout.types}" var="typ" itemLabel="#{typ.libelle}" itemValue="#{typ.id}" />     
                            <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                            <f:selectItem itemLabel="#{lab.L_plus_de_choix}" itemValue="-1"/>                               
                        </h:selectOneMenu>  
                        <pe:inputNumber value="#{managedFactureVenteV2.cout.montant}" style="text-align: right" decimalPlaces="0"/>  
                        <p:commandButton icon="ui-icon-circle-plus" actionListener="#{managedFactureVenteV2.saveNewCout()}" style="width: 22px; height: 22px;margin-left: 50px"/>                                                  
                    </h:panelGrid>
                    <p:dataTable id="data_cout_facture_vente" value="#{managedFactureVenteV2.docVente.couts}" var="coux" rowKey="#{coux.id}" 
                                 rowIndexVar="couIdx" selectionMode="single">
                        <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewCout}"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedFactureVenteV2.unLoadOnViewCout}"/>
                        <p:column headerText="N°" style="width: 7%">
                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{coux.new_}"/>
                            <span>#{couIdx+1}</span>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_type_coup}">
                            <span>#{coux.typeCout.libelle}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_montant}" style="text-align: right;width: 30%">
                            <h:outputText value="#{coux.montant}" converter="#{managedFactureVenteV2.converter}"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_serv}." style="width: 15%;text-align: center">
                            <h:graphicImage library="img" name="#{(coux.service)?'yes.png':'no.png'}" width="15" height="15"/>
                        </p:column>
                        <p:column style="width: 7%;text-align: center">
                            <p:contextMenu for="btn_option_cout_facture_vente" event="left click" style="font-size: 0.8em">
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanCout_(coux)}" oncomplete="dlgConfirmDeleteCout_.show()"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_cout_facture_vente" type="button"/>
                        </p:column> 
                        <p:column style="width: 7%;text-align: center" rendered="false">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_cout_facture_vente" value="false"
                                                         onclick="selectionAllLineTab(#{managedFactureVenteV2.docVente.couts.size()}, 'cout_facture_vente')">
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox  value="#{coux.selectActif}" styleClass="chek_line_cout_facture_vente"
                                                      onclick="selectionLineTab(#{coux.id}, 'cout_facture_vente')">
                            </h:selectBooleanCheckbox>
                        </p:column>
                    </p:dataTable>
                    <p:commandButton id="delete_cout_facture_vente" value="#{lab.L_supprimer}" style="float: right" rendered="false"
                                     onclick="dlgConfirmDeleteCout.show()"/>
                </p:outputPanel>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form-reglement_vente"> 
            <p:dialog hideEffect="explode" widgetVar="dlgReglementFv" closeOnEscape="true" header="#{lab.LC_PFV_reglement_facture}" resizable="false" style="width: 50%">
                <p:outputPanel id="form_mensualite_facture_vente">
                    <h:panelGrid columns="3" rendered="#{accesRessource.fv_create_reglement}"> 
                        <p:commandLink actionListener="#{managedFactureVenteV2.genereMensualite()}" global="false" style="float: left;border: 2px solid black; border-radius: 5px;padding: 3px;background: white;margin-left: 3px"
                                       rendered="#{0==managedFactureVenteV2.docVente.reglements.size()}" title="#{lab.LC_PFV_generer_mode_reglement}" update="form_mensualite_facture_vente">
                            <h:graphicImage library="img" name="update.png" width="20" height="20"/>
                        </p:commandLink>
                        <h:panelGrid id="blog_form_mensualite_facture_vente" columns="7" cellpadding="0" cellspacing="0" style="padding-top: 3px;padding-bottom: -5px">
                            <h:outputText value="#{lab.LC_PFV_mode}" />
                            <h:outputText value="#{lab.L_montant}" />
                            <h:outputText value="#{lab.LC_PFV_date_paiement}" />
                            <h:outputText value="#{lab.LC_PFV_caisse}" />
                            <h:outputText value="#{lab.LC_PFV_caissier}" />
                            <h:outputText value="#{lab.LC_PFV_statut}"  />
                            <h:outputText value="#{lab.LC_PRPF_reference_externe}"/>
                            <h:panelGroup>                                                    
                                <h:outputText value="#{managedFactureVenteV2.reglement.id}" rendered="#{managedFactureVenteV2 .reglement.id gt 0}"/>
                                <h:selectOneMenu value="#{managedFactureVenteV2.reglement.mode.id}" id="select_model_mens_facture_vente" style="min-width: 120px" title="#{lab.LC_PFV_mode_reglement}">
                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                    <f:selectItems value="#{managedModeReglement.modes}" var="modelm" itemLabel="#{modelm.designation}" itemValue="#{modelm.id}" />     
                                </h:selectOneMenu>  
                            </h:panelGroup>
                            <pe:inputNumber value="#{managedFactureVenteV2.reglement.montant}"  style="text-align: right"/>
                            <p:calendar value="#{managedFactureVenteV2.reglement.datePaiementPrevu}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                            <h:selectOneMenu value="#{managedFactureVenteV2.reglement.caisse.id}" 
                                             valueChangeListener="#{managedFactureVenteV2.chooseCaisses}" style="width: 160px">
                                <f:selectItem itemLabel="" itemValue="0" />
                                <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}" itemValue="#{icaiss.id}" />
                                <p:ajax event="valueChange"/>
                            </h:selectOneMenu>
                            <h:selectOneMenu id="chmp_caissier_reglement_fv" value="#{managedFactureVenteV2.reglement.caissier.id}" style="width: 160px" disabled="#{!accesRessource.compta_reg_fv_change_caissier}">
                                <f:selectItem itemLabel="" itemValue="0" />
                                <f:selectItems value="#{managedFactureVenteV2.caissiers}" var="iCaissier" itemLabel="#{iCaissier.nomUsers}" itemValue="#{iCaissier.id}" />
                                <p:ajax event="valueChange"/>
                            </h:selectOneMenu>
                            <h:selectOneMenu value="#{managedFactureVenteV2.reglement.statutPiece}" disabled="#{managedFactureVenteV2.reglement.statutPiece != constantes.STATUT_DOC_ATTENTE}">
                                <f:selectItem itemValue="#{constantes.STATUT_DOC_PAYER}" itemLabel="#{lab.LC_PFV_regler}" />
                                <f:selectItem itemValue="#{constantes.STATUT_DOC_ATTENTE}" itemLabel="#{lab.LC_PFV_en_attente}" />                                                    
                                <f:selectItem itemValue="#{constantes.STATUT_DOC_ENCOUR}" itemLabel="#{lab.LC_PFV_en_cours}" itemDisabled="true"/>                                                    
                            </h:selectOneMenu>
                            <h:panelGroup>
                                <h:inputText value="#{managedFactureVenteV2.reglement.numRefExterne}" />
                                <p:commandButton id="save_mensualite_facture_vente" icon="ui-icon-circle-plus" style="width: 22px; height: 22px;margin-left: 50px"
                                                 update="form_mensualite_facture_vente" actionListener="#{managedFactureVenteV2.saveNewReglement(false)}"/>
                            </h:panelGroup> 
                        </h:panelGrid>                                            
                    </h:panelGrid>    
                    <h:inputHidden id="input_hide_mensualite_facture_vente" value="#{managedFactureVenteV2.tabIds_mensualite}"/>
                    <p:dataTable id="data_mensualite_facture_vente" value="#{managedFactureVenteV2.docVente.reglements}" var="men" rowKey="#{men.id}" 
                                 rowIndexVar="menIdx" selectionMode="single" selection="#{managedReglementVente.selectedPiece}">
                        <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewMensualite}"
                                update=":form-reglement_vente:blog_form_mensualite_facture_vente :form-reglement_vente:zone_auteur_reg_fv"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedFactureVenteV2.unLoadOnViewMensualite}"
                                update=":form-reglement_vente:blog_form_mensualite_facture_vente :form-reglement_vente:zone_auteur_reg_fv"/>
                        <p:column headerText="N°" width="20" style="text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <f:facet name="header">
                                <p:contextMenu for="chp_view_id_pcr" event="left click" styleClass="context_menu">
                                    <p:menuitem update="data_mensualite_facture_vente" global="false" value="#{lab.LC_PCV_voir_identifiant}" actionListener="#{men.setView_id(!men.view_id)}"/>
                                </p:contextMenu>
                                <h:outputText value="N°" id="chp_view_id_pcr" style="cursor: pointer"/>
                            </f:facet>
                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{men.new_}"/>
                            <h:outputText value="#{menIdx+1}" rendered="#{!men.view_id}"/>
                            <h:outputText value="#{men.id}" rendered="#{men.view_id}"/>
                            <h:panelGroup style="float: right">
                                <h:outputText title="#{lab.LC_PFA_comptabiliser}" value="C" rendered="#{managedReglementVente.isComptabilise(men)}" styleClass="style_statut"/>
                            </h:panelGroup>
                        </p:column>
                        <p:column headerText="#{lab.LC_PCC_mode}" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <h:outputText value="#{men.model.designation}"/>
                            <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_ATTENTE)?'inline-block':'none'}; width: 10px; height: 10px; background: #444;" title="#{lab.LC_PFA_en_attente_paiment}"></span>
                            <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_ENCOUR)?'inline-block':'none'}; width: 10px; height: 10px; background: #f6a828" title="#{lab.LC_PFA_en_cours_paiment}"></span>
                            <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_PAYER)?'inline-block':'none'}; width: 10px; height: 10px; background: #006666" title="#{lab.LC_PFA_piece_regler}"></span>
                            <span style="display: #{(men.phasesReglement.size() gt 0)?'inline-block':'none'}; width: 10px; height: 10px; background: #99ccff" title="#{lab.LC_PFA_phase_reglement_generer}"></span>
                            <h:graphicImage title="#{lab.LC_PCV_text16}" library="icones" name="alert.png" width="15" height="15" rendered="#{men.error()}" style="float: right"/>  
                        </p:column>
                        <p:column headerText="#{lab.L_numero}" sortBy="#{men.datePiece}" style="text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <h:outputText value="#{men.numeroPiece}"/>
                            <h:outputText rendered="#{men.notifs.id gt 0}" value="A" styleClass="statut" title="#{lab.LC_PFV_paiement_lie_acompte} #{men.notifs.acompte.numRefrence}" style="float: right"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_date_paye}" sortBy="#{men.datePaimentPrevu}" style="text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <h:outputText value="#{(men.statutPiece eq constantes.STATUT_DOC_PAYER)?men.datePaiement:men.datePaimentPrevu}" converter="DATE"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_caisse}" style="width: 17%;text-align: right" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <h:outputText value="#{men.caisse.intitule}" />
                        </p:column>
                        <p:column headerText="#{lab.L_montant}" style="width: 17%;text-align: right" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <h:outputText value="#{men.montant}" converter="#{managedFactureVenteV2.converter}"/>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}" style="width: 17%;text-align: right" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <h:outputText value="#{men.referenceExterne}"/>
                        </p:column>
                        <p:column style="width: 5%;text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <p:contextMenu for="btn_option_mensualite_facture_vente" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                <p:menuitem value="#{!men.comptabilise?'Comptabiliser':'Annuler Comptabilité'}" actionListener="#{managedFactureVenteV2.setSelectReglement(men)}" 
                                            oncomplete="#{!men.comptabilise?'dlgComptabilisePiece.show()':'dlgUnComptabilisePiece.show()'}" icon="ui-icon-arrowthick-2-e-w" 
                                            rendered="#{men.id gt 0 and (men.statutPiece==constantes.STATUT_DOC_PAYER)}"/> 
                                <p:menuitem icon="ui-icon-pin-s" value="#{lab.LC_PFV_lettre_piece}" actionListener="#{managedFactureVenteV2.lettrerCaisse(men)}" rendered="#{men.comptabilise}"/>
                                <p:menuitem value="#{(men.statutPiece=='P')?'Annuler':'Encaisser/Valider'}" icon="#{(men.statutPiece=='P')?'ui-icon-circle-close':'ui-icon-circle-check'}" rendered="#{men.id gt 0 and men.phasesReglement.size() le 0}"  
                                            actionListener="#{managedFactureVenteV2.openConfirmPaiement(men, 'F', false)}" update=":main_facture_vente:grp_btn_etat_facture_vente data_mensualite_facture_vente"/>
                                <p:menuitem value="#{lab.LC_PFV_aller_retenue}" icon="ui-icon-arrowthick-1-e"   actionListener="#{managedFactureVenteV2.onSelectDistantReglement(men)}"
                                            rendered="#{accesPage.grh_prelvm_ret_ and men.model.typeReglement == constantes.MODE_PAIEMENT_SALAIRE}"/>
                                <p:menuitem value="#{lab.LC_PFV_aller_aux_cheques}" icon="ui-icon-arrowthick-1-e"  actionListener="#{managedFactureVenteV2.onSelectDistantReglement(men)}"
                                            rendered="#{accesPage.compta_view_reg_vente and men.model.typeReglement == constantes.MODE_PAIEMENT_BANQUE and men.phasesReglement.size() gt 0}"/>
                                <p:menuitem value="#{lab.LC_PFV_voir_compensation}" icon="ui-icon-arrowthick-1-e"  actionListener="#{managedFactureVenteV2.onSelectDistantReglement(men)}"
                                            rendered="#{accesPage.compta_view_reg_vente and men.model.typeReglement == constantes.MODE_PAIEMENT_COMPENSATION}"/>
                                <p:menuitem value="#{lab.LC_PFV_aller_acompte}" icon="ui-icon-arrowthick-1-e"  actionListener="#{managedOperationClient.onSelectDistant(men.notifs.acompte)}"
                                            rendered="#{accesPage.compta_ope_client and men.notifs.id gt 0}"/>
                                <p:menuitem value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" title="#{lab.LC_PFV_annuler_toute_phases}"  actionListener="#{managedReglementVente.openConfirmPaiement(men,'F', false)}"
                                            rendered="#{men.model.typeReglement == constantes.MODE_PAIEMENT_BANQUE and men.phasesReglement.size() gt 0}"/>
                                <p:menuitem value="#{lab.LC_PFV_equilibrer}" icon="ui-icon-arrowthick-1-e" actionListener="#{managedCompensation.onSelectVente(men)}" update=":select_fv_compensation data_mensualite_facture_vente"
                                            rendered="#{men.model.typeReglement == constantes.MODE_PAIEMENT_COMPENSATION}"/>
                                <p:separator style="width: 98%;margin: auto"/>
                                <p:menuitem value="#{lab.LC_PFV_dissocier}" icon="ui-icon-pin-w" actionListener="#{managedReglementVente.dissocierNotif(men)}" rendered="#{men.notifs.id gt 0}"
                                            update="data_mensualite_facture_vente"/>
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash"  actionListener="#{managedFactureVenteV2.deleteBeanReglement_(men)}" oncomplete="dlgConfirmDeleteMensualite_.show()"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_mensualite_facture_vente" type="button"/>
                        </p:column> 
                        <p:column style="width: 5%;text-align: center"  styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_mensualite_facture_vente" value="false"
                                                         onclick="selectionAllLineTab(#{managedFactureVenteV2.docVente.reglements.size()}, 'mensualite_facture_vente')">
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox value="#{men.selectActif}" styleClass="chek_line_mensualite_facture_vente" 
                                                     onclick="selectionLineTab(#{men.id}, 'mensualite_facture_vente')">
                            </h:selectBooleanCheckbox>
                        </p:column>
                    </p:dataTable>
                </p:outputPanel>                
                <f:facet name="footer">
                    <div style="font-size: 0.7em" align="right">
                        <h:panelGroup  id="zone_auteur_reg_fv">
                            <span>#{lab.L_par} </span>
                            <h:outputText value="#{managedReglementVente.selectedPiece.author.users.nomUsers}" />
                            <span>#{lab.L_le} </span>
                            <h:outputText value="#{managedReglementVente.selectedPiece.dateUpdate}" converter="DATETIME" />
                        </h:panelGroup>
                        <p:commandLink actionListener="#{managedFactureVenteV2.saveNewAllMensualite()}" update="form_mensualite_facture_vente" 
                                       style="background: black;color: white;border: 2px solid #666; border-radius: 5px;margin-top: -15px;padding: 3px"
                                       rendered="#{managedFactureVenteV2.newMensualite and managedFactureVenteV2.docVente.reglements.size() >0}" value="#{lab.LC_PFV_tout_enregistrer}"/>
                    </div>
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form-document_lie_vente"> 
            <p:dialog hideEffect="explode" widgetVar="dlgDocumentsFv" closeOnEscape="true" 
                      header="#{lab.LC_PFV_document_liees_facture}" resizable="false" style="width: 90%">
                <p:dataTable value="#{managedFactureVenteV2.docVente.documents}" var="iLivr" rowKey="#{iLivr.id}" rowIndexVar="iLivrIdx" selectionMode="single" id="data_livraison_facture_vente">
                    <p:column width="35" headerText="N°" styleClass="statut_#{iLivr.statut}">
                        <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{iLivr.cloturer}"/>  
                        <span>#{iLivrIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" styleClass="statut_#{iLivr.statut}">
                        <span>#{iLivr.numDoc}</span>
                        <h:outputText value="#{lab.LC_PFA_vide}" style="float: right;color: blue;font-style: italic;font-size: 0.8em" rendered="#{0>=iLivr.contenus.size()}"/>                                   
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_date_doc}" style="text-align: center" styleClass="statut_#{iLivr.statut}">
                        <h:panelGroup rendered="#{iLivr.statut == constantes.ETAT_VALIDE}">
                            <h:outputText value="#{iLivr.dateLivraison}" converter="DDMMYYYY"/>
                            <span> #{lab.L_a} </span>
                            <h:outputText value="#{iLivr.heureDoc}" converter="TIME"/>
                        </h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_non_livre}" rendered="#{iLivr.statut != constantes.ETAT_VALIDE}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_tranche}" style="text-align: center" styleClass="statut_#{iLivr.statut}">
                        <h:outputText value="#{iLivr.trancheLivrer.heureDebut}" converter="TIME"/>
                        <span> - </span>
                        <h:outputText value="#{iLivr.trancheLivrer.heureFin}" converter="TIME"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_depot}" styleClass="statut_#{iLivr.statut}"> 
                        <span>#{iLivr.depotLivrer.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_type}" styleClass="statut_#{iLivr.statut}" style="text-align: center">
                        <span >#{iLivr.typeDoc}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_auteur}" styleClass="statut_#{iLivr.statut}">
                        <h:outputText value="#{iLivr.author.users.nomUsers}" rendered="#{iLivr.statut!=constantes.STATUT_DOC_VALIDE}"/>
                        <h:outputText value="#{iLivr.livreur.nomUsers}" rendered="#{iLivr.statut==constantes.STATUT_DOC_VALIDE and iLivr.typeDoc==constantes.TYPE_BLV}"/>
                        <h:outputText value="#{iLivr.validerBy.nomUsers}" rendered="#{iLivr.statut==constantes.STATUT_DOC_VALIDE and (iLivr.typeDoc==constantes.TYPE_FAV or iLivr.typeDoc==constantes.TYPE_BRV)}"/>
                    </p:column>
                    <p:column style="width: 5%;text-align: center" styleClass="statut_#{iLivr.statut}">
                        <p:contextMenu for="btn_option_livraison_facture_vente" event="left click" style="font-size: 0.8em" styleClass="context_menu">                                 
                            <p:menuitem value="#{lab.LC_PCV_valider}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.onValideDistantLivraison(iLivr)}" 
                                        update="data_livraison_facture_vente :form-data_facture:data_facture_vente" rendered="#{iLivr.statut != constantes.ETAT_VALIDE}"/>
                            <p:menuitem value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-triangle-w" actionListener="#{managedFactureVenteV2.onAnnulerDistantLivraison(iLivr)}" 
                                        update="data_livraison_facture_vente :form-data_facture:data_facture_vente" rendered="#{iLivr.statut != constantes.ETAT_EDITABLE}"/>
                            <p:menuitem value="#{lab.L_suspendre}" icon="ui-icon-circle-close" actionListener="#{managedFactureVenteV2.onRefuserDistantLivraison(iLivr)}" 
                                        update="data_livraison_facture_vente :form-data_facture:data_facture_vente" rendered="#{false}"/>
                            <p:separator style="width: 98%;margin: auto"/>
                            <p:menuitem value="#{lab.LC_PFV_aller_a}" icon="ui-icon-arrowthick-1-e" global="false" actionListener="#{managedFactureVenteV2.onSelectDistantLivraison(iLivr)}"/>
                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanLie(iLivr)}" oncomplete="dlgConfirmDeleteLie.show()"/>
                            <p:menuitem value="#{lab.L_telecharger}" icon="ui-icon-circle-arrow-s" global="false"  actionListener="#{managedLivraisonVente.print(iLivr)}" ajax="false"/>
                        </p:contextMenu>                           
                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_livraison_facture_vente" type="button"/>
                    </p:column> 
                </p:dataTable>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form-data_facture"> 
            <p:dialog hideEffect="explode" widgetVar="dlgFacturesFv" closeOnEscape="true" header="#{lab.LC_PRA_liste_factures}" 
                      width="95%" height="80%" >
                <div class="dlg_part_fixe">
                    <p:outputPanel style="float: left;">
                        <ui:include src="../../gescom/vente/facture/search_v2.xhtml"/>
                    </p:outputPanel>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block" >
                        <p:commandButton actionListener="#{managedFactureVenteV2.init(false)}"  update="data_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedFactureVenteV2.p_contenu.disPrev}" rendered="#{managedFactureVenteV2.listing}"/>
                        <p:commandButton actionListener="#{managedFactureVenteV2.init(false)}"  update="data_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedFactureVenteV2.paginator.disPrev}" rendered="#{!managedFactureVenteV2.listing}"/>
                        <p:outputPanel rendered="#{managedFactureVenteV2.listing}">
                            <p:inplace label="#{managedFactureVenteV2.p_contenu.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                <pe:inputNumber value="#{managedFactureVenteV2.p_contenu.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                    <p:ajax event="valueChange" listener="#{managedFactureVenteV2.gotoPagePaginator()}" update="data_facture_vente"/>
                                </pe:inputNumber>
                            </p:inplace><p:outputLabel value="/#{managedFactureVenteV2.p_contenu.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        </p:outputPanel>
                        <p:outputPanel rendered="#{!managedFactureVenteV2.listing}">
                            <p:inplace label="#{managedFactureVenteV2.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                <pe:inputNumber value="#{managedFactureVenteV2.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                    <p:ajax event="valueChange" listener="#{managedFactureVenteV2.gotoPagePaginator()}" update="data_facture_vente"/>
                                </pe:inputNumber>
                            </p:inplace><p:outputLabel value="/#{managedFactureVenteV2.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        </p:outputPanel>
                        <p:commandButton actionListener="#{managedFactureVenteV2.init(true)}"  update="data_facture_vente" rendered="#{managedFactureVenteV2.listing}"
                                         icon="ui-icon-circle-triangle-e" disabled="#{managedFactureVenteV2.p_contenu.disNext}"/>
                        <p:commandButton actionListener="#{managedFactureVenteV2.init(true)}"  update="data_facture_vente" rendered="#{!managedFactureVenteV2.listing}"
                                         icon="ui-icon-circle-triangle-e" disabled="#{managedFactureVenteV2.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedFactureVenteV2.imax}" label="#{lab.L_nombre_max_resultat}"
                                         valueChangeListener="#{managedFactureVenteV2.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedFactureVenteV2.paginations}"/>
                            <p:ajax event="valueChange"  update="data_facture_vente"  />
                        </p:selectOneMenu>
                    </p:outputPanel>
                </div>

                <div style="clear:both"/>
                <div class="dlg_part_scroll">
                    <p:outputPanel id="data_facture_vente">
                        <p:outputPanel rendered="#{managedFactureVenteV2.listing}">
                            <ui:include src="../../gescom/vente/facture/list_details.xhtml" />
                        </p:outputPanel>
                        <p:outputPanel rendered="#{!managedFactureVenteV2.listing}">
                            <ui:include src="../../gescom/vente/facture/list_facture.xhtml" />
                        </p:outputPanel>
                    </p:outputPanel>
                </div>                
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form-print"> 
            <p:dialog hideEffect="explode" widgetVar="dlgPrint" closeOnEscape="true" header="#{lab.LC_PFV_imprimer_facture}" resizable="false" modal="true" width="90%">
                <p:outputPanel id="media-print">
                    <p:media value="#{managedFactureVenteV2.docVente.printPath}" width="100%" height="600px"/>
                </p:outputPanel>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuler" closeOnEscape="true"
                             message="#{lab.LC_PFV_text40}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.annulerOrder_()}" oncomplete="dlgConfirmAnnuler.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.annulerOrder(true)}"  oncomplete="dlgConfirmAnnuler.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmCancelForcer" closeOnEscape="true"
                             message="#{lab.LC_PFV_text37}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelOrder(true, false)}" oncomplete="dlgConfirmCancelForcer.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmCancelForcer.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmCancel" closeOnEscape="true"
                             message="#{lab.LC_PFV_text36}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelOrder(false, false)}" oncomplete="dlgConfirmCancel.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.cancelOrder(false, true)}" oncomplete="dlgConfirmCancel.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmRefuserForcer" closeOnEscape="true"
                             message="#{lab.LC_PFV_text37}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.refuserOrder(true, false)}" oncomplete="dlgConfirmRefuserForcer.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmRefuserForcer.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmRefuser" closeOnEscape="true"
                             message="#{lab.LC_PFV_text36}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.refuserOrder(false, false)}" oncomplete="dlgConfirmRefuser.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.refuserOrder(false, true)}" oncomplete="dlgConfirmRefuser.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmValide" closeOnEscape="true"
                             message="#{lab.LC_PFV_text35}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.validerFacture(true)}" oncomplete="dlgConfirmValide.hide();"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmValide.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmSoumis" closeOnEscape="true"
                             message="#{lab.LC_PFV_text34}" 
                             header="#{lab.L_confirmation}">
                <div align="center">
                    <div>
                        <p:calendar id="date-livraison_fv" value="#{managedFactureVenteV2.dateLivraison}" size="8" pattern="dd-MM-yyyy" navigator="true">
                            <p:ajax event="dateSelect" global="false"/>
                        </p:calendar>
                        <h:selectOneMenu value="#{managedFactureVenteV2.statutLivraison}">
                            <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            <f:selectItem itemLabel="#{lab.LC_PFV_valide}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            <p:ajax event="valueChange" global="false"/>
                        </h:selectOneMenu>                   
                    </div>
                    <div style="display: block">
                        <p:outputPanel id="blog-contenu_fv_require_lot">
                            <p:outputPanel  rendered="#{!managedFactureVenteV2.contenusRequireLot.isEmpty()}">
                                <div style="max-height: 400px">
                                    <div style="max-height: 350px;overflow-y: auto">
                                        <c:forEach items="#{managedFactureVenteV2.contenusRequireLot}" var="aRL" id="data-contenu_fa_require_lot">
                                            <p:dataTable value="#{aRL.lots}" var="lot" rowKey="#{lot.id}" style="width: 1000px;clear:both" editable="true">
                                                <p:ajax event="rowEdit" listener="#{managedFactureVenteV2.onRowEdit}"/>
                                                <f:facet name="header">
                                                    <div align="left">
                                                        <h:outputText value="#{aRL.quantite}" converter="#{managedFactureVenteV2.converterStock}" title="#{lab.LC_PFA_numero_serie}: #{aRL.numSerie}"/>
                                                        <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                        de
                                                        #{aRL.article.designation}
                                                        <div style="float:right">
                                                            <h:outputText value="#{aRL.article.quantite}" converter="#{managedFactureVenteV2.converterStock}"/>
                                                            <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                            <h:outputText value="#{lab.LC_PFV_en_stock}"/>
                                                        </div>
                                                    </div>
                                                </f:facet>
                                                <p:column headerText="Numero de lot" style="text-align: center">
                                                    #{lot.numero}
                                                </p:column>
                                                <p:column headerText="Date fabrication" style="text-align: center">
                                                    <h:outputText value="#{lot.dateFabrication}" converter="DATE"/>
                                                </p:column>
                                                <p:column headerText="Date expiration" style="text-align: center">
                                                    <h:outputText value="#{lot.dateExpiration}" converter="DATE"/>
                                                </p:column>
                                                <p:column headerText="Stock" style="text-align: right">
                                                    <h:outputText value="#{lot.stock}" converter="#{managedFactureAchat.converterStock}"/>
                                                    <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                </p:column>
                                                <p:column headerText="Quantitée" style="text-align: right">
                                                    <p:cellEditor>
                                                        <f:facet name="output">
                                                            <h:outputText value="#{lot.quantitee}"/>
                                                            <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                        </f:facet>
                                                        <f:facet name="input">
                                                            <h:inputText value="#{lot.quantitee}" style="width:100%;text-align: right">
                                                                <p:ajax event="valueChange" listener="#{managedFactureVenteV2.onBlurQuantiteeLot(aRL, lot)}"/>
                                                            </h:inputText>
                                                        </f:facet>
                                                    </p:cellEditor>
                                                </p:column>
                                                <p:column style="text-align: center;width: 5px">
                                                    <p:rowEditor />
                                                </p:column> 
                                            </p:dataTable>                                
                                        </c:forEach>
                                    </div>
                                </div>
                            </p:outputPanel>
                        </p:outputPanel>
                    </div>
                </div>
                <div align="center">
                    <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.transmisOrder()}" oncomplete="dlgConfirmSoumis.hide();"/>
                    <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmSoumis.hide()"/>
                </div>                
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCancelV" closeOnEscape="true"
                             message="#{lab.LC_PFV_text33}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelEtapeFacture(false, false)}" oncomplete="dlgCancelV.hide();" 
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCancelV.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgSuspendFact" closeOnEscape="true"
                             message="#{lab.LC_PFV_text32}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelEtapeFacture(false, true, false)}" oncomplete="dlgSuspendFact.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgSuspendFact.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgSaveEntete" closeOnEscape="true"
                             message="#{lab.LC_PFV_text31}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.saveNewEntete()}" oncomplete="dlgSaveEntete.hide();collapseForm('article_facture_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgSaveEntete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgResetEntete" closeOnEscape="true"
                             message="#{lab.LC_PFV_text30}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.resetFicheEntete()}" oncomplete="dlgResetEntete.hide();collapseForm('article_facture_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgResetEntete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanEntete" closeOnEscape="true"
                             message="#{lab.LC_PFV_text29}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cleanEnteteVente()}" oncomplete="dlgCleanEntete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanEntete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanVente" closeOnEscape="true"
                             message="#{lab.LC_PFV_text28}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cleanVente()}" oncomplete="dlgCleanVente.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanVente.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanVenteDate" closeOnEscape="true"
                             message="#{lab.LC_PFV_text28}" header="#{lab.L_confirmation}">
                <p:calendar value="#{managedFactureVenteV2.dateClean}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cleanVenteByDate()}" oncomplete="dlgCleanVente.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanVenteDate.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmPaye" closeOnEscape="true"
                             message="#{lab.LC_PFV_text27}" header="#{lab.L_confirmation}">
                <div >
                    <span>Mémoriser mon choix pour cette session</span>
                    <p:selectBooleanCheckbox value="#{managedReglementVente.needConfirmation}" />
                </div>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedReglementVente.reglerPieceTresorerie(true)}" oncomplete="dlgConfirmPaye.hide();" 
                                 update=":form-reglement_vente:data_mensualite_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmPaye.hide()"/>                
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmGenereBL" closeOnEscape="true"
                             message="#{lab.LC_PFV_text26}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.genereLivraison()}" oncomplete="dlgConfirmGenereBL.hide();" />
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmGenereBL.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuleDoc" closeOnEscape="true"
                             message="#{lab.LC_PFV_text25}" header="#{lab.L_confirmation}">
                <p:commandButton type="button" value="#{lab.L_oui}" onclick="dglMotifCancelEtape.show();
                        dlgConfirmAnnuleDoc.hide()" />
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnuleDoc.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnulerDoc" closeOnEscape="true"
                             message="#{lab.LC_PFV_text25}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelEtapeFacture(false, false, false)}" oncomplete="dlgConfirmAnnulerDoc.hide()" 
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnulerDoc.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnulePiece" closeOnEscape="true"
                             message="#{lab.LC_PFV_text24}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.openConfirmPaiement()}" oncomplete="dlgConfirmAnnulePiece.hide()" 
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :form-reglement_vente:data_mensualite_facture_vente"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnulePiece.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabiliseDoc" message="#{lab.LC_PFV_text22}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.comptabiliserVente(managedFactureVenteV2.selectDoc)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :form-data_facture:data_facture_vente :form-reglement_vente:data_mensualite_facture_vente" oncomplete="dlgComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabiliseDoc.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabiliseDoc" message="#{lab.LC_PFV_text20}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.unComptabiliserVente(managedFactureVenteV2.selectDoc, true)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :form-data_facture:data_facture_vente :form-reglement_vente:data_mensualite_facture_vente" oncomplete="dlgUnComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabiliseDoc.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabilisePiece" message="#{lab.LC_PFV_text19}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.comptabiliserCaisseVente(managedFactureVenteV2.selectReglement, true)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :form-reglement_vente:data_mensualite_facture_vente" oncomplete="dlgComptabilisePiece.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabilisePiece.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabilisePiece" message="#{lab.LC_PFV_text18}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.unComptabiliserCaisseVente(managedFactureVenteV2.selectReglement, true)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :form-reglement_vente:data_mensualite_facture_vente" oncomplete="dlgUnComptabilisePiece.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabilisePiece.hide()" />
            </p:confirmDialog>
        </h:form>        
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_facture_vente">    
            <h:inputHidden id="input_hide_facture_vente" value="#{managedFactureVenteV2.tabIds}"/>
            <div class="part_fix">
                <p:commandButton id="cancel_facture_vente" actionListener="#{managedFactureVenteV2.resetFiche()}" style="background: #FFF!important; "
                                 icon="ui-icon-circle-plus" update="fcs_article_facture_vente" title="#{lab.LC_PFV_nouvelle_facture}" value="#{lab.L_nouveau}"
                                 oncomplete="slideZoneOnClick(null, 'zone_fv_net_a_payer')"/>
                <h:panelGroup>
                    <p:commandButton actionListener="#{managedFactureVenteV2.parcoursInAllResult(false)}" update="txt_parc_linear_facture_vente"  icon="ui-icon-circle-triangle-w"/>
                    <h:inputText value="#{managedFactureVenteV2.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_facture_vente"/>
                    <p:outputPanel autoUpdate="true">                        
                        <p:outputLabel value="/#{managedFactureVenteV2.p_contenu.listeIds.size()}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedFactureVenteV2.parcoursInAllResult(true)}" update="txt_parc_linear_facture_vente"  icon="ui-icon-circle-triangle-e"/>
                </h:panelGroup> 
                <div style="float: right">
                    <h:panelGroup>  
                        <h:panelGrid id="blog_btn_action_facture" columns="6" cellpadding="0" cellspacing="0"> 
                            <h:inputText id="value_date_entete_fv" value="#{managedFactureVenteV2.docVente.enteteDoc.dateEntete}" title="#{lab.LC_PFV_cliquer_ouvrir_infos_journal}"
                                         converter="DATE" style="width: 80px;text-align: center;height:32px" readonly="true"/>
                            <h:panelGroup>                                
                                <p:commandButton icon="ui-icon-print" value="#{lab.L_telecharger}" actionListener="#{managedFactureVenteV2.print(managedFactureVenteV2.selectDoc)}"
                                                 title="#{lab.LC_PFV_telecharger_facture}" rendered="#{managedFactureVenteV2.docVente.id gt 0}" oncomplete="openPrintDialog()" id="btn-open_print"/>     
                                <p:contextMenu for="btn-open_print">
                                    <p:menuitem icon="ui-icon-print" value="#{lab.LC_PFV_imprimer_ticket}" global="false" rendered="false"
                                                title="#{lab.LC_PFV_telecharger_ticket_vente}" onclick="print('D:\\Documents\\CV dowes 2003.pdf');"/> 
                                    <p:menuitem icon="ui-icon-print" value="#{lab.LC_PFV_telecharger_ticket}" actionListener="#{managedFactureVenteV2.printTicket(managedFactureVenteV2.selectDoc)}"
                                                title="#{lab.LC_PFV_telecharger_ticket_vente}" oncomplete="openPrintDialog()"/> 
                                </p:contextMenu>
                            </h:panelGroup>
                            <p:splitButton value="#{lab.L_options}" icon="ui-icon-grip-solid-vertical" id="btn_action-fv">
                                <p:menuitem value="#{lab.LC_PFV_reglements}" icon="ui-icon-circle-triangle-e" title="#{lab.LC_PFV_liste_reglements_facture}"
                                            actionListener="#{managedFactureVenteV2.openDlgReglement()}" oncomplete="dlgReglementFv.show()" 
                                            id="btn-open_reglement" disabled="#{managedFactureVenteV2.docVente.id le 0}"/>
                                <p:separator />
                                <p:menuitem value="#{lab.LC_PFV_livraisons} " icon="ui-icon-circle-triangle-e" title="#{lab.LC_PFV_bons_livraisons_autres}" 
                                            actionListener="#{managedFactureVenteV2.openDlgLivraison()}" oncomplete="dlgDocumentsFv.show()" 
                                            id="btn-open_livraison" disabled="#{managedFactureVenteV2.docVente.id le 0}"/>  
                                <p:separator />
                                <p:menuitem value="#{lab.LC_PFV_couts_services}  (#{managedFactureVenteV2.docVente.nbreCout})" icon="ui-icon-circle-triangle-e" actionListener="#{managedFactureVenteV2.openDlgReglement()}" 
                                            oncomplete="dlgReglementFv.show()" id="btn-open_service"/>
                                <p:menuitem value="#{lab.LC_PCV_commissions} (#{managedFactureVenteV2.docVente.nbreCommerciaux})" icon="ui-icon-circle-triangle-e" title="#{lab.LC_PFV_liste_commerciaux_facture}" 
                                            actionListener="#{managedFactureVenteV2.openDlgCommerciaux()}" oncomplete="dlgCommerciauxFv.show()" id="btn-open_commercial"/>
                                <p:menuitem value="#{lab.LC_PFV_autre_documents} (#{managedFactureVenteV2.docVente.nbreDocLie})" icon="ui-icon-circle-triangle-e" title="#{lab.LC_PFV_autre_documents_lies}" 
                                            actionListener="#{managedFactureVenteV2.openDlgDocument()}" oncomplete="dlgDocumentsFv.show()" id="btn-open_document"/>
                                <p:separator />
                                <p:menuitem value="#{!managedFactureVenteV2.docVente.comptabilise?'Comptabiliser':'Annuler Comptabilité'}" actionListener="#{managedFactureVente.setSelectDoc(bon)}" 
                                            oncomplete="#{!managedFactureVenteV2.docVente.comptabilise?'dlgComptabiliseDoc.show()':'dlgUnComptabiliseDoc.show()'}" icon="ui-icon-arrowthick-2-e-w" 
                                            rendered="#{managedFactureVenteV2.docVente.statut == constantes.ETAT_VALIDE}"/> 
                                <p:menuitem icon="ui-icon-pin-s" value="Lettrer la facture" actionListener="#{managedFactureVenteV2.lettrer(bon)}" rendered="#{managedFactureVenteV2.docVente.comptabilise}"/>
                                <p:separator />
                                <p:menuitem value="#{lab.LC_PFV_factures}" icon="ui-icon-note" title="Liste de mes factures" update=":form-data_facture:data_facture_vente"
                                            actionListener="#{managedFactureVenteV2.openDlgFactures(false)}" oncomplete="dlgFacturesFv.show()" id="btn-open_facture"/>
                                <p:menuitem value="#{lab.LC_PFV_listing}" icon="ui-icon-note" title="Liste de mes factures" update=":form-data_facture:data_facture_vente"
                                            actionListener="#{managedFactureVenteV2.openDlgFactures(true)}" oncomplete="dlgFacturesFv.show()" />                                   
                                <p:separator />

                                <p:menuitem icon="ui-icon-trash" value="#{lab.L_supprimer}" global="false"
                                            oncomplete="dlgConfirmDelete.show()"/>                                
                            </p:splitButton>
                        </h:panelGrid>
                        <p:overlayPanel for="value_date_entete_fv" style="color: white;background: #CCC;width: 350px">
                            <h:panelGrid id="save_entete_facture_vente" columns="2" style="margin: auto;font-size: 0.8em;width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">                                                     
                                <h:outputText value="#{lab.L_point_vente}"/> 
                                <h:panelGroup id="select_point2">
                                    <h:inputText value="#{managedFactureVenteV2.docVente.enteteDoc.point.libelle}" style="color: #{managedFactureVenteV2.docVente.enteteDoc.point.error?'red':''}">
                                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.searchPointVente()}" update="select_point2 txt_zone_client select_vendeur"/>                                                
                                    </h:inputText>
                                    <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PFV_liste_point_vente}" 
                                                     onclick="dlgListPointVente.show()" type="button"/> 
                                </h:panelGroup>
                                <h:outputText value="#{lab.L_date}"/>   
                                <p:calendar value="#{managedFactureVenteV2.docVente.enteteDoc.dateEntete}" navigator="true" pattern="dd-MM-yyyy" size="10" disabled="#{managedFactureVenteV2.docVente.enteteDoc.id gt 0}" style="text-align: center!important">
                                    <p:ajax event="dateSelect" global="false" listener="#{managedFactureVenteV2.chooseDate()}" update="infos_document_facture_vente value_date_entete_fv"/>
                                </p:calendar>                                    
                                <h:outputText value="#{lab.LC_PFV_vendeur}"/> 
                                <h:selectOneMenu value="#{managedFactureVenteV2.docVente.enteteDoc.crenauHoraire.personnel.id}" id="select_vendeur" style="max-width: 180px">
                                    <f:selectItem itemValue="#{0}" itemLabel="" />
                                    <f:selectItems value="#{managedFactureVenteV2.vendeurs}" var="ivend" itemValue="#{ivend.id}" itemLabel="#{ivend.nomUsers}" />
                                    <p:ajax event="valueChange" global="false" />
                                </h:selectOneMenu>
                                <f:facet name="footer">
                                    <h:panelGroup style="float: left;margin-top: 5px">
                                        <p:commandLink title="#{lab.LC_PCV_reinitialiser_entete_journal_vente}" onclick="dlgResetEntete.show()" global="false" rendered="#{accesRessource.fv_update_header}"
                                                       style="border: 2px solid black; border-radius: 5px;padding: 3px;background: white;font-style: normal">
                                            <span><h:graphicImage library="icones" name="kedit.png" width="15" height="15"/>Nouveau</span>    
                                        </p:commandLink>
                                        <p:commandLink id="btnMontantsEntete" global="false" title="#{lab.LC_PFV_montants}" 
                                                       style="border: 2px solid black; border-radius: 5px;padding: 3px;background: white;margin-left: 5px">
                                            <span><h:graphicImage library="icones" name="ico_facture2.png" width="15" height="15"/>Details</span>   
                                        </p:commandLink>
                                    </h:panelGroup>                                
                                </f:facet>
                            </h:panelGrid>
                        </p:overlayPanel>                                               
                    </h:panelGroup> 
                </div>
            </div>
            <div class="part_scroll">
                <p:outputPanel id="blog_form_facture_vente" style="width: 99%; margin: auto;">
                    <div style="background: #ccc; padding: 3px; height: 22px">
                        <p:outputPanel id="grp_btn_etat_facture_vente" style="float: left" >
                            <h:panelGroup rendered="#{managedFactureVenteV2.docVente.update}">
                                <p:outputPanel styleClass="yvs_form_of" style="float:left; margin-right: 10px; font-size: 0.8em">
                                    <p:commandLink value="#{(managedFactureVenteV2.docVente.statutRegle == constantes.ETAT_REGLE)?'Réglé':(managedFactureVenteV2.docVente.statutRegle == constantes.ETAT_ENCOURS)?'En cours':'En attente'}" styleClass="button-stateOF #{(true)?'button-stateOF_actif':''}" 
                                                   disabled="true"/>
                                    <p:commandLink value="#{(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE)?'Livré':'Générer un BL'} #{(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_ENCOURS)?'(P)':(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE)?'':'(E)'}" styleClass="button-stateOF #{(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE)?'button-stateOF_actif':''}" 
                                                   disabled="#{!(managedFactureVenteV2.docVente.statut == constantes.ETAT_VALIDE) or managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE}" 
                                                   onclick="dlgConfirmSoumis.show()" type="button"
                                                   update="grp_btn_etat_facture_vente" global="false"/>
                                </p:outputPanel>
                                <h:panelGroup id="blog_choose_commande_fv" 
                                              style="font-size: 0.8em; background: #FFF; color: #000; border: 1px solid #045491; padding: 1px; margin-right: 5px">
                                    #{managedFactureVenteV2.docVente.id}
                                </h:panelGroup>
                            </h:panelGroup>
                        </p:outputPanel>
                        <h:panelGrid style="float: right; background: white; font-size: 0.9em;" columns="2" cellpadding="0" cellspacing="0"> 
                            <p:outputPanel id="etapes_valide_facture_vente" styleClass="yvs_form_of" style="float: right">                                              
                                <ui:repeat value="#{managedFactureVenteV2.docVente.etapesValidations}" var="etapeM" 
                                           rendered="#{managedFactureVenteV2.docVente.update}">
                                    <p:contextMenu for="etape_valide_facture_vente" style="font-size: 0.7em" 
                                                   rendered="#{etapeM.etapeValid or etapeM.motif != null}">
                                        <p:menuitem icon="ui-icon-newwin" value="#{lab.LC_PFA_proprietes}" title="#{lab.LC_PA_voir_proprietes_validations}"
                                                    oncomplete="dlgppteValid.show()" rendered="#{etapeM.etapeValid}"
                                                    update=":form_ppte_valid_fv:table_ppte_valid_fv"/>
                                        <p:menuitem icon="ui-icon-clipboard" value="#{lab.LC_PA_motif_annulation}" title="#{lab.LC_PA_voir_motif_annulation}" oncomplete="dglMotifCancelEtape.show()" rendered="#{etapeM.motif != null}"
                                                    update=":main-motif_etape_vente:value_motif_etape_vente" actionListener="#{managedFactureVenteV2.motifEtapeFacture(etapeM.motif, true)}"/>
                                        <p:separator rendered="#{etapeM.etapeValid}"/>
                                        <p:menuitem icon="ui-icon-circle-arrow-w" value="#{lab.LC_PFV_annuler}" rendered="#{etapeM.etapeValid}"
                                                    update=":main-motif_etape_vente:value_motif_etape_vente" actionListener="#{managedFactureVenteV2.annulEtapeFacture(etapeM, false)}"/>
                                    </p:contextMenu>
                                    <p:commandLink id="etape_valide_facture_vente" value="#{etapeM.etape.labelStatut}" disabled="#{(!etapeM.etapeActive or etapeM.etapeValid)}" title="#{etapeM.etape.titreEtape}" 
                                                   update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :form-data_facture:data_facture_vente :main_facture_vente:data_contenu_facture_vente"
                                                   styleClass="#{(etapeM.etapeValid)?'statut_valide':'etat_formation_true'}" actionListener="#{managedFactureVenteV2.validEtapeFacture(etapeM)}"/>                        
                                    <h:outputText value=" A " rendered="#{!etapeM.etapeValid and etapeM.motif ne null}" title="#{lab.LC_PFV_annulee_pour} : #{etapeM.motif}" style="position: relative;left: -10px; top: 5px; font-size: 0.7em; color: #FFF; background: red; border-radius: 5px;"/>
                                </ui:repeat>                                            
                                <h:panelGroup style="float: right" rendered="#{managedFactureVenteV2.docVente.update}">
                                    <p:commandLink value="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_VALIDE)?'VALIDE':'VALIDER'}" 
                                                   rendered="#{managedFactureVenteV2.docVente.etapeTotal lt 1}" process="@this"  
                                                   disabled="#{!(managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)}" 
                                                   styleClass="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_VALIDE)?'statut_valide':'etat_formation_true'}"                                                           
                                                   actionListener="#{managedFactureVenteV2.validerFacture(false)}" update="grp_btn_etat_facture_vente etapes_valide_facture_vente"/>
                                    <p:commandLink value="#{managedFactureVenteV2.writeEtape(((managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)?'EN EDITION':'EDITABLE'), managedFactureVenteV2.docVente.firstEtape)}" 
                                                   onclick="dlgCancelV.show()" type="button"
                                                   disabled="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)}"
                                                   styleClass="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)?'statut_valide':'etat_formation_true'}"/>
                                    <p:commandLink value="#{managedFactureVenteV2.writeEtape((managedFactureVenteV2.docVente.comptabilise?'COMPTABILIS&Eacute;':'COMPTABILISER'), managedFactureVenteV2.docVente.firstEtape)}"
                                                   type="button" styleClass="#{managedFactureVenteV2.docVente.comptabilise?'statut_valide':'etat_formation_true'}"
                                                   onclick="dlgComptabiliseDoc.show()" rendered="#{managedFactureVenteV2.docVente.statut==constantes.STATUT_DOC_VALIDE and managedFactureVenteV2.docVente.typeDoc eq constantes.TYPE_FV}" 
                                                   id="btn_comptabilised_fv"/>
                                    <p:contextMenu for="btn_comptabilised_fv" style="font-size: 0.7em">
                                        <p:menuitem icon="ui-icon-circle-arrow-w" value="#{lab.LC_PFV_annuler}" onclick="dlgUnComptabiliseDoc.show()" disabled="#{!managedFactureVenteV2.docVente.comptabilise}" global="false"/>
                                    </p:contextMenu>
                                </h:panelGroup>
                            </p:outputPanel>                                                 
                        </h:panelGrid>
                    </div>
                    <div style="clear: both" />
                    <div id="tabview_facture_vente" class="block_slide" style="height: 245px">
                        <span class="block_slide_title" onclick="slideShow('tabview_facture_vente', 245)">
                            <span class="button_slide">[-]</span>
                            #{lab.LC_PFV_facture} <h:panelGroup id="txt_reference_document_facture_vente" style="display: #{managedFactureVenteV2.docVente.update?'inline':'none'}">[<h:outputText value="#{managedFactureVenteV2.docVente.numDoc}" style="font-weight: bold"/>]</h:panelGroup>
                            <div style="float: right;font-size: 0.9em;display: none" class="zone_title_infos">
                                <span>#{lab.LC_PFV_client} : </span>
                                <h:outputText value="#{managedFactureVenteV2.docVente.nomClient}" style="font-weight: bold"/>
                                <span style="margin-left: 30px">#{lab.L_ttc} :</span>
                                <h:panelGroup id="value_ttc_facture" >
                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantTotal}" converter="#{managedFactureVenteV2.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                    <span style="font-size: 0.8em">Fcfa</span>
                                </h:panelGroup> 
                                <span>; #{lab.LC_PFV_reste_a_payer} :</span>
                                <h:panelGroup id="value_reste_a_payer_facture" >
                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantResteApayer}" converter="#{managedFactureVenteV2.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                    <span style="font-size: 0.8em">Fcfa</span>
                                </h:panelGroup>
                            </div>
                        </span>
                        <div class="zone_slide">
                            <p:outputPanel style="width: 100%" id="form_facture_vente">
                                <div style="width: 69%;float: left">                                             
                                    <p:outputPanel id="infos_document_facture_vente" style="width: 100%">
                                        <p:outputPanel>
                                            <h:panelGrid id="infos_facture_vente" columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                                <f:facet name="header">
                                                    <h:panelGrid id="form_entete_facture_vente" columns="2" style="width: 100%;float:left;margin-bottom: -5px;margin-top:-2px" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">                                                        
                                                        <pe:timePicker value="#{managedFactureVenteV2.docVente.heureDoc}" disabled="#{managedFactureVenteV2.docVente.statut != constantes.ETAT_EDITABLE}" style="float: left;width: 80px"/>                                                        
                                                        <p:commandButton value="Enregistrer" id="save_facture_vente" actionListener="#{managedFactureVenteV2.saveNew()}" icon="ui-icon-disk" style="float: right"/>                                                                            
                                                    </h:panelGrid>
                                                </f:facet>
                                                <h:panelGroup>
                                                    <span>#{lab.LC_PFV_client} </span>       
                                                    <p:outputPanel autoUpdate="true" style="float: right;margin-top: -2px">
                                                        [<h:outputText value="#{managedFactureVenteV2.docVente.client.codeClient}" style="color: #003399"/>]
                                                    </p:outputPanel>
                                                </h:panelGroup>
                                                <h:panelGroup id="select_client_facture_vente">
                                                    <h:inputText value="#{managedFactureVenteV2.docVente.client.nom}" style="color: #{managedFactureVenteV2.docVente.client.error?'red':''}"
                                                                 disabled="#{managedFactureVenteV2.docVente.statut != constantes.ETAT_EDITABLE or managedFactureVenteV2.isBon}">
                                                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchClient()}" update="infos_facture_vente txt_zone_client"/>
                                                    </h:inputText>    
                                                    <h:inputText value="#{managedFactureVenteV2.docVente.nomClient}" style="margin-left: 5px"/>
                                                    <h:panelGroup style="float: right">
                                                        <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PPL_liste_client}" global="false"
                                                                         disabled="#{managedFactureVenteV2.docVente.statut != constantes.ETAT_EDITABLE or managedFactureVenteV2.isBon}"
                                                                         actionListener="#{managedFactureVenteV2.initClients()}" oncomplete="dlgListClients.show()"/> 
                                                    </h:panelGroup>
                                                </h:panelGroup> 
                                                <span title="#{lab.LC_PFV_categorie_comptable}">#{lab.LC_PFV_c_comptable} </span>
                                                <h:panelGroup id="select_categorie_comptable_facture_vente">
                                                    <h:inputText value="#{managedFactureVenteV2.docVente.categorieComptable.designation}" style="color: #{managedFactureVenteV2.docVente.categorieComptable.error?'red':''}">
                                                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchCategorie()}" update="blog_form_contenu_facture_vente"/>                                                
                                                    </h:inputText>
                                                    <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PFV_liste_categorie_comptable}" global="false"
                                                                     actionListener="#{managedFactureVenteV2.initCategories()}" oncomplete="dlgListCategorieVente.show()"/> 
                                                </h:panelGroup> 
                                                <span title="#{lab.LC_PFV_model_reglement}">#{lab.LC_PFV_m_reglement} </span>
                                                <h:panelGroup style="width: 100%">
                                                    <h:panelGroup id="select_model_facture_vente">
                                                        <h:inputText value="#{managedFactureVenteV2.docVente.modeReglement.designation}" style="color: #{managedFactureVenteV2.docVente.modeReglement.error?'red':''}">
                                                            <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchModelReglement()}" update="@this"/>                                                
                                                        </h:inputText>
                                                        <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PFV_liste_model_reglement}" global="false"
                                                                         actionListener="#{managedFactureVenteV2.initModelReglements()}" oncomplete="dlgListModels.show()"/> 
                                                    </h:panelGroup> 
                                                    <h:panelGroup style="float: right; font-size: 0.8em;margin-top: 4px" id="select_auto_facture_vente">
                                                        <p:selectBooleanCheckbox itemLabel="#{lab.LC_PFV_livrer} " value="#{managedFactureVenteV2.docVente.livraisonAuto}"/>
                                                        <p:spacer width="5"/>
                                                        <p:selectBooleanCheckbox itemLabel="#{lab.LC_PFV_regler}" value="#{managedFactureVenteV2.docVente.validationReglement}"/>
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <span>#{lab.LC_PFV_adresse}</span>
                                                <h:panelGroup id="txt_zone_client">
                                                    <h:selectOneMenu id="Adresse_fv" value="#{managedFactureVenteV2.docVente.adresse.id}" style="min-width: 150px">
                                                        <f:selectItem itemValue="0" itemLabel="" />
                                                        <f:selectItems value="#{managedFactureVenteV2.lieux}" var="ilieu" itemValue="#{ilieu.id}" itemLabel="#{ilieu.parent.libele} - #{ilieu.libele}" />
                                                        <p:ajax event="valueChange" global="false" />
                                                    </h:selectOneMenu>
                                                    <h:panelGroup style="float: right">
                                                        <span>#{lab.LC_PFV_telephone} : </span>
                                                        <h:inputText value="#{managedFactureVenteV2.docVente.telephone}" style="text-align: center">
                                                            <p:ajax event="valueChange" global="false"/>                                                
                                                        </h:inputText>
                                                    </h:panelGroup>
                                                </h:panelGroup> 
                                                <span title="#{lab.LC_PFV_depot_livraison_prevu}">#{lab.LC_PFV_depot_liv}</span>                                                    
                                                <h:panelGroup id="blog_depot_livraison_fv">
                                                    <h:panelGroup id="select_depot_liv_prevu">
                                                        <h:inputText value="#{managedFactureVenteV2.docVente.depot.designation}" style="color: #{managedFactureVenteV2.docVente.depot.error?'red':''}">
                                                            <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchDepot()}" update="blog_depot_livraison_fv"/>                                                
                                                        </h:inputText>
                                                        <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" 
                                                                         title="#{lab.LC_PA_liste_depots}" onclick="dlgListDepots.show()" type="button"/> 
                                                    </h:panelGroup>
                                                    <span>#{lab.L_le}</span>
                                                    <p:calendar title="#{lab.LC_PFV_date_livraison_prevu}" value="#{managedFactureVenteV2.docVente.dateLivraisonPrevu}" pattern="dd-MM-yyyy HH:mm:ss" size="15" >
                                                        <p:ajax event="dateSelect" global="false"/>
                                                    </p:calendar>
                                                    <h:panelGroup style="float: right;margin-top: 3px">
                                                        <span title="#{lab.LC_PFV_tranche_livraison_prevu}">#{lab.L_tranche} : </span>  
                                                        <h:inputText id="select_tranche_livraison_fv" value="#{managedFactureVenteV2.docVente.tranche.titre}" readonly="true"/> 
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <span>#{lab.LC_PRPF_reference_externe}</span>
                                                <h:inputText value="#{managedFactureVenteV2.docVente.numeroExterne}" style="width: 100%">
                                                    <p:ajax event="valueChange" global="false"/>                                                
                                                </h:inputText>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                        <p:overlayPanel for="btnMontantsEntete" hideEffect="fade" style="width: 35%;background: black;color: white">
                                            <p:outputPanel id="blog_form_montant_entete">
                                                <h:panelGrid columns="2" style="width: 100%;font-weight: bolder;margin-top: 5px;color: white">
                                                    <span>#{lab.LC_PFV_total_taxe}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantTaxe}" converter="DNS"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_ht}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantHT}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_remise_article}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantRemise}" converter="DNS"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_ttc}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantTTC}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_ristourne}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantRistourne}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_remise_facture}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantRemises}" converter="DNS" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_cout_suppl}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantCoutSup}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_facture}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantTotal}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_commande}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.avanceCommande}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #0099ff">#{lab.LC_PFV_total_avance}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantAvance}" converter="#{managedFactureVenteV2.converter}" style="color: #0099ff"/>
                                                        <span style="font-size: small;color: #0099ff"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #009999">#{lab.LC_PCV_net_a_payer}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantNetApayer}" converter="#{managedFactureVenteV2.converter}" style="color: #009999"/>
                                                        <span style="font-size: small;color: #009999"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #99ccff">#{lab.LC_PTBVs_versement_attendu}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.versementAttendu}" converter="#{managedFactureVenteV2.converter}" style="color: #99ccff"/>
                                                        <span style="font-size: small;color: #99ccff"> Fcfa</span>
                                                    </h:panelGroup>
                                                </h:panelGrid>
                                            </p:outputPanel>
                                        </p:overlayPanel>
                                        <p:overlayPanel for="btnTaxesFV" hideEffect="fade" style="width: 35%">
                                            <p:dataTable id="data_taxes_facture_vente" value="#{managedFactureVenteV2.taxes}" var="tx" rowKey="#{tx.id}">
                                                <p:column headerText="#{lab.L_taxe}" >
                                                    <span>#{tx.designation}</span>
                                                </p:column>
                                                <p:column headerText="#{lab.L_montant}" style="text-align: right;width: 35%">
                                                    <h:outputText value="#{tx.taux}" converter="DNS"/>
                                                    Fcfa
                                                </p:column>
                                            </p:dataTable>
                                        </p:overlayPanel>
                                    </p:outputPanel>
                                </div>
                                <div style="width: 31%;margin-left: 69%">
                                    <p:outputPanel id="blog_form_montant_doc_fv"> 
                                        <span class="button_slide" onclick="slideZoneOnClick('button_slide', 'zone_fv_net_a_payer')" style="float: left;cursor: pointer;width: 10px;font-size: 0.8em">
                                            [+]
                                        </span>
                                        <h:panelGroup id="chp_fv_net_a_payer" style="margin-left: 10px;float:right;width:95%">
                                            <div id="zone_fv_net_a_payer" style="border: none;height: 135px">
                                                <h:panelGrid columns="2" style="width: 100%" cellpadding="0" cellspacing="0">
                                                    <span style="font-size: small;">#{lab.LC_PFV_montant_taxe}</span>
                                                    <h:panelGroup style="float: right">
                                                        <p:commandLink id="btnTaxesFV" global="false">
                                                            <h:outputText value="#{managedFactureVenteV2.docVente.montantTaxe}" converter="DNS" style="color:black;font-weight: bolder"/>
                                                        </p:commandLink>
                                                        <span style="font-size: 0.8em"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="font-size: small;">#{lab.LC_PFV_montant_ht}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantHT}" converter="DNS" style=";font-weight: bolder"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="font-size: small;">#{lab.LC_PFV_montant_remise}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantRemise}" converter="DNS" style=";font-weight: bolder"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="font-size: small;">#{lab.LC_PFV_montant_ttc}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantTTC}" converter="#{managedFactureVenteV2.converter}" style=";font-weight: bolder"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="font-size: small;">#{lab.LC_PFV_montant_ristourne}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantRistourne}" converter="#{managedFactureVenteV2.converter}" style=";font-weight: bolder"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="font-size: small;">#{lab.LC_PFV_montant_remise_facture}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantRemises}" converter="DNS" style=";font-weight: bolder"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="font-size: small;">#{lab.LC_PFV_montant_couts_supp}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantCS}" converter="#{managedFactureVenteV2.converter}" style=";font-weight: bolder"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                </h:panelGrid>
                                            </div>
                                            <h:panelGrid columns="2" style="width: 100%" cellpadding="0" cellspacing="0">
                                                <span style="font-size: small;color: #0099ff">Net à payer</span>
                                                <h:panelGroup style="float: right">
                                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantTotal}" converter="#{managedFactureVenteV2.converter}" style="color: #0099ff;font-weight: bolder"/>
                                                    <span style="font-size: small;color: #0099ff"> Fcfa</span>
                                                </h:panelGroup>
                                                <span style="font-size: small;">#{lab.LC_PFV_montant_avancer}</span>
                                                <h:panelGroup style="float: right">
                                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantAvance}" converter="#{managedFactureVenteV2.converter}" style=";font-weight: bolder"/>
                                                    <span style="font-size: small"> Fcfa</span>
                                                </h:panelGroup>
                                                <span style="font-size: small;color: #009999">#{lab.LDB_PC_reste_a_payer}</span>
                                                <h:panelGroup style="float: right">
                                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantResteApayer}" converter="#{managedFactureVenteV2.converter}" style="color: #009999;font-weight: bolder"/>
                                                    <span style="font-size: small;color: #009999"> Fcfa</span>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </h:panelGroup>
                                    </p:outputPanel>
                                </div>
                            </p:outputPanel>                            
                        </div>                        
                    </div>
                    <div style="clear: both"/>
                    <p:focus id="fcs_article_facture_vente" for="txt_article_facture_vente"/>
                    <p:focus id="fcs_prix_vente_facture_vente" for="txt_prix_vente_facture_vente"/>
                    <p:outputPanel id="blog_form_contenu_facture_vente">
                        <h:panelGrid id="form_contenu_facture_vente"  styleClass="yvs_nostyle" style="font-size: 0.9em" cellpadding="0" cellspacing="0"
                                     columns="6" >  
                            <f:facet name="header">
                                <h:panelGrid columns="1" id="desc_article_facture_vente" style="background: #fff; width: 100%;font-size: 1em">
                                    <h:panelGroup style="font-size: 0.8em" rendered="#{managedFactureVenteV2.selectArt}">
                                        <h:panelGroup style="float: left">
                                            <span style="font-weight: bold;color: #000">#{managedFactureVenteV2.contenu.article.designation}</span>
                                            <span> : #{lab.LC_PFV_prix_minimum} = </span>
                                            <h:outputText value="#{managedFactureVenteV2.contenu.prixMin}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold;color: #000"/>
                                            <span> ; #{lab.LC_PFV_prix_recommander} = </span>
                                            <h:outputText value="#{managedFactureVenteV2.contenu.article.puv}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold;color: #000"/>
                                        </h:panelGroup>
                                        <h:panelGroup style="float: right;margin-left: 5px">
                                            <span>avec </span>
                                            <h:outputText value="#{managedFactureVenteV2.contenu.article.stock}" converter="#{managedFactureVenteV2.converterStock}" style="font-weight: bold;color: #000"/>
                                            <h:outputText value=" #{managedFactureVenteV2.contenu.conditionnement.unite.reference}"/>
                                            <span> #{lab.LC_PFV_en_stock} </span>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </f:facet>
                            <h:outputText value="#{lab.L_article}"/>
                            <h:outputText value="#{lab.L_unite}" rendered="#{composantsVisible.fv_conditionnement}"  />
                            <h:outputText value="#{lab.L_quantite}" />
                            <h:outputText value="#{lab.L_prix}"/>
                            <h:outputText value="#{lab.L_total}"/>
                            <span>&nbsp;</span>
                            <h:panelGroup id="blog_article_facture_vente">
                                <h:panelGroup rendered="#{!managedFactureVenteV2.isBon}">
                                    <h:inputText id="txt_article_facture_vente" value="#{managedFactureVenteV2.contenu.article.refArt}" style="color: #{managedFactureVenteV2.contenu.article.error?'red':''};width: 80%" disabled="#{managedFactureVenteV2.contenu.update}" tabindex="10">
                                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.searchArticle(false)}" update=":main_facture_vente:form_contenu_facture_vente"/>
                                    </h:inputText>    
                                    <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="#{lab.LC_PFV_liste_articles}"
                                                     onclick="dlgListArticle.show()" disabled="#{managedFactureVenteV2.contenu.update}" type="button"/>
                                </h:panelGroup> 
                                <h:inputText value="#{managedFactureVenteV2.contenu.article.designation}" readonly="true" rendered="#{managedFactureVenteV2.isBon}"
                                             ondblclick="dlgListContenuBon.show()" style="width: 95%"/>
                            </h:panelGroup> 
                            <h:selectOneMenu value="#{managedFactureVenteV2.contenu.conditionnement.id}" style="min-width: 120px" title="#{lab.LC_PRA_selectionner_conditionnement}" tabindex="15"
                                             rendered="#{composantsVisible.fv_conditionnement}" disabled="#{!composantsEditable.fv_conditionnement}" id="txt_cond_vente">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedFactureVenteV2.contenu.article.conditionnements}" var="un" 
                                               itemLabel="#{un.unite.reference}" itemValue="#{un.id}"/>
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseConditionnement(false)}" update="desc_article_facture_vente txt_prix_vente_facture_vente txt_prix_total_facture_vente"/>
                            </h:selectOneMenu>
                            <h:inputText value="#{managedFactureVenteV2.contenu.quantite}" style="max-width: 100px;text-align: right" readonly="#{managedFactureVenteV2.isBon}" converter="#{managedFactureVenteV2.converterStock}" tabindex="20">
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onQuantiteBlur()}" 
                                        update="txt_prix_total_facture_vente txt_prix_vente_facture_vente fcs_prix_vente_facture_vente txt_cond_vente"/>
                            </h:inputText>
                            <h:panelGroup id="txt_prix_vente_facture_vente"> 
                                <h:inputText value="#{managedFactureVenteV2.contenu.prix}" style="max-width: 120px;text-align: right" readonly="#{!managedFactureVenteV2.contenu.article.changePrix}" converter="#{managedFactureVenteV2.converter}"  tabindex="30"
                                             title="#{lab.LC_PFV_rabais} : #{managedFactureVenteV2.contenu.rabais} Fcfa">
                                    <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onPrixBlur()}" update="txt_prix_total_facture_vente txt_cond_vente"/>
                                </h:inputText>
                                <span> Fcfa</span>
                            </h:panelGroup>  
                            <h:panelGroup id="txt_prix_total_facture_vente">
                                <h:inputText value="#{managedFactureVenteV2.contenu.prixTotal}" style="text-align: right" readonly="true" converter="#{managedFactureVenteV2.converter}"/>
                                <span> Fcfa</span>
                            </h:panelGroup>
                            <h:outputText value="#{lab.LC_PRPF_depots}" rendered="#{composantsVisible.fv_depot_content}"/>
                            <h:selectOneMenu value="#{managedFactureVenteV2.contenu.depoLivraisonPrevu.id}" style="min-width: 120px"
                                             rendered="#{composantsVisible.fv_depot_content}">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedFactureVenteV2.depotsLivraison}" var="dpl_" itemLabel="#{dpl_.designation}" itemValue="#{dpl_.id}" />  
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseDepot()}" />                              
                            </h:selectOneMenu> 
                            <p:commandButton value="#{lab.LC_PFV_ajouter_contenu}" id="save_contenu_facture_vente" icon="ui-icon-circle-plus" style="float: right" tabindex="40"
                                             oncomplete="closeShowAction('tabview_facture_vente', 245)"
                                             update="blog_form_contenu_facture_vente fcs_article_facture_vente" 
                                             actionListener="#{managedFactureVenteV2.saveNewContenu(false)}"/>                                      
                        </h:panelGrid>
                        <p:outputPanel>
                            <h:inputHidden id="input_hide_contenu_facture_vente" value="#{managedFactureVenteV2.tabIds_contenu}"/>
                            <p:dataTable id="data_contenu_facture_vente" value="#{managedFactureVenteV2.docVente.contenus}" var="artf" rowKey="#{artf.id}" 
                                         rowIndexVar="artfIdx" selection="#{managedLivraisonVente.selectContenus}">
                                <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewContenu}" update=":main_facture_vente:form_contenu_facture_vente"
                                        />
                                <p:ajax event="rowUnselect" global="false" listener="#{managedFactureVenteV2.unLoadOnViewContenu}" update=":main_facture_vente:form_contenu_facture_vente"/>
                                <p:column headerText="N°" style="width: 5%;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{artf.new_}"/>
                                    <span title="#{lab.LDB_PC_compte} : #{artf.compte.numCompte}">#{artfIdx+1}</span>                  
                                    <h:panelGroup style="float: right">                                      
                                        <h:graphicImage library="img" name="danger.png" rendered="#{artf.errorComptabilise}" width="23" height="23" title="#{artf.messageError}"/>
                                        <h:graphicImage library="img" name="comment.png" width="15" height="15" rendered="#{artf.onComment}" title="#{lab.LDB_PC_a_ete_commente}"/>
                                    </h:panelGroup>
                                </p:column>
                                <p:column headerText="#{lab.L_article}" style="color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    [<span style="font-weight: bold" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artf.article.refArt}</span>]
                                    <span title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artf.article.designation}</span>
                                    <h:outputText title="#{lab.LC_PCV_facture_consignee}" value="C" rendered="#{artf.idReservation ne null}"
                                                  style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 1px;background: black;color: white; float: right"/>
                                </p:column>
                                <p:column headerText="#{lab.L_qte}" style="width: 8%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.quantite}" title="#{lab.LC_PFV_plus} #{artf.quantiteBonus} #{lab.L_bonus}"/>
                                    <span title="#{artf.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{artf.conditionnement.unite.reference}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_bonus}" style="width: 8%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.quantiteBonus}" title="#{lab.LC_PFV_sur_article} #{artf.articleBonus.designation}"/>
                                    <span title="#{artf.conditionnementBonus.unite.libelle}" style="font-size: 0.6em;color: #003399; display: #{(artf.quantiteBonus gt 0)?'inline':'none'}">#{artf.conditionnementBonus.unite.reference}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_prix}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.prix}" converter="#{managedFactureVenteV2.converter}" title="#{artf.etat()=='R'?'Le prix de vente est inferieur au prix minimal':(artf.etat()=='P'?'Le prix de vente est inferieur au prix de revient':'Numéro Serie : '.concat(artf.numSerie))}"/>
                                </p:column>
                                <p:column headerText="Rem" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.remise}" converter="DNS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                </p:column>
                                <p:column headerText="#{lab.LC_PFV_rabais}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.quantite*artf.rabais}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PCV_numero_serie}: #{artf.numSerie}"/>
                                </p:column>
                                <p:column headerText="Rist." style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.ristourne}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PFV_ristourne}"/>
                                </p:column>
                                <p:column headerText="#{lab.L_taxe}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.taxe}" converter="DNS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                </p:column>
                                <p:column headerText="#{lab.L_total}" style="width: 12%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                    <h:outputText value="#{artf.prixTotal}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PCV_numero_serie}: #{artf.numSerie}"/>
                                </p:column>
                                <p:column style="width: 5%;text-align: center">
                                    <f:facet name="header">
                                        <p:contextMenu for="btn_option_head_contenu_facture_vente" event="left click" style="font-size: 0.8em;width: 220px">
                                            <p:menuitem value="#{lab.LC_PFV_verifier_comptabilite}" icon="ui-icon-lightbulb" actionListener="#{managedFactureVenteV2.findContenusErrorComptabilite()}" update="data_contenu_facture_vente"/>
                                            <p:menuitem id="menu-search_contenu_fv" value="Recherche" icon="ui-icon-search" global="false"/>
                                            <p:menuitem value="#{lab.LC_PFV_depot}" icon="ui-icon-person" global="false" actionListener="#{managedLivraisonVente.beginLivraison(managedFactureVenteV2.selectDoc, null, true)}"
                                                        oncomplete="dlgChangeDepot.show()" update=":main_change_depot_contenu:form_change_depot_contenu"/>
                                        </p:contextMenu>
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_head_contenu_facture_vente" type="button"/>
                                        <p:overlayPanel for="menu-search_contenu_fv" hideEffect="fade" style="width: 200px;background: black;color: white">
                                            <h:inputText value="#{managedFactureVenteV2.articleContenu}" style="width:100%">
                                                <p:ajax event="blur" listener="#{managedFactureVenteV2.findContenusByArticle()}" update="data_contenu_facture_vente"/>
                                            </h:inputText>
                                        </p:overlayPanel>
                                    </f:facet>
                                    <p:contextMenu for="btn_option_contenu_facture_vente" event="left click" style="font-size: 0.8em;width: 220px">
                                        <p:menuitem value="#{lab.LC_PCV_voir_detail}" icon="ui-icon-search" global="false" actionListener="#{managedFactureVenteV2.initInfosContenu(artf)}" oncomplete="dlgInfosContenu.show()"/>
                                        <p:menuitem value="#{artf.idReservation ne null?'Annuler la consigne':'Consigner le stock'}" icon="#{artf.idReservation ne null?'ui-icon-pin-w':'ui-icon-pin-s'}" 
                                                    global="false" actionListener="#{managedFactureVenteV2.consignerContent(artf)}" update="data_contenu_facture_vente :form-data_facture:data_facture_vente"/>
                                        <p:separator style="width: 98%;margin: auto"/>
                                        <p:menuitem value="#{lab.LC_PFV_rabais}" icon="ui-icon-suitcase" global="false" actionListener="#{managedFactureVenteV2.addRabaisContenu(artf)}" oncomplete="dlgAddRabais.show()"/>
                                        <p:menuitem value="#{lab.L_remise}" icon="ui-icon-suitcase" global="false" actionListener="#{managedFactureVenteV2.addRemiseContenu(artf)}" oncomplete="dlgAddRemise.show()"/>                                                            
                                        <p:menuitem value="#{lab.L_bonus}" icon="ui-icon-suitcase" global="false" actionListener="#{managedFactureVenteV2.addBonusContenu(artf)}" oncomplete="dlgAddBonus.show()"/>
                                        <p:menuitem value="#{lab.LC_PCV_voir_taxes}" icon="ui-icon-copy" global="false" actionListener="#{managedFactureVenteV2.loadTaxesVente(artf)}" oncomplete="dlgListTaxesContenu.show()"/>
                                        <p:separator style="width: 98%;margin: auto"/>
                                        <p:menuitem value="#{lab.LC_PFV_depot}" icon="ui-icon-person" global="false" actionListener="#{managedLivraisonVente.beginLivraison(artf, true)}"
                                                    oncomplete="dlgChangeDepot.show()" update=":main_change_depot_contenu:form_change_depot_contenu"/>
                                        <p:menuitem value="#{lab.LC_PFV_envoyer_livraison}" icon="ui-icon-transferthick-e-w" actionListener="#{managedLivraisonVente.loadLivraisonByClient(artf,managedFactureVenteV2.docVente.dateLivraisonPrevu)}"
                                                    update=":main_livraison_fv:data_livraison_content" rendered="false"/>
                                        <p:menuitem value="#{lab.LC_PFA_generer_livraison}" icon="ui-icon-circle-plus" actionListener="#{managedLivraisonVente.generedLivraison(artf,managedFactureVenteV2.docVente.dateLivraisonPrevu)}"
                                                    update=":main_livraison_fv:form_defined_contenu"/>
                                        <p:separator style="width: 98%;margin: auto"/>
                                        <p:menuitem value="#{lab.LC_PCV_note}" icon="ui-icon-comment" global="false" actionListener="#{managedFactureVenteV2.addCommentaireContenu(artf)}" oncomplete="dlgAddCommentaire.show()"/>
                                        <p:menuitem value="#{lab.LC_PRA_numero_serie}" icon="ui-icon-info" global="false" actionListener="#{managedFactureVenteV2.addNumSerieContenu(artf)}" oncomplete="dlgAddNumSerie.show()"/>
                                        <p:separator style="width: 98%;margin: auto"/>
                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanContenu_(artf)}" oncomplete="dlgConfirmDeleteArticle_.show()"/>
                                    </p:contextMenu>                           
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_contenu_facture_vente" type="button"/>
                                </p:column> 
                                <p:column selectionMode="multiple" style="width:16px;text-align:center"/>
                            </p:dataTable>
                        </p:outputPanel>
                    </p:outputPanel>                     
                </p:outputPanel>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">          
            <div class="zone_find">
                <div class="display_auteur" align="right"  style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedFactureVenteV2.selectDoc.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedFactureVenteV2.selectDoc.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedFactureVenteV2.selectDoc.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
