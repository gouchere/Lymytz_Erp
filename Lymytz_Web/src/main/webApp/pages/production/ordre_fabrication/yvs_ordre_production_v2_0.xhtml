<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui" 
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Ordres de fabrication','modProduction', 'smenOfSuivi2', true)}
    </ui:define>                                    
    <ui:define name="contents">    
        #{managedReconditionnement.doNothing()}
        #{managedOrdresF.setTypePage(constantes.PROD_TYPE_PAGE_CLASSIQUE)}
        #{managedTransfertStock.doNothing(null)}
        #{managedDepot.loadAllDepotActif(true)}
        #{managedLotReception.loadAllLots()}
        #{managedPosteCharge.loadAll()}
        #{managedConditionnement.doNothing()}
        #{managedEquipeProduction.loadAllEquipeProduction()}       
        #{managedTypeCreneau.loadAllTrancheProduction()}                                                                                                                 
        #{managedSiteProduction.loadAll()}          
        <script type="text/javascript">
            $(function() {
//                alert($('body').height()+" "+$('.part_scroll').height()+" "+$('#top').height()+" "+$('.zone_find').height())
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('of');
                collapseForm('conditionnement');
                loadAll();
            });
        </script>


        <!-->
        *****************************************************************************
        Boite de dialogue plus options
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:remoteCommand name="loadAll" actionListener="#{managedOrdresF.loadAll('OF')}" oncomplete="collapseList('declaration')"/>
        </h:form>
        <h:form prependId="false">
            <p:dialog widgetVar="dlgVerifyAppro" modal="true" showHeader="false" footer="&copy;Lymytz 2015"
                      resizable="false" dynamic="true">
                <span>Vous devez valider tous vos Approvisionnement avant de continuer !</span>                    
                <div align="center">
                    <p:commandLink value="Aller aux approvisionnement? "  actionListener="#{managedOrdresF._onloadDIstantDocStock()}" ajax="false"/>
                </div>
                <br />
                <p:commandButton type="button" value="Ok" onclick="dlgVerifyAppro.hide()" style="float: left; margin-left: 40%"/>
            </p:dialog>
        </h:form>
        <h:form prependId="false" >
            <p:dialog header="Composants" widgetVar="dlgComposantNom" height="250" width="40%">
                <p:dataTable value="#{managedOrdresF.program.nomenclature.composants}" var="comp_n" rowKey="#{comp_n.id}" rowIndexVar="idx"
                             selectionMode="single"  id="data_composant_nom_of" style="font-size: 0.9em"
                             editable="true" editMode="cell">
                    <p:ajax event="cellEdit" listener="#{managedOrdresF.changeQuantiteMp}"  />
                    <p:column headerText="N°" width="15">
                        <span>#{idx+1}</span>
                    </p:column>
                    <p:column width="100" headerText="Référence">
                        <span >#{comp_n.article.refArt}</span>
                    </p:column>
                    <p:column headerText="Désignation">
                        <span >#{comp_n.article.designation}</span>
                    </p:column>                    
                    <p:column headerText="quantite" width="80" style="text-align: right">
                        <p:cellEditor>
                            <f:facet name="output">
                                <h:outputText value="#{comp_n.quantite}" converter="DNS"/>
                            </f:facet>
                            <f:facet name="input">
                                <h:inputText  value="#{comp_n.quantite}" style="width:70%"/>
                            </f:facet>
                        </p:cellEditor>                       
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.L_plus_option}" width="40%"  closeOnEscape="true" widgetVar="dlgPlusOptions" resizable="false"> 
                <h:panelGrid id="blog_plus_option_declaration" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">    
                    <h:outputText value="Ids"/>
                    <h:inputText value="#{managedOrdresF.idsDeclaration}" style="width: 100%" title="#{lab.LC_PFA_text3}">
                        <p:ajax event="valueChange" listener="#{managedOrdresF.addParamIdsDeclaration()}" oncomplete="collapseList('declaration')"/>
                    </h:inputText>                           
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_search_statuts">
            <p:dialog header="#{lab.LP_POF_statuts_of}" widgetVar="dlgStatut" footer="&copy;Lymytz 2014" width="15%">
                <h:selectOneMenu value="#{managedOrdresF.egaliteStatutOf}" 
                                 styleClass="input_min_medium">
                    <f:selectItem itemLabel="#{lab.LP_POF_inclus}" itemValue="IN"/>
                    <f:selectItem itemLabel="#{lab.LP_POF_exclus}" itemValue="NOT IN" />
                </h:selectOneMenu> 
                <p:selectManyMenu value="#{managedOrdresF.statutsOf}" showCheckbox="true" 
                                  id="select_statuts_of" styleClass="input_min_medium">
                    <f:selectItems value="#{managedOrdresF.allStatutsOf}" var="istat" itemValue="#{istat}" itemLabel="#{managedOrdresF.giveNameStatut(istat)}" />
                </p:selectManyMenu>
                <p:commandButton value="#{lab.L_appliquer}" icon="ui-icon-arrowthickstop-1-s" styleClass="input_large" actionListener="#{managedOrdresF.searchByStatutOF()}"/>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog header="#{lab.LP_POF_recalcul_flux}" widgetVar="dlgRecalcul" message="#{lab.LP_POF_text}"
                             >
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-check" actionListener="#{managedOrdresF.maintenanceAll()}" oncomplete="dlgRecalcul.hide()"
                                 update=":formulaire_mainOrdreF:tableOF"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-close" onclick="dlgRecalcul.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog header="#{lab.LP_POF_recalcul_couts_production}" widgetVar="dlgRecalculCout" message="#{lab.LP_POF_text1}"
                             >
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-check" actionListener="#{managedOrdresF.recalculCoutOF()}" oncomplete="dlgRecalculCout.hide()"
                                 update=":formulaire_mainOrdreF:tableOF"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-close" onclick="dlgRecalculCout.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false" >
            <p:dialog header="#{lab.LP_POF_reconditionnement}" width="25%" closeOnEscape="true" height="150"
                      resizable="true" widgetVar="dlgRecondQte">
                <div class="margin_top_30" align="center">
                    <h:panelGrid columns="4"  cellpadding="10" id="form-recond-qte">
                        <span>#{lab.L_quantite}</span>
                        <h:panelGrid columns="2">
                            <span>#{lab.L_unite} </span>
                            <h:outputText value="#{managedReconditionnement.contenu.conditionnement.unite.reference}" styleClass="input_small" title="#{managedReconditionnement.contenu.conditionnement.unite.libelle}"/>
                            <f:facet name="footer">
                                <h:inputText value="#{managedReconditionnement.contenu.quantite}" styleClass="input_small" readonly="true"/>
                            </f:facet>
                        </h:panelGrid>
                        <span>>></span>
                        <h:panelGrid columns="2">
                            <span>#{lab.L_unite}: </span>
                            <h:outputText value="#{managedReconditionnement.contenu.uniteDestination.unite.reference}" styleClass="input_small" 
                                          title="#{managedReconditionnement.contenu.uniteDestination.unite.libelle}"/>
                            <f:facet name="footer">
                                <h:inputText value="#{managedReconditionnement.contenu.quantite}" styleClass="input_small" readonly="true"/>
                            </f:facet>
                        </h:panelGrid>
                    </h:panelGrid>
                </div>
                <p:commandButton value="#{lab.L_appliquer}" icon="ui-icon-circle-check" styleClass="right margin_top_10"/>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="Ordre de fabrication associé" widgetVar="dlgComposantOF" style="width: 90%" height="500" resizable="false">
                <p:dataTable value="#{managedOrdresF.composantsOF}" var="icomp" rowIndexVar="line_" rowKey="#{icomp.id}" id="tab_composant_lie" 
                             selection="#{managedOrdresF.selectionComposantsOF}" style="overflow-y: auto">
                    <p:column headerText="N°" width="10"  styleClass="statut_#{icomp.ordreFabrication.statutOrdre}">
                        #{line_+1}
                    </p:column>
                    <p:column  width="150" headerText="#{lab.L_reference}" styleClass="statut_#{icomp.ordreFabrication.statutOrdre}">
                        <h:outputText value="#{icomp.ordreFabrication.codeRef}"  />
                        <h:graphicImage library="icones" name="favoris.png" width="10" height="10" style="float: right" rendered="#{icomp.insideCout and icomp.id gt 0}"
                                        title="#{icomp.insideCout?'Participe au calcul du coût':'Exclut du calcul des coûts'}"/> 
                    </p:column>
                    <p:column width="250" headerText="#{lab.L_article}" styleClass="statut_#{icomp.ordreFabrication.statutOrdre}">
                        <h:outputText value="[#{icomp.ordreFabrication.article.refArt}]" style="font-weight: bold"/>
                        <h:outputText value=" #{icomp.ordreFabrication.article.designation}" /> 
                    </p:column>
                    <p:column width="150" headerText="#{lab.LP_POF_gamme}" styleClass="statut_#{icomp.ordreFabrication.statutOrdre}">
                        <h:outputText value="#{icomp.ordreFabrication.gamme.codeRef}" />
                    </p:column>     
                    <p:column  headerText="Quantitée OF" width="90" style="text-align: center" styleClass="statut_#{icomp.ordreFabrication.statutOrdre}">
                        <h:outputText value="#{icomp.ordreFabrication.quantite}" converter="#{managedOrdresF.converterProd(icomp.ordreFabrication.article.categorie)}" />
                    </p:column>
                    <p:column width="100" headerText="#{lab.LP_POF_qte_prevue}" style="text-align: right">
                        <h:outputText value="#{icomp.quantitePrevu}" style="color: #{((icomp.stock lt icomp.quantitePrevu) and (icomp.type eq constantes.PROD_OP_TYPE_COMPOSANT_NORMAL))?'red':'blue'}" converter="DNS"/>                                                                                             
                    </p:column>
                    <p:column width="100" style="text-align: right; color: #003333">  
                        <f:facet name="header"><span title="#{lab.LP_POF_quantite_reel_entree}">#{lab.LP_POF_qte_reel_entree}</span></f:facet>
                        <h:outputText value="#{managedOrdresF.findQteReelComposantOf(icomp, true)}" converter="#{managedOrdresF.cproduction}" title="Quantité déjà utilisé"/>           
                    </p:column>  
                    <p:column width="100" style="text-align: right; color: #790000">     
                        <f:facet name="header"><span title="#{lab.LP_POF_quantite_reel_sortie}">#{lab.LP_POF_qte_reel_sortie}</span></f:facet>
                        <h:outputText value="#{managedOrdresF.findQteReelComposantOf(icomp, false)}" converter="#{managedOrdresF.cproduction}" title="Quantité déjà utilisé"/>           
                    </p:column> 
                    <p:column selectionMode="multiple" style="width:16px;text-align:center" />                      
                    <p:column width="30" headerText="" style="text-align: center">
                        <f:facet name="header">
                            <p:contextMenu for="btn_opt_comp_of_h_" event="left click">
                                <p:menuitem value="Ne participe pas au coût" icon="ui-icon-radio-on" actionListener="#{managedOrdresF.tooglesInsideCout(true)}" update="tab_composant_lie" />
                                <p:menuitem value="Participe au coût" icon="ui-icon-bullet" actionListener="#{managedOrdresF.tooglesInsideCout(false)}" update="tab_composant_lie"/>                                            
                            </p:contextMenu>
                            <p:commandButton id="btn_opt_comp_of_h_" type="button" icon="ui-icon-gear" styleClass="button_gear" />
                        </f:facet>
                        <p:contextMenu for="btn_opt_comp_of_" event="left click" style="width: 240px">
                            <p:menuitem value="#{icomp.insideCout?'Ne participe pas au coût':'Participe au coût'}" icon="#{icomp.insideCout?'ui-icon-radio-on':'ui-icon-bullet'}"
                                        actionListener="#{managedOrdresF.toogleInsideCout(icomp)}" update="tab_composant_lie"/>
                        </p:contextMenu>
                        <p:commandButton id="btn_opt_comp_of_" type="button" icon="ui-icon-gear" styleClass="button_gear" />
                    </p:column> 
                </p:dataTable>
                <f:facet name="footer">
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedOrdresF.loadComposant(false, false)}" update="tab_composant_lie" icon="ui-icon-circle-triangle-w" disabled="#{managedOrdresF.p_composant.disPrev}"/>
                        <p:outputPanel >
                            <p:inplace label="#{managedOrdresF.p_composant.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                <pe:inputNumber value="#{managedOrdresF.p_composant.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                    <p:ajax event="valueChange" listener="#{managedOrdresF.gotoPagePaginatorComposant()}" update="tab_composant_lie"/>
                                </pe:inputNumber>
                            </p:inplace><p:outputLabel value="/#{managedOrdresF.p_composant.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        </p:outputPanel>
                        <p:commandButton actionListener="#{managedOrdresF.loadComposant(true, false)}" update="tab_composant_lie" icon="ui-icon-circle-triangle-e" disabled="#{managedOrdresF.p_composant.disNext}"/>
                        <p:selectOneMenu value="#{managedOrdresF.p_composant.rows}" label="#{lab.L_nombre_max_resultat}" 
                                         valueChangeListener="#{managedOrdresF.choosePaginatorComposant}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedOrdresF.paginations}"/>
                            <p:ajax event="valueChange" update="tab_composant_lie"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LP_POF_liste_composants}" width="30%" widgetVar="dlgAlterComp" >
                <p:dataTable value="#{managedOrdresF.composants}" var="_icomp" rowIndexVar="line_"
                             rowKey="#{_icomp.id}" id="tab_composant_alternatif" selectionMode="single">
                    <p:ajax event="rowSelect" listener="#{managedOrdresF.addNewComposantInOF}" />
                    <p:column headerText="N°" width="10" styleClass="lineFooter_true">
                        #{line_+1}
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" width="100" styleClass="line_disabled_#{_icomp.inListByDefault}">
                        #{_icomp.composant.article.refArt}
                    </p:column>
                    <p:column headerText="#{lab.LP_POF_composant}" styleClass="line_disabled_#{_icomp.inListByDefault}">
                        #{_icomp.composant.article.designation}
                    </p:column>
                    <p:column headerText="#{lab.LDB_PP_sens}" styleClass="line_disabled_#{_icomp.inListByDefault}" width="20" style="text-align: center">
                        <p:graphicImage library="icones" name="#{(_icomp.sens eq 'E')?'in.png':'out.png'}" width="12" height="12" />
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog height="500px" width="80%" header="#{lab.LP_POF_liste_besoins_matieres} " styleClass="top" widgetVar="dlgBesoin" 
                      showHeader="true" >
                <ui:include src="besoin_order_fabrication.xhtml"  />

            </p:dialog>
        </h:form>


        <p:dialog header="#{lab.LP_POF_liste_articles}" widgetVar="dlgArticles" width="80%" height="400">
            <ui:include src="../../donnee_de_base/articles/liste_article.xhtml" />
        </p:dialog>
        <p:dialog header="#{lab.LP_POF_simulation}" widgetVar="dlgSimulation" width="80%" footer="&copy;Lymytz 2014"
                  closeOnEscape="true"  height="400" >
            <ui:include src="../ordre_fabrication/yvs_simulation.xhtml" />
        </p:dialog>
        <h:form prependId="false" id="form_session">
            <p:dialog header="#{lab.LP_POF_infos_sessions}" widgetVar="dlgInfoSession_" width="80%" minHeight="450" footer="&copy;Lymytz 2014"
                      closeOnEscape="true" >
                <ui:include src="yvs_sessions_prod.xhtml" />
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="main_form_declaration">
            <p:dialog header="#{lab.LP_POF_declaration_production}" widgetVar="dlgDeclaration" width="93%" height="650" footer="&copy;Lymytz 2014"
                      closeOnEscape="true" >
                <ui:include src="yvs_declaration_prod.xhtml" />                
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmSuspendOf" closeOnEscape="true"
                             message="#{lab.LP_POF_text2} " header="#{lab.L_confirmation}" >
                <div align="center">(Les matières premières consommées seront maintenu)</div>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.suspendOf()}" oncomplete="dlgConfirmSuspendOf.hide()"
                                 icon="ui-icon-circle-check"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmSuspendOf.hide()" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>   
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelSuivi" closeOnEscape="true"
                             message="#{lab.LP_POF_text3}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.deleteSuiviOperation()}" oncomplete="dlgConfirmDelSuivi.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelSuivi.hide()"/>
            </p:confirmDialog>
        </h:form>   
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="confirmDelSF" closeOnEscape="true"
                             message="#{lab.LP_POF_text4} " header="#{lab.L_confirmation}">
                <p:selectBooleanCheckbox itemLabel="#{lab.LP_POF_supprimer_cycle}" value="#{managedOrdresF.delCycle}"/>
                <p:commandButton icon="ui-icon-circle-check" value="#{lab.L_oui}" actionListener="#{managedOrdresF.deleteOneLineFlux(managedOrdresF.delCycle)}" oncomplete="confirmDelSF.hide()"/>
                <p:commandButton icon="ui-icon-circle-close" type="button"  value="#{lab.L_non}" onclick="confirmDelSF.hide()"/>
            </p:confirmDialog>
        </h:form>   
        <h:form prependId="false" id="main-programmation_of" >
            <p:dialog header="#{lab.LP_POF_programmation}" widgetVar="dlgProgramOrdre" width="70%" style="max-height: 70%" minHeight="450">
                <p:focus id="defaut-article_program_of" for="txt-article_program_of"/>
                <h:panelGrid id="form-programmation_of" columns="2" style="width: 100%" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <div align="left">
                            <span>#{lab.LP_POF_date_lancement} : </span>
                            <p:calendar value="#{managedOrdresF.dateLancement}" pattern="dd-MM-yyyy" size="10">
                                <p:ajax event="dateSelect" global="false"/>
                            </p:calendar>
                            <div style="font-size: 0.9em; float: right;font-weight: normal;background: #000;color: #FFF;padding: 5px">
                                <p:selectBooleanCheckbox value="#{managedOrdresF.program.suiviOperations}"  itemLabel="#{lab.LP_PPG_suivi_operations_requis}"/>
                                <p:spacer width="10"/>
                                <p:selectBooleanCheckbox value="#{managedOrdresF.program.generateOfSousProduit}"  itemLabel="#{lab.LP_POF_generer_of_produit_inter}"/>
                            </div>
                        </div>
                    </f:facet>
                    <h:panelGrid columns="5" cellpadding="0" cellspacing="0" id="form-programmation_of_f">
                        <h:outputText value="#{lab.L_article}"/>
                        <h:outputText value="#{lab.LP_POF_nomenclature}"/>
                        <h:outputText value="#{lab.LP_POF_gamme}"/>                        
                        <p:commandLink value="#{lab.L_quantite}" title="Déterminez à partir d'un autre composant" actionListener="#{managedOrdresF.loadComposantsNomenclature()}" /> 
                        <h:outputText value=""/>
                        <h:inputText id="txt-article_program_of" value="#{managedOrdresF.program.articles.refArt}" style="color: #{pr.articles.error?'red':''}">
                            <p:ajax event="valueChange" listener="#{managedOrdresF.searchArticle(managedOrdresF.program)}" update="form-programmation_of"/>
                        </h:inputText>
                        <h:selectOneMenu value="#{managedOrdresF.program.nomenclature.id}" style="min-width: 140px">  
                            <f:selectItem itemValue="#{-1}" itemLabel="" noSelectionOption="true" />
                            <f:selectItems value="#{managedOrdresF.program.articles.nomenclatures}" var="itemNom" itemValue="#{itemNom.id}" itemLabel="#{itemNom.reference}" />   
                            <p:ajax event="valueChange" listener="#{managedOrdresF.chooseNomenclature()}"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedOrdresF.program.gamme.id}" style="min-width: 140px" disabled="#{!managedOrdresF.program.suiviOperations}">  
                            <f:selectItem itemValue="#{-1}" itemLabel="" noSelectionOption="true" />
                            <f:selectItems value="#{managedOrdresF.program.articles.gammes}" var="itemGam" itemValue="#{itemGam.id}" itemLabel="#{itemGam.codeRef}" />
                            <p:ajax event="valueChange" listener="#{managedOrdresF.chooseGamme()}"/>
                        </h:selectOneMenu>  
                        <h:inputText value="#{managedOrdresF.program.quantitePrevu}" style="width: 100px;text-align: center">
                            <p:ajax event="valueChange" global="false"/>
                        </h:inputText>
                        <p:commandButton value="Ajouter" title="Ajouter au programme" icon="ui-icon-plus" actionListener="#{managedOrdresF.addProgram()}"  
                                         update="data-programmation_of form-programmation_of defaut-article_program_of"/>
                    </h:panelGrid>
                </h:panelGrid>
                <p:dataTable id="data-programmation_of" value="#{managedOrdresF.programs}" var="pr" rows="10" paginatorAlwaysVisible="false">
                    <p:column width="250" headerText="#{lab.L_article}">
                        <h:outputText value="[#{pr.articles.refArt}]" style="font-weight: bold"/>
                        <h:outputText value=" #{pr.articles.designation}" /> 
                    </p:column>
                    <p:column  headerText="#{lab.L_quantite}" width="90" style="text-align: center">
                        <h:outputText value="#{pr.quantitePrevu}"/>
                    </p:column>
                    <p:column width="120" headerText="#{lab.LP_POF_nomenclature}" style="text-align: center">                                                             
                        <h:outputText value="#{pr.nomenclature.reference}"/>
                    </p:column>
                    <p:column width="150" headerText="#{lab.LP_POF_gamme}" style="text-align: center">
                        <h:outputText value="#{pr.gamme.reference}" />
                    </p:column>                                                                                
                    <p:column width="90" headerText="#{lab.LP_POF_lancement}" style="text-align: center">
                        <h:outputText value="#{pr.dateDebutLancement}" converter="DDMMYYYY" />
                    </p:column>
                    <p:column style="width: 10px;text-align: center">
                        <p:commandButton icon="ui-icon-trash" actionListener="#{managedOrdresF.removeProgram(pr)}" update="data-programmation_of"
                                         style="width: 22px; height: 22px" title="#{lab.LP_POF_retirer_programme}"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer">
                    <div align="left">
                        <span>#{lab.LP_POF_site_production} : </span> 
                        <h:selectOneMenu value="#{managedOrdresF.program.site.id}" style="min-width: 160px" id="select-site_programmation">
                            <f:selectItem itemValue="0" itemLabel="--" />
                            <f:selectItems value="#{managedSiteProduction.sites}" var="p_site" itemValue="#{p_site.id}" itemLabel="#{p_site.designation}" />                                    
                        </h:selectOneMenu>
                        <p:commandButton icon="ui-icon-check" value="Terminer" actionListener="#{managedOrdresF.terminerProgram()}"
                                         style="margin-top: -5px!important;margin-left: 5px" update="data-programmation_of select-site_programmation"/>
                    </div>
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" >
            <p:dialog header="#{lab.LP_POF_indicateurs}" widgetVar="dlgAllIndc" width="50%" height="80%">
                <p:dataTable value="#{managedOrdresF.selectedFlux.indicateursSuivis}" var="ind_" id="table_indicateur_xx" rowKey="#{ind_.id}"
                             selectionMode="single">
                    <p:column headerText="Id">
                        #{ind_.id}
                    </p:column>
                    <p:column headerText="#{lab.L_article}">
                        #{ind_.composant.composant.article.designation}
                    </p:column>
                    <p:column headerText="#{lab.L_qte}">
                        #{ind_.quantiteBorne}
                    </p:column>
                    <p:column width="20">
                        <p:commandButton icon="ui-icon-circle-close" actionListener="#{managedOrdresF.deleteOrdreFabrication(ind_)}"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_display_resumeflux">
            <p:dialog header="#{lab.LP_POF_resume_fluc_composants}" widgetVar="dlgResumeFlux" width="90%" height="450" closeOnEscape="true"
                      footer="&copy;Lymytz 2014" >
                <p:outputPanel id="table_resume_flux_equipe" layout="block" style="width: 100%; height:100%; overflow: auto">
                    <h:panelGrid columns="3" style="font-size: 0.8em">
                        <h:outputText value="Equipe" />
                        <h:panelGroup>
                            <h:outputText value="#{lab.L_date}" />
                            <h:selectBooleanCheckbox value="#{managedOrdresF.filterDate}" >
                                <p:ajax event="valueChange" update="chp_filter_date" global="false"/>
                            </h:selectBooleanCheckbox>
                        </h:panelGroup>
                        <span>&nbsp;</span>
                        <h:selectOneMenu value="#{managedOrdresF.filterEquipeResume.id}" >
                            <f:selectItem itemValue="-1" itemLabel=""/>
                            <f:selectItems value="#{managedOrdresF.listeEquipeFilter}" var="ef" itemValue="#{ef.id}" itemLabel="#{ef.nom}"/>
                        </h:selectOneMenu>
                        <h:panelGroup id="chp_filter_date">
                            <p:calendar value="#{managedOrdresF.filterDateResume}" pattern="dd-MM-yyyy" size="8" disabled="#{!managedOrdresF.filterDate}"/>
                            <p:calendar value="#{managedOrdresF.filterDateResume2}" pattern="dd-MM-yyyy" size="8" disabled="#{!managedOrdresF.filterDate}"/>
                        </h:panelGroup> 
                        <p:commandButton update="table_resume_flux_equipe" icon="ui-icon-refresh" title="#{lab.L_actualiser}" actionListener="#{managedOrdresF.loadCustumDataFlux()}" 
                                         style="width: 20px; height:20px;"/>
                    </h:panelGrid>                
                    <ui:repeat value="#{managedOrdresF.listeEquipe}" var="iEq">
                        <div class="head_niveau1">#{iEq.reference}</div>
                        <table class="table_niveau" cellpadding="0" cellspacing="0">    
                            <tr >
                                <th rowspan="2" width="100">#{lab.L_date}</th>
                                <th rowspan="2" width="120">#{lab.L_tranche}</th>
                                <ui:repeat value="#{ordreFabrication.listComposantOf}" var="hiart">
                                    <th colspan="2" style="font-size: 0.7em">#{hiart.article.designation}</th>
                                </ui:repeat>
                            </tr>
                            <tr >
                                <ui:repeat value="#{ordreFabrication.listComposantOf}" var="hiart">
                                    <th title="#{lab.LP_POF_quantite_consommee}">#{lab.LP_POF_conso}.</th>
                                    <th title="#{lab.LP_POF_quantite_produite}">#{lab.LP_POF_produ}.</th>
                                </ui:repeat>
                            </tr>
                            <ui:repeat value="#{managedOrdresF.listeDate}" var="iDate">
                                <h:panelGroup rendered="#{managedOrdresF.giveValueLine(iEq, iDate[0], iDate[1]) gt 0}">
                                    <tr >
                                        <td bgcolor="#aafab3"  style="font-size: 0.6em"><h:outputText value="#{iDate[0]}" converter="DATE" /></td>
                                        <td bgcolor="#aafab3"  style="font-size: 0.6em"><h:outputText value="#{iDate[1].titre}"  /></td>
                                        <ui:repeat value="#{ordreFabrication.listComposantOf}" var="iart">
                                            <td class="consomation">
                                                <h:outputText value="#{managedOrdresF.giveValueFlux(iEq, iDate[0], iDate[1], iart,true)}" converter="#{managedOrdresF.cproduction}" />
                                            </td>
                                            <td class="production">
                                                <h:outputText value="#{managedOrdresF.giveValueFlux(iEq, iDate[0], iDate[1], iart,false)}" converter="#{managedOrdresF.cproduction}" />
                                            </td>
                                        </ui:repeat>
                                    </tr>
                                </h:panelGroup>
                            </ui:repeat>
                        </table>
                    </ui:repeat>
                </p:outputPanel>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgNotAllDeclare" closeOnEscape="true"
                             message="#{lab.LP_POF_text5}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.changeStateOf(constantes.ETAT_CLOTURE,true)}" oncomplete="dlgNotAllDeclare.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgNotAllDeclare.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmChangeDepot" closeOnEscape="true"
                             message="#{lab.LP_POF_text6}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.confirmChangeDepotConso()}" oncomplete="dlgConfirmChangeDepot.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmChangeDepot.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeclare" closeOnEscape="true"
                             message="#{lab.LP_POF_text7}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.saveDeclaration(true)}" oncomplete="dlgConfirmDeclare.hide()"
                                 icon="ui-icon-circle-check"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeclare.hide()"  icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmFinOp" closeOnEscape="true"
                             message="#{lab.LP_POF_text8}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.finishOperation(false)}" oncomplete="dlgConfirmFinOp.hide()"
                                 icon="ui-icon-circle-check" update=":formulaire_mainOrdreF:zone_diplay_op"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmFinOp.hide()" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmFinAllOp" closeOnEscape="true"
                             message="#{lab.LP_POF_text9}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.finishOperation(false)}" oncomplete="dlgConfirmFinAllOp.hide()"
                                 icon="ui-icon-circle-check" update=":formulaire_mainOrdreF:zone_diplay_op"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmFinAllOp.hide()" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteDec" closeOnEscape="true"
                             message="#{lab.LP_POF_text10}" header="#{lab.L_confirmation}">
                <p:selectBooleanCheckbox value="#{managedOrdresF.notRemindDeleteDecl}" itemLabel="#{lab.LP_POF_ne_plus_rappeler}" />
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.deleteDeclaration()}" oncomplete="dlgConfirmDeleteDec.hide()"
                                 icon="ui-icon-circle-check" update=":formulaire_mainOrdreF:tablePhase_:data_declaration"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteDec.hide()" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       Boite de dialogue des declarations
       *****************************************************************************
       <--> 
        <h:form prependId="false">
            <p:dialog header="#{lab.L_statut}" widgetVar="dlgMoreStatuts" modal="true" closeOnEscape="true">                 
                <p:selectManyMenu value="#{managedOrdresF.statutsOf}" showCheckbox="true" style="min-width: 120px;size: 20px">
                    <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                    <f:selectItem itemLabel="#{lab.LP_POF_lance}" itemValue="#{constantes.ETAT_PROD_LANCE}"/>
                    <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>                   
                    <p:separator />
                    <f:selectItem itemLabel="#{lab.L_terminer}" itemValue="#{constantes.ETAT_SOUMIS}"/>
                    <f:selectItem itemLabel="#{lab.L_cloture}" itemValue="#{constantes.ETAT_CLOTURE}"/>
                    <p:separator />
                    <f:selectItem itemLabel="#{lab.L_suspendu}" itemValue="#{constantes.ETAT_SUSPENDU}"/> 
                    <f:selectItem itemLabel="#{lab.L_annuler}" itemValue="#{constantes.ETAT_ANNULE}"/> 
                    <p:ajax event="valueChange"   listener="#{managedOrdresF.searchByStatutOF()}"/>
                </p:selectManyMenu>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="main_declaration">
            <p:dialog header="#{lab.L_conditionnement}" widgetVar="dlgConditionnement" width="80%" modal="true" footer="&copy;Lymytz 2014" closeOnEscape="true"
                      >
                <div class="dlg_part_fix">
                    <p:commandButton value="#{lab.L_enregistrer}" id="save_conditionnement" actionListener="#{managedConditionnement.saveNew()}" update="form_conditionnement data_fiche_conditionnement"
                                     icon="ui-icon-disk"/>
                    <p:commandButton value="#{lab.L_nouveau}" id="cancel_conditionnement" actionListener="#{managedOrdresF.resetConditionner()}" update="form_conditionnement" oncomplete="collapseForm('conditionnement')"
                                     icon="ui-icon-document"/>
                    <div style="float: right">     
                        <h:link title="#{lab.L_mode_formulaire}" onclick="collapseForm('conditionnement');
                                return false">
                            <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>               
                        <p:spacer />
                        <h:link title="#{lab.L_mode_liste}" onclick="collapseList('conditionnement');
                                return false" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>   
                    </div>
                    <div style="clear: right"/>
                </div>
                <div class="dlg_part_scroll">
                    <div class="yvs_form_conditionnement" style="width: 99%; margin: auto; background: white">
                        <h:panelGrid id="form_conditionnement" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">     
                            <f:facet name="header">
                                <h:panelGrid id="form_entete_conditionnement" columns="2" styleClass="yvs_nostyle" style="width: 100%;margin-bottom: -5px;" cellpadding="0" cellspacing="0">
                                    <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: left">   
                                        <span>#{lab.L_depot} </span>
                                        <h:selectOneMenu value="#{managedConditionnement.fiche.depot.id}" style="min-width: 200px">
                                            <f:selectItem itemLabel="--" itemValue="0"/>
                                            <f:selectItems value="#{managedDepot.depots}" var="dep" itemLabel="#{dep.designation}" itemValue="#{dep.id}" />                                 
                                            <p:ajax event="valueChange" global="false" listener="#{managedConditionnement.chooseDepotConditionnement()}"/>
                                        </h:selectOneMenu>
                                    </h:panelGrid>
                                    <h:panelGroup style="padding: 7px;float: right; position: relative; margin-top: -5px" rendered="#{managedConditionnement.fiche.id gt 0}">
                                        <p:outputPanel id="grp_btn_etat_conditionnement" styleClass="yvs_form_of" autoUpdate="true">                                    
                                            <p:commandLink value="#{(managedConditionnement.fiche.statut==constantes.STATUT_DOC_ANNULE)?'Editable':'En Edition'}"
                                                           styleClass="#{(managedConditionnement.fiche.statut == constantes.STATUT_DOC_EDITABLE)?'statut_valide':'etat_formation_true'}" 
                                                           disabled="#{!(managedConditionnement.fiche.statut == constantes.STATUT_DOC_ANNULE
                                                                       or managedConditionnement.fiche.statut == constantes.STATUT_DOC_RENVOYE)}"
                                                           actionListener="#{managedConditionnement.annuler(false, false)}" style="font-size: 0.8em; color: #FFF"
                                                           process="@this" global="false"/>
                                            <p:commandLink value="#{(managedConditionnement.fiche.statut==constantes.STATUT_DOC_VALIDE)?'Validé':'Valider'}"
                                                           styleClass="#{(managedConditionnement.fiche.statut==constantes.STATUT_DOC_VALIDE)?'statut_valide':'etat_formation_true'}" 
                                                           disabled="#{!(managedConditionnement.fiche.statut == constantes.STATUT_DOC_EDITABLE)}" 
                                                           actionListener="#{managedConditionnement.valider()}" style="font-size: 0.8em; color: #FFF"
                                                           process="@this" global="false"/>
                                        </p:outputPanel>                                                
                                    </h:panelGroup>                                     
                                </h:panelGrid>
                            </f:facet>
                            <span style="font-size: initial">#{lab.L_article} : </span>
                            <h:panelGroup>
                                <h:inputText value="#{managedConditionnement.fiche.article.refArt}" style="color: #{managedConditionnement.fiche.article.error?'red':''}" tabindex="10" readonly="true">
                                    <p:ajax event="blur" global="false" listener="#{managedConditionnement.searchArticle(true)}" update="form_conditionnement"/>
                                </h:inputText>    
                                <span style="font-weight: bold;color: #000">#{managedConditionnement.fiche.article.designation}</span>                                
                                <h:panelGroup id="desc_article_fiche_conditionnement" style="float: right;margin-top: 5px">
                                    <h:outputText value="#{managedConditionnement.fiche.article.stock}" converter="DNS" style="font-weight: bold;color: #000"/>
                                    <h:outputText value=" #{managedConditionnement.fiche.conditionnement.unite.reference}"/>
                                    <span> en stock </span>
                                </h:panelGroup>
                            </h:panelGroup>
                            <span>#{lab.LP_POF_nomenclature} </span>  
                            <h:selectOneMenu value="#{managedConditionnement.fiche.nomenclature.id}" disabled="#{(managedConditionnement.fiche.statut != constantes.STATUT_DOC_EDITABLE)}"
                                             style="min-width: 200px">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedConditionnement.nomenclatures}" var="nome" 
                                               itemLabel="#{nome.reference}" itemValue="#{nome.id}" />                                 
                                <p:ajax event="valueChange" listener="#{managedConditionnement.chooseNomenclature()}" update="data_reconditionnement desc_article_fiche_conditionnement"/>
                            </h:selectOneMenu> 
                            <span>#{lab.LC_PR_date_fiche} </span>
                            <p:calendar value="#{managedConditionnement.fiche.dateConditionnement}" size="10" pattern="dd-MM-yyyy"/>
                            <span>#{lab.L_quantite} </span>  
                            <h:panelGroup>
                                <h:inputText value="#{managedConditionnement.fiche.quantite}">
                                    <p:ajax event="blur" listener="#{managedConditionnement.blurQuantiteFiche()}" update="data_reconditionnement"/>
                                </h:inputText>    
                                <h:outputText value="#{managedConditionnement.fiche.conditionnement.unite.reference}"/>
                            </h:panelGroup> 
                            <f:facet name="footer">
                                <p:dataTable id="data_reconditionnement" value="#{managedConditionnement.fiche.contenus}" var="y" rowKey="#{y.id}" 
                                             rowIndexVar="yIdx" style="font-size: 0.9em">
                                    <p:column headerText="N°" style="width: 5%">
                                        <span>#{yIdx+1}</span>
                                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{y.new_}"/>
                                    </p:column>
                                    <p:column headerText="#{lab.L_reference}">
                                        <span>#{y.article.refArt}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_article}">
                                        <span>#{y.article.designation}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_quantite}" style="text-align: right;width: 10%">
                                        <h:outputText value="#{y.quantite}" converter="DNS"/>
                                        <span title="#{y.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399"> #{y.conditionnement.unite.reference}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PSA_stock}." style="text-align: center;width: 5%">
                                        <h:graphicImage library="icones" name="#{(y.consommable)?'out.png':'in.png'}" width="15" height="15" title="#{(y.consommable)?'Consommable':'Produit final'}"/>
                                    </p:column>
                                    <p:column style="width: 5%;text-align: center">
                                        <p:contextMenu for="btn_option_reconditionnement" event="left click" style="font-size: 0.8em; text-align: center"
                                                       styleClass="context_menu">
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedConditionnement.deleteBeanContenu(y)}"
                                                        update="data_reconditionnement"/>
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_reconditionnement" type="button"/>
                                    </p:column> 
                                </p:dataTable>
                            </f:facet>
                        </h:panelGrid>
                    </div>
                    <div class="yvs_list_conditionnement" style="width: 99%; margin: auto; background: white">
                        <p:dataTable id="data_fiche_conditionnement" value="#{managedConditionnement.fiches}" var="mouv" 
                                     rowKey="#{mouv.id}" rowIndexVar="mouvIdx" selectionMode="single">
                            <p:ajax event="rowSelect" listener="#{managedConditionnement.loadOnView}" update=":main_declaration:form_conditionnement" 
                                    oncomplete="collapseForm('conditionnement')" />
                            <p:column headerText="N°" width="15" styleClass="statut_#{mouv.statut}">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{mouv.new_}"/>
                                <span>#{mouvIdx+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_article} " styleClass="statut_#{mouv.statut}">
                                <h:outputText value="#{mouv.nomenclature.article.designation}"/>
                            </p:column>
                            <p:column headerText="#{lab.LP_PC_nomenclature} " styleClass="statut_#{mouv.statut}">
                                <h:outputText value="#{mouv.nomenclature.reference}"/>
                            </p:column>
                            <p:column headerText="#{lab.L_date} " style="width: 12%;text-align: center" styleClass="statut_#{mouv.statut}">
                                <h:outputText value="#{mouv.dateConditionnement}" converter="DDMMYYYY"/>
                            </p:column>
                            <p:column headerText="#{lab.L_depot}" style="width: 20%;" styleClass="statut_#{mouv.statut}">
                                <span>#{mouv.depot.designation}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_quantite} " style="text-align: right;width: 10%" styleClass="statut_#{mouv.statut}">
                                <h:outputText value="#{mouv.quantite}" converter="DN"/>
                                <span title="#{mouv.nomenclature.uniteMesure.unite.libelle}" style="font-size: 0.6em;color: #003399"> #{mouv.nomenclature.uniteMesure.unite.reference}</span>
                            </p:column>
                            <p:column headerText="" width="15" styleClass="statut_#{mouv.statut}" style="text-align: center">
                                <p:contextMenu for="btn_option_conditionnement" event="left click" style="font-size: 0.9em"
                                               styleClass="context_menu">
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedConditionnement.openTodeleteBean(mouv)}"
                                                update="data_fiche_conditionnement" oncomplete="dlgConfirmDeleteConditionnement.show()"/>
                                </p:contextMenu>
                                <p:commandButton icon="ui-icon-gear" id="btn_option_conditionnement" style="width: 20px; height: 20px" type="button"/>
                            </p:column>
                        </p:dataTable> 
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                            <p:commandButton actionListener="#{managedConditionnement.paginer(false)}" global="false" update="data_fiche_conditionnement" icon="ui-icon-circle-triangle-w" disabled="#{managedConditionnement.paginator.disPrev}"/>
                            <p:outputPanel >
                                <p:inplace label="#{managedConditionnement.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                    <pe:inputNumber value="#{managedConditionnement.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                        <p:ajax event="blur" listener="#{managedConditionnement.gotoPagePaginator()}" update="data_fiche_conditionnement"/>
                                    </pe:inputNumber>
                                </p:inplace><p:outputLabel value="/#{managedConditionnement.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                            </p:outputPanel>
                            <p:commandButton actionListener="#{managedConditionnement.paginer(true)}" global="false" update="data_fiche_conditionnement" icon="ui-icon-circle-triangle-e" disabled="#{managedConditionnement.paginator.disNext}"/>
                            <p:selectOneMenu value="#{managedConditionnement.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedConditionnement.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                <f:selectItems value="#{managedConditionnement.paginations}"/>
                                <p:ajax event="valueChange" global="false" update="data_fiche_conditionnement"/>
                            </p:selectOneMenu>
                        </p:outputPanel>
                    </div>
                </div>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="main_form_transfert_prod">
            <p:dialog header="#{lab.LP_POF_transfert_production}" widgetVar="dlgTransfert" width="50%" modal="true" footer="&copy;Lymytz 2014"
                      closeOnEscape="true" >
                <h:panelGrid columns="2" style="float: right" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_depot}"/> 
                    <h:selectOneMenu value="#{managedOrdresF.depotDest.id}" style="min-width: 200px" id="chp_depot_tr_decl_prod_1"
                                     valueChangeListener="#{managedOrdresF.chooseDepotCible}">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedOrdresF.depotsCible}" var="dep_" itemLabel="#{dep_.designation}" itemValue="#{dep_.id}" />                                 
                        <p:ajax event="valueChange" />
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.L_tranche}"/> 
                    <h:selectOneMenu value="#{managedOrdresF.trancheHoraire.id}" style="min-width: 200px" id="chp_tranche_tr_decl_prod_1">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{managedOrdresF.tranchesCible}" var="tran_" itemLabel="#{tran_.titre}" itemValue="#{tran_.id}" />                                   
                        <p:ajax event="valueChange" global="false" process="@this"/>
                    </h:selectOneMenu>
                </h:panelGrid>
            </p:dialog>
        </h:form>
        <!-->
       *****************************************************************************
       Boite de dialogue des articles
       *****************************************************************************
       <--> 
        <h:form prependId="false" id="main_of_sous_produit">
            <p:dialog header="#{lab.LP_POF_information_of_pour} '#{managedOrdresF.sous.articles.designation}'" widgetVar="dlgGenererOF" width="500" modal="true" footer="&copy;Lymytz 2014" >
                <h:panelGrid columns="1" style="width: 100%" styleClass="yvs_noStyle" cellpadding="0" cellspacing="0" id="blog_of_sous_produit">
                    <span>#{lab.LP_POF_nomenclature}</span> 
                    <h:selectOneMenu value="#{managedOrdresF.sous.nomenclature.id}" style="width: 100%">  
                        <f:selectItem itemValue="#{-1}" itemLabel="" noSelectionOption="true" />
                        <f:selectItems value="#{managedOrdresF.sous.articles.nomenclatures}" var="isNom" itemValue="#{isNom.id}" itemLabel="#{isNom.reference}" />   
                    </h:selectOneMenu>
                    <span>#{lab.LP_POF_gamme}</span>
                    <h:selectOneMenu value="#{managedOrdresF.sous.gamme.id}" style="width: 100%">  
                        <f:selectItem itemValue="#{-1}" itemLabel="" noSelectionOption="true" />
                        <f:selectItems value="#{managedOrdresF.sous.articles.gammes}" var="isGam" itemValue="#{isGam.id}" itemLabel="#{isGam.codeRef}" />
                    </h:selectOneMenu>  
                    <f:facet name="footer">
                        <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedOrdresF.saveOFSousProduit()}" oncomplete="dlgGenererOF.hide()" style="float: right"/>
                    </f:facet>
                </h:panelGrid>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LP_POF_gamme}" widgetVar="dlgPostC" width="70%" modal="true" footer="&copy;Lymytz 2014" closeOnEscape="true">
                <div class="yvs_list_poste_charge">
                    <p:dataTable id="data_poste_charge_of" value="#{managedPosteCharge.postes}" var="postC" 
                                 rowIndexVar="postCLIne" rowKey="#{postC.id}" selectionMode="single" >
                        <p:ajax event="rowSelect" listener="#{managedOrdresF.addOrReplacePoste}" 
                                oncomplete="dlgPostC.hide()" />
                        <p:column headerText="N°" style="width: 5%">
                            <span>#{postCLIne+1}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}">
                            <span>#{postC.reference}</span>        
                            <h:panelGroup style="float: right">
                                <h:outputText title="#{lab.LP_PPC_valeur_directe}" value="D" rendered="#{postC.typeValeur == constantes.DIRECT}"
                                              style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: #0099ff;color: white"/>
                                <h:outputText title="#{lab.LP_POF_valeur_calculee}" value="C" rendered="#{postC.typeValeur != constantes.DIRECT}"
                                              style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: #0099ff;color: white"/>
                            </h:panelGroup>         
                        </p:column>
                        <p:column headerText="#{lab.L_designation}">
                            <span>#{postC.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_type}" style="text-align: center;width: 15%">
                            <span>#{postC.typeName}</span>
                        </p:column>
                        <p:column headerText="#{lab.LP_PEP_site_production}" style="width: 15%">
                            <span>#{postC.siteProduction.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.LP_PPC_capacite}" style="text-align: right;width: 10%">
                            <h:outputText value="#{postC.capaciteH}" converter="DNS"/>
                            <span>h/mois</span>
                        </p:column>
                        <p:column headerText="#{lab.LP_PPC_rendement}" style="text-align: right;width: 8%">
                            <h:outputText value="#{postC.tauxRendement}" converter="DNS"/>
                            <span>%</span>
                        </p:column>
                    </p:dataTable>   
                    <span class="nbSelectposte_charge" style="font-size: .8em; font-style: italic; color: #828c95;"></span>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedPosteCharge.init(false)}" global="false" update="data_poste_charge_of" icon="ui-icon-circle-triangle-w" disabled="#{managedPosteCharge.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedPosteCharge.paginator.currentPage}/#{managedPosteCharge.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedPosteCharge.init(true)}" global="false" update="data_poste_charge_of" icon="ui-icon-circle-triangle-e" disabled="#{managedPosteCharge.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedPosteCharge.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedPosteCharge.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedPosteCharge.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_poste_charge_of"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </div>
            </p:dialog>
        </h:form>      
        <h:form prependId="false">
            <p:dialog header="#{lab.L_liste_article}" widgetVar="dlgListArticle" modal="true" width="70%" closeOnEscape="true" height="450"> 
                <p:watermark for="txt_search_article_gammes_of" value="#{lab.L_reference_article}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_article_gammes_of" value="#{Marticle.article.refArt}" style="text-align: center">
                        <p:ajax event="valueChange" listener="#{Marticle.searchArticleActif(managedOrdresF.isComposant?'A':'P',Marticle.article.refArt,false)}" update="data_article_gammes_of" />
                    </h:inputText> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(false, false)}" global="false"
                                         update="data_article_gammes_of" icon="ui-icon-circle-triangle-w" disabled="#{Marticle.pa.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{Marticle.pa.currentPage}/#{Marticle.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(true, false)}" global="false" 
                                         update="data_article_gammes_of" icon="ui-icon-circle-triangle-e" disabled="#{Marticle.pa.disNext}"/>
                        <p:selectOneMenu value="#{Marticle.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{Marticle._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{Marticle.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_article_gammes_of"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable value="#{Marticle.articlesResult}" var="art" rowKey="#{art.id}" rowIndexVar="artIdx"
                             selectionMode="single" scrollable="true" scrollHeight="385" id="data_article_gammes_of" style="font-size: 0.9em">
                    <p:ajax event="rowSelect" global="false" listener="#{managedOrdresF.loadOnViewArticle}" oncomplete="dlgListArticle.hide()"/>
                    <p:column headerText="N°" width="15">
                        <span title="#{art.designation}">#{artIdx+1}</span>
                    </p:column>
                    <p:column width="70">
                        <span title="#{art.designation}">#{art.refArt}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}" width="150">
                        <span title="#{art.designation}">#{art.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" width="80">
                        <span title="#{art.designation}">#{art.categorie}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_prix_a}" width="80" style="text-align: right">
                        <h:outputText value="#{art.pua}" title="#{art.designation}" converter="DN" />
                    </p:column>
                    <p:column headerText="#{lab.L_prix_v}" width="80" style="text-align: right">
                        <h:outputText value="#{art.puv}" title="#{art.designation}" converter="DN" />
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form> 
        <h:form prependId="false" id="formulaire_update_edit_flux">
            <p:overlayPanel for="view_cycle_op_op" >
                <p:commandButton icon="ui-icon-arrowthickstop-1-s" title="#{lab.LP_POF_cycle_lie_session}" style="width: 20px; height: 20px" 
                                 actionListener="#{managedOrdresF.loadMyCycleProducteur(managedOrdresF.currentSession.producteur, managedOrdresF.selectedOp)}"
                                 update="table_cycle_session_op"/>
                <p:commandButton icon="ui-icon-arrowthick-2-se-nw" title="#{lab.LP_POF_cycle_lie_all_session}" style="width: 20px; height: 20px" 
                                 actionListener="#{managedOrdresF.loadMyCycleSession(managedOrdresF.currentSession.ordreF, managedOrdresF.selectedOp)}"
                                 update="table_cycle_session_op"/>
                <p:dataTable value="#{managedOrdresF.mesCycles}" var="myC" id="table_cycle_session_op">
                    <f:facet name="header">
                        <div align="left" style="font-size: 0.8em">Mes cycles</div>
                    </f:facet>
                    <p:column headerText="#{lab.L_reference}">
                        #{myC.referenceOp}
                    </p:column>
                    <p:column headerText="#{lab.L_date}">
                        <h:outputText value="#{myC.dateDebut}" converter="DATE" />
                    </p:column>
                    <p:column headerText="#{lab.L_heure_debut}">
                        <h:outputText value="#{myC.heureDebut}" converter="TIME" />
                    </p:column>
                    <p:column headerText="#{lab.L_heure_fin}">
                        <h:outputText value="#{myC.heureFin}" converter="TIME" />
                    </p:column>
                </p:dataTable>
            </p:overlayPanel>
            <p:dialog modal="true" width="85%" widgetVar="dlgEditFlux" footer="&copy;Lymytz 2014" closeOnEscape="true" 
                      >
                <f:facet name="header">
                    #{lab.LP_POF_suivi_flux_operation} : 
                    <h:panelGroup id="header_detail_edit_flux">
                        <h:outputText value="'#{managedOrdresF.selectedOp.codeRef}'" style="color: #aaa; font-size: 0.8em"  /> 
                    </h:panelGroup>
                </f:facet>
                <p:outputPanel layout="block" style="border-bottom: 1px #003399 solid; width: 100%" id="zone_gear_operation">
                    <p:commandButton icon="ui-icon-triangle-1-w" style="width: 22px; height: 22px" actionListener="#{managedOrdresF.findAndSelectNextOperation(managedOrdresF.selectedOp,false)}"
                                     update="zone_gear_operation header_detail_edit_flux"/>
                    <h:outputText value="#{managedOrdresF.selectedOp.numero}/#{ordreFabrication.listOperationsOf.size()*10}" style="font-size: 0.8em"/>
                    <p:commandButton icon="ui-icon-triangle-1-e" style="width: 22px; height: 22px" actionListener="#{managedOrdresF.findAndSelectNextOperation(managedOrdresF.selectedOp,true)}"
                                     update="zone_gear_operation header_detail_edit_flux"/>
                    <span style="font-size: 0.8em">#{lab.LP_POF_session_de} </span>                    
                    <h:outputText style="font-size: 0.8em; color: #000066; cursor: pointer" value="#{managedOrdresF.currentSession.producteur.nomUsers}" id="view_cycle_op_op"/>
                    <p:commandButton icon="ui-icon-pencil" style="width: 20px; height: 20px" type="button" title="#{lab.LP_POF_modifier_session}" onclick="dlgInfoSession_.show()"/>                    
                    <p:selectBooleanCheckbox itemLabel="#{lab.LP_POF_appliquer_suivant}"  value="#{managedOrdresF.loadNext}" style="font-size: 0.8em; float: right" >
                        <p:ajax global="false"  />
                    </p:selectBooleanCheckbox>
                    <p:outputPanel rendered="#{managedOrdresF.mesCycles.size() gt 1}"  >
                        <p:separator />
                        <div style="font-size: 0.8em; padding-left: 2%">
                            <div align="right">
                                <span style="margin-top: -10px; display: inline-block; cursor: pointer">
                                    <h:graphicImage class="ico_slide_down" library="img" name="pointe_.png" width="18" height="18" onclick="slideOnClick(true, 'display_cycle_')" />
                                    <h:graphicImage class="ico_slide_up" library="img" name="pointe_h.png" width="18" height="18" onclick="slideOnClick(false, 'display_cycle_')" style="display: none"/>
                                </span>
                            </div>
                            <div class="display_cycle_" style="height: 25px; display: none">
                                <p:outputPanel  id="control_cycle_op" layout="block">
                                    <span style="display: inline-block;margin-right: 1%">#{lab.LP_POF_cycles_operation} :</span>
                                    <p:commandButton icon="ui-icon-triangle-1-w" style="width: 22px; height: 22px" actionListener="#{managedOrdresF.navigueInCycle(false)}"
                                                     update="control_cycle_op form_detail_edit_flux table_suivi_edit_flux" disabled="#{managedOrdresF.navPrevCycle}"/>
                                    <h:outputText value="0/#{managedOrdresF.mesCycles.size()*10}" style="font-size: 0.8em"/>                    
                                    <p:commandButton icon="ui-icon-triangle-1-e listeSuiviFlux" style="width: 22px; height: 22px" actionListener="#{managedOrdresF.navigueInCycle(true)}"
                                                     update="control_cycle_op form_detail_edit_flux table_suivi_edit_flux" disabled="#{managedOrdresF.navNextCycle}"/>
                                    <span>#{lab.L_ref}. :</span>
                                    <h:outputText value="#{managedOrdresF.selectedCycle.referenceOp}" style="font-size: 0.8em; font-weight: bold"/>    
                                    <span>#{lab.L_par} :</span>
                                    <h:outputText value="#{managedOrdresF.selectedCycle.sessionOf.sessionProd.producteur.nomUsers}" style="font-size: 0.8em; font-weight: bold"/>    
                                </p:outputPanel>
                            </div>
                        </div>
                    </p:outputPanel>
                </p:outputPanel>
                <p:outputPanel id="form_detail_edit_flux">
                    <h:panelGrid columns="7" styleClass="yvs_nostyle" style="float: left; font-size: 0.8em" id="panel_detail_ppte_cycle_op">
                        <h:outputText value="Id" />
                        <h:outputText value="#{lab.L_date}" />
                        <h:outputText value="#{lab.L_tranche}" />
                        <h:outputText title="#{lab.LP_POF_cycles_operatoire}" value="Cycle N°" />
                        <h:outputText value="#{lab.L_debut}" />
                        <h:outputText value="#{lab.L_fin}" />
                        <h:outputText value="&nbsp;" />
                        <h:outputText value="#{managedOrdresF.suiviOperation.id}" />
                        <h:outputText value="#{managedOrdresF.currentSession.dateSession}" converter="DATE"/>
                        <h:outputText value="#{managedOrdresF.currentSession.tranche.titre}" />
                        <h:outputText value="#{managedOrdresF.suiviOperation.reference}" style="font-weight: bold; color: #000066"/>
                        <pe:timePicker value="#{managedOrdresF.suiviOperation.heureDebut}" style="width: 70px"/>
                        <pe:timePicker value="#{managedOrdresF.suiviOperation.heureFin}" style="width: 70px"/>
                        <h:panelGroup>
                            <p:commandLink rendered="#{managedOrdresF.suiviOperation.id gt 0}" onclick="dlgConfirmDelSuivi.show()" type="button">
                                <h:graphicImage library="icones" name="alert.png"  title="#{lab.LP_POF_supprimer_cycle}"/>
                            </p:commandLink>
                        </h:panelGroup>
                    </h:panelGrid>
                    <h:panelGrid style="float: right; width: 100px" columns="1">
                        <span>#{lab.LP_POF_pf_declarer} </span>
                        <pe:inputNumber value="#{managedOrdresF.qteAProduire}"  decimalPlaces="2" maxValue="999999999999999" style="width: 100px; text-align: center">
                            <p:ajax event="blur" listener="#{managedOrdresF.calculBesoinProduit()}" update="table_suivi_edit_flux"/>
                        </pe:inputNumber>
                    </h:panelGrid>
                </p:outputPanel>
                <p:dataTable value="#{managedOrdresF.selectedFlux.listeSuiviFlux}" var="item_es" selectionMode="single" rowIndexVar="line_s_" rowKey="#{item_es.id}"
                             id="table_suivi_edit_flux" editMode="cell" editable="true" style="font-size: 0.8em">
                    <p:ajax event="cellEdit" global="false" process="@this"  listener="#{managedOrdresF.listenChangeQuantite}" />
                    <p:column headerText="N°" width="15" style="text-align: center">
                        #{line_s_+1}
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" width="80"  >                                    
                        <span style="color: #{((item_es.composant.composant.stock lt item_es.quantite) and (item_es.composant.sens eq 'S'))?'red':'inherit'}"
                              title="#{(item_es.composant.composant.stock lt item_es.quantite)?'Stock article insuffisant':''}">
                            <b >#{item_es.composant.composant.article.refArt}</b>
                        </span>
                    </p:column>
                    <p:column headerText="#{lab.LP_PN_composant}" >
                        <span style="color: #{((item_es.composant.composant.stock lt item_es.quantite) and (item_es.composant.sens eq 'S')) ?'red':'inherit'}"
                              title="#{(item_es.composant.composant.stock lt item_es.quantite)?'Stock article insuffisant':''}">
                            #{item_es.composant.composant.article.designation}
                        </span>
                        <h:graphicImage library="img/icones" name="#{(item_es.composant.sens ne constantes.STOCK_SENS_SORTIE )?'in.png':'out.png'}"
                                        width="15" height="15" title="#{(item_es.composant.sens == constantes.STOCK_SENS_SORTIE )?'NORMAL':'SOUS-PRODUIT'}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PMS_stocks}" style="text-align: right">
                        <h:panelGroup rendered="#{item_es.composant.composant.article.suiviEnStock}">
                            <h:outputText value="#{managedOrdresF.giveStockMp(item_es.composant.composant)}" converter="#{managedOrdresF.cproduction}"/>       
                        </h:panelGroup>
                    </p:column>
                    <p:column headerText="#{lab.LP_POF_qte_cycle}" style="text-align: right" rendered="#{managedOrdresF.suiviOperation.id gt 0}">
                        <h:outputText value="#{managedOrdresF.giveQteCycleOp(item_es.composant,managedOrdresF.suiviOperation.id)}" converter="#{managedOrdresF.cproduction}"/>       
                    </p:column>
                    <p:column headerText="#{lab.LP_POF_en_cours}" width="100"  style="text-align: right">
                        <h:outputText value="#{item_es.quantiteSave}" converter="#{managedOrdresF.cproduction}"/>       /
                        <h:outputText value="#{item_es.composant.quantite}" converter="#{managedOrdresF.cproduction}" style="font-weight: bold"/>
                    </p:column>    
                    <p:column headerText="#{lab.LCF_PC_reste}" width="100"  style="text-align: right">
                        <h:outputText value="#{item_es.composant.quantite-item_es.quantiteSave}" converter="#{managedOrdresF.cproduction}" />
                    </p:column>    
                    <p:column headerText="#{lab.LP_PGF_perte}" width="100"  style="text-align: right">
                        <p:cellEditor >
                            <f:facet name="output" >
                                <h:outputText value="#{item_es.quantitePerdue}" converter="#{managedOrdresF.cproduction}" id="cell_qte12"/>
                            </f:facet>
                            <f:facet name="input">
                                <h:inputText value="#{item_es.quantitePerdue}" style="width: 80px" id="cell_qte22" disabled="#{item_es.composant.sens eq constantes.STOCK_SENS_SORTIE}"/>
                            </f:facet>
                        </p:cellEditor>
                    </p:column>    
                    <p:column headerText="" style="text-align: right" width="90">
                        <f:facet name="header">
                            <span>#{lab.L_quantite}</span>
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px; float: right" title="#{lab.LP_POF_option_remplissage}" type="button" id="btn_opt_qte_flux"
                                             rendered="#{accesRessource.prod_acces_raccourcis}"/>
                            <p:contextMenu for="btn_opt_qte_flux" event="left click" style="font-size: 0.8em; width: 220px">
                                <p:menuitem icon="ui-icon-arrowthickstop-1-s" value="#{lab.LP_POF_appliquer_restes}" actionListener="#{managedOrdresF.applyResteQte(false)}"
                                            />
                                <p:menuitem icon="ui-icon-arrowthickstop-1-s" value="#{lab.LP_POF_appliquer_enregistrer_restes}" actionListener="#{managedOrdresF.applyResteQte(true)}"
                                            />
                            </p:contextMenu>
                        </f:facet>
                        <p:cellEditor >
                            <f:facet name="output" >
                                <h:outputText value="#{item_es.quantite}" converter="#{managedOrdresF.cproduction}" id="cell_qte1"/>
                            </f:facet>
                            <f:facet name="input">
                                <h:inputText value="#{item_es.quantite}" style="width: 80px" id="cell_qte2" />
                            </f:facet>
                        </p:cellEditor>
                    </p:column>
                    <p:column headerText="" width="15"  style="text-align: right">
                        <p:commandButton icon="ui-icon-circle-minus" styleClass="button_gear center" title="#{lab.LP_POF_retirer_composant_operation}"
                                         actionListener="#{managedOrdresF.deleteUseComposant(item_es)}"/>                        
                        <f:facet name="header">
                            <p:commandButton icon="ui-icon-circle-plus" styleClass="button_gear center" title="#{lab.LP_POF_ajouter_composant_operation}"
                                             onclick="dlgComposantOFView.show()" />
                        </f:facet>
                    </p:column> 
                </p:dataTable>
                <p:outputPanel autoUpdate="true">
                    <p:commandButton rendered="#{managedOrdresF.suiviOperation.id gt 0}" value="#{lab.LP_POF_appliquer_nouveau}" actionListener="#{managedOrdresF.saveFluxStock(true)}" 
                                     update=":formulaire_mainOrdreF:zone_diplay_op table_suivi_edit_flux" icon="ui-icon-arrowthickstop-1-s"
                                     title="#{lab.LP_POF_appliquer_flux_nouveau_cycle_operation}"/>                
                    <p:commandButton value="#{(managedOrdresF.suiviOperation.id gt 0)?'Modifier':'Appliquer'}" actionListener="#{managedOrdresF.saveFluxStock(false)}" 
                                     update=":formulaire_mainOrdreF:zone_diplay_op table_suivi_edit_flux panel_detail_ppte_cycle_op" icon="ui-icon-arrowthickstop-1-s"/>                
                </p:outputPanel>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="formulaire_update_flux">
            <p:dialog header=" " width="80%" widgetVar="dlgSuiviFlux" footer="&copy;Lymytz 2014" closeOnEscape="true">
                <f:facet name="header">
                    #{lab.LP_POF_suivi_flux_operation} :
                    <h:panelGroup id="header_detail_flux">
                        <h:outputText value="#{managedOrdresF.selectedFlux.operation.codeRef}" style="color: #aaa; font-size: 0.8em"  /> /
                        <h:outputText value="#{managedOrdresF.selectedFlux.composant.article.designation}" style="color: #aaa; font-size: 0.8em" />
                    </h:panelGroup>
                </f:facet>
                <p:outputPanel id="form_detail_flux">
                    <div>#{lab.LP_POF_enregistrer_nouveau_flux}  
                        <h:outputText value="#{managedOrdresF.selectedFlux.composant.article.designation}" style="color: #aaa; font-size: 0.8em"/></div>
                    <h:panelGrid columns="2" styleClass="yvs_nostyle" >
                        <h:outputText value="Id: " title="Id #{lab.LP_POF_flux_composant}"/>
                        <h:outputText value="#{managedOrdresF.selectedFlux.id}" />                        
                    </h:panelGrid>
                </p:outputPanel>
                <p:dataTable value="#{managedOrdresF.selectedFlux.listeSuiviFlux}" var="item_so"  rowIndexVar="line_s_" rowKey="#{item_so.id}"
                             id="table_suivi_flux">
                    <p:column headerText="N°" width="15" style="text-align: center">
                        #{line_s_+1}
                    </p:column>
                    <p:column headerText="#{lab.L_quantite}">
                        <h:outputText value="#{item_so.quantite}" converter="#{managedOrdresF.cproduction}" />
                    </p:column>
                    <p:column headerText="#{lab.LP_POF_cout}">
                        <h:outputText value="#{item_so.cout}" converter="#{managedOrdresF.converterCoutStock}" />
                    </p:column>
                    <p:column headerText="#{lab.LP_POF_ref_op}">
                        <h:outputText value="#{item_so.idOperation.referenceOp}"  />
                    </p:column>
                    <p:column headerText="#{lab.LP_POF_equipes}">
                        #{item_so.idOperation.sessionOf.sessionProd.equipe.nom}
                    </p:column>
                    <p:column headerText="#{lab.L_dates}">
                        <h:outputText value="#{item_so.idOperation.sessionOf.sessionProd.dateSession}" converter="DATE" />
                    </p:column>
                    <p:column headerText="#{lab.L_tranche}">
                        <h:outputText value="#{item_so.idOperation.sessionOf.sessionProd.tranche.titre}" /> 
                    </p:column>
                    <p:column headerText="#{lab.LP_POF_operateur}">
                        <h:outputText value="#{item_so.idOperation.sessionOf.sessionProd.producteur.nomUsers}" /> 
                    </p:column>
                    <p:column headerText="" style="text-align: center" width="15">
                        <p:contextMenu for="opt_suivi_flux_composant" event="left click">
                            <p:menuitem value="#{lab.LP_POF_recalculer_cout}" icon="ui-icon-refresh" actionListener="#{managedOrdresF.valoriseOperation(item_so.idOperation)}"
                                        update="table_suivi_flux"/>
                            <p:separator />
                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedOrdresF.deleteSuiviFlux(item_so)}" update="table_suivi_flux"/>
                        </p:contextMenu>
                        <p:commandButton  style="width: 22px; height: 22px" type="button" icon="ui-icon-gear" id="opt_suivi_flux_composant"/>
                    </p:column>  
                </p:dataTable>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="formulaire_propriete_phase">
            <p:dialog closeOnEscape="true" width="85%" position="center" showEffect="fade" hideEffect="scale" widgetVar="dlgProprieteOp"
                      >
                <f:facet name="header">
                    #{lab.LP_POF_proprietes_operation} .:
                    <h:outputText value="#{managedOrdresF.operation.reference}" style="color: #aaa; font-size: 0.8em" id="headPPt"/>
                </f:facet>
                <p:outputPanel id="formPptePhase">
                    <p:outputPanel layout="block"  rendered="#{managedOrdresF.operation.id gt 0}" style="width: 100%">
                        <h:panelGroup style="float: left">
                            <p:commandButton title="#{lab.LP_POF_operation_precedente}" update="headPPt formPptePhase" actionListener="#{managedOrdresF.navigueInListOperation(false)}" global="false"  icon="ui-icon-circle-triangle-w" />                            
                            <p:commandButton title="#{lab.LP_POF_operation_suivante} " update="headPPt formPptePhase" actionListener="#{managedOrdresF.navigueInListOperation(true)}" global="false"  icon="ui-icon-circle-triangle-e" />                            
                        </h:panelGroup>
                        <h:panelGroup id="zone_state_op" style="float: right;font-size: 0.9em">
                            <p:commandLink value="#{lab.LP_POF_en_attente}" title="Pause" styleClass="#{(managedOrdresF.operation.statutOp==constantes.STATUT_DOC_ATTENTE)?'statut_valide':'etat_formation_true'}"                                    
                                           process="@this"  actionListener="#{managedOrdresF.changeStatutOp(constantes.STATUT_DOC_ATTENTE)}"
                                           update=":formulaire_mainOrdreF:zone_operations :formulaire_mainOrdreF:tablePhase_:table_composantOF"/>
                            <p:commandLink value="#{lab.LP_POF_en_cours}" styleClass="#{(managedOrdresF.operation.statutOp==constantes.STATUT_DOC_ENCOUR)?'statut_valide':'etat_formation_true'}"                                    
                                           process="@this"  actionListener="#{managedOrdresF.changeStatutOp(constantes.STATUT_DOC_ENCOUR)}"
                                           update=":formulaire_mainOrdreF:zone_operations :formulaire_mainOrdreF:tablePhase_:table_composantOF"/>
                            <p:commandLink value="#{lab.LP_POF_terminer}" styleClass="#{(managedOrdresF.operation.statutOp==constantes.STATUT_DOC_TERMINE)?'statut_valide':'etat_formation_true'}" 
                                           process="@this"  actionListener="#{managedOrdresF.finishOperation()}" disabled="#{managedOrdresF.operation.statutOp.equals(constantes.STATUT_DOC_ATTENTE)}"
                                           update=":formulaire_mainOrdreF:zone_operations :formulaire_mainOrdreF:tablePhase_:table_composantOF"/>
                        </h:panelGroup>
                    </p:outputPanel>
                    <h:panelGrid columns="1" styleClass="yvs_nostyle" style="width: 100%" cellpadding="0" cellspacing="0">  
                        <h:panelGrid columns="4" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                            <f:facet name="header">
                                <div align="left" style="padding: 5px">
                                    <span> 
                                        <span style="font-weight: normal">Op. N° : </span>
                                        <h:outputText value="#{managedOrdresF.operation.numero}" style="font-weight: bold" rendered="#{managedOrdresF.operation.id gt 0}"/>
                                        <h:inputText value="#{managedOrdresF.operation.numero}" style="font-weight: bold;width: 70px" rendered="#{managedOrdresF.operation.id lt 1}"/>
                                    </span> 
                                    <span>
                                        <span style="font-weight: normal; margin-left: 5%">#{lab.L_reference} : </span>
                                        <h:outputText value="#{managedOrdresF.operation.reference}" style="font-weight: bold" rendered="#{managedOrdresF.operation.id gt 0}"/>
                                        <h:inputText value="#{managedOrdresF.operation.reference}" style="font-weight: bold" rendered="#{managedOrdresF.operation.id lt 1}"/>
                                    </span> 
                                    <h:outputText style="float: right" styleClass="style_identifiant" value="#{managedOrdresF.operation.id}" />
                                </div>
                            </f:facet>
                            <span>#{lab.LP_POF_machine}</span>
                            <h:panelGroup id="op_poste_machine">
                                <h:outputText title="#{managedOrdresF.operation.machine.designation}" value="#{managedOrdresF.operation.machine.reference}" style="width: 80%; padding: 8px; background: #444; color: #FFF; margin-right: 8px"/>
                                <p:inplace label="#{managedOrdresF.operation.nbMachine}" style="font-weight: bold">
                                    <h:inputText value="#{managedOrdresF.operation.nbMachine}" disabled="#{managedOrdresF.operation.machine.id le 0 or managedOrdresF.operation.machine==null}"
                                                 style="width: 50px"/>
                                </p:inplace>
                                <p:contextMenu for="btn_opt_replace_pc_ma" event="left click">
                                    <p:menuitem value="#{lab.LP_POF_remplacer_poste}" icon="ui-icon-arrow-4-diag" rendered="#{managedOrdresF.operation.machine.id gt 0}"
                                                actionListener="#{managedOrdresF.openDlgPoste('MA')}"/>
                                    <p:separator />
                                    <p:menuitem value="#{lab.LP_POF_supprimer_poste}" icon="ui-icon-trash" rendered="#{managedOrdresF.operation.machine.id gt 0}"
                                                actionListener="#{managedOrdresF.operation.setMachine(null)}" update="op_poste_machine"/>
                                    <p:menuitem value="#{lab.LP_POF_ajouter_poste}" icon="ui-icon-circle-plus" rendered="#{managedOrdresF.operation.machine.id le 0 or managedOrdresF.operation.machine==null}"
                                                actionListener="#{managedOrdresF.openDlgPoste('MA')}"/>
                                </p:contextMenu>
                                <p:commandButton id="btn_opt_replace_pc_ma" icon="ui-icon-gear" title="#{lab.LP_POF_remplacer_poste}" style="width: 22px; height: 22px; margin-left: 2%"/>
                            </h:panelGroup>
                            <span>#{lab.LP_POF_main_oeuevre}</span>
                            <h:panelGroup  id="op_poste_mo" >
                                <h:outputText title="#{managedOrdresF.operation.mainOeuvre.designation}" value="#{managedOrdresF.operation.mainOeuvre.reference}" style="width: 80%; padding: 8px; background: #444; color: #FFF; margin-right: 8px"  />
                                <p:inplace label="#{managedOrdresF.operation.nbMainOeuvre}" style="font-weight: bold">
                                    <h:inputText value="#{managedOrdresF.operation.nbMainOeuvre}" disabled="#{managedOrdresF.operation.mainOeuvre.id le 0 or managedOrdresF.operation.mainOeuvre==null}"
                                                 style="width: 50px"/>
                                </p:inplace>
                                <p:contextMenu for="btn_opt_replace_pc_mo" event="left click">
                                    <p:menuitem value="#{lab.LP_POF_remplacer_poste}" icon="ui-icon-arrow-4-diag" rendered="#{(managedOrdresF.operation.mainOeuvre.id gt 0)}"
                                                actionListener="#{managedOrdresF.openDlgPoste('MO')}"/>
                                    <p:separator />
                                    <p:menuitem value="#{lab.LP_POF_supprimer_poste}" icon="ui-icon-trash" rendered="#{(managedOrdresF.operation.mainOeuvre.id gt 0)}"
                                                actionListener="#{managedOrdresF.operation.setMachine(null)}" update="op_poste_mo"/>
                                    <p:menuitem value="#{lab.LP_POF_ajouter_poste}" icon="ui-icon-circle-plus" rendered="#{managedOrdresF.operation.mainOeuvre.id le 0 or managedOrdresF.operation.mainOeuvre==null}"
                                                actionListener="#{managedOrdresF.openDlgPoste('MO')}"/>
                                </p:contextMenu>
                                <p:commandButton id="btn_opt_replace_pc_mo" icon="ui-icon-gear" title="#{lab.LP_POF_remplacer_main_oeuevre}" style="width: 22px; height: 22px; margin-left: 2%"/>
                            </h:panelGroup>
                            <span>#{lab.LP_POF_date_lancement_op}</span>
                            <h:panelGroup>
                                <p:calendar value="#{managedOrdresF.operation.dateDebut}" navigator="true" pattern="dd-MM-yyyy" size="8" />
                                <pe:timePicker value="#{managedOrdresF.operation.heureDebut}" style="width: 80px"/>                        
                            </h:panelGroup>
                            <span>#{lab.L_date_fin}</span>
                            <h:panelGroup>
                                <p:calendar value="#{managedOrdresF.operation.dateFin}" navigator="true" pattern="dd-MM-yyyy" size="8" />
                                <pe:timePicker value="#{managedOrdresF.operation.heureFin}" style="width: 80px"/>                        
                            </h:panelGroup>
                            <span title="#{lab.LP_PGF_temps_reglage}">#{lab.LP_PGF_temps_reglage}</span>
                            <h:panelGroup>
                                <pe:inputNumber value="#{managedOrdresF.operation.tempsReglage}" style="width: 100px"/>
                                <span style="font-size: 0.8em; font-weight: bold">(#{ordreFabrication.gamme.uniteTemps.reference})</span>
                            </h:panelGroup>
                            <span title="#{lab.LP_PGF_temps_operatoire}">#{lab.LP_PGF_temps_operatoire}</span>
                            <h:panelGroup >
                                <pe:inputNumber value="#{managedOrdresF.operation.tempsOperation}" style="width: 100px"/>                                                      
                                <span style="font-size: 0.8em; font-weight: bold"> (#{ordreFabrication.gamme.uniteTemps.reference})</span>
                            </h:panelGroup>                        
                        </h:panelGrid>
                        <h:inputTextarea value="#{managedOrdresF.operation.commentaire}" title="#{lab.LC_PR_commentaire}" style="width: 100%"  rows="1"/>                                                        
                    </h:panelGrid> 
                    <p:tabView id="tbv_ppte_op">
                        <p:tab title="#{lab.LP_POF_suivi_operations}">
                            <p:dataTable value="#{managedOrdresF.operation.operations}" var="isuiviOp" id="table_op_suivi_op"
                                         rowIndexVar="line_op" selectionMode="single" rowKey="#{isuiviOp.id}" style="max-height: 250px; overflow-y: auto">
                                <p:column headerText="#{lab.L_date}" >
                                    <h:outputText value="#{isuiviOp.sessionOf.sessionProd.dateSession}" converter="DATE" />
                                </p:column>
                                <p:column headerText="Cycle N°" >
                                    <h:outputText value="#{isuiviOp.referenceOp}" />
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_equipes}" >
                                    <span>#{isuiviOp.sessionOf.sessionProd.equipe.nom}</span>
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_producteurs}" >
                                    <span>#{isuiviOp.sessionOf.sessionProd.producteur.nomUsers}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_debut}" >
                                    <h:outputText value="#{isuiviOp.dateDebut}" converter="DATE" />
                                    <p:spacer width="5" />
                                    <h:outputText value="#{isuiviOp.heureDebut}" converter="TIME" />
                                </p:column>
                                <p:column headerText="#{lab.L_fin}" >
                                    <h:outputText value="#{isuiviOp.dateFin}" converter="DATE" />
                                    <p:spacer width="5" />
                                    <h:outputText value="#{isuiviOp.heureFin}" converter="TIME" />
                                </p:column>
                                <p:column headerText="#{lab.L_statut}" >
                                    <h:outputText value="#{managedOrdresF.giveNameStatut(isuiviOp.statut)}"/>
                                </p:column>
                                <p:column headerText="" >
                                    <p:contextMenu for="btn_opt_all_op_flux" event="left click">
                                        <p:menuitem value="#{lab.LP_POF_flux_stock}"  actionListener="#{managedOrdresF.displayFluxOneOperation(isuiviOp)}"/>
                                        <p:menuitem value="#{lab.LP_POF_recalculer_cout}"  actionListener="#{managedOrdresF.valoriseOperation(isuiviOp)}"/>
                                        <p:separator />
                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash"  actionListener="#{managedOrdresF.openSuiviFluxOperation(isuiviOp)}"/>
                                    </p:contextMenu>
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" type="button" id="btn_opt_all_op_flux"/>
                                </p:column>
                            </p:dataTable> 
                        </p:tab>
                        <p:tab title="#{lab.LP_POF_composants_operation}">
                            <p:dataTable value="#{managedOrdresF.operation.composants}" var="iconso" id="table_op_use_mp"
                                         rowIndexVar="line_cop" editMode="cell" editable="true" selectionMode="single" rowKey="#{iconso.id}">
                                <p:column headerText="Id" width="50" styleClass="#{(iconso.id gt 0 or iconso.inListByDefault)?'':'line_disable'}">
                                    <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{iconso.id eq managedOrdresF.selectedFlux.id}"/>                                
                                    <span style="font-weight: bold">#{iconso.id}</span>
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_composant}" styleClass="#{(iconso.id gt 0 or iconso.inListByDefault)?'':'line_disable'}">
                                    <span style="font-weight: bold">[#{iconso.composant.article.refArt}]</span>
                                    <span > #{iconso.composant.article.designation}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_unite}" width="15" style="text-align: center" styleClass="#{(iconso.id gt 0 or iconso.inListByDefault)?'':'line_disable'}">
                                    <h:outputText styleClass="style_unite" value="#{iconso.composant.unite.unite.reference}" title="#{iconso.composant.unite.unite.libelle}"/>                      
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_qte_perdue}" style="text-align: right" styleClass="#{(iconso.id gt 0 or iconso.inListByDefault)?'':'line_disable'}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{iconso.quantitePerdue}" converter="#{managedOrdresF.cproduction}" title="#{iconso.tauxComposant} %"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <h:inputText value="#{iconso.quantitePerdue}" style="width:70%" disabled="#{!ordreFabrication.suiviStockByOperation or iconso.id gt 0}"/>
                                        </f:facet>
                                    </p:cellEditor>                        
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_flux_reel}" style="text-align: right" styleClass="#{(iconso.id gt 0 or iconso.inListByDefault)?'':'line_disable'}">
                                    <h:outputText value="#{iconso.quantiteFlux}" converter="#{managedOrdresF.cproduction}" title="#{iconso.tauxComposant} %"/>                            
                                </p:column>
                                <p:column headerText="#{lab.L_quantite}" style="text-align: right" styleClass="#{(iconso.id gt 0 or iconso.inListByDefault)?'':'line_disable'}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{iconso.quantite}" converter="#{managedOrdresF.cproduction}" title="#{iconso.tauxComposant} %"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <h:inputText value="#{iconso.quantite}" style="width:70%" disabled="#{!ordreFabrication.suiviStockByOperation or iconso.id gt 0}"/>
                                        </f:facet>
                                    </p:cellEditor>                        
                                </p:column>
                                <p:column headerText="#{lab.LC_PFA_sens}" style="text-align: center" width="15" styleClass="#{(iconso.id gt 0 or iconso.inListByDefault)?'':'line_disable'}">
                                    <h:graphicImage title="#{(iconso.sens eq constantes.STOCK_SENS_ENTREE)?'Production de stock':'Consommation de stock'}" library="icones" rendered="#{iconso.inListByDefault or iconso.id gt 0}" name="#{(iconso.sens eq constantes.STOCK_SENS_ENTREE)?'in.png':'out.png'}" width="15" height="15"/>
                                </p:column>
                                <p:column headerText="" style="text-align: center" width="15">
                                    <f:facet name="header">
                                        <p:commandButton  style="width: 22px; height: 22px" type="button" icon="ui-icon-gear"
                                                          id="opt_flux_composant_h"/>
                                        <p:contextMenu for="opt_flux_composant_h" event="left click" style="width: 300px">                                       
                                            <p:menuitem value="#{lab.L_ajouter}" icon="ui-icon-circle-plus" actionListener="#{managedOrdresF.openToAddNewComposant(false)}" 
                                                        title="#{lab.LP_POF_ajouter_nouveau_composant_of}"  />                                
                                        </p:contextMenu>
                                    </f:facet>
                                    <p:commandButton  style="width: 22px; height: 22px" type="button" icon="ui-icon-gear"
                                                      id="opt_flux_composant"/>
                                    <p:contextMenu for="opt_flux_composant" event="left click" style="width: 300px">
                                        <p:menuitem value="#{lab.LP_POF_voir_flux_de} #{(iconso.sens eq constantes.STOCK_SENS_SORTIE)? 'consommations':'productions'}" icon="ui-icon-folder-open" 
                                                    actionListener="#{managedOrdresF.loadDetailFluxCOmposant(iconso)}"  title="#{lab.LP_POF_modifier_details_flux}"  oncomplete="dlgSuiviFlux.show()"  />
                                        <p:menuitem value="#{lab.LP_POF_effacer}" icon="ui-icon-trash" actionListener="#{managedOrdresF.removeComposant(iconso)}"
                                                    title="#{lab.LP_POF_supprimer_composant_operation}"/>
                                        <p:separator />
                                        <p:menuitem value="#{lab.LP_POF_remplacer}" icon="ui-icon-transferthick-e-w" actionListener="#{managedOrdresF.replaceComposant(iconso)}"    />                                
                                    </p:contextMenu>
                                </p:column>                    
                            </p:dataTable> 
                        </p:tab>
                    </p:tabView>                                   
                </p:outputPanel>
                <f:facet name="footer">
                    &copy; lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="formulaire_propriete_composant">
            <p:dialog id="headPPtC" closeOnEscape="true" width="65%" position="center" showEffect="fade" hideEffect="scale" 
                      widgetVar="dlgProprieteComposant" height="500" >
                <f:facet name="header">
                    #{lab.LP_POF_proprietes_composant} 
                    <h:outputText id="headPPtCc" value="#{managedOrdresF.composant.composant.designation}" style="text-decoration: underline; font-style: italic; color: #009999"/>
                </f:facet>
                <h:panelGrid id="formPpteComposant" columns="1" style="width: 100%; font-size: 0.9em" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <div align="left">
                            <h:inputText value="#{managedOrdresF.composant.id}" style="font-weight: bold; width: 80px; text-align: center; background: #CCC" disabled="true"/> 
                            <h:panelGroup rendered="#{managedOrdresF.composant.id lt 1}">
                                <h:inputText id="txt_article_composant" value="#{managedOrdresF.composant.composant.refArt}" style="color: #{managedOrdresF.composant.composant.error?'red':''}">
                                    <p:ajax event="valueChange" global="false" listener="#{managedOrdresF.searchArticle(managedOrdresF.composant.composant.refArt, true)}" update="txt_article_composant headPPtCc"/>
                                </h:inputText>  
                                <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="#{lab.L_liste_article}" global="false"
                                                 actionListener="#{managedOrdresF.initArticles(true)}" oncomplete="dlgListArticle.show()"/>
                            </h:panelGroup>
                            <p:selectOneRadio  styleClass="yvs_nostyle" value="#{managedOrdresF.composant.nature}" style="float: right; font-size: 0.8em">
                                <f:selectItem itemValue="#{constantes.PROD_OP_TYPE_COMPOSANT_NORMAL}" itemLabel="#{lab.LP_POF_composant_normal}" />
                                <f:selectItem itemValue="#{constantes.PROD_OP_TYPE_COMPOSANT_SOUS_PRODUIT}" itemLabel="#{lab.LP_POF_sous_produits.toUpperCase()}" />
                            </p:selectOneRadio>
                        </div>
                    </f:facet>
                    <h:panelGrid columns="6" styleClass="yvs_nostyle size-08" cellpadding="0" cellspacing="0" >
                        <h:outputText value="#{lab.LP_POF_point_consommation}" />
                        <span>#{lab.L_unite} </span>
                        <h:outputText value="#{lab.LP_POF_reference_lot}" />
                        <h:outputText value="#{lab.LP_POF_mode_arrondi}"/>
                        <h:outputText value="#{lab.LP_POF_participe_cout}"/>
                        <h:outputText value=""/>
                        <h:selectOneMenu value="#{managedOrdresF.composant.depotConso.id}" style="max-width: 180px">
                            <f:selectItem itemLabel="--" itemValue="-1" />
                            <f:selectItems value="#{managedDepot.depots}"
                                           var="_idept" itemLabel="#{_idept.designation}"  itemValue="#{_idept.id}" />
                            <p:ajax event="valueChange" global="false" listener="#{managedOrdresF.chooseUniteComposant()}"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu id="txt_unite_composant" value="#{managedOrdresF.composant.unite.id}" style="min-width: 120px; max-width: 180px">
                            <f:selectItem itemLabel="--" itemValue="-1" />
                            <f:selectItems value="#{managedOrdresF.composant.composant.conditionnements}"
                                           var="icon_c" itemLabel="[#{icon_c.unite.reference}] #{icon_c.unite.libelle}"  itemValue="#{icon_c.id}" />
                            <p:ajax event="valueChange" global="false" listener="#{managedOrdresF.chooseUniteComposant()}"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedOrdresF.composant.lotSortie.id}" style="min-width: 180px" >
                            <f:selectItem itemLabel="--" itemValue="-1" />
                            <f:selectItems value="#{managedLotReception.lots}"
                                           var="icon_l" itemLabel="#{icon_l.numero}"  itemValue="#{icon_l.id}" />
                            <p:ajax event="valueChange" global="false" listener="#{managedOrdresF.chooseLotComposant()}"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedOrdresF.composant.modeArrondi}">
                            <f:selectItem itemValue="S" itemLabel="#{lab.LP_POF_valeur_superieur}" />
                            <f:selectItem itemValue="I" itemLabel="#{lab.LP_POF_valeur_inferieur} "/>
                            <f:selectItem itemValue="E" itemLabel="#{lab.LP_POF_valeur_exacte} "/>
                            <f:selectItem itemValue="N" itemLabel="#{lab.LP_PN_pas_arrondi.toLowerCase()}"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedOrdresF.composant.insideCout}" style="width: 100px">
                            <f:selectItem itemValue="#{true}" itemLabel="#{lab.L_oui}" />
                            <f:selectItem itemValue="#{false}" itemLabel="#{lab.L_non}"/>
                        </h:selectOneMenu>
                        <p:selectBooleanCheckbox value="#{managedOrdresF.composant.freeUse}" itemLabel="Utilisation libre"/>
                    </h:panelGrid>   
                    <f:facet name="footer">
                        <h:inputTextarea value="#{managedOrdresF.composant.commentaire}" title="#{lab.LC_PR_commentaire}" style="width: 100%" />                             
                    </f:facet>
                </h:panelGrid>                                                               
                <div align="left" style="margin-top: 5px">
                    <p:tabView id="tbv_composant_of">
                        <p:tab title="#{lab.LP_POF_flux_oper}">
                            <p:dataTable value="#{managedOrdresF.composant.composantsUsed}" var="cop" rowKey="#{cop.id}" editable="true" editMode="cell">
                                <p:column headerText="#{lab.LP_POF_num_operation}" styleClass="statut_#{cop.operation.statutOp}">
                                    #{cop.operation.numero}
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_code_operation}" styleClass="statut_#{cop.operation.statutOp}">
                                    #{cop.operation.codeRef}
                                </p:column>
                                <p:column headerText="#{lab.L_quantite}" style="text-align: right" styleClass="statut_#{cop.operation.statutOp}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{cop.quantite}" title="#{cop.tauxComposant} %" converter="DNS"/>
                                            <h:outputText styleClass="style_unite" value="#{cop.composant.unite.unite.reference}" />
                                        </f:facet>
                                        <f:facet name="input">
                                            <h:inputText  value="#{cop.quantite}" style="width:70%" disabled="#{cop.operation.statutOp==constantes.ETAT_TERMINE}"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>
                            </p:dataTable>
                        </p:tab>                        
                    </p:tabView>                    
                </div>
                <div>
                    <div>Stocks</div>
                    <p:dataTable value="#{managedOrdresF.composant.composant.conditionnements}" var="_icond" >
                        <p:column headerText="#{lab.L_reference}" width="80">
                            #{managedOrdresF.composant.composant.refArt}
                        </p:column>
                        <p:column headerText="#{lab.L_article}" >
                            #{managedOrdresF.composant.composant.designation}
                        </p:column>
                        <p:column headerText="#{lab.L_unite}" width="60" >
                            <span title="#{_icond.unite.libelle}">#{_icond.unite.reference}</span>
                        </p:column>
                        <p:column headerText="#{lab.LP_PC_stock}" style="text-align: right" width="120">
                            <h:outputText value="#{managedOrdresF.giveStockMp(managedOrdresF.selectedComposant,_icond.id)}" converter="#{managedOrdresF.cproduction}" rendered="#{managedOrdresF.currentSession.id gt 0}"
                                          title="#{lab.LP_POF_stock_point} #{(managedOrdresF.selectedComposant.depotConso.id gt 0)?managedOrdresF.selectedComposant.depotConso.designation:managedOrdresF.currentSession.depot.designation}"/>       
                        </p:column>
                        <p:column headerText="" width="25" style="text-align: center">
                            <p:contextMenu for="btn-opt-cond" event="left click">
                                <p:menuitem value="#{lab.LP_POF_reconditionner}" icon="ui-icon-transferthick-e-w" actionListener="#{managedOrdresF.openToRecond(managedOrdresF.composant, _icond)}"/>
                            </p:contextMenu>
                            <p:commandButton styleClass="button_gear" icon="ui-icon-gear" type="button" id="btn-opt-cond"/>
                        </p:column>
                    </p:dataTable>
                </div>
                <p:commandButton value="#{lab.L_appliquer}" style="float: right" oncomplete="dlgProprieteComposant.hide()"
                                 actionListener="#{managedOrdresF.applyPropertyComposant()}"/>
                <f:facet name="footer">
                    &copy; lymytz
                </f:facet>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmFinish" closeOnEscape="true"
                             message="#{lab.LP_PC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedConditionnement.terminer()}" oncomplete="dlgConfirmFinish.hide();collapseForm('conditionnement')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmFinish.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmEditer" closeOnEscape="true"
                             message="#{lab.LP_PC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedConditionnement.annuler(false, true)}" oncomplete="dlgConfirmEditer.hide();collapseForm('conditionnement')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmEditer.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuler" closeOnEscape="true"
                             message="#{lab.LC_PR_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedConditionnement.annuler(true, true)}" oncomplete="dlgConfirmAnnuler.hide();collapseForm('conditionnement')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAnnuler.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmDeleteConditionnement" closeOnEscape="true"
                             message="#{lab.LP_POF_text11}" header="#{lab.L_confirmation}" width="40%">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedConditionnement.deleteBean()}" 
                                 oncomplete="dlgConfirmDeleteConditionnement.hide()" update=":main_declaration:data_fiche_conditionnement"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteConditionnement.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LP_POF_text11}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.deleteBean()}" update=":formulaire_mainOrdreF:tableOF"
                                 oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LP_POF_text11}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.deleteOrdres()}" update=":formulaire_mainOrdreF:tableOF"
                                 oncomplete="dlgConfirmDelete_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteOperation" closeOnEscape="true"
                             message="#{lab.LP_POF_text11}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.deleteBeanOperation()}" update=":formulaire_mainOrdreF:zone_operations"
                                 oncomplete="dlgConfirmDeleteOperation.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteOperation.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteComposant" closeOnEscape="true"
                             message="#{lab.LP_POF_text11}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOrdresF.deleteBeanComposant()}" update=":formulaire_mainOrdreF:tablePhase_:table_composantOF"
                                 oncomplete="dlgConfirmDeleteComposant.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteComposant.hide()"/>
            </p:confirmDialog>
        </h:form>
        <div style="width: 100%; overflow-y: hidden"> 
            <h:form prependId="false" id="formulaire_mainOrdreF" style="width: 100%; overflow-y: hidden"> 
                <div class="part_fix">  
                    <p:splitButton value="#{lab.L_enregistrer}" id="save_of" actionListener="#{managedOrdresF.saveNew()}" icon="ui-icon-disk"
                                   update="tableOF panel_state of_depot tablePhase_:table_composantOF of_statut_zone zone_operations zone_diplay_op">

                        <p:menuitem value="#{lab.L_nouveau}"  id="cancel_of" update="panel_state formOF tablePhase_ of_depot zone_diplay_op"
                                    actionListener="#{managedOrdresF.resetFiche()}" icon="ui-icon-document"/> 
                        <p:separator />
                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash"  onclick="dlgConfirmDelete_.show()" global="false"/>

                    </p:splitButton>
                    <!-->Un champ caché pour gérer la mise à zero du formulaire<-->
                    <h:inputHidden value="#{managedOrdresF.chaineSelectOf}" id="input_hide_of" />
                    <p:splitButton type="button" value="#{lab.LP_POF_simulateur}" style="font-size: 0.8em" id="page_prod_splitbutton"
                                   onclick="dlgSimulation.show()" icon="ui-icon-calendar">
                        <p:menuitem value="#{lab.LP_POF_recalculer_cout}" icon="ui-icon-refresh" actionListener="#{managedOrdresF.recalculOrder()}" 
                                    id="option_of" update="control_cout_of zone_cout_of"/>
                        <p:menuitem value="#{lab.LP_POF_programmation}" icon="ui-icon-note" actionListener="#{managedOrdresF.resetProgram()}"
                                    oncomplete="dlgProgramOrdre.show()" update=":main-programmation_of:form-programmation_of"/>
                        <p:menuitem value="#{managedOrdresF.displayAll?'Affichage réduit':'Tout afficher'}" icon="#{managedOrdresF.displayAll?'ui-icon-copy':'ui-icon-newwin'}" actionListener="#{managedOrdresF.setDisplayAll(!managedOrdresF.displayAll)}"
                                    update=":formulaire_mainOrdreF:formOF page_prod_splitbutton"/>
                        <p:separator />                        
                        <p:menuitem value="#{lab.LC_PMS_declarations}" actionListener="#{managedOrdresF.loadDeclaration()}" oncomplete="dlgDeclaration.show(); collapseList('declaration');"/>
                        <p:separator />
                        <p:menuitem value="#{lab.LP_POF_recalcul_cout}" actionListener="#{managedOrdresF.openDlgMaintenance('dlgRecalculCout')}" 
                                    icon="ui-icon-wrench" global="false" />                        
                        <p:menuitem value="#{lab.LP_POF_recalcul_flux} " actionListener="#{managedOrdresF.openDlgMaintenance('dlgRecalculCout')}"
                                    icon="ui-icon-wrench" global="false" />
                        <p:separator />
                        <p:menuitem value="#{lab.LP_POF_voir_besoin}" icon="ui-icon-newwin" actionListener="#{managedOrdresF.getOrdres()}" 
                                    oncomplete="dlgBesoin.show()" global="false"  />
                        <p:separator />
                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" id="delete_of" onclick="dlgConfirmDelete_.show()" global="false"/>
                    </p:splitButton>                    
                    <div style="float: right">                        
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('of');
                                return false">
                            <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>               
                        <p:spacer />
                        <h:link onclick="collapseList('of');
                                return false" title="#{lab.L_mode_liste}" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>          
                    </div>
                    <h:panelGroup style="float: right; margin-right: 45%">
                        <p:commandButton actionListener="#{managedOrdresF.parcoursInAllResult(false)}" 
                                         update="formOF txt_parc_linear_ordre_fabrication tablePhase_ tableOF zone_diplay_op"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('of')"/>
                        <h:inputText value="#{managedOrdresF.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_ordre_fabrication"/>
                        <p:outputPanel autoUpdate="true">                        
                            <p:outputLabel value="/#{managedOrdresF.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedOrdresF.parcoursInAllResult(true)}" 
                                         update="formOF txt_parc_linear_ordre_fabrication tablePhase_ tableOF zone_diplay_op" icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('of')"/>
                    </h:panelGroup>
                </div> 
                <div class="part_scroll" style="background: white">
                    <div style="width: 100%;" class="yvs_form_of">
                        <p:overlayPanel for="btn-opt-session-prod"  hideEffect="fade" id="panel-opt-session-prod" appendToBody="true"
                                        my="left bottom">
                            <div style="font-size: 0.9em">  
                                <p:commandButton value="#{lab.LP_POF_gerer_sessions}" type="button" icon="ui-icon-extlink" onclick="dlgInfoSession_.show()"/>                                            
                            </div >
                            <h:panelGrid columns="2" rendered="#{managedOrdresF.currentSession.id gt 0}" style="font-size: 0.8em; width: 100%">
                                <f:facet name="header">
                                    <h:inputText value="#{managedOrdresF.currentSession.id}" style="font-weight: bold; width: 60px; text-align: right; background: #CCC; float: left" disabled="true"/> 
                                </f:facet>
                                <span>#{lab.LP_POF_equipe}</span>
                                <h:outputText value="#{managedOrdresF.currentSession.equipe.nom}" style="font-weight: bold; color: darkblue; float: right;font-size: 0.9em"/>
                                <span>#{lab.LP_POF_producteur}</span>
                                <h:outputText value="#{managedOrdresF.currentSession.producteur.nomUsers}" style="font-weight: bold; color: darkblue; float: right;font-size: 0.9em"/>
                                <span>#{lab.LP_POF_depots}</span>
                                <h:outputText value="#{managedOrdresF.currentSession.depot.designation}" style="font-weight: bold; color: darkblue; float: right;font-size: 0.9em"/>
                                <span>#{lab.L_tranche}</span>
                                <h:panelGroup style="float: right">
                                    <h:outputText value="#{managedOrdresF.currentSession.dateSession}" converter="DATE" style="font-weight: bold; color: darkblue;font-size: 0.9em"/>
                                    <p:spacer width="2" />
                                    <h:outputText value="  #{managedOrdresF.currentSession.tranche.titre}" style="font-weight: bold; color: darkblue;font-size: 0.9em"/>
                                </h:panelGroup>
                            </h:panelGrid>
                            <p:dataTable value="#{managedOrdresF.currentSession.ordreF.operations}" var="item_op" style="font-size: 0.8em; max-height: 150px; overflow-y: auto"
                                         id="table_operation_session">
                                <f:facet name="header">#{lab.LP_POF_mes_operations}</f:facet>
                                <p:column headerText="#{lab.L_numero}">
                                    #{item_op.id}
                                </p:column>
                                <p:column headerText="#{lab.L_numero}">
                                    #{item_op.operationOf.numero}
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_ref_cycle}">
                                    #{item_op.referenceOp}
                                </p:column>
                                <p:column headerText="#{lab.LP_POF_operation}">
                                    #{item_op.operationOf.codeRef}
                                </p:column>
                                <p:column headerText="#{lab.L_debut}">
                                    <h:outputText value="#{item_op.dateDebut}" converter="DATE" />
                                    <p:spacer width="5" />
                                    <h:outputText value="#{item_op.heureDebut}" converter="TIME" />
                                </p:column>
                                <p:column headerText="#{lab.L_fin}">
                                    <h:outputText value="#{item_op.dateFin}" converter="DATE" /> 
                                    <p:spacer width="5" />
                                    <h:outputText value="#{item_op.heureDebut}" converter="TIME" />
                                </p:column>
                                <p:column headerText="">
                                    <p:contextMenu for="btn_opt_sess_op_flux" event="left click">
                                        <p:menuitem value="#{lab.LP_POF_flux_stock}" actionListener="#{managedOrdresF.displayFluxOneOperation(item_op)}"  />
                                    </p:contextMenu>
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" type="button" id="btn_opt_sess_op_flux"/>
                                </p:column>
                            </p:dataTable>
                        </p:overlayPanel>
                        <h:panelGrid id="formOF" columns="1" style="width: 100%" cellpadding="0" cellspacing="0">
                            <f:facet name="header">                                
                                <p:outputPanel autoUpdate="true" id="of_statut_zone">
                                    <h:panelGrid columns="2" style="float: left; font-weight: 300; font-size: 0.8em;">
                                        <span style="display: #{(ordreFabrication.id gt 0)?'inline':'none'}">Reference.: </span>
                                        <h:panelGroup>
                                            <h:outputText value="#{ordreFabrication.reference}" style="float: left;background: black;color: white"/>
                                            <p:commandButton title="#{lab.LP_POF_infos_session}" icon="ui-icon-person" style="width: 22px; height: 22px; margin-left: 5px" type="button" id="btn-opt-session-prod"/>                                        
                                        </h:panelGroup>
                                        <span style="display: #{(ordreFabrication.id gt 0)?'inline':'none'}">Statut déclaration.:</span>                                          
                                        <h:panelGroup  rendered="#{ordreFabrication.id gt 0}">
                                            <h:outputText value="#{(ordreFabrication.statutDeclaration eq constantes.ETAT_TERMINE)?'Déclaré ':(ordreFabrication.statutDeclaration eq constantes.ETAT_ENCOURS)?'En cours':'En Attente'}"  styleClass="button-stateOF_actif" style="font-size: 0.9em"/>
                                            <p:commandLink value="+ #{lab.LP_POF_declarer}" title="#{lab.LP_POF_enregistrer_nouvelle_declaration}"  style="font-size: 0.9em; text-decoration: none; margin-left: 3%"
                                                           actionListener="#{managedOrdresF.loadDeclaration()}" disabled="#{(ordreFabrication.statutDeclaration eq constantes.ETAT_TERMINE)}" rendered="#{(ordreFabrication.id gt 0) and accesRessource.prod_acces_raccourcis and ordreFabrication.nomenclature.typeNomenclature ne constantes.PROD_TYPE_NOMENCLATURE_TRANSFORMATION}"                                                        
                                                           oncomplete="dlgDeclaration.show()" update=":main_form_declaration:blog_declaration"/>
                                        </h:panelGroup>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2" style="display: inline" rendered="#{managedOrdresF.currentSession.ordreF.id gt 0}">
                                        <span style="font-size: 0.8em" title="#{managedOrdresF.currentSession.ordreF.id}">Session de </span>
                                        <p:commandLink  title="#{lab.LP_POF_afficher_resume_flux_stock}" value="#{managedOrdresF.currentSession.ordreF.sessionProd.producteur.nomUsers} (#{managedOrdresF.currentSession.ordreF.ordre.id})" style="font-size: 0.8em; font-weight: bold; text-decoration: none" 
                                                        actionListener="#{managedOrdresF.loadAllFluxComposant(false)}"/> 
                                    </h:panelGrid>
                                    <p:contextMenu for="panel_state">
                                        <p:menuitem value="#{lab.LP_POF_annuler_etape_courante}"  style="font-size: 0.8em" actionListener="#{managedOrdresF.changePreviousStateOf()}" update="panel_state tableOF"/>
                                    </p:contextMenu>
                                    <p:outputPanel id="panel_state" styleClass="yvs_form_of" style="font-size: 0.8em;float: right;margin-bottom: 10px" rendered="#{ordreFabrication.id gt 0}">  
                                        <p:commandLink value="#{lab.L_en_attente}" styleClass="button-stateOF #{(ordreFabrication.statusOrdre==constantes.STATUT_DOC_ATTENTE)?'button-stateOF_actif':''}" 
                                                       disabled="#{((ordreFabrication.statusOrdre != constantes.STATUT_DOC_SUSPENDU) 
                                                                   and (ordreFabrication.statusOrdre != constantes.STATUT_PROD_LANCE)
                                                                   and (ordreFabrication.statusOrdre != constantes.STATUT_DOC_ENCOUR))}"
                                                       actionListener="#{managedOrdresF.changeStateOf(constantes.STATUT_DOC_ATTENTE)}"
                                                       process="@this" update="panel_state tableOF" />
                                        <p:commandLink value="#{(ordreFabrication.statusOrdre != constantes.STATUT_PROD_LANCE)?'LANCER':'LANC&Eacute;'}" styleClass="button-stateOF #{(ordreFabrication.statusOrdre==constantes.STATUT_PROD_LANCE)?'button-stateOF_actif':''}" 
                                                       rendered="#{!(ordreFabrication.statusOrdre != constantes.STATUT_DOC_ATTENTE)}" 
                                                       actionListener="#{managedOrdresF.changeStateOf(constantes.STATUT_PROD_LANCE)}"
                                                       process="@this" update="panel_state tableOF" title="Prêt pour le lancement"/>
                                        <p:commandLink value="#{(ordreFabrication.statusOrdre != constantes.STATUT_DOC_SUSPENDU)?'SUSPENDRE':'SUSPENDU'}" styleClass="button-stateOF #{((ordreFabrication.statusOrdre==constantes.STATUT_DOC_SUSPENDU) or ordreFabrication.suspendu)?'button-stateOF_actif':''}" 
                                                       disabled="#{((ordreFabrication.statusOrdre == constantes.STATUT_DOC_TERMINE) or (ordreFabrication.statusOrdre == constantes.STATUT_DOC_CLOTURE))}" 
                                                       actionListener="#{managedOrdresF.changeStateOf(constantes.STATUT_DOC_SUSPENDU)}"
                                                       process="@this" update="panel_state tableOF" />
                                        <p:commandLink value="#{lab.L_en_cours}" styleClass="button-stateOF #{(ordreFabrication.statusOrdre==constantes.STATUT_DOC_ENCOUR)?'button-stateOF_actif':''}" 
                                                       disabled="#{ordreFabrication.suiviOperations or ordreFabrication.statusOrdre eq constantes.STATUT_DOC_ATTENTE}" title="En cours de fabrication"  actionListener="#{managedOrdresF.changeStateOf(constantes.STATUT_DOC_ENCOUR)}"
                                                       process="@this" update="panel_state tableOF"/>
                                        <p:commandLink value="#{(ordreFabrication.statusOrdre != constantes.STATUT_DOC_TERMINE)?'TERMINER':'TERMIN&Eacute;'}" styleClass="button-stateOF #{(ordreFabrication.statusOrdre==constantes.STATUT_DOC_TERMINE)?'button-stateOF_actif':''}" 
                                                       disabled="#{!(ordreFabrication.statusOrdre eq constantes.STATUT_DOC_ENCOUR)}" 
                                                       actionListener="#{managedOrdresF.finishOrdre()}"
                                                       process="@this" update="panel_state tableOF :formulaire_mainOrdreF:zone_operations" />
                                        <p:commandLink value="#{(ordreFabrication.statusOrdre != constantes.STATUT_DOC_CLOTURE)?'CL&Ocirc;TURER':'CL&Ocirc;TUR&Eacute;'}"  styleClass="button-stateOF #{(ordreFabrication.statusOrdre==constantes.STATUT_DOC_CLOTURE)?'button-stateOF_actif':''}" 
                                                       rendered="#{!(ordreFabrication.statusOrdre != constantes.STATUT_DOC_TERMINE)}" 
                                                       actionListener="#{managedOrdresF.changeStateOf(constantes.STATUT_DOC_CLOTURE)}" 
                                                       process="@this" update="panel_state tableOF" />                                        
                                    </p:outputPanel>
                                </p:outputPanel>
                            </f:facet>
                            <h:panelGrid columns="9" id="of_depot" style="background: #ccc;border-top-left-radius: 10px; border-top-right-radius: 10px;
                                         font-size: 0.8em; color: #000; width: 100%" rendered="#{managedOrdresF.displayAll}"> 
                                <h:inputText value="#{ordreFabrication.id}" style="font-weight: bold; width: 80px; text-align: right; background: #CCC" disabled="true"/> 
                                <span>#{lab.LP_PGF_site}</span>
                                <h:selectOneMenu value="#{ordreFabrication.site.id}" style="min-width: 160px">
                                    <f:selectItem itemValue="0" itemLabel="" />
                                    <f:selectItems value="#{managedSiteProduction.sites}" var="i_site" itemValue="#{i_site.id}" itemLabel="#{i_site.designation}" />                                    
                                </h:selectOneMenu>
                                <span>#{lab.LP_POF_debut_ordre}</span>
                                <h:panelGroup>
                                    <p:calendar value="#{ordreFabrication.dateDebutLancement}" pattern="dd-MM-yyyy" size="8" navigator="true"/>
                                    <pe:timePicker style="width: 70px" value="#{ordreFabrication.heureDeLancement}"  intervalMinutes="10" />
                                </h:panelGroup>                                                                        
                                <span>#{lab.LP_POF_fin_ordre}</span>
                                <h:panelGroup>
                                    <p:calendar value="#{ordreFabrication.dateFinFabrication}" pattern="dd-MM-yyyy" size="8" navigator="true"/>
                                    <pe:timePicker style="width: 70px" value="#{ordreFabrication.heureFinFabrication}"  intervalMinutes="10"  />
                                </h:panelGroup> 
                                <span>#{lab.LP_POF_priorite} : </span>
                                <h:selectOneMenu value="#{ordreFabrication.priorite}">
                                    <f:selectItem itemValue="1" itemLabel="#{lab.LP_POF_tres_eleve}" />
                                    <f:selectItem itemValue="2" itemLabel="#{lab.LP_POF_eleve}" />
                                    <f:selectItem itemValue="3" itemLabel="#{lab.LP_POF_normale}" />
                                    <f:selectItem itemValue="4" itemLabel="#{lab.LP_POF_faible}" />
                                </h:selectOneMenu>
                                <f:facet name="footer">
                                    <p:separator style="width: 100%" />
                                    <h:panelGrid style="width: 100%" columns="7" cellpadding="0" cellspacing="0" id="txt_article_des_gammes">                                        
                                        <span>#{lab.L_article}</span>
                                        <h:panelGrid columns="1" >
                                            <h:outputText  value="#{ordreFabrication.articles.designation}" style="color: #003399;"/>
                                            <h:panelGroup>
                                                <h:inputText value="#{ordreFabrication.articles.refArt}" style="color: #{ordreFabrication.articles.error?'red':''};" disabled="#{ordreFabrication.id gt 0}" tabindex="100">
                                                    <p:ajax event="blur"  listener="#{managedOrdresF.searchArticle(ordreFabrication.articles.refArt, false)}" 
                                                            update="txt_article_gammes_of form_of txt_article_des_gammes zone_operations tablePhase_:table_composantOF input_qte_bis input_qte"/>
                                                </h:inputText> 
                                                <p:commandButton icon="ui-icon-search" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="#{lab.L_liste_article}" global="false"
                                                                 actionListener="#{managedOrdresF.initArticles(false)}" oncomplete="dlgListArticle.show()" disabled="#{ordreFabrication.id gt 0}"/>                                        

                                            </h:panelGroup>    
                                        </h:panelGrid>
                                        <h:panelGrid columns="2" styleClass="yvs_noStyle" cellpadding="0" cellspacing="0" id="prod_zone_ppte" 
                                                     style="font-size: 1em;">
                                            <span>#{lab.LP_POF_nomenclature}</span> 
                                            <h:panelGroup >
                                                <h:selectOneMenu value="#{ordreFabrication.nomenclature.id}" id="chp_nomenclature" valueChangeListener="#{managedOrdresF.selectNomenclature}" style="min-width: 140px"
                                                                 disabled="#{!(ordreFabrication.canEditable(managedOrdresF.autoriser('prod_update_of_encours')))}" tabindex="120">  
                                                    <f:selectItem itemValue="#{-1}" itemLabel="" noSelectionOption="true" />
                                                    <f:selectItems value="#{ordreFabrication.articles.nomenclatures}" var="itemNom" itemValue="#{itemNom.id}" itemLabel="#{itemNom.reference}" />   
                                                    <p:ajax update="tablePhase_:table_composantOF input_qte_bis input_qte" event="valueChange"/>
                                                </h:selectOneMenu>
                                                <h:selectBooleanCheckbox value="#{ordreFabrication.suiviOperations}" title="#{lab.LP_PPG_suivi_operations_requis}" disabled="#{ordreFabrication.id gt 0}"  >
                                                    <p:ajax event="valueChange" update="tablePhase_ prod_zone_ppte" global="false" />
                                                </h:selectBooleanCheckbox>                                                
                                            </h:panelGroup>
                                            <span>#{lab.LP_POF_gamme}</span>
                                            <h:panelGroup >
                                                <h:selectOneMenu value="#{ordreFabrication.gamme.id}" id="chp_gamme" valueChangeListener="#{managedOrdresF.selectGamme}" style="min-width: 140px" 
                                                                 disabled="#{!(ordreFabrication.canEditable(managedOrdresF.autoriser('prod_update_of_encours'))) or !ordreFabrication.suiviOperations}" tabindex="130">  
                                                    <f:selectItem itemValue="#{-1}" itemLabel="" noSelectionOption="true" />
                                                    <f:selectItems value="#{ordreFabrication.articles.gammes}" var="itemGam" itemValue="#{itemGam.id}" itemLabel="#{itemGam.codeRef}" />
                                                    <p:ajax update="zone_operations" event="valueChange"/>
                                                </h:selectOneMenu>  
                                                <p:selectBooleanCheckbox value="#{ordreFabrication.generateOfSousProduit}"  itemLabel="#{lab.LP_POF_generer_of_produit_inter}" disabled="#{ordreFabrication.id gt 0}" />
                                            </h:panelGroup>
                                        </h:panelGrid>
                                        <span>#{lab.L_quantite} </span>
                                        <h:panelGroup>
                                            <pe:inputNumber value="#{ordreFabrication.quantitePrevu}"  style="width: 90px; text-align: center" disabled="#{!(ordreFabrication.canEditable(managedOrdresF.autoriser('prod_update_of_encours')))}" tabindex="110">
                                                <p:ajax update="input_qte tablePhase_:table_composantOF zone_diplay_op" event="valueChange" 
                                                        listener="#{managedOrdresF.listenChangeValueQtePrevu()}"  />
                                            </pe:inputNumber> 
                                            <h:inputText disabled="true" styleClass="input_dis" value="#{(ordreFabrication.nomenclature.unite.unite.id gt 0)?ordreFabrication.nomenclature.unite.unite.reference:'Aucune unité'}" 
                                                         style="color: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'#003399':'red'}; font-size: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'0.8em':'0.7em'}; width: 60px; text-align: center" />
                                        </h:panelGroup>                                                                                
                                    </h:panelGrid>
                                </f:facet>
                            </h:panelGrid>
                            <p:outputPanel id="form_of" style="width: 100%">
                                <h:panelGrid columns="2">
                                    <h:panelGroup id="txt_article_gammes_of" style="float: left; font-weight: normal;">                                    
                                        <h:panelGrid  id="input_qte_bis" columns="2" styleClass="yvs_noStyle" style="float: right" cellpadding="0" cellspacing="0" rendered="#{!managedOrdresF.displayAll}">                                                                                                           
                                            <span title="#{lab.LP_POF_quantite_deja_realise}">Quantité #{ordreFabrication.nomenclature.typeNomenclature eq constantes.PROD_TYPE_NOMENCLATURE_TRANSFORMATION?'Transformé':'Déclaré'} :</span>
                                            <h:panelGroup id="txt-quantite_declare_of">
                                                <h:inputText value="#{ordreFabrication.quantiteDeclare}" disabled="true"  style="padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="#{managedOrdresF.converterProd(ordreFabrication.articles.categorie)}"/>                                        
                                                <h:inputText disabled="true" styleClass="input_dis" value="#{(ordreFabrication.nomenclature.unite.unite.id gt 0)?ordreFabrication.nomenclature.unite.unite.reference:'Aucune unité'}" 
                                                             style="color: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'#003399':'red'}; font-size: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'0.8em':'0.7em'}; width: 100px; text-align: center"/>

                                            </h:panelGroup>
                                            <span>#{lab.LP_POF_reste_a} #{ordreFabrication.nomenclature.typeNomenclature eq constantes.PROD_TYPE_NOMENCLATURE_TRANSFORMATION?'Transformer':'Déclarer'}:</span>
                                            <h:panelGroup id="txt-reste_a_declare_of">
                                                <h:inputText value="#{(ordreFabrication.quantitePrevu-ordreFabrication.quantiteDeclare)lt 0?0:(ordreFabrication.quantitePrevu-ordreFabrication.quantiteDeclare)}" disabled="true" readonly="true"  style="padding: 3px; background: #333; color: #FFF; width: 140px;text-align: right" converter="DNS"/>
                                                <h:inputText disabled="true" styleClass="input_dis" value="#{(ordreFabrication.nomenclature.unite.unite.id gt 0)?ordreFabrication.nomenclature.unite.unite.reference:'Aucune unité'}" 
                                                             style="color: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'#003399':'red'}; font-size: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'0.8em':'0.7em'}; width: 100px; text-align: center"/>

                                            </h:panelGroup>
                                            <span>#{lab.LP_POF_ecart}.:</span>
                                            <h:panelGroup>
                                                <h:inputText value="#{ordreFabrication.quantitePrevu-ordreFabrication.quantitePrevu}" disabled="true"  style="padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DN"/>
                                                <h:inputText disabled="true" styleClass="input_dis" value="#{(ordreFabrication.nomenclature.unite.unite.id gt 0)?ordreFabrication.nomenclature.unite.unite.reference:'Aucune unité'}" 
                                                             style="color: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'#003399':'red'}; font-size: #{(ordreFabrication.nomenclature.unite.unite.id gt 0)?'0.8em':'0.7em'}; width: 100px; text-align: center"/>

                                            </h:panelGroup>
                                        </h:panelGrid>
                                    </h:panelGroup>
                                </h:panelGrid>                                
                                <p:outputPanel layout="block" rendered="#{managedOrdresF.displayAll}">
                                    <div style="background: #90bff5">
                                        <div style="float: left; background: #CCC; width: 25%; height: 20px; padding: 5px; font-weight: bold; font-size: 0.8em">
                                            #{lab.LP_POF_declaration} <span>(#{(ordreFabrication.nomenclature.unite.unite.id gt 0)?ordreFabrication.nomenclature.unite.unite.reference:'Aucune unité'})</span> 
                                        </div>                                        
                                        <h:panelGrid columns="8" id="input_qte" style="font-size: 0.9em; margin-left:25%">                                            
                                            <span title="#{lab.LP_POF_quantite_deja_realise}">#{lab.L_quantite} #{ordreFabrication.nomenclature.typeNomenclature eq constantes.PROD_TYPE_NOMENCLATURE_TRANSFORMATION?'Transformé':'Déclaré'} :</span>
                                            <h:inputText value="#{ordreFabrication.quantiteDeclare}" disabled="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DN"/>                                                                                       
                                            <span>#{lab.LP_POF_reste_a} #{ordreFabrication.nomenclature.typeNomenclature eq constantes.PROD_TYPE_NOMENCLATURE_TRANSFORMATION?'Transformer':'Déclarer'}:</span>
                                            <h:inputText value="#{(ordreFabrication.quantitePrevu-ordreFabrication.quantiteDeclare)lt 0?0:(ordreFabrication.quantitePrevu-ordreFabrication.quantiteDeclare)}" disabled="true" readonly="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DNS"/>
                                            <span>#{lab.LP_POF_ecart}.:</span>
                                            <h:inputText value="#{ordreFabrication.quantitePrevu-ordreFabrication.quantitePrevu}" disabled="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 60px;text-align: right" converter="DN"/>
                                            <h:outputText value="#{lab.LP_POF_cout_of}" id="control_cout_of"  style="text-decoration: underline; color: #003399;cursor: pointer"
                                                          rendered="#{accesRessource.gescom_inventaire_print_with_pr}"/>
                                            <h:inputText value="#{ordreFabrication.coutDeProduction}" disabled="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DN"
                                                         rendered="#{accesRessource.gescom_inventaire_print_with_pr}" id="txt_c_p"/>
                                        </h:panelGrid>
                                        <p:overlayPanel for="control_cout_of" >
                                            <h:panelGrid columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" id="zone_cout_of">
                                                <span>#{lab.LP_POF_cout_planifie}</span>
                                                <h:inputText value="#{ordreFabrication.coutDeProduction}" disabled="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DN"/>
                                                <span>#{lab.LP_POF_cout_reel}</span>
                                                <h:inputText value="#{ordreFabrication.coutDeProduction}" disabled="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DN"/>
                                                <span>#{lab.LP_POF_cout_mp}</span>
                                                <h:inputText value="#{ordreFabrication.coutDeProduction}" disabled="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DN"/>
                                                <span>#{lab.LP_POF_cout_op}</span>
                                                <h:inputText value="#{ordreFabrication.coutDeProduction}" disabled="true"  style="float: right;padding: 3px; background: #333; color: #FFF; width: 100px;text-align: right" converter="DN"/>
                                                <f:facet name="footer">
                                                    <p:commandButton icon="ui-icon-refresh" value="#{lab.LP_POF_recalculer_couts}" style="width: 100%" actionListener="#{managedOrdresF.recalculCurrentOrder()}" 
                                                                     update="control_cout_of zone_cout_of txt_c_p"/>
                                                </f:facet>
                                            </h:panelGrid>
                                        </p:overlayPanel>
                                    </div>
                                    <div style="margin-top: 3px; clear: left">
                                        <div style="background: #CCC; width: 99%; height: 20px; padding: 5px; font-weight: bold">
                                            #{lab.LP_POF_operations}
                                            <span style="float: right; display: block">
                                                <p:contextMenu for="btn_change_view" event="left click" >
                                                    <p:menuitem value="#{lab.LP_POF_changer_affichage}" icon="ui-icon-newwin" actionListener="#{managedOrdresF.setDisplayOpAtTable(!managedOrdresF.displayOpAtTable)}"
                                                                update="zone_operations"/>
                                                    <p:menuitem value="Evolutions" title="#{lab.LP_POF_afficher_evolution}"  icon="ui-icon-refresh" 
                                                                actionListener="#{managedOrdresF.actualiseOperation()}" update="zone_operations"/>
                                                    <p:menuitem value="#{lab.LP_POF_voir_resume}"  icon="ui-icon-calendar" actionListener="#{managedOrdresF.loadAllFluxComposant(true)}"/>
                                                    <p:separator />
                                                    <p:menuitem icon="ui-icon-circle-plus" value="Opération"  title="#{lab.LP_POF_ajouter_nouvelle_operation}" oncomplete="dlgProprieteOp.show()"   
                                                                actionListener="#{managedOrdresF.resetOperation()}" update=":formulaire_propriete_phase zone_operations" />
                                                </p:contextMenu>
                                                <p:commandButton type="button" icon="ui-icon-gear" id="btn_change_view" style="width: 22px; height: 22px"/>
                                            </span>
                                        </div>
                                        <p:outputPanel id="zone_operations">
                                            <p:dataTable value="#{ordreFabrication.listOperationsOf}" editable="true" editMode="cell"  rendered="#{managedOrdresF.displayOpAtTable}"
                                                         var="itemOp" rowKey="#{itemOp.id}" selectionMode="single" selection="#{managedOrdresF.selectedOp}" id="table_pptes_op_of">
                                                <p:ajax event="rowEdit" listener="#{managedOrdresF.changeLineOperation}" />
                                                <p:column headerText="Id" styleClass="statut_#{(itemOp.suspendu)?'S':itemOp.statutOp}">
                                                    #{itemOp.id}
                                                </p:column>
                                                <p:column headerText="#{lab.L_numero}" style="text-align: center" styleClass="statut_#{(itemOp.suspendu)?'S':itemOp.statutOp}">
                                                    #{itemOp.numero}
                                                </p:column>
                                                <p:column headerText="#{lab.L_reference}" styleClass="statut_#{itemOp.statutOp}">
                                                    #{itemOp.codeRef}                                        
                                                </p:column>
                                                <p:column headerText="#{lab.LP_POF_date_lancement}" styleClass="statut_#{itemOp.statutOp}" style="text-align: center">
                                                    <h:outputText value="#{itemOp.dateDebut}" converter="DATE"/>
                                                    <span> - </span>
                                                    <h:outputText value="#{itemOp.heureDebut}" converter="TIME"/>
                                                </p:column>
                                                <p:column headerText="#{lab.LP_POF_date_fin}" styleClass="statut_#{itemOp.statutOp}" style="text-align: center">
                                                    <h:outputText value="#{itemOp.dateFin}" converter="DATE"/>
                                                    <span> - </span>
                                                    <h:outputText value="#{itemOp.heureFin}" converter="TIME"/>
                                                </p:column>  
                                                <p:column headerText="#{lab.LP_POF_machine}" styleClass="statut_#{itemOp.statutOp}">
                                                    <span title="#{itemOp.machine.designation}">#{itemOp.machine.reference}</span>
                                                </p:column>
                                                <p:column headerText="#{lab.LP_POF_main_oeuevre}" styleClass="statut_#{itemOp.statutOp}">
                                                    <span title="#{itemOp.mainOeuvre.designation}">#{itemOp.mainOeuvre.reference}</span>
                                                </p:column>
                                                <p:column headerText="#{lab.LP_POF_t_operation}" styleClass="statut_#{itemOp.statutOp}" style="text-align: right">
                                                    <h:outputText value="#{itemOp.tempsOperation}" converter="DNS" />
                                                    <span style="font-style: italic"> #{ordreFabrication.gamme.uniteTemps.reference}</span>
                                                </p:column>          
                                                <p:column headerText="#{lab.LP_POF_t_reglage}" styleClass="statut_#{itemOp.statutOp}" style="text-align: right">
                                                    <h:outputText value="#{itemOp.tempsReglage}" converter="DNS" />
                                                    <span style="font-style: italic"> #{ordreFabrication.gamme.uniteTemps.reference}</span>
                                                </p:column>                        
                                                <p:column headerText="#{lab.LP_POF_couts}" styleClass="statut_#{itemOp.statutOp}" style="text-align: right">
                                                    <h:outputText value="#{itemOp.tempsReglage}" converter="DNS" />
                                                    <span style="font-style: italic"> #{ordreFabrication.gamme.uniteTemps.reference}</span>
                                                </p:column>                        
                                                <p:column headerText="" style="text-align: center">
                                                    <p:contextMenu for="btn_opt_op_of" event="left click">
                                                        <p:menuitem value="#{lab.LP_POF_flux_stocks}" icon="ui-icon-signal-diag" oncomplete="dlgEditFlux.show()"  actionListener="#{managedOrdresF.openFluxComposantOperation(itemOp)}" style="float: right" 
                                                                    update=":formulaire_update_edit_flux:header_detail_edit_flux :formulaire_update_edit_flux:zone_gear_operation table_pptes_op_of :formulaire_update_edit_flux:zone_gear_operation" 
                                                                    />
                                                        <p:menuitem value="#{lab.LC_PFA_proprietes}" icon="ui-icon-gear" oncomplete="dlgProprieteOp.show()"  
                                                                    actionListener="#{managedOrdresF.openPropertiesOperation(itemOp)}"  update=":formulaire_propriete_phase :formulaire_mainOrdreF:zone_operations" disabled="#{itemOp.id lt 1}"
                                                                    />
                                                        <p:menuitem value="#{lab.L_ajouter}" icon="ui-icon-circle-plus" oncomplete="dlgProprieteOp.show()"  actionListener="#{managedOrdresF.openPropertiesOperation(itemOp)}" disabled="#{itemOp.id lt 1}"
                                                                    update=":formulaire_propriete_phase"/>
                                                        <p:menuitem value="#{lab.LP_POF_activer_desactiver}" icon="ui-icon-circle-close" oncomplete="dlgProprieteOp.show()"
                                                                    update=":formulaire_propriete_phase"/>
                                                        <p:separator />
                                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedOrdresF.setSelectedOp(itemOp)}" oncomplete="dlgConfirmDeleteOperation.show()"/>
                                                    </p:contextMenu>
                                                    <p:commandButton id="btn_opt_op_of" type="button" icon="ui-icon-gear" style="width: 22px; height: 22px" />
                                                </p:column>
                                            </p:dataTable>
                                            <p:outputPanel style="width: 100%" id="zone_diplay_op" rendered="#{!managedOrdresF.displayOpAtTable}">                            
                                                <div class="#{(ordreFabrication.listOperationsOf.size() gt 0 )?'wrap_zone_op':'t'}"  >
                                                    <ui:repeat value="#{ordreFabrication.listOperationsOf}" var="c_op" varStatus="i" rendered="#{(ordreFabrication.listOperationsOf.size() gt 0)}">
                                                        <div class="care_op" style="width: #{98/ordreFabrication.listOperationsOf.size()}%; border: 2px double #{c_op.indicateur ne null?c_op.indicateur.codeCouleur:'FFF'}" >
                                                            <div style="width: 96.5%; float: left">
                                                                <div class="header">
                                                                    <p:contextMenu for="txt_num_op" >
                                                                        <p:menuitem value="#{lab.LP_POF_recalculer_couts}" actionListener="#{managedOrdresF.valoriseOperationOF(c_op)}" />
                                                                    </p:contextMenu>
                                                                    <h:outputText styleClass="num_op" value="#{c_op.numero}" id="txt_num_op" />
                                                                    <span class="titre_op" title="#{c_op.codeRef}">#{(c_op.codeRef.length() gt 8)?c_op.codeRef.substring(0,8).concat('...'):c_op.codeRef}</span>
                                                                    <h:panelGroup style="float: right;margin-top: 5px" id="btn_opt_op">
                                                                        <p:commandLink value="#{lab.LP_POF_en_cours}" styleClass="#{(c_op.statutOp==constantes.STATUT_DOC_ENCOUR)?'statut_valide':'etat_formation_true'}"   style="font-size: 0.8em"                                  
                                                                                       process="@this"  actionListener="#{managedOrdresF.changeStatutOp(c_op, constantes.STATUT_DOC_ENCOUR, true)}"
                                                                                       update=":formulaire_mainOrdreF:zone_operations :formulaire_mainOrdreF:tablePhase_:table_composantOF btn_op_flux0 btn_op_flux1 btn_opt_op"/>
                                                                        <p:commandLink value="#{lab.LP_POF_terminer}" styleClass="#{(c_op.statutOp==constantes.STATUT_DOC_TERMINE)?'statut_valide':'etat_formation_true'}"    style="font-size: 0.8em"
                                                                                       process="@this"  actionListener="#{managedOrdresF.finishOperation(c_op,true)}" disabled="#{c_op.statutOp.equals(constantes.STATUT_DOC_ATTENTE)}"
                                                                                       update=":formulaire_mainOrdreF:zone_operations :formulaire_mainOrdreF:tablePhase_:table_composantOF btn_op_flux0 btn_op_flux1 btn_opt_op"/>
                                                                    </h:panelGroup>
                                                                </div>
                                                                <h:panelGrid columns="2" styleClass="yvs_table" style="width: 100%;font-size: 0.9em" cellpadding="0" cellspacing="0">
                                                                    <f:facet name="header">
                                                                        <div style="background: #{c_op.indicateur ne null?c_op.indicateur.codeCouleur:'FFF'}; width: 100%">
                                                                            #{lab.LP_POF_evolution} 
                                                                            <h:outputText value="#{(c_op.indicateur ne null)?(100*c_op.indicateur.composant.quantiteFlux/c_op.indicateur.composant.quantite):'0'}" converter="DNS" rendered="false"/>
                                                                            <h:outputText value="#{(c_op.indicateur ne null)?c_op.indicateur.giveTauxEvolution():'0'}" converter="DNS"/>
                                                                            <span> %</span>
                                                                            <h:outputText value=" + (" rendered="#{c_op.indicateur.giveTauxEvolutionSup() gt 0}"/>
                                                                            <h:outputText value="#{(c_op.indicateur ne null)?c_op.indicateur.giveTauxEvolutionSup():'0'}" converter="DNS" rendered="#{c_op.indicateur.giveTauxEvolutionSup() gt 0}"/>
                                                                            <h:outputText value=" )%" rendered="#{c_op.indicateur.giveTauxEvolutionSup() gt 0}"/>
                                                                        </div>
                                                                    </f:facet>
                                                                    <span>#{lab.L_debut} :</span>
                                                                    <h:panelGroup>
                                                                        <h:outputText value="#{c_op.dateDebut}" converter="DATE"/>
                                                                        &nbsp;
                                                                        <h:outputText value="#{c_op.heureDebut}" converter="TIME"/>
                                                                    </h:panelGroup>
                                                                    <span>#{lab.L_fin} :</span>
                                                                    <h:panelGroup>
                                                                        <h:outputText value="#{c_op.dateFin}" converter="DATE"/> 
                                                                        &nbsp;
                                                                        <h:outputText value="#{c_op.heureFin}" converter="TIME"/>
                                                                    </h:panelGroup>
                                                                    <f:facet name="footer">
                                                                        <span>#{lab.LP_POF_duree_operation} :</span>
                                                                        <h:outputText value="#{c_op.tempsOperation}" converter="DNS" />
                                                                        <span style="font-style: italic"> #{c_op.ordreFabrication.gamme.uniteTemps.reference}</span>
                                                                        <span style="float: right">#{c_op.composants.size()}</span>
                                                                    </f:facet>
                                                                </h:panelGrid>
                                                                <p:commandButton id="btn_op_flux0" icon="ui-icon-newwin" value="#{lab.LC_PFA_proprietes}..." oncomplete="dlgProprieteOp.show()"  actionListener="#{managedOrdresF.openPropertiesOperation(c_op)}"  update=":formulaire_propriete_phase :formulaire_mainOrdreF:zone_operations"
                                                                                 disabled="#{ordreFabrication.id le 0}"/>
                                                                <p:commandButton id="btn_op_flux1" icon="ui-icon-signal-diag" value="#{lab.LP_POF_flux_stocks}" oncomplete="dlgEditFlux.show()"  actionListener="#{managedOrdresF.openFluxComposantOperation(c_op)}" style="float: right" update=":formulaire_update_edit_flux:header_detail_edit_flux :formulaire_update_edit_flux:zone_gear_operation" 
                                                                                 disabled="#{ordreFabrication.id le 0 or (c_op.statutOp ne constantes.STATUT_DOC_ENCOUR)}"/>
                                                            </div>
                                                            <div style="margin-left: 97%; background: #90bff5; vertical-align: middle; height: 100%; display: #{(i.index+1) lt ordreFabrication.listOperationsOf.size()?'block':'none'}">&rArr;</div>
                                                        </div>
                                                    </ui:repeat>
                                                </div>
                                            </p:outputPanel>
                                        </p:outputPanel>
                                    </div>  
                                </p:outputPanel>
                            </p:outputPanel>  
                        </h:panelGrid>                                           
                        <p:tabView style="overflow-x: auto" id="tablePhase_">
                            <p:tab title="#{lab.LP_POF_compositions}">
                                <div align="right" style="float: right;margin-top: -20px">
                                    #{lab.LP_POF_stock_evalue} <h:outputText styleClass="style_unite" value="#{managedOrdresF.currentSession.id eq null? ordreFabrication.dateDebutLancement:managedOrdresF.currentSession.dateSession}" converter="DATE" />                                    
                                </div>
                                <p:dataTable id="table_composantOF" value="#{ordreFabrication.listComposantOf}" var="itemComposant" rowIndexVar="lineC"
                                             selectionMode="single" rowKey="#{itemComposant.id}" selection="#{managedOrdresF.selectedComposant}"
                                             editMode="cell" editable="true">
                                    <p:ajax event="cellEdit" listener="#{managedOrdresF.onEditQuantiteValide}"  update=":formulaire_mainOrdreF:tablePhase_:table_composantOF"/>
                                    <p:column  width="300" headerText="#{lab.LP_POF_composant}" >                                        
                                        <h:outputText value="[#{itemComposant.article.refArt}]"  title="#{itemComposant.commentaire}" style="font-weight: bold"/>
                                        <h:outputText value=" #{itemComposant.article.designation}"  title="#{itemComposant.commentaire}"/>  
                                        <h:graphicImage library="icones" name="favoris.png" width="10" height="10" style="float: right" rendered="#{itemComposant.insideCout and itemComposant.id gt 0}"
                                                        title="#{itemComposant.insideCout?'Participe au calcul du coût':'Exclut du calcul des coûts'}"/>                                        
                                    </p:column>
                                    <p:column width="15" headerText="#{lab.L_unite}" style="text-align: center">
                                        <h:outputText styleClass="style_unite" value="#{itemComposant.unite.unite.reference}" title="#{itemComposant.unite.unite.libelle}" />
                                    </p:column>
                                    <p:column width="100" headerText="#{lab.LP_PC_stock} " style="text-align: right" rendered="#{managedOrdresF.displayColStock}">  
                                        <h:panelGroup rendered="#{itemComposant.article.suiviEnStock}">
                                            <h:outputText value="#{managedOrdresF.giveStockMp(itemComposant)}" converter="#{managedOrdresF.cproduction}" rendered="#{managedOrdresF.currentSession.id gt 0}"
                                                          title="#{lab.LP_POF_stock_point} #{(itemComposant.depotConso.id gt 0)?itemComposant.depotConso.designation:managedOrdresF.currentSession.depot.designation}"/>       
                                            <h:outputText value="#{lab.LP_POF_aucun_depot}" rendered="#{managedOrdresF.currentSession.id eq null}"/>       
                                        </h:panelGroup>
                                        <h:outputText value="#{lab.LP_POF_non_suivi}" style="color: red;font-size: 0.8em; font-style: italic" rendered="#{!itemComposant.article.suiviEnStock}"/>
                                    </p:column>
                                    <p:column width="100" headerText="#{lab.LP_POF_qte_prevue}" style="text-align: right">
                                        <h:outputText value="#{itemComposant.quantitePrevu}" style="color: #{((itemComposant.stock lt itemComposant.quantitePrevu) and (itemComposant.type eq constantes.PROD_OP_TYPE_COMPOSANT_NORMAL))?'red':'blue'}" converter="DNS"/>                                                                                             
                                    </p:column>
                                    <p:column width="100" style="text-align: right; color: #003333" rendered="#{managedOrdresF.displayColFlux}">  
                                        <f:facet name="header"><span title="#{lab.LP_POF_quantite_reel_entree}">#{lab.LP_POF_qte_reel_entree}</span></f:facet>
                                        <h:outputText value="#{managedOrdresF.findQteReelComposantOf(itemComposant, true)}" converter="#{managedOrdresF.cproduction}" title="Quantité déjà utilisé"/>           
                                    </p:column>  
                                    <p:column width="100" style="text-align: right; color: #790000" rendered="#{managedOrdresF.displayColFlux}">     
                                        <f:facet name="header"><span title="#{lab.LP_POF_quantite_reel_sortie}">#{lab.LP_POF_qte_reel_sortie}</span></f:facet>
                                        <h:outputText value="#{managedOrdresF.findQteReelComposantOf(itemComposant, false)}" converter="#{managedOrdresF.cproduction}" title="Quantité déjà utilisé"/>           
                                    </p:column>  
                                    <p:column headerText="#{lab.LP_POF_coef}."  width="80" style="text-align: right" >     
                                        <p:cellEditor >
                                            <f:facet name="output">
                                                <h:outputText value="#{itemComposant.coefficient}" converter="DNS" title="#{lab.LP_POF_qte_deja_utilise}"/>           
                                            </f:facet>
                                            <f:facet name="input">
                                                <h:inputText value="#{itemComposant.coefficient}" disabled="#{ordreFabrication.suiviStockByOperation}"/>
                                            </f:facet>
                                        </p:cellEditor>                                                                             
                                    </p:column>  
                                    <p:column headerText="#{lab.LP_POF_ecart}" width="100" style="text-align: right" rendered="#{managedOrdresF.displayColFlux}">
                                        <h:outputText value="#{(itemComposant.quantitePrevu-managedOrdresF.findQteReelComposantOf(itemComposant, false))}" style="color: #{(itemComposant.quantitePrevu lt itemComposant.quantiteValide)?'red':'blue'}" converter="#{managedOrdresF.cproduction}"/>                                                          
                                    </p:column>   
                                    <p:column headerText="#{lab.LP_POF_cout_t}" width="100" style="text-align: right" rendered="#{managedOrdresF.displayColCout}">   
                                        <h:outputText value="#{managedOrdresF.getCoutComposant(itemComposant)}" converter="#{managedOrdresF.cproduction}" rendered="#{managedOrdresF.ordre.id gt 0}"/>       
                                        <h:outputText value="#{lab.LP_POF_aucun_of_selectionne}" rendered="#{managedOrdresF.ordre.id le 0}"/>       
                                    </p:column>      
                                    <p:column  width="100" headerText="Lot" >
                                        <h:outputText value="#{itemComposant.lotSortie.numero}"  />                                           
                                    </p:column>                       
                                    <p:column width="30" headerText="" style="text-align: center">
                                        <f:facet name="header">
                                            <p:contextMenu for="btn_opt_comp_of_h" event="left click">
                                                <p:menuitem value="#{lab.LP_POF_afficher_stock}" icon="ui-icon-check" actionListener="#{managedOrdresF.setDisplayColStock(!managedOrdresF.displayColStock)}"
                                                            update="table_composantOF" />
                                                <p:menuitem value="#{lab.LP_POF_afficher_couts}" icon="ui-icon-check" actionListener="#{managedOrdresF.setDisplayColCout(!managedOrdresF.displayColCout)}"
                                                            update="table_composantOF"/>
                                                <p:menuitem value="#{lab.LP_POF_afficher_flux}" icon="ui-icon-check" actionListener="#{managedOrdresF.setDisplayColFlux(!managedOrdresF.displayColFlux)}"
                                                            update="table_composantOF"/>                                               
                                            </p:contextMenu>
                                            <p:commandButton id="btn_opt_comp_of_h" type="button" icon="ui-icon-gear" styleClass="button_gear" />
                                        </f:facet>
                                        <p:contextMenu for="btn_opt_comp_of" event="left click" style="width: 240px">
                                            <p:menuitem value="#{itemComposant.insideCout?'Ne participe pas au coût':'Participe au coût'}" icon="#{itemComposant.insideCout?'ui-icon-radio-on':'ui-icon-bullet'}"
                                                        actionListener="#{managedOrdresF.toogleInsideCout(itemComposant)}" update="table_composantOF"/>
                                            <p:menuitem value="Autres OF" icon="i-icon-extlink" actionListener="#{managedOrdresF.managedInsideCout(itemComposant)}" oncomplete="dlgComposantOF.show()"/>
                                            <p:separator/>
                                            <p:menuitem value="#{lab.LP_POF_generer_of}" icon="i-icon-extlink" oncomplete="dlgGenererOF.show()" actionListener="#{managedOrdresF.openInfosPFSousProduit(itemComposant)}"
                                                        update=":main_of_sous_produit" disabled="#{itemComposant.id lt 1}" rendered="#{itemComposant.article.categorie eq constantes.CAT_PSF or itemComposant.article.categorie eq constantes.CAT_PF}"/>
                                            <p:menuitem value="#{lab.LC_PA_proprietes}" icon="ui-icon-gear" oncomplete="dlgProprieteComposant.show()" 
                                                        actionListener="#{managedOrdresF.openOneComposantToUpdate(itemComposant)}"
                                                        update=":formulaire_mainOrdreF:tablePhase_:table_composantOF :formulaire_propriete_composant:headPPtC" disabled="#{itemComposant.id lt 1}"/>
                                            <p:separator />
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedOrdresF.setSelectedComposant(itemComposant)}" oncomplete="dlgConfirmDeleteComposant.show()"/>
                                        </p:contextMenu>
                                        <p:commandButton id="btn_opt_comp_of" type="button" icon="ui-icon-gear" styleClass="button_gear" />
                                    </p:column> 
                                </p:dataTable>
                            </p:tab>                       
                            <p:tab title="#{lab.LP_POF_flux_composants}" disabled="#{!ordreFabrication.suiviOperations}">
                                <div align="right" style="float: right;margin-top: -20px">
                                    <p:commandButton icon="ui-icon-refresh" value="Actualise" actionListener="#{managedOrdresF.displayFluxComposant()}" update="table_op_use_mp_" />
                                </div>
                                <p:dataTable  value="#{managedOrdresF.listeComposants}" var="i_flux" id="table_op_use_mp_" editMode="cell" editable="true" rowKey="#{i_flux.id}">                    
                                    <p:columnGroup type="header">
                                        <p:row>
                                            <p:column headerText="#{lab.LP_POF_operations}" style="width: 15%"/>
                                            <c:forEach items="#{managedOrdresF.colonnes}" var="head" varStatus="_head">
                                                <p:column headerText="#{head}" />
                                            </c:forEach>
                                        </p:row>
                                    </p:columnGroup>
                                    <p:column styleClass="ui-widget-header">                        
                                        <span style="font-weight: bold">#{i_flux.article.designation}</span>
                                    </p:column>                                        
                                    <p:columns width="100" value="#{i_flux.composantsUsed}" var="icol" columnIndexVar="i" style="text-align: right">                        
                                        <p:cellEditor>
                                            <f:facet name="output">
                                                <h:outputText value="#{i_flux.composantsUsed.get(i).quantite}" converter="DNS"/>
                                                <h:outputText styleClass="style_unite" value="#{i_flux.unite.unite.reference}" />
                                            </f:facet>
                                            <f:facet name="input">
                                                <h:inputText  value="#{i_flux.quantitePrevu}" style="width:70%"/>
                                            </f:facet>
                                        </p:cellEditor>
                                    </p:columns>                                        
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Déclarations" rendered="#{ordreFabrication.id gt 0 and ordreFabrication.declarations.size() gt 0}">
                                <p:dataTable id="data_declaration" value="#{ordreFabrication.declarations}" var="decl" rowIndexVar="dLIne" rowKey="#{decl.id}" selectionMode="single">
                                    <p:ajax event="rowSelect" listener="#{managedOrdresF.loadOnView}" update=":main_form_declaration:blog_declaration"
                                            oncomplete="dlgDeclaration.show()"/>
                                    <p:column headerText="N°" style="width: 5%" styleClass="statut_#{decl.statut}">
                                        <span>#{dLIne+1}</span>
                                    </p:column>
                                    <p:column headerText="Id" style="width: 5%" styleClass="statut_#{decl.statut}">
                                        <span>#{decl.id}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LP_POF_date_declaration}" styleClass="statut_#{decl.statut}" width="150">
                                        <h:outputText value="#{decl.sessionOf.sessionProd.dateSession}" converter="DATE"/>        
                                    </p:column>
                                    <p:column headerText="#{lab.L_depot}" styleClass="statut_#{decl.statut}">
                                        <span>#{decl.sessionOf.sessionProd.depot.designation}</span>          
                                    </p:column>
                                    <p:column headerText="#{lab.L_quantite}" styleClass="statut_#{decl.statut}" width="100">
                                        <h:outputText value="#{decl.quantite}" converter="DNS"/>
                                        <span title="#{decl.conditionnement.unite.libelle}" style="font-size: 0.8em;color: #003399">#{decl.conditionnement.unite.reference}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LP_POF_cout_u}" styleClass="statut_#{decl.statut}" width="100" style="text-align: right"
                                              rendered="#{accesRessource.gescom_inventaire_print_with_pr}">
                                        <h:outputText value="#{decl.coutProduction}" converter="DNS" title="#{lab.LP_POF_cout_unitaire_production}"/>
                                    </p:column>
                                    <p:column width="25" style="text-align: center" styleClass="statut_#{decl.statut}">
                                        <p:contextMenu for="btn_option_tableOF" event="left click" style="font-size: 0.8em">
                                            <p:menuitem value="#{(decl.statut eq constantes.ETAT_VALIDE)?'Annuler':'Valider'}" icon="#{(decl.statut eq constantes.ETAT_VALIDE)?'ui-icon-circle-close':'ui-icon-circle-check'}" 
                                                        actionListener="#{managedOrdresF.changeStatutDeclaration(decl)}" 
                                                        update=":main_declaration:data_fiche_conditionnement :formulaire_mainOrdreF:tableOF data_declaration :formulaire_mainOrdreF:of_statut_zone :formulaire_mainOrdreF:input_qte_bis :formulaire_mainOrdreF:input_qte"/>
                                            <p:separator />
                                            <p:menuitem value="#{lab.LP_POF_conditionnner}" icon="ui-icon-suitcase" global="false"  actionListener="#{managedOrdresF.beginConditionner(decl)}" 
                                                        update=":main_declaration:form_conditionnement :main_declaration:data_fiche_conditionnement"/>
                                            <p:menuitem value="#{lab.LP_POF_tranferer}" icon="ui-icon-circle-arrow-e" actionListener="#{managedOrdresF.openViewToConfirmTransfert(decl)}"/>
                                            <p:separator />
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedOrdresF.openToConfirmDelete(decl)}"/>
                                        </p:contextMenu>   
                                        <p:commandButton icon="ui-icon-gear" type="button" id="btn_option_tableOF" style="width: 22px; height: 22px" />
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                    </div>
                    <div class="yvs_list_of">
                        <p:dataTable value="#{managedOrdresF.listeOrdreF}" var="itemOF" rowIndexVar="line"
                                     rowKey="#{itemOF.id}" selectionMode="single"  id="tableOF" style="width: 100%; overflow-x: auto; ">
                            <p:ajax event="rowSelect"  listener="#{managedOrdresF.openOfToupdate}" oncomplete="collapseForm('of');"
                                    update=":formulaire_mainOrdreF:of_depot :formulaire_mainOrdreF:formOF :formulaire_mainOrdreF:panel_state :formulaire_mainOrdreF:tablePhase_
                                    :formulaire_mainOrdreF:zone_diplay_op tableOF"/>
                            <p:column headerText="N°" width="25" styleClass="statut_#{itemOF.statutOrdre}">
                                <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{itemOF.id eq ordreFabrication.id}"/>
                                #{line+1}
                            </p:column>
                            <p:column  width="150" headerText="#{lab.L_reference}" styleClass="statut_#{itemOF.statutOrdre}">
                                <h:outputText value="#{itemOF.codeRef}"  />
                                <h:graphicImage library="icones" name="drapeau.png" width="15" height="15" style="float: right" rendered="#{itemOF.statutDeclaration ne constantes.ETAT_TERMINE}"
                                                title="#{lab.LP_POF_declaration_of_non_encore_atteint}"/>
                            </p:column>
                            <p:column width="250" headerText="#{lab.L_article}" styleClass="statut_#{itemOF.statutOrdre}">
                                <h:outputText value="[#{itemOF.article.refArt}]" style="font-weight: bold"/>
                                <h:outputText value=" #{itemOF.article.designation}" /> 
                            </p:column>
                            <p:column  headerText="#{lab.L_quantite}" width="90" style="text-align: center" styleClass="statut_#{itemOF.statutOrdre}">
                                <h:outputText value="#{itemOF.quantite}" converter="#{managedOrdresF.converterProd(itemOF.article.categorie)}" />
                            </p:column>
                            <p:column width="120" headerText="#{lab.LP_POF_nomenclature}" styleClass="statut_#{itemOF.statutOrdre}">                                                             
                                <h:outputText value="#{itemOF.nomenclature.reference}"/>
                            </p:column>
                            <p:column width="150" headerText="#{lab.LP_POF_gamme}" styleClass="statut_#{itemOF.statutOrdre}">
                                <h:outputText value="#{itemOF.gamme.codeRef}" />
                            </p:column>                                                                                
                            <p:column width="200" headerText="#{lab.LP_POF_lancement}" style="text-align: center" styleClass="statut_#{itemOF.statutOrdre}">
                                <h:outputText value="#{itemOF.dateDebut}" converter="DDMMYYYY" /> -AU-
                                <h:outputText value="#{itemOF.finValidite}" converter="DDMMYYYY" />
                            </p:column>
                            <p:column width="40" headerText="#{lab.LP_POF_cout}" style="text-align: center" styleClass="statut_#{itemOF.statutOrdre}" rendered="#{managedOrdresF.displayAll}">
                                <h:outputText value="#{itemOF.coutOf}" converter="#{managedOrdresF.converterCoutStock}"/>
                            </p:column>
                            <p:column width="40" headerText="#{lab.LP_POF_evolution}" style="text-align: center" styleClass="statut_#{itemOF.statutOrdre}">
                                <h:outputText value="#{itemOF.tauxEvolution}" converter="DNS"/> %
                            </p:column>
                            <p:column width="25" style="text-align: center" styleClass="statut_#{itemOF.statutOrdre}">

                                <p:contextMenu for="btn_option_tableOF" event="left click" style="font-size: 0.8em">
                                    <p:menuitem value="#{lab.LP_POF_resume}" icon="ui-icon-transferthick-e-w"  actionListener="#{managedOrdresF.loadAllFluxComposant(itemOF, true)}"/>
                                    <p:menuitem value="#{lab.LP_POF_mise_rebut}" icon="ui-icon-transferthick-e-w"  />
                                    <p:menuitem value="#{lab.L_annuler} " icon="ui-icon-circle-close" rendered="false"/>
                                    <p:separator  />
                                    <h:outputText value="#{lab.LP_PGF_maintenance}" />
                                    <p:menuitem icon="ui-icon-wrench" value="#{lab.LP_POF_recalcul_flux}" actionListener="#{managedOrdresF.maintenanceOF(itemOF)}" />
                                    <p:menuitem icon="ui-icon-wrench" value="#{lab.LP_POF_recalcul_cout}" actionListener="#{managedOrdresF.recalculOrder(itemOF)}" update="tableOF"/>
                                    <p:separator  />
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedOrdresF.setSelectedOf(itemOF)}" oncomplete="dlgConfirmDelete.show()"/>
                                </p:contextMenu>   
                                <p:commandButton icon="ui-icon-gear" type="button" id="btn_option_tableOF" style="width: 22px; height: 22px" />
                            </p:column>
                            <p:column width="25" style="text-align: center">
                                <f:facet name="header">
                                    <h:selectBooleanCheckbox class="chek_all_line_of" onclick="selectionAllLineTab(#{managedOrdresF.listeOrdreF.size()}, 'of')" value="false" />
                                </f:facet>
                                <h:selectBooleanCheckbox class="chek_line_of" value="false" onclick="selectionLineTab(#{line}, 'of')"/>
                            </p:column>
                        </p:dataTable>  
                        <span style="margin-left: 35%; font-size: .8em; font-style: italic; color: #828c95" class="nbSelectof"></span>
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                            <p:commandButton actionListener="#{managedOrdresF.avance(false)}" update="tableOF" icon="ui-icon-circle-triangle-w" disabled="#{managedOrdresF.paginator.disPrev}"/>
                            <p:outputPanel >
                                <p:inplace label="#{managedOrdresF.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                    <pe:inputNumber value="#{managedOrdresF.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                        <p:ajax event="valueChange" listener="#{managedOrdresF.gotoPagePaginator()}" update="tableOF"/>
                                    </pe:inputNumber>
                                </p:inplace><p:outputLabel value="/#{managedOrdresF.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                            </p:outputPanel>
                            <p:commandButton actionListener="#{managedOrdresF.avance(true)}" update="tableOF" icon="ui-icon-circle-triangle-e" disabled="#{managedOrdresF.paginator.disNext}"/>
                            <p:selectOneMenu value="#{managedOrdresF.imax}" label="#{lab.L_nombre_max_resultat}" 
                                             valueChangeListener="#{managedOrdresF.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                <f:selectItems value="#{managedOrdresF.paginations}"/>
                                <p:ajax event="valueChange" update="tableOF"/>
                            </p:selectOneMenu>
                        </p:outputPanel> 
                    </div>                           
                </div>
            </h:form>

        </div>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">            
            <div class="zone_find">
                <div class="yvs_form_of display_auteur" align="right"  style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedOrdresF.selectedOf.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedOrdresF.selectedOf.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedOrdresF.selectedOf.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <div id="zone_search_of">
                    <h:panelGrid id="blog_search_fv" columns="2" style="width: 100%;" cellpadding="0" cellspacing="0">
                        <h:panelGrid columns="7" style="float: left; font-size: 0.8em" cellpadding="0" cellspacing="0">
                            <h:outputText value="" />
                            <h:panelGroup>
                                <h:selectBooleanCheckbox value="#{managedOrdresF.date_}" valueChangeListener="#{managedOrdresF._chooseDateSearch}" style="float: left;margin-left: 5px">
                                    <p:ajax event="valueChange" oncomplete="collapseList('of')" update="blog_date_search_entete_facture_vente"/>
                                </h:selectBooleanCheckbox>
                                <h:outputText value="#{lab.L_date}" />
                            </h:panelGroup>
                            <h:outputText value="#{ab.LP_POF_site}" />
                            <h:outputText value="#{lab.L_article}" />
                            <h:panelGroup>                                
                                <h:outputText value="#{lab.LP_POF_s_decl}." title="#{lab.LP_POF_statut_decl}" style="float:left;margin-top: 2px"/>
                                <h:selectOneMenu value="#{managedOrdresF.egaliteStatutDec}" style="float:right;margin-right: 5px;">
                                    <f:selectItem itemLabel="#{lab.L_egale}" itemValue="="/>
                                    <f:selectItem itemLabel="#{lab.L_different}" itemValue="!="/>
                                    <p:ajax event="valueChange" listener="#{managedOrdresF.searchByStatutDec()}" oncomplete="collapseList('of')"/>
                                </h:selectOneMenu>  
                            </h:panelGroup>
                            <span title="#{lab.LP_POF_numero_production}">#{lab.LP_POF_numero_p}</span>
                            <h:outputText value="" />
                            <p:commandButton icon="ui-icon-bullet" actionListener="#{managedOrdresF.clearParams()}" title="#{lab.L_reset_param}" style="width: 20px; height: 22px" 
                                             update="blog_search_fv"/>
                            <h:panelGroup id="blog_date_search_entete_facture_vente">
                                <p:calendar value="#{managedOrdresF.dateDebut}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedOrdresF.date_}" size="10" style="font-size: 0.8em">
                                    <p:ajax event="dateSelect"  listener="#{managedOrdresF.addParamDate1}" oncomplete="collapseList('of')"/>
                                    <p:ajax event="valueChange"  listener="#{managedOrdresF.addParamDate2()}" oncomplete="collapseList('of')"/>
                                </p:calendar>
                                <p:spacer width="5px" style="background: black"/>
                                <p:calendar value="#{managedOrdresF.dateFin}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedOrdresF.date_}" size="10" style="font-size: 0.8em">
                                    <p:ajax event="dateSelect" listener="#{managedOrdresF.addParamDate1}" oncomplete="collapseList('of')"/>
                                    <p:ajax event="valueChange" listener="#{managedOrdresF.addParamDate2()}" oncomplete="collapseList('of')"/>
                                </p:calendar>
                            </h:panelGroup>
                            <h:selectOneMenu value="#{managedOrdresF.siteSearch}" style="min-width: 160px">
                                <f:selectItem itemValue="0" itemLabel="" />
                                <f:selectItems value="#{managedSiteProduction.sites}" var="isS" itemValue="#{isS.id}" itemLabel="#{isS.designation}" />    
                                <p:ajax event="valueChange" listener="#{managedOrdresF.addParamSite()}" oncomplete="collapseList('of')"/>                                
                            </h:selectOneMenu>
                            <h:inputText value="#{managedOrdresF.article_}" style="min-width: 120px">
                                <p:ajax event="valueChange" listener="#{managedOrdresF.addParamArticle()}" oncomplete="collapseList('of')"/>
                            </h:inputText>                             
                            <h:selectOneMenu value="#{managedOrdresF.statutDec}"  valueChangeListener="#{managedOrdresF.addParamStatuDeclaration}" style="min-width: 120px">
                                <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                                <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.ETAT_ATTENTE}"/>
                                <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                                <f:selectItem itemLabel="#{lab.L_termine}" itemValue="#{constantes.ETAT_TERMINE}"/>
                                <p:ajax event="valueChange" oncomplete="collapseList('of')"/>
                            </h:selectOneMenu>
                            <h:inputText value="#{managedOrdresF.numSearch_}" style="min-width: 120px">
                                <p:ajax event="valueChange" listener="#{managedOrdresF.addParamNumRef()}" oncomplete="collapseList('of')"/>
                            </h:inputText>  
                            <p:commandLink value="#{lab.L_avancees}" type="button" global="false" onclick="dlgStatut.show()"/>
                        </h:panelGrid>
                    </h:panelGrid>
                </div>          
            </div>
        </h:form>
    </ui:define>
</ui:composition>

