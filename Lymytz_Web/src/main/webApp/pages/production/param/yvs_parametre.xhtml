<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Paramètres généraux','modProduction', 'smenParamProd', true)}
    </ui:define>  
    <ui:define name="contents">
        #{managedParamProd.loadAll()}
        #{managedCalendrier.loadByModule(constantes.MOD_PROD)}
        #{managedTypeCout.loadAll(constantes.MOD_PROD)}
        #{managedSiteProduction.loadAll()}
        #{managedCentreCharge.loadAll()}
        <script type="text/javascript">
            $(function() {
                collapseForm('type_cout_prod');
                collapseForm('site_production');
                collapseForm('cal_production');
                collapseForm('centre_charge');
            });
        </script>
        <h:form prependId="false" >
            <p:dialog header="#{lab.LP_PPG_liste_compte}" widgetVar="dlgListComptes" modal="true" width="50%" closeOnEscape="true" style="min-height: 250px">
                <div class="dlg_part_fixe">
                    <p:watermark value="#{lab.LP_PPG_saisir_compte_g}...." for="txt_cmpte_find_typeCoutProd"/>
                    <p:watermark value="#{lab.LP_PPG_saisir_nature_compte}...." for="txt_nature_find_typeCoutProd"/>
                    <h:panelGrid columns="2" style="font-size: 0.7em; float: left">        
                        <h:inputText value="#{managedCompte.numCompteF}" id="txt_cmpte_find_typeCoutProd">
                            <p:ajax event="keyup" listener="#{managedCompte.addParamNumCompte(managedCompte.numCompteF)}" update="data_comptes_type_prod" />
                        </h:inputText>
                        <h:inputText value="#{managedCompte.natureCompteF}" id="txt_nature_find_typeCoutProd">
                            <p:ajax event="keyup" listener="#{managedCompte.addParamNatureCompte(managedCompte.natureCompteF)}" update="data_comptes_type_prod" />
                        </h:inputText>
                    </h:panelGrid>
                    <p:outputPanel style="float: right" layout="block" autoUpdate="true">
                        <p:commandButton actionListener="#{managedCompte.pagineDataCompte(false)}" update="data_comptes_type_prod" icon="ui-icon-circle-triangle-w" disabled="#{managedCompte.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedCompte.paginator.currentPage}/#{managedCompte.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedCompte.pagineDataCompte(true)}" update="data_comptes_type_prod" icon="ui-icon-circle-triangle-e" disabled="#{managedCompte.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedCompte.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCompte.changeMaxResult}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedCompte.paginations}"/>
                            <p:ajax event="valueChange" update="data_comptes_type_prod"/>
                        </p:selectOneMenu>
                    </p:outputPanel><div  style="clear: both" />
                </div>
                <div class="dlg_part_scroll">
                    <p:dataTable id="data_comptes_type_prod" value="#{managedCompte.listComptes}" var="cpt" rowKey="#{cpt.id}" 
                                 rowIndexVar="cltIdx" selectionMode="single" paginator="true" rows="20" paginatorAlwaysVisible="false">
                        <p:ajax event="rowSelect" global="false" listener="#{managedTypeCout.loadOnViewCompte}"  oncomplete="dlgListComptes.hide()"
                                update=":main_param_prod:tabview_param_prod:txt_compte_type_cout_prod"/>
                        <p:column width="15">
                            <span>#{cltIdx+1}</span>
                        </p:column>
                        <p:column width="50" headerText="#{lab.LP_PPG_numero_g}.">
                            <span>#{cpt.numCompte}</span>
                        </p:column>
                        <p:column width="50" headerText="#{lab.LDB_PP_compte_general}">
                            <span>#{cpt.compteGeneral.numCompte}</span>
                        </p:column>
                        <p:column headerText="#{lab.LDB_PP_intitule}" width="80">
                            <span>#{cpt.intitule}</span>
                        </p:column>
                    </p:dataTable>
                </div>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteParametre" closeOnEscape="true"
                             message="#{lab.LP_PPG_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedParamProd.deleteBean()}" update=":main_param_prod:tabview_param_prod:form_param_prod"
                                 oncomplete="dlgConfirmDeleteParametre.hide();collapseForm('param_prod')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteParametre.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteTypeCout" closeOnEscape="true"
                             message="#{lab.LP_PPG_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTypeCout.deleteBean()}" update=":main_param_prod:tabview_param_prod:form_type_cout_prod :main_param_prod:tabview_param_prod:data_type_cout_prod"
                                 oncomplete="dlgConfirmDeleteTypeCout.hide();collapseForm('type_cout_prod')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteTypeCout.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteTypeCout_" closeOnEscape="true"
                             message="#{lab.LP_PPG_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTypeCout.deleteBean_()}" update=":main_param_prod:tabview_param_prod:form_type_cout_prod :main_param_prod:tabview_param_prod:data_type_cout_prod"
                                 oncomplete="dlgConfirmDeleteTypeCout_.hide();collapseForm('type_cout_prod')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteTypeCout_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCentre" closeOnEscape="true"
                             message="#{lab.LP_PPG_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCentreCharge.deleteBean()}" update=":main_param_prod:tabview_param_prod:form_centre_charge :main_param_prod:tabview_param_prod:data_centre_charge"
                                 oncomplete="dlgConfirmDeleteCentre.hide();collapseForm('centre_charge')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCentre.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCentre_" closeOnEscape="true"
                             message="#{lab.LP_PPG_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCentreCharge.deleteBean_()}" update=":main_param_prod:tabview_param_prod:form_centre_charge :main_param_prod:tabview_param_prod:data_centre_charge"
                                 oncomplete="dlgConfirmDeleteCentre_.hide();collapseForm('centre_charge')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCentre_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog message="#{lab.LP_PPG_text1} " closeOnEscape="true" widgetVar="dlgDelCal"
                             header="#{lab.LP_PPG_text2}" rendered="false">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedCalendrier.deleteBean()}" update=":main_param_prod:tabview_param_prod:tab_travail" oncomplete="dlgDelCal.hide();collapseList('cal_production')"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgDelCal.hide()"/>
            </p:confirmDialog>
        </h:form>
        <!-->
        *****************************************************************************
        Début du formulaire
        *****************************************************************************
        <-->         
        <h:form prependId="false" id="main_param_prod">  
            <div class="part_scroll">
                <p:tabView id="tabview_param_prod">                   
                    <p:tab title="#{lab.LP_PPG_parametres}">
                        <h:panelGrid id="form_param_prod" columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0"> 
                            <f:facet name="header">
                                <h:panelGrid columns="2" style="width: 100%">
                                    <span style="font-weight: bold">#{lab.LP_PPG_parametres_generaux}</span>
                                    <h:panelGroup style="float: right">
                                        <p:commandButton value="#{lab.L_supprimer}" id="delete_param_prod_" global="false" rendered="false"
                                                         onclick="dlgConfirmDeleteParametre.show()" style="float: left"/>
                                        <p:commandButton value="#{lab.L_enregistrer}" update="form_param_prod"
                                                         actionListener="#{managedParamProd.saveNew()}"/>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </f:facet>
                            <span>#{lab.LP_PPG_format_stock} (MP, PSF) </span>
                            <h:panelGroup>
                                <pe:inputNumber value="#{managedParamProd.param.converter}" decimalPlaces="0"  style="width: 70px; text-align: center">
                                    <p:ajax event="blur" global="false" update="txt_apercu_converter_monnaie"/>
                                </pe:inputNumber>
                                <h:panelGroup style="float: right;margin-top: 5px">
                                    <span>#{lab.L_apercu} : </span>
                                    <h:outputText id="txt_apercu_converter_monnaie" value="1000" converter="#{managedParamProd.getConverted(managedParamProd.param.converter)}" style="font-weight: bold"/>
                                </h:panelGroup>
                            </h:panelGroup>
                            <span>#{lab.LP_PPG_format_stock} (PF)</span>
                            <h:panelGroup>
                                <pe:inputNumber value="#{managedParamProd.param.converterPF}" decimalPlaces="0"  style="width: 70px; text-align: center">
                                    <p:ajax event="blur" global="false" update="txt_apercu_converter_monnaie_PF"/>
                                </pe:inputNumber>
                                <h:panelGroup style="float: right;margin-top: 5px">
                                    <span>#{lab.L_apercu} : </span>
                                    <h:outputText id="txt_apercu_converter_monnaie_PF" value="1000" converter="#{managedParamProd.getConverted(managedParamProd.param.converterPF)}" style="font-weight: bold"/>
                                </h:panelGroup>
                            </h:panelGroup>
                            <span>#{lab.LP_PPG_suivi_operations_requis}</span>
                            <h:selectBooleanCheckbox value="#{managedParamProd.param.suiviOprequis}" />
                            <span>#{lab.LP_PPG_duree_affichage_of}</span>
                            <pe:inputNumber value="#{managedParamProd.param.limiteVuOf}" minValue="1" maxValue="365" decimalPlaces="0" style="width: 70px; text-align: center"/>
                            <span>#{lab.LP_PPG_duree_limite_creation_antidate_of}</span>
                            <pe:inputNumber value="#{managedParamProd.param.limiteCreateOf}" minValue="1" maxValue="365"  decimalPlaces="0" style="width: 70px; text-align: center"/>
                            <span>#{lab.LP_PPG_cloturer_declaration_quantite_atteint}</span>
                            <h:selectBooleanCheckbox value="#{managedParamProd.param.closeDeclAuto}" />                            
                            <span>#{lab.LP_PPG_declaration_dois_proportionnelle_composant_conome}</span>
                            <h:selectBooleanCheckbox value="#{managedParamProd.param.declarationProportionnel}" />                             
                            <span>Evalue PR depuis OF</span>
                            <h:selectBooleanCheckbox value="#{managedParamProd.param.valoriseFromOf}" />                             
                            <span>#{lab.LP_PPG_valoriser_stock_au_prix} </span>
                            <h:selectOneMenu value="#{managedParamProd.param.valoriserBy}"  >
                                <f:selectItem itemLabel="#{lab.LP_PPG_production}" itemValue="P"/>
                                <f:selectItem itemLabel="#{lab.LP_PPG_vente}" itemValue="V"/>
                                <f:selectItem itemLabel="#{lab.LP_PPG_achat}" itemValue="A"/>
                                <f:selectItem itemLabel="#{lab.LP_PPG_revient}" itemValue="R"/>
                                <p:ajax event="valueChange" global="false"/>
                            </h:selectOneMenu>                                
                            <span>Déclarer quand on termine un ordre de fabrication</span>
                            <h:selectBooleanCheckbox value="#{managedParamProd.param.declareWhenFinishOf}" />                  
                        </h:panelGrid>
                        <div style="clear: both"/>
                    </p:tab>
                    <p:tab title="#{lab.LP_PPG_calendrier}">
                        <p:outputPanel id="blog_form_cal_production"> 
                            <div class="headline_data">
                               #{lab.LP_PPG_reference_du}                           
                            </div>
                            <div style="float: right" >                                        
                                <h:link onclick="collapseForm('cal_production');
                                        return false" title="#{lab.L_mode_liste}" >
                                    <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                                </h:link>
                                <h:link  onclick="collapseList('cal_production');
                                        return false" title="#{lab.LP_PPG_vue_hieraechique}">
                                    <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                                </h:link>                                                               
                            </div>
                            <h:panelGroup id="form_cal_production">
                                <span>#{lab.L_actif}</span>
                                <h:selectBooleanCheckbox value="#{managedCalendrier.calendrier.actif}" />
                                <span>#{lab.L_reference}</span>
                                <h:inputText value="#{managedCalendrier.calendrier.reference}" />
                                <span>#{lab.LP_PPG_marge_autorisee}</span>
                                <pe:timePicker value="#{managedCalendrier.calendrier.marge}" />                             
                                <p:outputPanel autoUpdate="true">
                                    <span>#{lab.LP_PPG_duree} </span>
                                    <p:inputText disabled="true" value="#{managedCalendrier.calendrier.totalHeureHebdo}"  id="detail_jour_travail_production_fp" style="width: 50px"/>
                                </p:outputPanel>
                                <p:commandButton value="#{lab.L_nouveau}" style="float: right" icon="ui-icon-document" actionListener="#{managedCalendrier.resetForm()}" update=":main_param_prod:tabview_param_prod:blog_form_cal_production"
                                                 oncomplete="collapseForm('cal_production')"/>
                                <p:commandButton value="#{lab.L_enregistrer}" style="float: right" icon="ui-icon-circle-plus" actionListener="#{managedCalendrier.saveNew()}" update=":main_param_prod:tabview_param_prod:blog_form_cal_production"
                                                 oncomplete="collapseForm('cal_production')"/>
                            </h:panelGroup>
                            <div class="headline_data" style="clear: right">
                                #{lab.LP_PPG_calendrier_travail}                            
                            </div>
                            <p:outputPanel id="bloc_jour_travail_production">
                                <div class="yvs_form_cal_production">                                
                                    <h:panelGrid columns="7" style="width: 100%" id="detail_jour_travail_production">                                    
                                        <h:panelGroup >
                                            <span>#{lab.L_jour} </span>
                                            <h:selectOneMenu value="#{managedCalendrier.jourOuv.jour}"  >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>
                                                <f:selectItem itemLabel="#{lab.LP_PPG_lundi}" itemValue="Lundi"/>
                                                <f:selectItem itemLabel="#{lab.LP_PPG_mardi}" itemValue="Mardi"/>
                                                <f:selectItem itemLabel="#{lab.LP_PPG_mercredi}" itemValue="Mercredi"/>
                                                <f:selectItem itemLabel="#{lab.LP_PPG_jeudi}" itemValue="Jeudi"/>
                                                <f:selectItem itemLabel="" itemValue="Vendredi"/>
                                                <f:selectItem itemLabel="#{lab.LP_PPG_samedi}" itemValue="Samedi"/>
                                                <f:selectItem itemLabel="#{lab.LP_PPG_dimanche}" itemValue="Dimanche"/>
                                                <p:ajax event="valueChange" listener="#{managedParametrageGRH.searchJoursOuvreeByJour()}" global="false"/>
                                            </h:selectOneMenu>
                                        </h:panelGroup>
                                        <p:selectBooleanCheckbox value="#{managedCalendrier.jourOuv.ouvrable}" itemLabel="#{lab.LP_PPG_ouvrable}"/>
                                        <p:selectBooleanCheckbox value="#{managedCalendrier.jourOuv.jourDerepos}" itemLabel="#{lab.LP_PPG_jour_repos} "/>
                                        <h:panelGrid columns="4" style="width: 100%" >                                      
                                            <p:outputLabel value="#{lab.LP_PPG_debut_travail}" style="color: #006666"/>
                                            <pe:timePicker value="#{managedCalendrier.jourOuv.heureDebutTravail}">
                                                <p:ajax event="timeSelect" listener="#{managedCalendrier.eventCalculDureeTravail()}" global="false"/>
                                            </pe:timePicker>
                                            <p:outputLabel value="#{lab.LP_PPG_fin_travail}" style="color: #006666"/>
                                            <pe:timePicker value="#{managedCalendrier.jourOuv.heureFinTravail}">
                                                <p:ajax event="timeSelect" listener="#{managedCalendrier.eventCalculDureeTravail()}" global="false"/>
                                            </pe:timePicker>
                                            <p:outputLabel value="#{lab.LP_PPG_debut_pause} " style="color: #f6a828"/>
                                            <pe:timePicker value="#{managedCalendrier.jourOuv.heureDebutPause}" />
                                            <p:outputLabel value="#{lab.LP_PPG_fin_pause}" style="color: #f6a828"/>
                                            <pe:timePicker value="#{managedCalendrier.jourOuv.heureFinPause}" />                                           
                                        </h:panelGrid>
                                        <p:commandButton value="#{(managedCalendrier.jourOuv.id gt 0)?'Modifier':'Ajouter'}" oncomplete="collapseForm('cal_production')"
                                                         actionListener="#{managedCalendrier.addDayInCalndrier()}" update=":main_param_prod:tabview_param_prod:blog_form_cal_production"/>
                                    </h:panelGrid>
                                    <p:dataTable id="tab_jours_ouvree" value="#{managedCalendrier.calendrier.listJoursOuvres}" var="jour"
                                                 rowKey="#{jour.id}" selectionMode="single" widgetVar="tabJoursOuvrees">
                                        <p:ajax event="rowSelect" listener="#{managedCalendrier.loadJourOnView}" update=":main_param_prod:tabview_param_prod:detail_jour_travail_production"/>
                                        <p:ajax event="rowUnselect" listener="#{managedCalendrier.unLoadOnView}" update=":main_param_prod:tabview_param_prod:detail_jour_travail_production"/>
                                        <p:column headerText="Jour" styleClass="ouvrable_#{jour.ouvrable}">
                                            <h:outputText value="#{jour.jour}"/>
                                            <span style="float: right; font-weight: bold; font-size: 1.1em">#{jour.jourDeRepos?'R':''}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.LP_PPG_heure_debut_travail}" styleClass="ouvrable_#{jour.ouvrable}" style="text-align: center">
                                            <h:outputText value="#{jour.heureDebutTravail}" converter="TIME"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LP_PPG_heure_fin_travail}" styleClass="ouvrable_#{jour.ouvrable}" style="text-align: center">
                                            <h:outputText value="#{jour.heureFinTravail}" converter="TIME"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LP_PPG_heure_debut_pause}" styleClass="ouvrable_#{jour.ouvrable}" style="text-align: center">
                                            <h:outputText value="#{jour.heureDebutPause}" converter="TIME"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LP_PPG_heure_fin_pause}" styleClass="ouvrable_#{jour.ouvrable}" style="text-align: center">
                                            <h:outputText value="#{jour.heureFinPause}" converter="TIME"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LP_PPG_duree_pause}" style="text-align: center" styleClass="ouvrable_#{jour.ouvrable}" >
                                            <h:outputText value="#{jour.dureePause}" converter="TIME" />
                                        </p:column>
                                        <p:column headerText="" style="text-align: center" width="20">
                                            <p:contextMenu for="btn_option_tbJO" event="left click">
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCalendrier.deleteJour(jour)}"/>
                                            </p:contextMenu>
                                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" type="button" id="btn_option_tbJO" />
                                        </p:column>
                                    </p:dataTable>
                                </div>
                                <div class="yvs_list_cal_production">
                                    <p:dataTable value="#{managedCalendrier.calendriers}" var="iCal" id="table_paramG_calendar"
                                                 rowIndexVar="line_cal" rowKey="#{iCal.id}" selectionMode="single">
                                        <p:ajax event="rowSelect" listener="#{managedCalendrier.loadOnView}" update=":main_param_prod:tabview_param_prod:blog_form_cal_production" oncomplete="collapseForm('cal_production')"/>
                                        <p:column headerText="N°" width="15" style="text-align: center">
                                            #{line_cal+1}
                                        </p:column>
                                        <p:column headerText="#{lab.L_reference}" width="300" >
                                            #{iCal.reference}
                                        </p:column>
                                        <p:column headerText="#{lab.LP_PPG_marge_accepte}" width="50" style="text-align: right">
                                            <h:outputText value="#{iCal.tempsMarge}" converter="TIME" />
                                        </p:column>
                                        <p:column headerText="#{lab.actif}" width="15" style="text-align: center">
                                            <h:graphicImage library="img" name="#{iCal.actif?'yes.png':'no.png'}" width="15" height="15" />
                                        </p:column>
                                        <p:column headerText="" style="text-align: center" width="20">
                                            <p:contextMenu for="btn_option_tbJO" event="left click">
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCalendrier.openDlgDelCal(iCal)}"/>
                                            </p:contextMenu>
                                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" type="button" id="btn_option_tbJO" />
                                        </p:column>                                    
                                    </p:dataTable>
                                    <p:outputPanel style="float: right" layout="block" autoUpdate="true">
                                        <p:commandButton actionListener="#{managedCalendrier.pagineData(false)}" update="table_paramG_calendar" icon="ui-icon-circle-triangle-w" disabled="#{managedCalendrier.paginator.disPrev}"/>
                                        <p:outputPanel ><p:outputLabel value="#{managedCalendrier.paginator.currentPage}/#{managedCalendrier.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                                        <p:commandButton actionListener="#{managedCalendrier.pagineData(true)}" update="table_paramG_calendar" icon="ui-icon-circle-triangle-e" disabled="#{managedCalendrier.paginator.disNext}"/>
                                        <p:selectOneMenu value="#{managedCalendrier.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCalendrier.changeMaxResult}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                            <f:selectItems value="#{managedCalendrier.paginations}"/>
                                            <p:ajax event="valueChange" update="table_paramG_calendar"/>
                                        </p:selectOneMenu>
                                    </p:outputPanel>
                                    <div style="clear: right"/>
                                </div>                              
                            </p:outputPanel>
                        </p:outputPanel> 
                    </p:tab>             
                    <p:tab title="#{lab.LP_PPG_centre_charge}">
                        <p:outputPanel id="blog_form_centre_charge">
                            <div style="float: left;width: 30%">
                                <h:panelGrid id="form_centre_charge" columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                    <span>#{lab.L_reference} </span>
                                    <h:inputText value="#{centreCharge.reference}" style="width: 100%"/>
                                    <span>#{lab.L_designation} </span>
                                    <h:inputText value="#{centreCharge.designation}" style="width: 100%"/>
                                    <span>#{lab.LP_PPG_site} </span>
                                    <h:selectOneMenu id="select_site_centre_charge" value="#{centreCharge.siteProduction.id}" style="width: 100%">
                                        <f:selectItem itemLabel="--" itemValue="#{0}"/>
                                        <f:selectItems value="#{managedSiteProduction.sites}" var="site" 
                                                       itemLabel="#{site.designation}" itemValue="#{site.id}"/>                                        
                                    </h:selectOneMenu>
                                    <span>#{lab.L_actif} </span>
                                    <h:selectBooleanCheckbox value="#{centreCharge.actif}"/>
                                    <f:facet name="footer">
                                        <span>#{lab.L_description} </span>
                                        <h:inputTextarea value="#{centreCharge.description}" rows="5" style="width: 98%"/>
                                    </f:facet>
                                </h:panelGrid>
                                <div>
                                    <p:commandButton value="#{lab.L_nouveau}" update="form_centre_charge" global="false"
                                                     actionListener="#{managedCentreCharge.resetFiche()}" style="float: left"
                                                     oncomplete="collapseForm('centre_charge')"/>
                                    <p:commandButton value="#{lab.L_enregistrer}" update="form_centre_charge data_centre_charge"
                                                     actionListener="#{managedCentreCharge.saveNew()}" style="float: right"/>
                                </div>
                            </div>
                            <div style="margin-left:31%;width: 69%">
                                <h:inputHidden id="input_hide_centre_charge" value="#{managedCentreCharge.tabIds}"/>
                                <p:dataTable id="data_centre_charge" value="#{managedCentreCharge.centres}" var="centr"
                                             rowKey="#{centr.id}" rowIndexVar="cIdx" selectionMode="single">
                                    <p:ajax event="rowSelect" global="false" listener="#{managedCentreCharge.loadOnView}" update=":main_param_prod:tabview_param_prod:form_centre_charge"/>
                                    <p:ajax event="rowUnselect" global="false" listener="#{managedCentreCharge.unLoadOnView}" update=":main_param_prod:tabview_param_prod:form_centre_charge"/>
                                    <p:column width="30" headerText="N°">
                                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{centr.new_}"/>
                                        <span>#{cIdx+1}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_reference}">
                                        <span>#{centr.reference}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_designation}">
                                        <span>#{centr.designation}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LP_PPG_site}">
                                        <span>#{centr.siteProduction.designation}</span>
                                    </p:column>
                                    <p:column width="20" style="text-align: center">
                                        <h:graphicImage library="img" name="#{(centr.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                                    </p:column>
                                    <p:column width="20" style="text-align: center">                                          
                                        <p:contextMenu for="btn_option_centre_charge" event="left click" style="font-size: 0.8em">
                                            <p:menuitem value="#{(centr.actif)?'Desactiver':'Activer'}" icon="#{(centr.actif)?'ui-icon-locked':'ui-icon-unlocked'}" 
                                                        global="false" actionListener="#{managedCentreCharge.setActive(centr)}" update="data_centre_charge"/>
                                            <p:separator />
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedCentreCharge.deleteBean_(centr)}" oncomplete="dlgConfirmDeleteCentre_.show()"/>
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_centre_charge" type="button"/>
                                    </p:column> 
                                    <p:column width="20" style="text-align: center" rendered="false">
                                        <f:facet name="header">
                                            <h:selectBooleanCheckbox styleClass="chek_all_line_centre_charge" value="false"
                                                                     onclick="selectionAllLineTab(#{managedCentreCharge.centres.size()}, 'centre_charge')">
                                            </h:selectBooleanCheckbox>
                                        </f:facet>
                                        <h:selectBooleanCheckbox  value="#{centr.select}" styleClass="chek_line_centre_charge" 
                                                                  onclick="selectionLineTab(#{centr.id}, 'centre_charge')">
                                        </h:selectBooleanCheckbox>
                                    </p:column>
                                </p:dataTable>
                                <p:commandButton value="Supprimer" id="delete_centre_charge" global="false" rendered="false"
                                                 onclick="dlgConfirmDeleteCentre.show()" style="float: right"/>
                            </div>
                        </p:outputPanel>
                        <div style="clear: both"/>
                    </p:tab>               
                    <p:tab title="#{lab.LP_PPG_type_cout}">
                        <p:outputPanel id="blog_form_type_cout_prod">
                            <div style="float: left;width: 30%">
                                <h:panelGrid id="form_type_cout_prod" columns="1" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                    <span>#{lab.L_libelle} </span>
                                    <h:inputText value="#{managedTypeCout.typeCout.libelle}" style="width: 100%"/>
                                    <span>#{lab.LP_PPG_compte} </span>
                                    <h:panelGroup id="txt_compte_type_cout_prod">
                                        <h:inputText value="#{managedTypeCout.typeCout.compte.numCompte}" style="color: #{managedTypeCout.typeCout.compte.error?'red':''};width: 35%">
                                            <p:ajax event="blur" global="false" listener="#{managedTypeCout.searchCompte()}" update="txt_compte_type_cout_prod"/>
                                        </h:inputText>  
                                        <h:outputText value="#{managedTypeCout.typeCout.compte.intitule}"/>                                    
                                        <p:commandButton icon="ui-icon-note" style="float: right; width: 20px;height: 22px" title="Liste Comptes" global="false"
                                                         actionListener="#{managedTypeCout.initComptes()}" oncomplete="dlgListComptes.show()"/>
                                    </h:panelGroup>
                                    <span>#{lab.LP_PPG_point_application} </span>
                                    <h:selectOneMenu value="#{managedTypeCout.typeCout.module}" style="width: 100%" valueChangeListener="#{managedTypeCout.chooseType}">
                                        <f:selectItem itemValue="" itemLabel="--"/>
                                        <f:selectItems value="#{constantes.COUTS(constantes.MOD_PROD)}" var="mol" itemValue="#{mol.value}" itemLabel="#{mol.label}"/>
                                        <p:ajax event="valueChange" global="false" update="data_type_cout_prod"/>
                                    </h:selectOneMenu>
                                </h:panelGrid>
                                <div>
                                    <p:commandButton value="#{lab.L_nouveau}" update="form_type_cout_prod" global="false" style="float: left"
                                                     actionListener="#{managedTypeCout.resetFiche()}" oncomplete="collapseForm('type_cout_prod')"/>
                                    <p:commandButton value="#{lab.L_enregistrer}" update="form_type_cout_prod data_type_cout_prod"
                                                     actionListener="#{managedTypeCout.saveNew()}" style="float: right"/>
                                </div>
                            </div>
                            <div style="margin-left:31%;width: 69%">
                                <h:inputHidden id="input_hide_type_cout_prod" value="#{managedTypeCout.tabIds}"/>
                                <p:dataTable id="data_type_cout_prod" value="#{managedTypeCout.types}" var="typC"
                                             rowKey="#{typC.id}" rowIndexVar="modeIdx" selectionMode="single">
                                    <p:ajax event="rowSelect" global="false" listener="#{managedTypeCout.loadOnView}" update=":main_param_prod:tabview_param_prod:form_type_cout_prod"/>
                                    <p:ajax event="rowUnselect" global="false" listener="#{managedTypeCout.unLoadOnView}" update=":main_param_prod:tabview_param_prod:form_type_cout_prod"/>
                                    <p:column width="30" headerText="N°">
                                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{typC.new_}"/>
                                        <span>#{modeIdx+1}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LP_PPG_valeur}">
                                        <span>#{typC.libelle}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LP_PPG_compte}">
                                        <span title="#{typC.compte.intitule}">#{typC.compte.numCompte}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LP_PPG_appli_sur}">
                                        <span>#{managedTypeCout.giveNameCouts(typC.moduleCout)}</span>
                                    </p:column>
                                    <p:column width="20" style="text-align: center">                                          
                                        <p:contextMenu for="btn_option_type_cout_prod" event="left click" style="font-size: 0.8em">
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedTypeCout.deleteBean_(typC)}" oncomplete="dlgConfirmDeleteTypeCout_.show()"/>
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_type_cout_prod" type="button"/>
                                    </p:column> 
                                    <p:column width="20" style="text-align: center" rendered="false">
                                        <f:facet name="header">
                                            <h:selectBooleanCheckbox styleClass="chek_all_line_type_cout_prod" value="false"
                                                                     onclick="selectionAllLineTab(#{managedTypeCout.types.size()}, 'type_cout_prod')">
                                            </h:selectBooleanCheckbox>
                                        </f:facet>
                                        <h:selectBooleanCheckbox  value="#{typC.selectActif}" styleClass="chek_line_type_cout_prod" 
                                                                  onclick="selectionLineTab(#{typC.id}, 'type_cout_prod')">
                                        </h:selectBooleanCheckbox>
                                    </p:column>
                                </p:dataTable>
                                <p:commandButton value="#{lab.L_supprimer}" id="delete_type_cout_prod" global="false" rendered="false"
                                                 onclick="dlgConfirmDeleteMode.show()" style="float: right"/>
                            </div>
                        </p:outputPanel>
                        <div style="clear: both"/>
                    </p:tab>  
                </p:tabView>
            </div>
        </h:form>
    </ui:define>
</ui:composition>

