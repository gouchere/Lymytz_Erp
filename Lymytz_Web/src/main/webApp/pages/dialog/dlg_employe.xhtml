<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"       
                xmlns:p="http://primefaces.org/ui" 
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions" 
                xmlns:xmlns="http://java.sun.com/jsf/composite"    
                xmlns:ui="http://java.sun.com/jsf/facelets">     
    <h:head> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="initial-scale=1.0, user-scalable=yes"/>
        <h:outputStylesheet name="./css/default.css"/>
        <h:outputStylesheet name="./css/cssLayout.css"/>
        <h:outputStylesheet name="./css/styleModule.css" />
        <h:outputStylesheet library="css/menu" name="menuStyle.css" />
        <h:outputStylesheet library="css/menu" name="submenu.css" />
        <script type="text/javascript" src="../resources/js/jquery-1.11.1.min.js" language="javascript"/>
        <h:outputScript library="js" name="script.js" value="script.js"/>
        <title>Employés</title>
    </h:head>
    <h:form prependId="false" enctype="multipart/form-data">
        <p:dialog widgetVar="dlgUploadImg" width="300" height="100" closeOnEscape="true"
                  dynamic="true" resizable="false">
            <p:fileUpload sizeLimit="100000"  id="logo"  mode="advanced" dragDropSupport="true" 
                          allowTypes="/(\.|\/)(gif|jpe?g|png)$/" fileUploadListener="#{MEmps.handleFileUpload}"
                          uploadLabel="Envoyer" label="Parcourir.." auto="true"  update=":form-emps02:photos_empl"
                          oncomplete="dlgUploadImg.hide()"> 

            </p:fileUpload>
        </p:dialog>
    </h:form>
    <h:form prependId="false" enctype="multipart/form-data">
        <p:dialog widgetVar="dlgUploadDoc" width="300" height="100" closeOnEscape="true"
                  dynamic="true" resizable="false">
            <p:fileUpload sizeLimit="100000"  mode="advanced" dragDropSupport="true" 
                          allowTypes="/(\.|\/)(jpe?g|png|pdf|doc?x|txt)$/" fileUploadListener="#{MEmps.handleUploadDocEmps}"
                          uploadLabel="Envoyer" label="Parcourir.." auto="true"  
                          oncomplete="dlgUploadDoc.hide()"> 

            </p:fileUpload>
        </p:dialog>
    </h:form>





    <h:form prependId="false">
        <p:dialog widgetVar="dlgAddLangue" width="500" closeOnEscape="true"
                  header="Ajouter une nouvelle qualification" dynamic="true">
            <p:panelGrid columns="2" style="width: 100%">
                <p:outputLabel value="Nom" />
                <h:inputText value="#{MEmps.newLangue}"/>                              
                <f:facet name="footer">
                    <p:commandButton value="Ajouter" actionListener="#{MEmps.createNewLangue()}" 
                                     />                      
                </f:facet>
            </p:panelGrid>            
        </p:dialog>
    </h:form>
    <h:form prependId="false" >
        <p:dialog widgetVar="dlgLangue" width="50%" closeOnEscape="true"
                  header="Liste des langues" dynamic="true" >
            #{MEmps.loadLangue()}
            <p:dataTable value="#{MEmps.listLangues}" var="lan1" rowKey="#{lan1.id}"
                         selectionMode="single" >
                <p:ajax event="rowSelect" listener="#{MEmps.selectLangue}"/>
                <p:column headerText="Intitulé" >
                    #{lan1.langue}
                </p:column>                
            </p:dataTable> 
            <f:facet name="footer">
                <p:commandButton value="Créer" onclick="dlgAddLangue.show()" />
            </f:facet>
        </p:dialog>
    </h:form>
    <h:form prependId="false">
        <p:dialog widgetVar="dlgAddQualification" width="500" closeOnEscape="true"
                  header="Ajouter une nouvelle qualification" dynamic="true">
            <p:panelGrid columns="2" style="width: 100%">
                <p:outputLabel value="Désignation" />
                <h:inputText value="#{MEmps.newQualif}"/>                              
                <f:facet name="footer">
                    <p:commandButton value="Ajouter" actionListener="#{MEmps.createNewQualification()}" 
                                     />                     
                </f:facet>
            </p:panelGrid>            
        </p:dialog>
    </h:form>
    <h:form prependId="false" >
        <p:dialog widgetVar="dlgQualification" width="50%" closeOnEscape="true"
                  header="Liste des qualifications" dynamic="true" >
            #{qualification.loadAll()}
            <p:dataTable value="#{qualification.listValue}" var="qua1" rowKey="#{qua1.id}"
                         selectionMode="single" >
                <p:ajax event="rowSelect" listener="#{MEmps.selectQualification}"/>
                <p:column headerText="Intitulé" >
                    #{qua1.intitule}
                </p:column>                
            </p:dataTable> 
            <f:facet name="footer">
                <p:commandButton value="Créer" onclick="dlgAddQualification.show()" />
            </f:facet>
        </p:dialog>
    </h:form>
    <h:form prependId="false" id="form-emps03">
        <p:dialog widgetVar="dlgAddPoste" width="500" closeOnEscape="true"
                  header="Ajouter un nouveau poste de travail" dynamic="true">
            <p:panelGrid columns="2" style="width: 100%" id="gridPoste">
                <p:outputLabel value="Poste de Travail" />
                <h:inputText value="#{employe.posteDeTravail.intitule}"/>
                <p:outputLabel value=" Départements "/>
                <p:selectOneMenu value="#{employe.posteDeTravail.departement.id}">
                    <f:selectItem itemValue="0" itemLabel=""/>
                    <f:selectItems value="#{MEmps.departements}" var="dep" itemValue="#{dep.id}" 
                                   itemLabel="#{(dep.cheminParent==null)?dep.intitule:dep.cheminParent.concat('/').concat(dep.intitule)}" />
                </p:selectOneMenu>                
                <f:facet name="footer">
                    <p:panelGrid columns="2" style="width: 30%; margin: auto">
                        <p:commandButton value="Ajouter" actionListener="#{MEmps.createNewPosteDeTravail()}" oncomplete="dlgAddPoste.hide()"
                                         />
                        <p:commandButton value="Annuler" oncomplete="dlgAddPoste.hide()"
                                         />
                    </p:panelGrid>
                </f:facet>
            </p:panelGrid>            
        </p:dialog>
    </h:form>
    <h:form prependId="false" >
        <p:dialog widgetVar="dlgPosteDeTravail" width="50%" closeOnEscape="true"
                  header="Liste des postes de travails" dynamic="true" >
            <p:dataTable value="#{MEmps.posteDeTravails}" var="post1" rowKey="#{post1.id}"
                         selectionMode="single" >
                <p:ajax event="rowSelect" listener="#{MEmps.selectPoste}"/>
                <p:column headerText="Intitulé" >
                    #{post1.intitule}
                </p:column>
                <p:column headerText="Département" >
                    <h:outputText value="#{post1.departement.cheminParent} / #{post1.departement.intitule}"/>
                </p:column>
            </p:dataTable> 
            <f:facet name="footer">
                <p:commandButton value="Créer" onclick="dlgAddPoste.show()" update=":form-emps03:gridPoste"/>
            </f:facet>
        </p:dialog>
    </h:form>

    <h:form prependId="false" >
        <p:dialog widgetVar="dlgPays" width="20%" closeOnEscape="true"
                  header="pays" dynamic="true" height="550">
            #{MEmps.loadPays(0,true)}
            <p:dataTable value="#{MEmps.listPays}" var="pay" rowKey="#{pay.id}"
                         selectionMode="single"  scrollable="true" scrollHeight="500">
                <p:ajax event="rowSelect" listener="#{MEmps.selectPay}"/>
                <p:column headerText="Pays" >
                    #{pay.titre}
                </p:column>
            </p:dataTable>
            <f:facet name="footer">
                <p:commandButton value="Créer" onclick="dlgAddPays.show()"/>
            </f:facet>
        </p:dialog>
    </h:form>
    <h:form prependId="false">
        <p:dialog widgetVar="dlgAddPays" width="50%" closeOnEscape="true"
                  header="Ajouter un pays" dynamic="true">            
            <p:panelGrid columns="1" style="width: 100%" >
                <p:outputLabel value="Nom du pays" />
                <p:inputText value="#{MEmps.pays}" />
                <f:facet name="footer">
                    <p:commandButton value="Enregistrer" actionListener="#{MEmps.createNewPAys()}"/>
                </f:facet>
            </p:panelGrid>
        </p:dialog>
    </h:form>
    <h:form prependId="false">
        <p:dialog widgetVar="dlgVille" width="20%" closeOnEscape="true"
                  header="Liste des villes" dynamic="true" height="550">
            #{MEmps.loadVille(0, true)}
            <p:dataTable value="#{MEmps.listVille}" var="vill" rowKey="#{vill.id}"
                         selectionMode="single" scrollable="true" scrollHeight="500">
                <p:ajax event="rowSelect" listener="#{MEmps.selectVille}"/>
                <p:column headerText="Pays" >
                    #{vill.titre}
                </p:column>
            </p:dataTable>
            <f:facet name="footer">
                <p:commandButton value="Créer" onclick="dlgAddVille.show()"/>
            </f:facet>
        </p:dialog>
    </h:form>
    <h:form prependId="false">
        <p:dialog widgetVar="dlgAddVille" width="50%" closeOnEscape="true"
                  header="Ajouter une ville">
            <p:panelGrid columns="1" style="width: 100%" >
                <p:outputLabel value="Nom de la ville" />
                <p:inputText value="#{MEmps.ville}" />
                <f:facet name="footer">
                    <p:commandButton value="Enregistrer" actionListener="#{MEmps.createNewVille()}"/>
                </f:facet>
            </p:panelGrid>
        </p:dialog>
    </h:form>

    <h:form prependId="false">
        <p:dialog widgetVar="dlgVilleCNI" width="20%" closeOnEscape="true"
                  header="Liste des villes" dynamic="true" height="550">
            #{MEmps.loadVille(0, true)}
            <p:dataTable value="#{MEmps.listVille}" var="vill" rowKey="#{vill.id}"
                         selectionMode="single" scrollable="true" scrollHeight="500">
                <p:ajax event="rowSelect" listener="#{MEmps.selectVille1}"/>
                <p:column headerText="Pays" >
                    #{vill.titre}
                </p:column>
            </p:dataTable>
            <f:facet name="footer">
                <p:commandButton value="Créer" onclick="dlgAddVilleCNI.show()"/>
            </f:facet>
        </p:dialog>
    </h:form>
    <h:form prependId="false">
        <p:dialog widgetVar="dlgAddVilleCNI" width="50%" closeOnEscape="true"
                  header="Ajouter une ville">
            <p:panelGrid columns="1" style="width: 100%" >
                <p:outputLabel value="Nom de la ville" />
                <p:inputText value="#{MEmps.ville1}" />
                <f:facet name="footer">
                    <p:commandButton value="Enregistrer" actionListener="#{MEmps.createNewVille1()}"/>
                </f:facet>
            </p:panelGrid>
        </p:dialog>
    </h:form>    
    <h:form prependId="false" id="formUser">
        <p:dialog header="Liste des utilisateurs" closeOnEscape="true" dynamic="true"
                  widgetVar="dlgListUsers" modal="true" width="800" height="580" resizable="false">
            #{Musers.loadUsers(100,true)}
            <p:dataTable value="#{Musers.listUsers}" var="usr" rowKey="#{usr.id}"
                         widgetVar="tabUsers" id="tabUsers" selectionMode="single" scrollable="true" scrollHeight="500">
                <p:ajax event="rowSelect" listener="#{MEmps.selectUser}" oncomplete="dlgListUsers.hide()"/>
                <p:column headerText="Id" width="30">
                    <h:outputText value="#{usr.id}" />
                </p:column>
                <p:column headerText="Code Utilisateur">
                    <h:outputText value="#{usr.codeUser}" />
                </p:column>
                <p:column headerText="Noms &amp; Prénoms">
                    <h:outputText value="#{usr.nom}, #{usr.prenom}" />
                </p:column>                                       
                <p:column headerText="Groupe " >
                    <h:outputText value="#{usr.groupe}" />
                </p:column>
                <p:column headerText="Date Création">
                    <h:outputText value="#{usr.dateSave}"/>
                </p:column>
                <p:column headerText="Actif">
                    <p:column headerText="#{lab.L_actif}" style="text-align: center" width="30">
                        <h:graphicImage  value="#{(art.actif)?'../../resources/img/yes.png':'../../resources/img/no.png'}"  style="width: 10px; height: 10px"/>
                    </p:column>
                </p:column>
            </p:dataTable>
            <h:panelGrid columns="2" id="bNav">
                <p:commandLink actionListener="#{Musers.loadUsers(-100, false)}" disabled="#{Musers.disPrevUser}" update="tabUsers">
                    <h:graphicImage style="border:none; margin-left: .5em; cursor: pointer;"  alt="img" library="img"  name="dnavigation.png" width="30" height="25"/>                        
                </p:commandLink>
                <p:commandLink action="#{Musers.loadUsers(100, false)}" disabled="#{Musers.disNextUser}" update="tabUsers">
                    <h:graphicImage style="border:none; margin-left: 1em; cursor: pointer;"  alt="img" library="img"  name="gnavigation.png" width="30" height="25"/>                                                        
                </p:commandLink>  
            </h:panelGrid>
        </p:dialog> 
    </h:form>
    <h:form prependId="false" >
        <h:panelGrid columns="3" style="float: left" id="employe-main-dgrid">
            <p:commandButton value="Enregistrer" actionListener="#{MEmps.saveNew()}" 
                             icon="ui-icon-check"  rendered="#{MEmps.displayForm}"/>
            <p:commandButton value="Modifier" rendered="#{MEmps.displayOptions}"
                             actionListener="#{MEmps.openFormToUpdate()}"/>
            <p:commandButton value="Nouveau"  rendered="#{MEmps.displayForm}" actionListener="#{MEmps.resetFiche()}"/>
            <p:splitButton value="Options" rendered="#{MEmps.displayOptions}">                           
                <p:menuitem value="Contrats" />
                <p:menuitem value="Activer/desactiver" />
                <p:menuitem icon="ui-icon-close" value="Supprimer" />
            </p:splitButton>            
        </h:panelGrid>
        <h:panelGrid columns="6" style="float: right" id="employe-main-bloc">                                                               
            <p:outputLabel for="matEmps" value="Rechercher..."/>
            <p:inputText value="#{MEmps.matriculeToUpdate}" id="matEmps" />
            <p:commandButton icon="ui-icon-search" actionListener="#{MEmps.findEmploye()}"/>
            <p:commandButton icon="ui-icon-search" value="Rechercher..." id="optionB"/>                          
            <p:commandButton value="Form"  actionListener="#{MEmps.changeViewForm()}" rendered="#{MEmps.activBtnForm}"/>
            <p:commandButton value="Li./Gr." actionListener="#{MEmps.changeViewListe()}"/>            
        </h:panelGrid>
        <p:overlayPanel for="optionB" hideEffect="fade" dynamic="true" style="width: 25%">
            <p:panelGrid columns="2" style="width: 100%">
                <p:outputLabel value="Qualification" />
                <p:selectOneMenu style="width: 100%" value="#{MEmps.idQualif}" valueChangeListener="#{MEmps.findByQualification}">
                    <f:selectItems value="#{MEmps.listQualification}" var="item0" itemValue="#{item0.id}"
                                   itemLabel="#{item0.intitule}" />
                    <p:ajax event="valueChange" />
                </p:selectOneMenu>
                <p:outputLabel value="Département" />
                <p:selectOneMenu style="width: 100%" value="#{MEmps.idDepartement}" valueChangeListener="#{MEmps.findByDepartement}">
                    <f:selectItems value="#{MEmps.departements}" var="item1" itemValue="#{item1.id}"
                                   itemLabel="#{item1.intitule}" />
                    <p:ajax event="valueChange" />
                </p:selectOneMenu>
            </p:panelGrid>            
        </p:overlayPanel>
    </h:form>
    <p:separator style="width: 100%" /> 
    #{MEmps.loadAll()} 
    <p:outputPanel id="employe-main-panel" >
        <h:form prependId="false" id="form-emps02" >
            <p:outputPanel  rendered="#{MEmps.displayForm}">
                <p:panelGrid columns="1" style="width: 15%; float: left">
                    <f:facet name="header">
                        <p:commandLink title="Modifier..." onclick="dlgUploadImg.show()">
                            <p:graphicImage library="lymytz/documents/docEmps/photo"  width="100" height="110" 
                                            name="#{(employe.photos==null)?'user1.png':employe.photos}" alt="photos Employé" style="border: 0px solid #006666" id="photos_empl"/>
                        </p:commandLink>
                    </f:facet>                                                                            
                </p:panelGrid>
                <p:panelGrid columns="2" style="width: 85%;margin-left: 15%" id="emps-titre">                    
                    <h:outputText value="Nom" />                                    
                    <p:inputText value="#{employe.nom}" style="width: 100%" >
                        <p:ajax event="blur" />
                    </p:inputText>                                     
                    <h:outputText value="Prénom"/>                                    
                    <p:inputText value="#{employe.prenom}" style="width: 100%">
                        <p:ajax event="blur"/>
                    </p:inputText>
                    <h:outputText value="Civilité"  />
                    <h:selectOneMenu value="#{employe.civilite}"  valueChangeListener="#{MEmps.choixCivilite}">
                        <f:selectItem itemLabel="M." itemValue="M."/>
                        <f:selectItem itemLabel="Mlle" itemValue="Mlle"/>
                        <f:selectItem itemLabel="Mme" itemValue="Mme"/>  
                        <p:ajax update="emps-titre" />
                    </h:selectOneMenu> 
                    <h:outputText value="Nom de jeune fille" rendered="#{MEmps.displayName}"/>                                    
                    <p:inputText value="#{employe.nomDeJeuneFille}" style="width: 100%; background: aliceblue" 
                                 rendered="#{MEmps.displayName}" >
                        <p:ajax event="blur"/>
                    </p:inputText>
                </p:panelGrid> 
                <p:panelGrid columns="1"  id="titre" style="width: 100%">                
                    <p:tabView id="mainEmps" style="width: 99%;">        
                        <p:tab title="#{lab.L_general}" id="E-tab-gen">                             
                            <p:panelGrid columns="4" style="width: 100%">                                
                                <h:outputText value="Matricule "/>
                                <p:inputText value="#{employe.matricule}" >
                                    <p:ajax event="blur"/>
                                </p:inputText>
                                <h:outputText value="Utilisateur rattaché"  /> 
                                <p:selectOneMenu value="#{employe.user.id}" valueChangeListener="#{MEmps.choixUser}"
                                                 id="employe-select-user">
                                    <f:selectItem itemValue="0" itemLabel=""/>                                    
                                    <f:selectItems value="#{MEmps.listUsers}" var="usr1" itemValue="#{usr1.id}" itemLabel="#{usr1.nom}"/>
                                    <f:selectItem itemValue="0" itemLabel=""/>
                                    <f:selectItem itemValue="-1" itemLabel="Plus de choix..."/>
                                    <p:ajax event="valueChange" />
                                </p:selectOneMenu>                                                                 
                                <p:outputLabel value="Grade" />
                                <p:selectOneMenu value="#{employe.profil.grade}" >
                                    <f:selectItem itemLabel=" " itemValue="#{null}"/>
                                    <f:selectItem itemLabel="Débutant" itemValue="Débutant"/>
                                    <f:selectItem itemLabel="Junior" itemValue="Junior"/>
                                    <f:selectItem itemLabel="Senior" itemValue="Senior"/>
                                </p:selectOneMenu>
                                <p:outputLabel value="Statut" />
                                <p:selectOneRadio value="#{employe.profil.statut}">
                                    <f:selectItem itemLabel="Permanent" itemValue="PE"/>
                                    <f:selectItem itemLabel="A l'essai" itemValue="ES"/>
                                    <f:selectItem itemLabel="Temporaire" itemValue="TEP"/>
                                    <f:selectItem itemLabel="Stagiaire" itemValue="ST"/>
                                    <p:ajax event="valueChange" />
                                </p:selectOneRadio>
                                <h:outputText value="#{lab.L_actif}"/>
                                <p:selectBooleanCheckbox value="#{employe.actif}">
                                    <p:ajax event="valueChange"/>
                                </p:selectBooleanCheckbox>
                            </p:panelGrid>
                            <p:tabView id="mainEmps00">
                                <p:tab title="personnel" >
                                    <p:panelGrid columns="4" style="width: 100%">
                                        <h:outputText value="Date Naissance"/>
                                        <p:calendar value="#{employe.dateNaissance}" pattern="dd-MM-yyyy" navigator="true">
                                            <p:ajax event="dateSelect"/>
                                        </p:calendar>
                                        <h:outputText value="Lieu "/>
                                        <p:selectOneMenu value="#{employe.villeNaissance.id}" id="employe-select-ville" 
                                                         valueChangeListener="#{MEmps.choixVille}" >
                                            <f:selectItem itemValue="0" itemLabel="" />                                    
                                            <f:selectItems value="#{MEmps.listVille}" var="vi" itemValue="#{vi.id}" 
                                                           itemLabel="#{vi.titre}"/>
                                            <f:selectItem itemValue="0" itemLabel="" />
                                            <f:selectItem itemValue="-1" itemLabel="Plus de choix..."/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>
                                        <h:outputText value="Nationalité"/>
                                        <p:selectOneMenu value="#{employe.paysDorigine.id}" id="employe-select-pays" 
                                                         valueChangeListener="#{MEmps.choixPay}">
                                            <f:selectItem itemValue="0" itemLabel=""/>                                    
                                            <f:selectItems value="#{MEmps.listPays}" var="pi" itemValue="#{pi.id}" itemLabel="#{pi.titre}"/>
                                            <f:selectItem itemValue="0" itemLabel=""/>
                                            <f:selectItem itemValue="-1" itemLabel="Plus de choix..."/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>                                       
                                        <h:outputText value="Etat Civil" />                                    
                                        <p:selectOneMenu value="#{employe.situationFamilial}" >
                                            <f:selectItem itemLabel="Marié(e)" itemValue="Marié"/>
                                            <f:selectItem itemLabel="Célibataire" itemValue="Célibataire"/>
                                            <f:selectItem itemLabel="Fiancé(e)" itemValue="Fiancé(e)"/>
                                            <f:selectItem itemLabel="Divorcé(e)" itemValue="Divorcé(e)"/>
                                        </p:selectOneMenu>                                   
                                        <h:outputText value="CNI : "  />
                                        <p:inputText value="#{employe.cni}"/>
                                        <h:outputText value="Lieu de délivrance : "  />
                                        <p:selectOneMenu value="#{employe.lieuDelivCni.id}" id="employe-select-villeCNI" 
                                                         valueChangeListener="#{MEmps.choixVille1}" >
                                            <f:selectItem itemValue="0" itemLabel="" />                                    
                                            <f:selectItems value="#{MEmps.listVille}" var="vi1" itemValue="#{vi1.id}" 
                                                           itemLabel="#{vi1.titre}"/>
                                            <f:selectItem itemValue="0" itemLabel="" />
                                            <f:selectItem itemValue="-1" itemLabel="Plus de choix..."/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>
                                        <h:outputText value="Date de délivrance : "  />
                                        <p:calendar value="#{employe.dateDelivCni}" pattern="dd-MM-yyyy" navigator="true" />
                                        <h:outputText value="Date d'expiration : "  />
                                        <p:calendar value="#{employe.dateExpCni}" pattern="dd-MM-yyyy" navigator="true" />                                        
                                    </p:panelGrid>
                                </p:tab>
                                <p:tab title="Embauche">
                                    <p:panelGrid columns="4"  style="width: 100%">
                                        <p:outputLabel value="Motif d'entrée"/>
                                        <p:selectOneMenu value="#{employe.motifDentree}" style="width: 100%">
                                            <f:selectItem itemLabel="Embauche" itemValue="Embauche"/>
                                            <f:selectItem itemLabel="Mutation" itemValue="Mutation"/>
                                            <f:selectItem itemLabel="Remplacement" itemValue="Stage"/>
                                            <f:selectItem itemLabel="Autre" itemValue="Autre"/>
                                        </p:selectOneMenu> 
                                        <p:outputLabel value="Date Embauche :"/>
                                        <p:calendar value="#{employe.dateEmbauche}" navigator="true" pattern="dd-MM-yyyy"/>                                        
                                        <p:outputLabel value="Motif d'arrêt"/>
                                        <p:selectOneMenu value="#{employe.motifArret}" style="width: 100%">
                                            <f:selectItem itemLabel="Embauche" itemValue="Embauche"/>
                                            <f:selectItem itemLabel="Mutation" itemValue="Mutation"/>
                                            <f:selectItem itemLabel="Remplacement" itemValue="Stage"/>
                                            <f:selectItem itemLabel="Autre" itemValue="Autre"/>
                                        </p:selectOneMenu>     
                                        <p:outputLabel value="Date d'arrêt :"/>
                                        <p:calendar value="#{employe.dateArret}" navigator="true" pattern="dd-MM-yyyy"/>                                                                                                                 
                                        <p:outputLabel value="Catégorie Professionnelle" />
                                        <p:selectOneMenu value="#{employe.convention.categorie.id}"
                                                         style="width: 80%">
                                            <f:selectItem itemValue="0" itemLabel=""/>
                                            <f:selectItems value="#{MEmps.listCategoriePro}" var="cp" itemValue="#{cp.id}" itemLabel="#{cp.categorie}"/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>
                                        <p:outputLabel value="Echelon" />
                                        <p:selectOneMenu value="#{employe.convention.echelon.id}"
                                                         style="width: 80%">
                                            <f:selectItem itemValue="0" itemLabel=""/>
                                            <f:selectItems value="#{MEmps.listEchelon}" var="ec" itemValue="#{ec.id}" itemLabel="#{ec.titre}"/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>
                                        <p:outputLabel value="Nombre de jours de congé acquis par mois" />
                                        <pe:inputNumber value="#{employe.jourConge}" />                                        
                                        <p:outputLabel value="Horaire de travail dynamique" />
                                        <p:selectBooleanCheckbox value="#{employe.horaireDynamique}" />
                                        <p:outputLabel value="Poste de travail " /> 
                                        <p:selectOneMenu value="#{employe.posteDeTravail.id}" valueChangeListener="#{MEmps.choixPoste}"
                                                         id="employe-select-poste" style="width: 100%">
                                            <f:selectItem itemValue="0" itemLabel=""/>                                    
                                            <f:selectItems value="#{MEmps.posteDeTravails}" var="post" itemValue="#{post.id}" itemLabel="#{post.intitule}"/>
                                            <f:selectItem itemValue="0" itemLabel=""/>
                                            <f:selectItem itemValue="-1" itemLabel="Plus de choix..."/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>
                                    </p:panelGrid> 
                                </p:tab>                                                                
                                <p:tab title="Adresses " disabled="#{MEmps.disOnglets}">
                                    <p:panelGrid columns="4" >                            
                                        <h:outputText value="Adresse  "/>
                                        <p:inputText value="#{employe.adresse1}" />
                                        <h:outputText value="Adresse secondaire "/>
                                        <p:inputText value="#{employe.adresse2}" />
                                        <h:outputText value="Téléphone 1 "/>
                                        <p:inputText value="#{employe.telephone1}" converter="TEL" />
                                        <h:outputText value="Téléphone 2 "/>
                                        <p:inputText value="#{employe.telephone2}" converter="TEL" />
                                        <h:outputText value="Email 1 "/>
                                        <p:inputText value="#{employe.mail1}" converter="EMAIL" />
                                        <h:outputText value="Email alternative 2 "/>
                                        <p:inputText value="#{employe.mail2}" converter="EMAIL" />                                            
                                    </p:panelGrid>
                                </p:tab>
                                <p:tab title="comptabilité">
                                    <p:panelGrid columns="2" style="width: 100%">
                                        <h:outputText value="Compte Collectif"  />
                                        <p:inputText value="#{employe.compteCollectif.numCompte}"/>
                                        <h:outputText value="Compte Auxiliaire"  />
                                        <p:inputText value="#{employe.compteAuxiliaire.numCompte}"/>
                                        <h:outputText value="Centre Analytique"  />
                                        <p:inputText value="centre.."/>  
                                    </p:panelGrid>
                                </p:tab>
                            </p:tabView>                             
                        </p:tab> 
                        <p:tab title="Profil" disabled="#{MEmps.disOnglets}" >                               
                            <p:tabView id="emps-subTab1">
                                <p:tab title="Qualifications">
                                    <p:panelGrid columns="1" style="width: 100%" id="emp-panel-qualif">
                                        <p:selectOneMenu value="#{MEmps.qualification.id}" valueChangeListener="#{MEmps.choixQualification}"
                                                         id="employe-select-qualification" style="width: 100%">
                                            <f:selectItem itemValue="0" itemLabel=""/>                                    
                                            <f:selectItems value="#{MEmps.listQualification}" var="qaa" itemValue="#{qaa.id}" itemLabel="#{qaa.intitule}"/>
                                            <f:selectItem itemValue="0" itemLabel=""/>
                                            <f:selectItem itemValue="-1" itemLabel="Plus de choix..."/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>                                            
                                        <f:facet name="footer">                                            
                                            <p:commandButton value="Enregistrer" actionListener="#{MEmps.addQualification()}"/>
                                            <p:commandButton value="Supprimer (#{MEmps.selectionQualification.size()})" actionListener="#{MEmps.deleteQualif()}"  
                                                             style="float: right" rendered="#{MEmps.displayDelQualif}"
                                                             update="@this"/>
                                        </f:facet>
                                    </p:panelGrid>
                                    <p:dataTable value="#{employe.qualifications}" var="qual" 
                                                 rowKey="#{qual.id}" selection="#{MEmps.selectionQualification}"
                                                 selectionMode="multiple" id="tabQual" scrollHeight="270" scrollable="true">
                                        <p:ajax event="rowSelect" listener="#{MEmps.selectedQualif}"/>
                                        <p:ajax event="rowUnselect" listener="#{MEmps.unSelectQualif}"/>                                        
                                        <p:column>
                                            <h:outputText value="#{qual.intitule}" />                                          
                                        </p:column>
                                    </p:dataTable>
                                </p:tab>
                                <p:tab title="Diplomes &amp; Certifications">
                                    <p:panelGrid columns="2" style="width: 100%" id="emp-panel-diplome">                                        
                                        <p:outputLabel value="Nom" />
                                        <p:selectOneMenu value="#{MEmps.diplome.id}" style="width: 100%">
                                            <f:selectItem itemValue="0" itemLabel=""/>                                    
                                            <f:selectItems value="#{MEmps.diplomes}" var="dip" itemValue="#{dip.id}" itemLabel="#{dip.designation}"/>                                                                                               
                                        </p:selectOneMenu>
                                        <p:outputLabel value="Date d'obtention" />
                                        <p:calendar value="#{MEmps.diplome.dateObtention}" pattern="dd-MM-yyyy" navigator="true" />
                                        <p:outputLabel value="Ecole" />
                                        <p:inputText value="#{MEmps.diplome.ecole}"  />
                                        <p:outputLabel value="Mention"/>
                                        <p:selectOneMenu value="#{MEmps.diplome.mention}">
                                            <f:selectItem itemLabel="Passable" itemValue="Passable"/>
                                            <f:selectItem itemLabel="Assez Bien" itemValue="Assez Bien"/>
                                            <f:selectItem itemLabel="Bien" itemValue="Bien"/>
                                            <f:selectItem itemLabel="Tres Bien" itemValue="Tres Bien"/>
                                        </p:selectOneMenu>
                                        <p:outputLabel value="Classement"/>
                                        <pe:inputNumber value="#{MEmps.diplome.niveau}" decimalPlaces="0" />                                     
                                        <f:facet name="footer">                                            
                                            <p:commandButton value="Enregistrer" actionListener="#{MEmps.addDiplome()}" update="tabDiplome"/>
                                            <p:commandButton value="Annuler" actionListener="#{MEmps.resetFormDiplome()}" />
                                            <p:commandButton value="Supprimer (#{MEmps.selectionDiplome.size()})" actionListener="#{MEmps.deleteDiplome()}"  
                                                             style="float: right" rendered="#{MEmps.displayDelDiplome}"/>
                                        </f:facet>
                                    </p:panelGrid>
                                    <p:dataTable value="#{employe.diplomes}" var="diplome" id="tabDiplome"
                                                 rowKey="#{diplome.id}" scrollable="true" scrollHeight="100"
                                                 selection="#{MEmps.selectionDiplome}" selectionMode="multiple">
                                        <p:ajax event="rowSelect" listener="#{MEmps.selectedDiplome}"/>
                                        <p:ajax event="rowUnselect" listener="#{MEmps.unSelectDiplome}"/>
                                        <p:column headerText="Nom">
                                            <h:outputText value="#{diplome.designation}" />
                                        </p:column>
                                        <p:column headerText="mention">
                                            <h:outputText value="#{diplome.mention}" />
                                        </p:column>
                                    </p:dataTable>
                                </p:tab> 
                                <p:tab title="Langue">
                                    <p:panelGrid columns="8" style="width: 100%" id="emp-panel-langue">       
                                        <p:selectOneMenu value="#{MEmps.langue.id}" valueChangeListener="#{MEmps.choixLangues}"
                                                         id="employe-select-langue" style="width: 50%" >
                                            <f:selectItem itemValue="0" itemLabel=""/>                                    
                                            <f:selectItems value="#{MEmps.listLangues}" var="lan" itemValue="#{lan.id}" itemLabel="#{lan.langue}"/>
                                            <f:selectItem itemValue="0" itemLabel=""/>
                                            <f:selectItem itemValue="-1" itemLabel="Plus de choix..."/>
                                            <p:ajax event="valueChange" />
                                        </p:selectOneMenu>                                                                      
                                        <p:outputLabel value="Parlée" />
                                        <p:selectBooleanCheckbox value="#{MEmps.langue.parle}" >
                                            <p:ajax event="valueChange" />
                                        </p:selectBooleanCheckbox>
                                        <p:outputLabel value="Ecrit" />
                                        <p:selectBooleanCheckbox value="#{MEmps.langue.ecrit}">
                                            <p:ajax event="valueChange" />
                                        </p:selectBooleanCheckbox>
                                        <p:outputLabel value="Lu" />
                                        <p:selectBooleanCheckbox value="#{MEmps.langue.lu}">
                                            <p:ajax event="valueChange" />
                                        </p:selectBooleanCheckbox>                                        
                                        <f:facet name="footer">                                            
                                            <p:commandButton value="Enregistrer" actionListener="#{MEmps.addLangue()}" update="tabLangue"/>
                                            <p:commandButton value="Annuler" actionListener="#{MEmps.resetFormLangue()}" />
                                            <p:commandButton value="Supprimer (#{MEmps.seletionLangue.size()})" actionListener="#{MEmps.deleteLangue()}"  
                                                             style="float: right" rendered="#{MEmps.displayDelLangue}"/>
                                        </f:facet>
                                    </p:panelGrid>                                  
                                    <p:dataTable value="#{employe.langues}" var="langu" rowKey="#{langu.id}"
                                                 selectionMode="multiple" id="tabLangue" scrollHeight="225" scrollable="true"
                                                 selection="#{MEmps.seletionLangue}">
                                        <p:ajax event="rowSelect" listener="#{MEmps.selectedLangue}" />
                                        <p:ajax event="rowUnselect" listener="#{MEmps.unSelectLangue}" />
                                        <p:column headerText="Langues" >
                                            <h:outputText value="#{langu.langue}" />
                                        </p:column>
                                        <p:column headerText="Parlé">
                                            <h:graphicImage  library="img" name="#{(langu.parle)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                                        </p:column>                                        
                                        <p:column headerText="Ecrit">
                                            <h:graphicImage  library="img" name="#{(langu.ecrit)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                                        </p:column>
                                        <p:column headerText="Lu">
                                            <h:graphicImage  library="img" name="#{(langu.lu)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                                        </p:column>
                                    </p:dataTable>                                    
                                </p:tab>
                                <p:tab title="Permis">
                                    <p:panelGrid columns="4" id="emp-panel-permi">                                        
                                        <p:outputLabel value="Catégorie" />
                                        <p:inputText value="#{MEmps.permis.categorie}"  />
                                        <p:outputLabel value="Numéro " />
                                        <p:inputText value="#{MEmps.permis.numero}"  />
                                        <p:outputLabel value="Date d'obtention" />
                                        <p:calendar value="#{MEmps.permis.dateObtention}" navigator="true" pattern="dd-MM-yyyy" />
                                        <p:outputLabel value="Date d'expiration" />
                                        <p:calendar value="#{MEmps.permis.dateExp}"  navigator="true" pattern="dd-MM-yyyy"/>                                                                                                                           
                                        <f:facet name="footer">
                                            <p:commandButton value="Enregistrer" actionListener="#{MEmps.addPermisDeConduire()}" />                                      
                                            <p:commandButton value="Annuler" actionListener="#{MEmps.resetFormPermis()}" />                                      
                                            <p:commandButton value="Supprimer (#{MEmps.selectionPermi.size()})" actionListener="#{MEmps.deletePermis()}"  
                                                             style="float: right" rendered="#{MEmps.displayDelPermis}"/>
                                        </f:facet>
                                    </p:panelGrid>
                                    <p:dataTable value="#{employe.permis}" var="perm" rowKey="#{perm.id}"
                                                 id="emp-tab-permi" selection="#{MEmps.selectionPermi}" selectionMode="multiple">
                                        <p:ajax event="rowSelect" listener="#{MEmps.selectPermi}" />
                                        <p:ajax event="rowUnselect" listener="#{MEmps.unSelectPermi}" />
                                        <p:column headerText="Categorie">
                                            #{perm.categorie}
                                        </p:column>
                                        <p:column headerText="Numéro">
                                            #{perm.numero}
                                        </p:column>
                                        <p:column headerText="Date expiration" style="background-color: #{(perm.expire)?'red':'white'}; color: #{(perm.expire)?'white':'none'};">
                                            <h:outputText value="#{perm.dateExp}" converter="DATE" />
                                        </p:column>
                                    </p:dataTable>
                                </p:tab>
                            </p:tabView>                        
                        </p:tab>                                                                                                                  
                        <p:tab title="Personnes en charges" disabled="#{MEmps.disOnglets}">
                            <p:panelGrid columns="2" style="width: 100%" styleClass="dgrid"
                                         id="emp-panel-personne">
                                <p:outputLabel value="Nom &amp; Prénom"/>
                                <p:inputText  value="#{MEmps.personne.nom}" style="width: 100%"/>
                                <p:outputLabel value="Naissance"/>
                                <p:calendar value="#{MEmps.personne.dateNaissance}" style="width: 100%" navigator="true"/>                                                                                                                                                            
                                <p:outputLabel value="Statut"/>
                                <p:panelGrid columns="4">
                                    <p:outputLabel value="Infirme"/>
                                    <p:selectBooleanCheckbox  value="#{MEmps.personne.infirme}"/>                                
                                    <p:outputLabel value="Scolarisé"/>
                                    <p:selectBooleanCheckbox  value="#{MEmps.personne.scolarise}"/>
                                </p:panelGrid>
                                <f:facet name="footer">
                                    <p:commandButton value="Enregistrer" actionListener="#{MEmps.addPersonneEnCharge()}" />                                      
                                    <p:commandButton value="Annuler" actionListener="#{MEmps.resetFormPersonne()}" />                                      
                                    <p:commandButton value="Supprimer (#{MEmps.selectionPersonne.size()})" actionListener="#{MEmps.deletePersonne()}"  
                                                     style="float: right" rendered="#{MEmps.displayDelPersonne}"/>
                                </f:facet>
                            </p:panelGrid>
                            <p:dataTable value="#{employe.personneEnCharge}" var="enf" id="tab-enf"
                                         selectionMode="multiple" rowKey="#{enf.id}" selection="#{MEmps.selectionPersonne}">  
                                <p:ajax event="rowSelect" listener="#{MEmps.selectPersonne}" />
                                <p:ajax event="rowUnselect" listener="#{MEmps.unSelectPersonne}" />
                                <p:column headerText="Nom &amp; Prénom">
                                    #{enf.nom}
                                </p:column> 
                                <p:column headerText="Date de Naiss.">
                                    <h:outputText value="#{enf.dateNaissance}" converter="DATE"/>
                                </p:column> 
                                <p:column headerText="Infirme">
                                    <h:graphicImage  library="img" name="#{(enf.infirme)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                                </p:column> 
                                <p:column headerText="Scolarisé">
                                    <h:graphicImage  library="img" name="#{(enf.scolarise)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                                </p:column> 
                            </p:dataTable>
                        </p:tab>
                        <p:tab title="Documents" disabled="#{MEmps.disOnglets}">
                            <p:panelGrid columns="2" style="width: 100%">
                                <p:panelGrid columns="1" style="width: 100%">
                                    <p:commandButton value="fichier" onclick="dlgUploadDoc.show()" style="width: 100%"/>
                                    <p:panelGrid columns="2" id="emp-grid-doc"> 
                                        <p:outputLabel value="Titre " />
                                        <p:inputText value="#{MEmps.document.titre}" />
                                        <p:outputLabel value="Description " />
                                        <p:inputTextarea style="width: 100%" autoResize="true"
                                                         value="#{MEmps.document.description}" />                                    
                                        <f:facet name="footer">
                                            <p:commandButton value="Enregistrer" actionListener="#{MEmps.addDocument()}" />                                      
                                            <p:commandButton value="Annuler" actionListener="#{MEmps.resetFormDoc()}" />                                      
                                            <p:commandButton value="Supprimer (#{MEmps.selectionDoc.size()})" actionListener="#{MEmps.deleteDocument()}"  
                                                             style="float: right" rendered="#{MEmps.displayDelDoc}"/>
                                        </f:facet>
                                    </p:panelGrid>
                                </p:panelGrid>
                                <p:dataTable value="#{employe.documents}" var="docE" id="emp-tab-doc" selection="#{MEmps.selectionDoc}"
                                             rowKey="#{docE.id}" selectionMode="multiple">
                                    <p:ajax event="rowSelect" listener="#{MEmps.selectDoc}" />
                                    <p:ajax event="rowUnselect" listener="#{MEmps.unSelectDoc}" />
                                    <p:column headerText="Titre">
                                        <h:outputText value="#{docE.titre}" />
                                    </p:column>
                                    <p:column headerText="Fichier">
                                        <h:outputText value="#{docE.chemin}" />
                                    </p:column>
                                </p:dataTable>                            
                            </p:panelGrid>
                        </p:tab>                                                                            
                        <p:tab title="Assurance" disabled="#{MEmps.disOnglets}">
                            <p:tabView>
                                <p:tab title="Assurance">

                                </p:tab>

                            </p:tabView>
                        </p:tab>
                    </p:tabView>
                </p:panelGrid>  
            </p:outputPanel>
        </h:form>           
        <h:form prependId="false" id="E-f">
            #{MEmps.loadAllEmployes(100, true)}
            <p:outputPanel id="VL" rendered="#{!MEmps.displayForm}">               
                <p:dataTable value="#{MEmps.listEmployes}" var="emp" rowKey="#{emp.id}" rendered="#{MEmps.displayListe}"
                             id="tabEmployes" selectionMode="single" 
                             scrollable="true" scrollHeight="500">                      
                    <p:ajax event="rowSelect" listener="#{MEmps.choixEmploye}" />
                    <p:column  width="20">
                        <h:graphicImage  library="img" name="#{(emp.selectActif)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                    </p:column>
                    <p:column headerText="Noms &amp; Prénoms" width="200">
                        <h:outputText value="#{emp.prenom} #{emp.nom}" />
                    </p:column>                                        
                    <p:column headerText="Matricule" width="150">
                        <h:outputText value="#{emp.matricule}" />
                    </p:column>
                    <p:column headerText="Poste" width="100">
                        <h:outputText value="#{emp.posteDeTravail.intitule}" />
                    </p:column>
                    <p:column headerText="Téléphone" width="100">
                        <h:outputText value="#{emp.telephone1}" />
                    </p:column>                    
                    <p:column headerText="Actif" width="40">
                        <p:column headerText="#{lab.L_actif}" style="text-align: center" width="20">
                            <h:graphicImage  library="img" name="#{(emp.actif)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                        </p:column>
                    </p:column>
                </p:dataTable>                
                <p:dataGrid value="#{MEmps.listEmployes}" var="emp1" columns="4"
                            rows="50"  rendered="#{!MEmps.displayListe}" id="empps-dgrig">                                                                    
                    <p:panelGrid  columns="1" style="text-align: center; width: 100%">                            
                        <f:facet name="header">
                            <p:selectBooleanCheckbox value="#{emp1.selectActif}" disabled="true"/>
                            <p:commandLink  actionListener="#{MEmps.choixEmploye1(emp1)}">    
                                <h:outputText value="#{emp1.prenom} #{emp1.nom}" /><br />                                
                                <p:graphicImage library="lymytz/documents/docEmps/photo" name="#{(emp1.photos==null)?'user1.png':emp1.photos}" width="100" height="100"/>
                            </p:commandLink>
                        </f:facet>                        
                        <p:panelGrid columns="2" style="width: 100%">
                            <p:outputLabel value="Matricule" />
                            <h:outputText value="#{emp1.matricule}" />  
                            <p:outputLabel value="Poste" />
                            <h:outputText value="#{emp1.posteDeTravail.intitule}" />  
                            <p:outputLabel value="Téléphone" />
                            <h:outputText value="#{emp1.telephone1}"  />  
                        </p:panelGrid>
                    </p:panelGrid>                                      
                </p:dataGrid>
                <h:panelGrid columns="2" id="bNavEmps">
                    <p:commandLink actionListener="#{MEmps.loadAllEmployesByAgence(true,false)}" disabled="#{MEmps.disPrevEmps}" update="tabEmployes">
                        <h:graphicImage style="border:none; margin-left: .5em; cursor: pointer;"  alt="img" library="img"  name="dnavigation.png" width="30" height="25"/>                        
                    </p:commandLink>
                    <p:commandLink action="#{MEmps.loadAllEmployes(100, false)}" disabled="#{MEmps.disPrevEmps}" update="tabUsers">
                        <h:graphicImage style="border:none; margin-left: 1em; cursor: pointer;"  alt="img" library="img"  name="gnavigation.png" width="30" height="25"/>                                                        
                    </p:commandLink>  
                </h:panelGrid> 
            </p:outputPanel>            
        </h:form>
    </p:outputPanel>
</ui:composition>