<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Importation et Exportation','modParam', 'smenImportExport', true,managedImportExport)}
    </ui:define>  
    <ui:define name="contents"> 
        #{managedInventaire.doNothing()}
        #{managedDepot.loadAllDepot()}
        #{managedAgence.loadAllUsable()}
        #{Marticle.doNothing()}

        <h:form prependId="false">
            <p:dialog header="Infos importation" width="40%"
                      widgetVar="dlg_orderCol">
                <p:selectOneListbox value="#{managedImportExport.numEtat}" style="width: 200px; float: left"
                                    valueChangeListener="#{managedImportExport.chooseState}">
                    <f:selectItem itemLabel="Articles" itemValue="1" />
                    <f:selectItem itemLabel="Plan comptable" itemValue="2" />
                    <f:selectItem itemLabel="Inventaires" itemValue="3" />
                    <f:selectItem itemLabel="Employés" itemValue="4" />
                    <f:selectItem itemLabel="Départements" itemValue="5" />
                    <f:selectItem itemLabel="Poste de travail" itemValue="6" />
                    <f:selectItem itemLabel="Contrats" itemValue="7" />
                    <f:selectItem itemLabel="Convention collective" itemValue="8" />
                    <p:ajax event="valueChange" update="colonnes_order"/>
                </p:selectOneListbox>
                <div style="width: 100%; margin-left: 220px" >
                    <div>Ordre des colonnes du fichier à importer</div>
                    <div>NB: la première colonne doit être écrite à l'identique</div>
                    <p:selectOneListbox value="#{managedImportExport.etat}" disabled="true"
                                        id="colonnes_order">
                        <f:selectItems value="#{managedImportExport.colonnes}" var="icol" itemLabel="#{icol}" itemValue="#{icol}" />
                    </p:selectOneListbox>
                </div>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmSave" closeOnEscape="true"
                             message="#{lab.LMP_PIE_vouloir_importer_donnees}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedImportExport.importData()}" oncomplete="dlgConfirmSave.hide()"
                                 update=":body_import_export:tabView_import_export:tab_import"/>
                <p:commandButton value="#{lab.L_non}" onclick="dlgConfirmSave.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false" enctype="multipart/form-data">
            <p:dialog widgetVar="dlgUploadImgXML" width="300" height="100" closeOnEscape="true"
                      dynamic="true" resizable="false">
                <p:fileUpload sizeLimit="1000000"  id="file_import_00"  mode="advanced" dragDropSupport="true" 
                              allowTypes="/(\.|\/)(xml)$/" fileUploadListener="#{managedImportExport.handleFileUploadXML}"
                              uploadLabel="#{lab.L_envoyer}" label="#{lab.L_parcourir}" auto="true"
                              oncomplete="dlgUploadImgXML.hide()"> 
                </p:fileUpload>
            </p:dialog>
        </h:form>
        <h:form prependId="false" enctype="multipart/form-data">
            <p:dialog widgetVar="dlgUploadImgTXT" width="300" height="100" closeOnEscape="true"
                      dynamic="true" resizable="false">
                <p:fileUpload sizeLimit="1000000"  id="file_import_01"  mode="advanced" dragDropSupport="true" 
                              allowTypes="/(\.|\/)(txt)$/" fileUploadListener="#{managedImportExport.handleFileUploadTXT}"
                              uploadLabel="#{lab.L_envoyer}" label="#{lab.L_parcourir}" auto="true"
                              oncomplete="dlgUploadImgTXT.hide()"> 
                </p:fileUpload>
            </p:dialog>
        </h:form>
        <h:form prependId="false" enctype="multipart/form-data">
            <p:dialog widgetVar="dlgUploadImgXLS" width="300" height="100" closeOnEscape="true"
                      dynamic="true" resizable="false">
                <p:fileUpload sizeLimit="1000000"  id="file_import_02"  mode="advanced" dragDropSupport="true" 
                              allowTypes="/(\.|\/)(xls|xls?x)$/" fileUploadListener="#{managedImportExport.handleFileUploadXLS}"
                              uploadLabel="#{lab.L_envoyer}" label="#{lab.L_parcourir}" auto="true"
                              oncomplete="dlgUploadImgXLS.hide()"> 
                </p:fileUpload>
            </p:dialog>
        </h:form>
        <h:form prependId="false" enctype="multipart/form-data">
            <p:dialog widgetVar="dlgUploadImgCSV" width="300" height="100" closeOnEscape="true"
                      dynamic="true" resizable="false">
                <p:fileUpload sizeLimit="1000000"  id="file_import_03"  mode="advanced" dragDropSupport="true" 
                              allowTypes="/(\.|\/)(csv)$/" fileUploadListener="#{managedImportExport.handleFileUploadCSV}"
                              uploadLabel="#{lab.L_envoyer}" label="#{lab.L_parcourir}" auto="true"
                              oncomplete="dlgUploadImgCSV.hide()"> 
                </p:fileUpload>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="body_import_export">
            <div class="part_scroll">
                <p:tabView id="tabView_import_export">
                    <p:tab title="#{lab.LMP_PIE_exportation}">    
                        <p:outputPanel>
                            <h:panelGrid columns="2">
                                <p:outputLabel value="#{lab.LMP_PIE_element} : "/>
                                <h:panelGrid columns="2" id="zone_head_import_export">
                                    <p:selectOneMenu value="#{managedImportExport.objetExport}" valueChangeListener="#{managedImportExport.chooseObject}">
                                        <f:selectItem itemValue="...." itemLabel="-" noSelectionOption="true"/>
                                        <f:selectItem itemValue="article" itemLabel="#{lab.LMP_PIE_articles}"/>
                                        <f:selectItem itemValue="regle_salaire" itemLabel="#{lab.LMP_PIE_regle_salaire}"/>
                                        <f:selectItem itemValue="inventaire" itemLabel="#{lab.LMP_PIE_inventaire}"/>
                                        <f:selectItem itemValue="departement" itemLabel="#{lab.LMP_PIE_departement}"/>
                                        <f:selectItem itemValue="poste_travail" itemLabel="#{lab.LMP_PIE_poste_travail}"/>
                                        <f:selectItem itemValue="employe" itemLabel="#{lab.LMP_PIE_employe}"/>
                                        <f:selectItem itemValue="contrat" itemLabel="#{lab.LMP_PIE_contrat}"/>
                                        <f:selectItem itemValue="plan_comptable" itemLabel="#{lab.LMP_PIE_plan_comptable}"/>
                                        <f:selectItem itemValue="convention" itemLabel="#{lab.LMP_PIE_convention_collective}"/>
                                        <f:selectItem itemValue="doc_vente" itemLabel="#{lab.LMP_PIE_facture_vente}"/>
                                        <p:ajax event="valueChange" update="tab_export zone_head_import_export"/>
                                    </p:selectOneMenu>
                                    <h:panelGrid columns="5" rendered="#{managedImportExport.objetExport eq 'inventaire'}">
                                        <p:calendar value="#{managedImportExport.datePrint}" navigator="true" pattern="dd-MM-yyyy" size="8"/>
                                        <h:selectOneMenu value="#{managedImportExport.depotPrint}" style="min-width: 140px">
                                            <f:selectItem itemLabel="--" itemValue="0"/>
                                            <f:selectItems value="#{managedDepot.depots_all}" var="dep" itemLabel="#{dep.designation}" itemValue="#{dep.id}"/>
                                            <p:ajax event="valueChange" listener="#{managedImportExport.loadAllInventaire(false)}" update="tab_export"/>
                                        </h:selectOneMenu>
                                        <span> --> </span>
                                        <p:selectOneMenu value="#{managedImportExport.inventaire.nature}">
                                            <f:selectItem itemValue="A" itemLabel="#{lab.LDB_PF_prix_achat}"/>
                                            <f:selectItem itemValue="V" itemLabel="#{lab.LMP_PIE_prix_vente}"/>
                                            <f:selectItem itemValue="R" itemLabel="#{lab.LMP_PIE_prix_revient}"/>
                                            <p:ajax event="valueChange" global="false" update="tab_export"/>
                                        </p:selectOneMenu>
                                        <p:commandButton value="#{lab.LMP_PIE_calculer}" actionListener="#{managedImportExport.loadAllInventaire(true)}" update="tab_export"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2" rendered="#{managedImportExport.objetExport eq 'employe' or managedImportExport.objetExport eq 'contrat'}">
                                        <h:selectOneMenu value="#{managedImportExport.agencePrint}" style="min-width: 140px">
                                            <f:selectItem itemLabel="--" itemValue="0"/>
                                            <f:selectItems value="#{managedAgence.listAgence}" var="age" itemLabel="#{age.designation}" itemValue="#{age.id}"/>
                                            <p:ajax event="valueChange" listener="#{managedImportExport.loadAllByAgence()}" update="tab_export"/>
                                        </h:selectOneMenu>
                                    </h:panelGrid>
                                </h:panelGrid>
                            </h:panelGrid>
                            <div style="overflow-x: auto;width: 100%">
                                <p:outputPanel id="tab_export" style=";width: 100%">
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'article'}" style=";width: 100%">
                                        <p:dataTable value="#{managedImportExport.listArticles}" var="cond" rowKey="#{cond.id}"
                                                     style="width: 100%;overflow-x: auto" id="tabl_articles" paginator="true" rows="20">
                                            <f:facet name="header">Liste des articles</f:facet>
                                            <p:column headerText="Id" exportable="false">
                                                <h:outputText value="#{cond.id}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_reference}" exportable="true">
                                                <f:facet name="header">     
                                                    <p:outputLabel value="#{lab.L_reference}"/>
                                                </f:facet>
                                                <h:outputText value="#{cond.article.refArt}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_designation}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_designation}"/>
                                                </f:facet>
                                                <h:outputText value="#{cond.article.designation}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_unite}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_unite}"/>
                                                </f:facet>
                                                <h:outputText value="#{cond.unite.libelle}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PTBS_pua}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PTBS_pua}"/>
                                                </f:facet>
                                                <h:outputText value="#{cond.prixAchat}"/>
                                            </p:column>                               
                                            <p:column headerText="#{lab.LC_PTBS_puv}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PTBS_puv}"/>
                                                </f:facet>
                                                <h:outputText value="#{cond.prix}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_famille}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_famille}"/>
                                                </f:facet>
                                                <h:outputText value="#{cond.article.famille.referenceFamille}"/>
                                            </p:column>
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_article">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_articles" fileName="articles" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport eq 'plan_comptable'}" style="width: 100%;overflow: auto">
                                        <p:dataTable value="#{managedImportExport.listComptes}" var="cpt" rowKey="#{cpt.id}"
                                                     id="tabl_comptes" paginator="true" rows="15" paginatorAlwaysVisible="false">
                                            <f:facet name="header">
                                                <p:outputLabel value="#{lab.LDB_PTT_liste_comptes}"/>                                            
                                            </f:facet>
                                            <p:column headerText="Id" exportable="false">
                                                <h:outputText value="#{cpt.id}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_reference}">
                                                <f:facet name="header">     
                                                    <p:outputLabel value="#{lab.L_numero}"/>
                                                </f:facet>
                                                <h:outputText value="#{cpt.numCompte}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_designation}">
                                                <f:facet name="header">     
                                                    <p:outputLabel value="#{lab.L_designation}"/>
                                                </f:facet>
                                                <h:outputText value="#{cpt.intitule}"/>
                                            </p:column> 
                                            <p:column headerText="#{lab.L_nature}">
                                                <f:facet name="header">     
                                                    <p:outputLabel value="#{lab.L_nature}"/>
                                                </f:facet>
                                                <h:outputText value="#{cpt.natureCompte.designation}"/>
                                            </p:column> 
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_comptes">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_comptes" fileName="comptes" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'inventaire'}" style=";width: 100%">
                                        <p:dataTable value="#{managedImportExport.inventaire.inventaires}" var="inv" rowKey="#{inv.unite}"
                                                     style="width: 100%;overflow-x: auto" id="tabl_inventaire" paginator="true" rows="20"
                                                     >
                                            <f:facet name="header">Liste des articles</f:facet>
                                            <p:column headerText="#{lab.L_reference}" sortBy="#{inv.code}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_article}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.code}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_designation}" sortBy="#{inv.designation}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_designation}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.designation}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_famille}" exportable="true" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_famille}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.famille}"/>
                                            </p:column>
                                            <p:column style="width: 10%;text-align: right" headerText="#{lab.LCF_PBAV_puv}" exportable="#{managedImportExport.inventaire.nature eq 'V'}">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LCF_PBAV_puv}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.puv}" converter="DNS"/>
                                            </p:column>
                                            <p:column style="width: 10%;text-align: right" headerText="#{lab.LC_PA_pua}" exportable="#{managedImportExport.inventaire.nature eq 'A'}">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PA_pua}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.pua}" converter="DNS"/>
                                            </p:column>
                                            <p:column style="width: 10%;text-align: right" headerText="#{lab.LC_PTBV_pr}" exportable="#{managedImportExport.inventaire.nature eq 'R'}">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PTBV_pr}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.pr}" converter="DNS"/>
                                            </p:column>
                                            <p:column style="width: 10%;text-align: right" sortBy="#{inv.stock}" headerText="#{lab.LC_PA_stock}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PA_stock}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.stock}" converter="DNS"/>
                                            </p:column>
                                            <p:column style="width: 10%" headerText="#{lab.L_unite}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_unite}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.reference}"/>
                                            </p:column>
                                            <p:column style="width: 10%;text-align: right" headerText="#{lab.LC_PCV_value}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PCV_value}"/>
                                                </f:facet>
                                                <h:outputText value="#{inv.stock * inv.puv}" rendered="#{managedImportExport.inventaire.nature eq 'V'}" converter="DNS"/>
                                                <h:outputText value="#{inv.stock * inv.pua}" rendered="#{managedImportExport.inventaire.nature eq 'A'}" converter="DNS"/>
                                                <h:outputText value="#{inv.stock * inv.pr}" rendered="#{managedImportExport.inventaire.nature eq 'R'}" converter="DNS"/>
                                            </p:column>
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_inventaire">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_inventaire" fileName="inventaire" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'regle_salaire'}">
                                        <p:dataTable id="tabl_regle_salaire" value="#{managedImportExport.listElementSalaire}" var="regl" rowKey="#{regl.id}"
                                                     scrollable="true" scrollWidth="200%" paginator="true" rows="20">

                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_regle_salaire">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_regle_salaire" fileName="elements_salaire" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'employe'}">
                                        <p:dataTable id="tabl_employe" value="#{managedImportExport.listEmployes}" var="empl" rowKey="#{empl.id}"
                                                     scrollable="true" paginator="true" rows="20">
                                            <f:facet name="header">#{lab.LMP_PIE_liste_employes}</f:facet>
                                            <p:column headerText="#{lab.LDB_PD_matricule}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LDB_PD_matricule}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.matricule}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PC_civilite}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PC_civilite}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.civilite}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_noms}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_noms}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.nom}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_prenoms}" exportable="true" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_prenoms}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.prenom}"/>
                                            </p:column>
                                            <p:column headerText="CNPS" exportable="true" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="CNPS"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.matriculeCnps}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_adresse}" exportable="true" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_adresse}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.adresse1}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LRH_PE_date_naissance}" exportable="true" style="text-align: center" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LRH_PE_date_naissance}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.dateNaissance}" converter="DATE"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LRH_PE_date_embauche}" exportable="true" style="text-align: center" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LRH_PE_embauche}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.dateEmbauche}" converter="DATE"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LRH_PPT_poste}" exportable="true" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LRH_PPT_poste}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.posteActif.intitule}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.T_photo}" exportable="true" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.T_photo}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.photos}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_agence}" exportable="true" >
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_agence}"/>
                                                </f:facet>
                                                <h:outputText value="#{empl.agence.codeagence}"/>
                                            </p:column>
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_employe">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_employe" fileName="employes" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'departement'}">
                                        <p:dataTable id="tabl_departement" value="#{managedImportExport.listDepartements}" var="dept" rowKey="#{dept.id}"
                                                     scrollable="true" paginator="true" rows="10">
                                            <f:facet name="header">#{lab.LRH_PPT_liste_departements}</f:facet>
                                            <p:column headerText="#{lab.L_code}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LRH_PPT_departement}"/>
                                                </f:facet>
                                                <h:outputText value="#{dept.codeDepartement}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PS_abbreviation}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PS_abbreviation}"/>
                                                </f:facet>
                                                <h:outputText value="#{dept.abreviation}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_intitule}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_intitule}"/>
                                                </f:facet>
                                                <h:outputText value="#{dept.intitule}"/> 
                                            </p:column>
                                            <p:column headerText="#{lab.L_parent}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_parent}"/>
                                                </f:facet>
                                                <h:outputText value="#{dept.departementParent.codeDepartement}"/> 
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_vis_livre_paie}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_visible_livre_paie}"/>
                                                </f:facet>
                                                <h:outputText value="#{dept.visibleOnLivrePaie}"/>
                                            </p:column>
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_departement">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_departement" fileName="departement" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'poste_travail'}">
                                        <p:dataTable id="tabl_poste_travail" value="#{managedImportExport.listPostes}" var="pots" rowKey="#{pots.id}"
                                                     scrollable="true" paginator="true" rows="10">
                                            <f:facet name="header">#{lab.LRH_PE_liste_postes_travails}</f:facet>
                                            <p:column headerText="#{lab.L_code}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LRH_PE_poste}"/>
                                                </f:facet>
                                                <h:outputText value="#{pots.intitule}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LRH_PPT_departement}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LRH_PPT_departement}"/>
                                                </f:facet>
                                                <h:outputText value="#{pots.departement.codeDepartement}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PPG_grade}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LC_PPG_grade}"/>
                                                </f:facet>
                                                <h:outputText value="#{pots.grade}"/>
                                            </p:column>
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_poste_travail">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_poste_travail" fileName="poste_travail" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'contrat'}">
                                        <p:dataTable id="tabl_contrat" value="#{managedImportExport.listContrats}" var="cont" rowKey="#{cont.id}"
                                                     scrollable="true" paginator="true" rows="10">
                                            <f:facet name="header">#{lab.LMP_PIE_liste_contrats}</f:facet>
                                            <p:column headerText="#{lab.LMP_PIE_employe}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_employe}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.employe.matricule}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_reference}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_reference}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.referenceContrat}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_date_debut}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_date_debut}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.dateDebut}" converter="DATE"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_date_fin}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_date_fin}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.dateFin}" converter="DATE"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_salaire_horaire}" exportable="true" style="text-align: right">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_salaire_horaire}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.salaireHoraire}" converter="DN"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_salaire_mensuel} " exportable="true" style="text-align: right">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_salaire_mensuel}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.salaireMensuel}" converter="DN"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LCF_PRV_mode_paiement}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LCF_PRV_mode_paiement}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.modePaiement.designation}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LRH_PC_type_contrat}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LRH_PC_type_contrat}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.typeContrat.libelle}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_horaire_hebdo}" exportable="true" style="text-align: right">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_horaire_hebdo}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.horaireHebdo}" converter="DNA"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_jour_conge}" exportable="true" style="text-align: right">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_jour_conge}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.congeAcquis}" converter="DNA"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_type_tranche}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_type_tranche}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.typeTranche}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_souce_conge}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_souce_conge}"/>
                                                </f:facet>
                                                <h:outputText value="#{cont.sourceFirstConge}"/>
                                            </p:column>
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_contrat">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_contrat" fileName="contrats" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{managedImportExport.objetExport == 'convention'}">
                                        <p:dataTable id="tabl_convention" value="#{managedImportExport.listConventions}" var="conv" rowKey="#{conv.id}"
                                                     scrollable="true" paginator="true" rows="10">
                                            <f:facet name="header">#{lab.LMP_PIE_liste_convention_collective}</f:facet>
                                            <p:column headerText="#{lab.L_categorie}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_categorie}"/>
                                                </f:facet>
                                                <h:outputText value="#{conv.categorie.categorie}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_echellon}" exportable="true">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_echellon}"/>
                                                </f:facet>
                                                <h:outputText value="#{conv.echelon.echelon}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_salaire_minimal}" exportable="true" style="text-align: right">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_salaire_minimal}"/>
                                                </f:facet>
                                                <h:outputText value="#{conv.salaireMin}" converter="DN"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LMP_PIE_salaire_horaire_min}." exportable="true" style="text-align: right">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.LMP_PIE_salaire_horaire_min}"/>
                                                </f:facet>
                                                <h:outputText value="#{conv.salaireHoraireMin}" converter="DN"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_secteur}" exportable="true" style="text-align: center">
                                                <f:facet name="header">        
                                                    <p:outputLabel value="#{lab.L_secteur}"/>
                                                </f:facet>
                                                <h:outputText value="#{conv.yvsSecteurs.nom}"/>
                                            </p:column>
                                        </p:dataTable>
                                        <h:commandLink id="exp_excel_convention">
                                            <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                            <p:dataExporter type="xls" target="tabl_convention" fileName="conventions" />
                                        </h:commandLink>
                                    </p:outputPanel>
                                </p:outputPanel>
                            </div>
                        </p:outputPanel>
                    </p:tab>
                    <p:tab title="#{lab.LMP_PIE_importation}">    
                        <p:outputPanel>
                            <h:panelGrid columns="5" style="float: left">
                                <p:commandLink id="imp_excel" onclick="dlgUploadImgXLS.show()">
                                    <p:graphicImage library="img" name="xls.png" width="25" height="25" title="excel"/>
                                </p:commandLink>

                                <p:commandLink id="imp_csv" onclick="dlgUploadImgCSV.show()">
                                    <p:graphicImage library="img" name="csv.png" width="25" height="25" title="csv"/>
                                </p:commandLink>

                                <p:commandLink id="imp_xml" onclick="dlgUploadImgXML.show()">
                                    <p:graphicImage library="img" name="xml.png" width="25" height="25" title="xml"/>
                                </p:commandLink>

                                <p:commandLink id="imp_txt" onclick="dlgUploadImgTXT.show()">
                                    <p:graphicImage library="img" name="txt.png" width="25" height="25" title="xml"/>
                                </p:commandLink>
                            </h:panelGrid>
                            <p:commandLink onclick="dlg_orderCol.show()" type="button">
                                <h:graphicImage library="icones" name="info.png"  width="20" height="20" style="float: right"/> 
                            </p:commandLink>
                            <p:outputPanel id="tab_import">
                                <p:outputPanel rendered="#{managedImportExport.objetImport eq 'article'}" style="width: 100%;overflow: auto">
                                    <p:dataTable value="#{managedImportExport.listImportArticles}" var="condI" rowKey="#{condI.refArt}"
                                                 id="tabl_articles_Import" paginator="true" rows="15" rowIndexVar="idxA" paginatorAlwaysVisible="false">
                                        <f:facet name="header">
                                            <p:outputLabel value="#{lab.LP_POF_liste_articles}"/>                                            
                                        </f:facet>
                                        <p:column headerText="N°" width="20">
                                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{condI.new_}"/>
                                            <h:outputText value="#{idxA+1}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_reference}" width="100">
                                            <h:outputText value="#{condI.article.refArt}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_designation}">
                                            <h:outputText value="#{condI.article.designation}"/>
                                        </p:column>  
                                        <p:column headerText="#{lab.L_unite}">
                                            <h:outputText value="#{condI.unite.libelle}"/>
                                        </p:column>  
                                        <p:column headerText="#{lab.LDB_PA_pu_a}" style="text-align: right" width="100">
                                            <h:outputText value="#{condI.prixAchat}"/>
                                        </p:column>                            
                                        <p:column headerText="#{lab.LDB_PCB_puv}" style="text-align: right" width="100">
                                            <h:outputText value="#{condI.prix}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_famille}" style="text-align: center">
                                            <h:outputText value="#{condI.article.famille.referenceFamille}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                                <p:outputPanel rendered="#{managedImportExport.objetImport eq 'plan_comptable'}" style="width: 100%;overflow: auto">
                                    <p:dataTable value="#{managedImportExport.listImportComptes}" var="cptI" rowKey="#{cptI.numCompte}"
                                                 id="tabl_comptes_Import" paginator="true" rows="15" rowIndexVar="idxC" paginatorAlwaysVisible="false">
                                        <f:facet name="header">
                                            <p:outputLabel value="#{lab.LDB_PTT_liste_comptes}"/>                                            
                                        </f:facet>
                                        <p:column headerText="N0" width="20">
                                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{cptI.new_}"/>
                                            <h:outputText value="#{idxC+1}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_reference}">
                                            <h:outputText value="#{cptI.numCompte}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_designation}">
                                            <h:outputText value="#{cptI.intitule}"/>
                                        </p:column> 
                                        <p:column headerText="#{lab.L_nature}">
                                            <h:outputText value="#{cptI.natureCompte.designation}"/>
                                        </p:column> 
                                    </p:dataTable>
                                </p:outputPanel>
                                <p:outputPanel rendered="#{managedImportExport.objetImport eq 'inventaire'}" style="width: 100%;overflow: auto">
                                    <p:dataTable value="#{managedImportExport.listImportContenus}" var="invI" rowKey="#{invI.id}"
                                                 id="tabl_inventaire_Import" paginator="true" rows="15" rowIndexVar="idxI" paginatorAlwaysVisible="false">
                                        <f:facet name="header">
                                            <p:outputLabel value="#{lab.LMP_PIE_liste_contnus_inventaire}"/>                                            
                                        </f:facet>
                                        <p:column headerText="N°" width="30">
                                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{invI.new_}"/>
                                            <h:outputText value="#{idxI+1}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_depot}" filterBy="#{invI.docStock.source.designation}">
                                            <h:outputText value="#{invI.docStock.source.designation}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_article}" filterBy="#{invI.article.refArt}">
                                            <h:outputText value="#{invI.article.refArt}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_quantite}" style="text-align: right">
                                            <h:outputText value="#{invI.quantite}"/>
                                            <span title="#{invI.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{invI.conditionnement.unite.reference}</span>
                                        </p:column> 
                                        <p:column width="30" headerText="#{lab.LMP_PIE_mouv}" style="text-align: center"> 
                                            <h:graphicImage library="img/icones" name="#{(invI.update)?'in.png':'out.png'}" rendered="#{invI.id gt 0}"
                                                            width="15" height="15" title="#{(hist.update)?lab.LDB_PA_entree:lab.LDB_PA_sortie}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                                <p:outputPanel rendered="#{managedImportExport.objetImport == 'employe'}">
                                    <p:dataTable id="tabl_employe_Import" value="#{managedImportExport.listImportEmployes}" var="emplI" rowKey="#{emplI.id}"
                                                 scrollable="true" paginator="true" rows="10">
                                        <f:facet name="header">#{lab.LMP_PIE_liste_employes}</f:facet>
                                        <p:column headerText="#{lab.LDB_PD_matricule}">
                                            <h:outputText value="#{emplI.matricule}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PC_civilite}">
                                            <h:outputText value="#{emplI.civilite}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PC_noms}">
                                            <h:outputText value="#{emplI.nom}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_prenoms}">
                                            <h:outputText value="#{emplI.prenom}"/>
                                        </p:column>
                                        <p:column headerText="CNPS">
                                            <h:outputText value="#{emplI.matriculeCnps}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_adresse}">
                                            <h:outputText value="#{emplI.adresse1}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LRH_PE_date_naissance}" style="text-align: center" >
                                            <h:outputText value="#{emplI.dateNaissance}" converter="DATE"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LRH_PE_date_embauche}" style="text-align: center" >
                                            <h:outputText value="#{emplI.dateEmbauche}" converter="DATE"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LRH_PPT_poste}">
                                            <h:outputText value="#{emplI.posteActif.intitule}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.T_photo}">
                                            <h:outputText value="#{emplI.photos}"/>
                                        </p:column>                                        
                                        <p:column headerText="#{lab.L_agence}">
                                            <h:outputText value="#{emplI.agence.codeagence}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                                <p:outputPanel rendered="#{managedImportExport.objetImport == 'departement'}">
                                    <p:dataTable id="tabl_departement_import" value="#{managedImportExport.listImportDepartements}" var="deptI" rowKey="#{deptI.id}"
                                                 scrollable="true" paginator="true" rows="10">
                                        <f:facet name="header">#{lab.LRH_PPT_liste_departements}</f:facet>
                                        <p:column headerText="#{lab.L_code}">
                                            <h:outputText value="#{deptI.codeDepartement}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PS_abbreviation}">
                                            <h:outputText value="#{deptI.abreviation}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_intitule}">
                                            <h:outputText value="#{deptI.intitule}"/> 
                                        </p:column>
                                        <p:column headerText="#{lab.L_parent}">
                                            <h:outputText value="#{deptI.departementParent.codeDepartement}"/> 
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_vis_livre_paie}" style="text-align: center">
                                            <h:outputText value="#{deptI.visibleOnLivrePaie}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                                <p:outputPanel rendered="#{managedImportExport.objetImport == 'poste_travail'}">
                                    <p:dataTable id="tabl_poste_travail_import" value="#{managedImportExport.listImportPostes}" var="potsI" rowKey="#{potsI.id}"
                                                 scrollable="true" paginator="true" rows="10">
                                        <f:facet name="header">#{lab.LRH_PE_liste_postes_travails}</f:facet>
                                        <p:column headerText="#{lab.L_code}">
                                            <h:outputText value="#{potsI.intitule}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LRH_PA_departement}">
                                            <h:outputText value="#{potsI.departement.codeDepartement}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PNA_grade}" style="text-align: center">
                                            <h:outputText value="#{potsI.grade}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                                <p:outputPanel rendered="#{managedImportExport.objetImport == 'contrat'}">
                                    <p:dataTable id="tabl_contrat_import" value="#{managedImportExport.listImportContrats}" var="contI" rowKey="#{contI.id}"
                                                 scrollable="true" paginator="true" rows="10">
                                        <f:facet name="header">#{lab.LMP_PIE_liste_contrats}</f:facet>
                                        <p:column headerText="#{lab.LMP_PIE_employe}">
                                            <h:outputText value="#{contI.employe.matricule}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_reference}">
                                            <h:outputText value="#{contI.referenceContrat}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_date_debut}" style="text-align: center">
                                            <h:outputText value="#{contI.dateDebut}" converter="DATE"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_date_fin}" style="text-align: center">
                                            <h:outputText value="#{contI.dateFin}" converter="DATE"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_salaire_horaire}" style="text-align: right">
                                            <h:outputText value="#{contI.salaireHoraire}" converter="DN"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_salaire_mensuel}" style="text-align: right">
                                            <h:outputText value="#{contI.salaireMensuel}" converter="DN"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LRH_PC_mode_paiement}" style="text-align: center">
                                            <h:outputText value="#{contI.modePaiement.designation}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LRH_PC_type_contrat}" style="text-align: center">
                                            <h:outputText value="#{contI.typeContrat.libelle}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_horaire_hebdo}" style="text-align: right">
                                            <h:outputText value="#{contI.horaireHebdo}" converter="DNA"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_jour_conge}" style="text-align: right">
                                            <h:outputText value="#{contI.congeAcquis}" converter="DNA"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_type_tranche}" style="text-align: center">
                                            <h:outputText value="#{contI.typeTranche}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_souce_conge}" style="text-align: center">
                                            <h:outputText value="#{contI.sourceFirstConge}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                                <p:outputPanel rendered="#{managedImportExport.objetImport == 'convention'}">
                                    <p:dataTable id="tabl_convention_import" value="#{managedImportExport.listImportConventions}" var="convI" rowKey="#{convI.id}"
                                                 scrollable="true" paginator="true" rows="10">
                                        <f:facet name="header">#{lab.LMP_PIE_liste_convention_collective}</f:facet>
                                        <p:column headerText="#{lab.L_categorie}">
                                            <h:outputText value="#{convI.categorie.categorie}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_echellon}">
                                            <h:outputText value="#{convI.echelon.echelon}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_salaire_minimal}" style="text-align: right">
                                            <h:outputText value="#{convI.salaireMin}" converter="DN"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LMP_PIE_salaire_horaire_min}" style="text-align: right">
                                            <h:outputText value="#{convI.salaireHoraireMin}" converter="DN"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_secteur}" style="text-align: center">
                                            <h:outputText value="#{convI.yvsSecteurs.nom}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                            </p:outputPanel>
                            <p:outputPanel autoUpdate="true" style="float: right">
                                <p:calendar value="#{managedImportExport.dateInventaire}" navigator="true" pattern="dd-MM-yyyy" size="8" 
                                            rendered="#{managedImportExport.objetImport eq 'inventaire'}">
                                    <p:ajax event="dateSelect" process="@this" global="false"/>
                                    <p:ajax event="valueChange" process="@this" global="false"/>
                                </p:calendar>
                                <p:commandButton type="button" value="#{lab.L_importer}" onclick="dlgConfirmSave.show()" icon="ui-icon-arrowthickstop-1-s"/>
                            </p:outputPanel>
                            <p:separator style="width: 100%"/>
                        </p:outputPanel>
                    </p:tab>
                </p:tabView>
            </div>
        </h:form>
    </ui:define>
</ui:composition>