<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core"> 
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Caisses','modDonneBase', 'smenCaisses', true)}
    </ui:define>  
    <ui:define name="contents">
        <script type="text/javascript">
            $(function() {
                collapseForm('caisses');
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 135);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
            });

            function enabledWizard() {
                enableWizard();
            }

            function disabledWizard() {
                disableWizard();
            }
        </script>  
        <style type="text/css">
            .part_fix{
                height: 70px !important;
            }
        </style>     
        #{managedNatureCompte.doNothing()}

        #{managedAgence.loadAgence()}
        #{managedCaisses.loadAll()}
        #{managedCaisses.loadAllCaisses()}
        #{MEmps.loadAllEmployesByAgence(true, true)}
        #{managedCompte.loadAllActif(true)}
        #{managedJournaux.loadAllActif()}
        #{managedModeReglement.loadAllMode()}
        #{managedUser.loadAllUserSociete_()}
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelCompteC" closeOnEscape="true"
                             message="#{lab.LDB_PCB_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCaisses.confirmDeleteCompteCaiss()}" 
                                 oncomplete="dlgConfirmDelCompteC.hide();" update=":main_form_caisses:tabview_others_info_caiss:chmp_compteGen_Caisse_ :main_form_caisses:tabview_others_info_caiss:form_zone_add_others_compte"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelCompteC.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelCaiss" closeOnEscape="true"
                             message="#{lab.LDB_PCB_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCaisses.deleteBean()}" 
                                 oncomplete="dlgConfirmDelCaiss.hide();" update=":main_form_caisses:table_caisses"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelCaiss.hide()"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelCaiss_" closeOnEscape="true"
                             message="#{lab.LDB_PCB_text3}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCaisses.deleteBean_()}" 
                                 oncomplete="dlgConfirmDelCaiss_.hide();" update=":main_form_caisses:table_caisses"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelCaiss_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:remoteCommand name="enableWizard" actionListener="#{managedCaisses.activeModeWizard(true)}"/>
            <p:remoteCommand name="disableWizard" actionListener="#{managedCaisses.activeModeWizard(false)}"/>
        </h:form>

        <h:form prependId="false" id="main_fusion_caisses">
            <p:dialog widgetVar="dlgConfirmFusion" header="#{lab.L_fusionner}" dynamic="true" resizable="false" closeOnEscape="true" modal="true">
                <h:panelGrid id="blog_fusionner_caisses" columns="1" styleClass="yvs_nostyle" style="width: 100%" cellpadding="0" cellspacing="0">
                    <span>#{lab.LDB_PCB_text4} </span>
                    <h:outputText style="font-weight: bold;margin-left: 10px" value="#{managedCaisses.fusionneTo}"/>
                    <span>#{lab.LDB_PCB_text5}</span>
                    <c:forEach items="#{managedCaisses.fusionnesBy}" var="fus">
                        <span style="margin-left: 10px"> - <span style="font-weight: bold">#{fus}</span></span>
                    </c:forEach>
                    <span>#{lab.LDB_PCB_text6}</span>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCaisses.fusionner(false)}" style="float: right" 
                                 oncomplete="dlgConfirmFusion.hide()"  update=":main_form_caisses:table_caisses"/> 
            </p:dialog>
        </h:form> 
        <h:form prependId="false" >
            <p:dialog header="#{lab.LDB_PCB_text7}" widgetVar="dlgPrintBrouillard" closeOnEscape="true" >
                <h:panelGrid columns="3" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.LDB_PCB_date_debut}"/>
                    <h:outputText value="#{lab.LDB_PCB_date_fin}"/>
                    <h:outputText value=""/>
                    <p:calendar value="#{managedCaisses.dateDebut}" navigator="true" pattern="dd-MM-yyyy"/>
                    <p:calendar value="#{managedCaisses.dateFin}" navigator="true" pattern="dd-MM-yyyy"/>
                    <p:commandButton value="#{lab.L_telecharger}" icon="ui-icon-print" global="false" actionListener="#{managedCaisses.printBrouillard()}" ajax="false"/>
                </h:panelGrid>
                <f:facet name="footer">                    
                    <h:outputText value="#{lab.L_copy}" escape="true" />
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" >
            <p:dialog header="#{lab.LDB_PCB_creer_journal_comptable}" widgetVar="dlgCreateJournal" width="80%" closeOnEscape="true" footer="&copy; Lymytz" >
                <div class="dlg_part_fixe">
                    <div style="float: left;width: 20%">
                        <p:commandButton id="save_journaux" value="#{lab.L_enregistrer}" actionListener="#{managedJournaux.saveNew()}" icon="ui-icon-disk"/>
                        <p:commandButton id="cancel_journaux" value="#{lab.L_nouveau}" actionListener="#{managedJournaux.resetFiche()}" icon="ui-icon-document"/> 
                    </div> 
                    <div  style="clear: both" />
                </div>
                <div class="dlg_part_scroll">
                    <p:outputPanel id="form_edit_journaux">
                        <ui:include src="../../finance_compta/base/journal/form.xhtml" />
                    </p:outputPanel>
                </div>
            </p:dialog>
        </h:form>
        <h:form prependId="false" >
            <p:dialog header="#{lab.LDB_PCB_gestion_compte}" widgetVar="dlgCmpteG" width="80%" height="600" closeOnEscape="true" footer="&copy; Lymytz">
                <script type="text/javascript">
                    $(function() {
                        collapseList('plan_compte');
                    });
                </script>  
                <div class="dlg_part_fixe">
                    <div style="float: left">
                        <p:commandButton id="save_plan_compte" value="#{lab.L_enregistrer}" actionListener="#{managedCompte.saveNew()}" icon="ui-icon-disk"/>
                        <p:commandButton id="cancel_plan_compte" value="#{lab.L_nouveau}" actionListener="#{managedCompte.resetFiche()}" icon="ui-icon-document"/>                   
                        <h:panelGroup id="find_plan_compte">
                            <p:watermark value="#{lab.LDB_PCB_saisir_compte_g}" for="txt_cmpte_find_caisss"/>
                            <p:watermark value="#{alab.LDB_PCB_saisir_nature_compte}" for="txt_nature_find_caisss"/>
                            <h:panelGrid columns="3" style="font-size: 0.7em; float: left">        
                                <h:inputText value="#{managedCompte.numCompteF}" id="txt_cmpte_find_caisss">
                                    <p:ajax event="valueChange" listener="#{managedCompte.addParamNumCompte(managedCompte.numCompteF)}" update="table_plan_compte" />
                                </h:inputText>
                                <h:inputText value="#{managedCompte.natureCompteF}" id="txt_nature_find_caisss">
                                    <p:ajax event="valueChange" listener="#{managedCompte.addParamNatureCompte(managedCompte.natureCompteF)}" update="table_plan_compte" />
                                </h:inputText>
                                <p:outputPanel autoUpdate="true">
                                    <h:panelGrid columns="4" cellpadding="0" cellspacing="0">
                                        <p:commandButton actionListener="#{managedCompte.pagineDataCompte(false)}" update="table_plan_compte" icon="ui-icon-circle-triangle-w" disabled="#{managedCompte.paginator.disPrev}"/>
                                        <p:outputLabel value="#{managedCompte.paginator.currentPage}/#{managedCompte.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                                        <p:commandButton actionListener="#{managedCompte.pagineDataCompte(true)}" update="table_plan_compte" icon="ui-icon-circle-triangle-e" disabled="#{managedCompte.paginator.disNext}"/>
                                        <p:selectOneMenu value="#{managedCompte.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCompte.changeMaxResult}" style="font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                            <f:selectItems value="#{managedCompte.paginations}"/>
                                            <p:ajax event="valueChange" update="table_plan_compte"/>
                                        </p:selectOneMenu>
                                    </h:panelGrid>
                                </p:outputPanel>
                            </h:panelGrid>
                        </h:panelGroup>
                    </div>
                    <div style="float: right">                     
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('plan_compte');
                                return false;">
                            <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>          
                        <h:link title="#{lab.L_mode_liste}" onclick="collapseList('plan_compte');
                                return false;" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>                                   
                    </div> 
                    <div style="clear: both"/>
                </div>
                <div class="dlg_part_scroll">
                    <div class="yvs_form_plan_compte">
                        <p:outputPanel id="form_edit_compte">
                            <ui:include src="../../finance_compta/base/compte/form.xhtml" />
                        </p:outputPanel>
                    </div>
                    <div class="yvs_list_plan_compte">
                        <p:outputPanel id="table_plan_compte">
                            <ui:include src="../../finance_compta/base/compte/list.xhtml" />
                        </p:outputPanel>
                    </div>
                </div>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_caisses_emps"> 
            <p:dialog header="#{lab.LDB_PCB_liste_employes_actif}" widgetVar="dlgEmploye" width="85%" height="450"
                      closeOnEscape="true" resizable="false"  modal="true" >  
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">                    
                    <h:panelGroup>
                        <p:inputText value="#{MEmps.matriculeToUpdate}">
                            <p:ajax event="keyup" listener="#{MEmps.findEmploye()}" update="tabEmployes_caisses" global="false" process="@this" />
                        </p:inputText>  
                        <h:selectOneMenu value="#{managedCaisses.agence_}" valueChangeListener="#{MEmps.addParamAgence}">
                            <f:selectItem itemValue="" itemLabel="" noSelectionOption="true"/>
                            <f:selectItems value="#{managedMission.currentScte.agences}" var="itemA" itemValue="#{itemA.id}" itemLabel="#{itemA.designation}" />
                            <f:selectItem itemValue="-1" itemLabel="#{lab.LDB_PCB_toutes_societe}" />
                            <p:ajax event="valueChange" update=":form_caisses_emps:tabEmployes_caisses"/>
                        </h:selectOneMenu>
                    </h:panelGroup>
                    <h:panelGroup style="float: right">
                        <p:commandButton actionListener="#{MEmps.pagineResult(false)}" update="tabEmployes_caisses" icon="ui-icon-circle-triangle-w" disabled="#{MEmps.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{MEmps.paginator.currentPage}/#{MEmps.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{MEmps.pagineResult(true)}" update="tabEmployes_caisses" icon="ui-icon-circle-triangle-e" disabled="#{MEmps.paginator.disNext}"/>
                        <p:selectOneMenu value="#{MEmps.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{MEmps.changeMaxResult}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{MEmps.paginations}"/>
                            <p:ajax event="valueChange" update="tabEmployes_caisses"/>
                        </p:selectOneMenu>
                    </h:panelGroup>
                </h:panelGrid>
                <div class="yvs_list_employe_mission">
                    <p:dataTable value="#{MEmps.listEmployes}" var="emp" rowKey="#{emp.id}" rowIndexVar="line_e" scrollable="true"
                                 widgetVar="tabEmployes" id="tabEmployes_caisses" selectionMode="single" scrollHeight="385"> 
                        <p:ajax event="rowSelect" listener="#{managedCaisses.choisirEmploye}" oncomplete="dlgEmploye.hide()"/>
                        <p:column headerText="N°" width="15" style="text-align: center">
                            <h:outputText value="#{line_e+1}" />
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_noms_prenoms}" width="200">
                            <h:outputText value="#{emp.civilite} #{emp.nom} #{emp.prenom}" />
                        </p:column>                        
                        <p:column headerText="#{lab.LDB_PCB_matricule}" width="90" style="text-align: center">
                            <h:outputText value="#{emp.matricule}" />
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_poste} " width="200">
                            <h:outputText value="#{emp.posteActif.intitule}" />
                        </p:column> 
                        <p:column headerText="#{lab.L_actif}" style="text-align: center" width="20">
                            <h:graphicImage  library="img" name="#{(emp.actif)?'yes.png':'no.png'}"  style="width: 10px; height: 10px" />
                        </p:column>
                    </p:dataTable> 
                </div>
                <f:facet name="footer">                    
                    <h:outputText value="#{lab.L_copy}" escape="true" />
                </f:facet>
            </p:dialog>
        </h:form>

        <h:form prependId="false" id="main_form_caisses">       
            <div class="part_fix">
                <h:panelGroup style="float: left; " >                    
                    <p:splitButton id="save_caisses" value="#{lab.L_enregistrer}" update=":main_form_caisses:table_caisses"
                                   actionListener="#{managedCaisses.saveNew()}" icon="ui-icon-disk" >
                        <p:menuitem id="cancel_caisses" value="#{lab.L_nouveau}" update=":main_form_caisses:form_edit_caisses" 
                                    actionListener="#{managedCaisses.resetFiche()}" icon="ui-icon-document"/>                   
                        <p:menuitem  value="#{lab.L_supprimer}" onclick="dlgConfirmDelCaiss_.show()" global="false" icon="ui-icon-trash"/>
                    </p:splitButton>

                    <p:splitButton id="delete_caisses" value="#{lab.L_supprimer}" onclick="dlgConfirmDelCaiss_.show()" global="false" icon="ui-icon-trash">
                        <p:menuitem value="#{lab.L_fusionner}" icon="ui-icon-refresh" actionListener="#{managedCaisses.fusionner(true)}" global="false"
                                    oncomplete="dlgConfirmFusion.show()" update=":main_fusion_caisses:blog_fusionner_caisses"/>
                        <p:separator/>
                        <p:menuitem value="Activer" icon="ui-icon-check" actionListener="#{managedCaisses.changeActifAll(true)}"/>
                        <p:menuitem value="Désactiver" icon="ui-icon-cancel" actionListener="#{managedCaisses.changeActifAll(false)}"/>
                    </p:splitButton>
                </h:panelGroup>
                <p:outputPanel style="margin-left: 30%" autoUpdate="true">     
                    <p:commandButton actionListener="#{managedCaisses.parcoursInAllResult(false)}" update="txt_parc_linear_caisse table_caisses"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('caisses')"/>
                    <h:inputText value="#{managedCaisses.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_caisse"/>                   
                    <p:outputLabel value="/#{managedCaisses.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                    <p:commandButton actionListener="#{managedCaisses.parcoursInAllResult(true)}" update="txt_parc_linear_caisse table_caisses" icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('caisses')"/>   
                    <h:outputText value="#{caisses.id}" title="#{lab.LDB_PCB_identifiant_element_courant}" styleClass="style_identifiant" rendered="#{caisses.id gt 0}" />                 
                </p:outputPanel>
                <div style="float: right">                     
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('caisses');
                            return false;">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>          
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('caisses');
                            return false;" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>                                 
                </div> 
                <div style="border: 2px solid #045491; border-radius: 5px;padding: 3px;width: 30%;background: #666;float: right;margin-right: 30%"  >
                    <h:panelGrid id="btnSoldeCaisse" columns="2" style="margin: auto;color: white;font-weight: bold;cursor: pointer" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                        <h:outputText value="#{lab.LDB_PCB_solde} : "/>
                        <h:panelGroup>
                            <h:outputText value="#{caisses.solde}" converter="DNS"/>
                            <span style="font-size: small"> Fcfa</span>
                        </h:panelGroup>
                    </h:panelGrid>
                </div>
                <div style="clear: right"/>                
            </div>
            <div class="part_scroll">
                <div class="yvs_form_caisses" style="margin: auto; background: white;">
                    <p:outputPanel id="form_edit_caisses">
                        <ui:include id="main-caisses" src="../../finance_compta/base/caisse/form.xhtml" />
                        <p:tabView style="font-size: 0.9em" id="tabview_others_info_caiss" >
                            <p:tab title="#{lab.LDB_PCB_caisses_liaison}">
                                <h:panelGrid columns="1" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">
                                    <f:facet name="header">
                                        <div align="left"> 
                                            <span style="font-size: 1em">#{lab.LDB_PCB_caisses_liaison}</span>
                                            <h:selectOneMenu value="#{managedCaisses.caisseLie.id}" style="margin-left: 20px;min-width: 160px" id="chmp_caisseLie_Caisse">
                                                <f:selectItem itemValue="0" itemLabel="" />
                                                <f:selectItems value="#{managedCaisses.allCaisses}" var="sc_" itemValue="#{sc_.id}" itemLabel="#{sc_.intitule}"/>
                                            </h:selectOneMenu>      
                                            <p:spacer width="10"/>
                                            <span>#{lab.LDB_PCB_compte_liaison}</span>
                                            <h:panelGroup id="chmp_compteLie_Caisse" style="margin-left: 20px;">
                                                <h:inputText value="#{managedCaisses.compteLie.numCompte}"  style="color: #{caisses.compte.error?'red':'normal'}"> 
                                                    <p:ajax event="blur" global="false" listener="#{managedCaisses.ecouteSaisieCG(managedCaisses.compteLie.numCompte,'CL')}" update="chmp_compteLie_Caisse"/>
                                                </h:inputText>
                                                <p:commandButton icon="ui-icon-note" style="width: 20px; height: 20px; margin-left: 2%" actionListener="#{managedCaisses.openAllCompte('CL')}"/>
                                                <h:outputText value="#{managedCaisses.compteLie.intitule}" style="color: #006666; font-size: 0.9em"  />
                                            </h:panelGroup>
                                            <p:commandButton value="#{lab.LDB_PCB_lier}" icon="ui-icon-link" style="height: 22px" actionListener="#{managedCaisses.addLiaisonCaisse()}"
                                                             update="table_subcaisses chmp_compteLie_Caisse"/>
                                        </div>                                
                                    </f:facet>
                                    <p:dataTable id="table_subcaisses" value="#{caisses.subCaisses}" var="cs" rowKey="#{cs.id}" rowIndexVar="line_c" style="margin-top: 5px"
                                                 selectionMode="single" >
                                        <p:ajax event="rowSelect" listener="#{managedCaisses.chooseLiaisonCaisse}" update=":main_form_caisses:tabview_others_info_caiss:chmp_compteLie_Caisse :main_form_caisses:tabview_others_info_caiss:chmp_caisseLie_Caisse"/>
                                        <p:column headerText="N°" width="20" style="text-align: center">
                                            #{line_c+1}
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PCB_intitule}" width="100" >
                                            #{cs.caisseCible.intitule}
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PCB_responsable}" width="200" >
                                            #{cs.caisseCible.responsable.nom} #{cs.caisseCible.responsable.prenom}
                                        </p:column>
                                        <p:column headerText="#{lab.LDB_PCB_journal}" width="100" >
                                            #{cs.caisseCible.journal.intitule}
                                        </p:column>
                                        <p:column headerText="#{lab.L_agence}">
                                            <span>#{cs.caisseCible.journal.agence.designation}</span>
                                        </p:column>   
                                        <p:column headerText="#{lab.LDB_PCB_compte_l}" width="100" >
                                            <h:outputText value="#{cs.compte.numCompte}" title="#{lab.LDB_PCB_compte_liaison}" />
                                        </p:column>
                                        <p:column headerText="#{lab.L_actif}" width="20" style="text-align: center">
                                            <h:graphicImage library="img" name="#{cs.actif?'vu.png':'vu_non.png'}" width="15" height="15" />
                                        </p:column>
                                        <p:column headerText="" width="20" style="text-align: center">
                                            <p:contextMenu styleClass="context_menu" for="cpte_optionG_caisse_subcaisses" event="left click">                              
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCaisses.deleteLiaison(cs)}"
                                                            update="table_subcaisses"/>
                                            </p:contextMenu>
                                            <p:commandButton type="button" icon="ui-icon-gear" style="width: 22px; height: 22px" id="cpte_optionG_caisse_subcaisses"/>
                                        </p:column>
                                    </p:dataTable>
                                </h:panelGrid>
                            </p:tab>
                            <p:tab title="#{lab.LDB_PCB_autres_comptes}" rendered="#{caisses.type eq 'BANQUE'}">
                                <h:panelGrid columns="5" id="form_zone_add_others_compte" styleClass="yvs_table" cellpadding="0" cellspacing="0"
                                             style="width: 80%">
                                    <span>#{lab.LDB_PCB_comptes}</span>
                                    <h:panelGroup id="chmp_compteGen_Caisse_" >
                                        <h:inputText value="#{managedCaisses.otherCompte.numCompte}"  style="color: #{managedCaisses.otherCompte.error?'red':'normal'}; width: 150px"> 
                                            <p:ajax event="blur" update="chmp_compteGen_Caisse_" global="false" listener="#{managedCaisses.ecouteSaisieCG(managedCaisses.otherCompte.numCompte,'OC')}"/>
                                        </h:inputText>
                                        <p:commandButton icon="ui-icon-note" style="width: 20px; height: 20px; margin-left: 1%" actionListener="#{managedCaisses.openAllCompte('OC')}"/>
                                        <h:outputText value="#{managedCaisses.otherCompte.intitule}" style="color: #006666; font-size: 0.9em"  />
                                    </h:panelGroup>
                                    <span title="#{lab.LDB_PCB_text8}">Code comptable</span>
                                    <h:inputText value="#{managedCaisses.otherCompte.codeComptable}" style="width: 100px"/>
                                    <p:commandButton value="#{lab.L_enregistrer}" style="font-size: 0.9em; margin-right: 20%; float: right" 
                                                     actionListener="#{managedCaisses.saveOthersComptes()}"/>
                                    <f:facet name="footer">
                                        <p:dataTable value="#{caisses.othersComptes}" var="ioc" rowIndexVar="line_oc"
                                                     rowKey="#{ioc.id}" selectionMode="single">
                                            <p:ajax listener="#{managedCaisses.selectLineOthersCompte}" event="rowSelect"/>
                                            <p:column headerText="N°" width="10" style="text-align: center">
                                                #{line_oc+1}
                                            </p:column>
                                            <p:column headerText="#{lab.LDB_PCB_num_compte}" width="100" >
                                                #{ioc.compteGeneral.numCompte}
                                            </p:column>
                                            <p:column headerText="#{lab.LDB_PCB_intitule} " width="100" >
                                                #{ioc.compteGeneral.intitule}
                                            </p:column>
                                            <p:column headerText="#{lab.LDB_PCB_code_comptable} " width="50" >
                                                #{ioc.codeComptable}
                                            </p:column>
                                            <p:column headerText=" " width="15" style="text-align: center">
                                                <p:contextMenu styleClass="context_menu" for="btn_option_oc"
                                                               event="left click">                                                    
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCaisses.deleteOneCompteCaisse(ioc)}" 
                                                                />
                                                </p:contextMenu>
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" type="button" id="btn_option_oc"/>
                                            </p:column>
                                        </p:dataTable>
                                    </f:facet>
                                </h:panelGrid>                                
                                <div style="clear: right" />
                            </p:tab>
                            <p:tab title="#{lab.LDB_PCB_accessibilite}">
                                <p:dataTable value="#{managedCaisses.users}" var="iuser" selectionMode="single" rowIndexVar="line_u" rowKey="#{iuser.id}"
                                             id="table_l_user" style="max-height: 400px; overflow-y: auto; width: 40%">
                                    <p:column headerText="N°" width="15">
                                        #{line_u+1}
                                    </p:column>
                                    <p:column headerText="#{lab.LDB_PCB_noms_prenoms}" styleClass="#{(iuser.new_)?'line_actiftrue':'_'}">
                                        #{iuser.nomUsers}
                                    </p:column>
                                    <p:column headerText="#{lab.L_agence}">
                                        <span>#{iuser.agence.designation}</span>
                                    </p:column> 
                                    <p:column headerText="#{lab.LDB_PCB_vu}" width="15" style="text-align: center">
                                        <p:commandButton icon="#{(iuser.new_)?'ui-icon-circle-minus':'ui-icon-circle-plus'}" title="#{(iuser.new_)?'Caisse invisible pour cet utilisateur':'Rendre visible pour cet utilisateur'}"
                                                         actionListener="#{managedCaisses.addLiaisonCaisseUser(iuser)}" update="table_l_user @this" style="width: 22px; height: 22px"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                        <p:overlayPanel for="btnSoldeCaisse" hideEffect="fade" style="width: 35%;background: black;padding: 2px">
                            <h:panelGrid id="blog_form_solde_caisse" styleClass="yvs_table" columns="2" cellpadding="0" cellspacing="0"
                                         style="width: 100%;font-weight: bolder;background: #EEE;color: #000">
                                <span>#{lab.LDB_PCB_achats}</span>
                                <h:outputText value="#{caisses.soldeAchat}" converter="DNS" style="float: right;color:#{caisses.soldeAchat lt 0 ? 'red' : ''}"/>
                                <span>#{lab.LDB_PCB_ventes}</span>
                                <h:outputText value="#{caisses.soldeVente}" converter="DNS" style="float: right;color:#{caisses.soldeVente lt 0 ? 'red' : ''}"/>
                                <span>#{lab.LDB_PCB_missions}</span>
                                <h:outputText value="#{caisses.soldeMission}" converter="DNS" style="float: right;color:#{caisses.soldeMission lt 0 ? 'red' : ''}"/>
                                <span>#{lab.LDB_PCB_virements}</span>
                                <h:outputText value="#{caisses.soldeVirement}" converter="DNS" style="float: right;color:#{caisses.soldeVirement lt 0 ? 'red' : ''}"/>
                                <span>#{lab.LDB_PCB_od}</span>
                                <h:outputText value="#{caisses.soldeDivers}" converter="DNS" style="float: right;color:#{caisses.soldeDivers lt 0 ? 'red' : ''}"/>
                                <span>#{lab.LDB_PCB_note_frais}</span>
                                <h:outputText value="#{caisses.soldeNote}" converter="DNS" style="float: right;color:#{caisses.soldeNote lt 0 ? 'red' : ''}"/>
                                <span>#{lab.LDB_PCB_autres}</span>
                                <h:outputText value="#{caisses.soldeOther}" converter="DNS" style="float: right;color:#{caisses.soldeOther lt 0 ? 'red' : ''}"/>
                                <f:facet name="footer">
                                    <h:panelGrid columns="2" style="width: 100%;color: #000" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                        <span style="font-size: 1.2em">#{lab.LDB_PCB_recettes}</span>
                                        <h:outputText value="#{caisses.recette}" converter="DNS" style="float: right"/>
                                        <span style="font-size: 1.2em">#{lab.LDB_PCB_depenses}</span>
                                        <h:outputText value="#{caisses.depense}" converter="DNS" style="float: right"/>
                                        <span style="font-size: 1.2em">#{lab.LDB_PCB_solde}</span>
                                        <h:outputText value="#{caisses.solde}" converter="DNS" style="float: right;color:#{caisses.solde gt 0 ? 'green': (caisses.solde lt 0 ? 'red':'')}"/>
                                    </h:panelGrid>
                                </f:facet>
                            </h:panelGrid>
                        </p:overlayPanel>
                    </p:outputPanel>
                </div>
                <div class="yvs_list_caisses" style="background: white;">
                    <h:inputHidden id="input_hide_caisses" value="#{managedCaisses.tabIds}"/>
                    <p:dataTable selectionMode="single" value="#{managedCaisses.caisses}" var="icaiss"
                                 rowKey="#{icaiss.id}" rowIndexVar="line_c" id="table_caisses">
                        <p:ajax event="rowSelect" listener="#{managedCaisses.loadOnView}" update=":main_form_caisses:input_hide_caisses"/>
                        <p:column headerText="N°" width="20" style="text-align: center">
                            #{line_c+1}
                            <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{icaiss.id eq caisses.id}"/>  
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_code}" width="100" style="font-weight: bold">
                            #{icaiss.code}
                            <h:graphicImage title="#{lab.LDB_PCB_caisse_defaut}" library="img"  name="bookmark.png" width="15" height="15" rendered="#{icaiss.defaultCaisse}" style="float: right"/>
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_intitule}" width="100" >
                            #{icaiss.intitule}
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_caissier}" width="100" >
                            #{icaiss.caissier.nomUsers}
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_journal}" width="100" >
                            #{icaiss.journal.intitule}
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_compte_g}" width="100" >
                            #{icaiss.compte.numCompte}
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_parent}" width="100" style="text-align: center">
                            <h:outputText value="#{icaiss.parent.intitule}" />
                        </p:column>
                        <p:column headerText="#{lab.L_type}" width="100" style="text-align: center">
                            <h:outputText value="#{icaiss.typeCaisse}" />
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_sc}" width="20" style="text-align: center">
                            <h:outputText value="#{icaiss.subCaisses.size()}" />
                        </p:column>
                        <p:column headerText="#{lab.LDB_PD_agence}" width="200" >
                            #{icaiss.journal.agence.designation}
                        </p:column>
                        <p:column headerText="#{lab.LDB_PCB_princ}" width="20" style="text-align: center">
                            <h:graphicImage library="img" name="#{icaiss.principal?'vu.png':'vu_non.png'}" width="15" height="15" />
                        </p:column>
                        <p:column headerText="#{lab.L_actif}" width="20" style="text-align: center">
                            <h:graphicImage library="img" name="#{icaiss.actif?'vu.png':'vu_non.png'}" width="15" height="15" />
                        </p:column>
                        <p:column headerText="" width="20" style="text-align: center">
                            <p:contextMenu styleClass="context_menu" for="cpte_optionG_caisse" event="left click">
                                <p:menuitem value="#{icaiss.defaultCaisse?'Retirer':'Définir'} #{lab.L_defaut}" icon="ui-icon-star" global="false" actionListener="#{managedCaisses.activeDefaut(icaiss)}" update="table_caisses"/>
                                <p:menuitem value="#{icaiss.actif?'Désactiver':'Activer'}" icon="#{icaiss.actif?'ui-icon-circle-close':'ui-icon-circle-check'}" 
                                            actionListener="#{managedCaisses.toogleActiveCaisse(icaiss)}" update="table_caisses"/>  
                                <p:separator />
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCaisses.openToDelete(icaiss)}" 
                                            oncomplete="collapseForm('plan_compte')"/>
                                <p:separator style="width: 98%;margin: auto"/>
                                <p:menuitem value="#{lab.LDB_PCB_telecharger_brouillard}" icon="ui-icon-print" global="false" actionListener="#{managedCaisses.setSelectCaisse(icaiss)}"
                                            oncomplete="dlgPrintBrouillard.show()"/>
                            </p:contextMenu>
                            <p:commandButton type="button" icon="ui-icon-gear" style="width: 22px; height: 22px" id="cpte_optionG_caisse"/>
                        </p:column>
                        <p:column width="25" style="text-align: center">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_caisses" value="false"
                                                         onclick="selectionAllLineTab(#{managedCaisses.caisses.size()}, 'caisses')">
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox  value="#{icaiss.select}" styleClass="chek_line_caisses" 
                                                      onclick="selectionLineTab(#{line_c}, 'caisses')">
                            </h:selectBooleanCheckbox>
                        </p:column>
                    </p:dataTable>
                    <span class="nbSelectcaisses" style="font-size: .8em; font-style: italic; color: #828c95;"></span>
                    <p:outputPanel autoUpdate="true" style="float: right;" layout="block" >
                        <p:commandButton actionListener="#{managedCaisses.paginer(false)}"  update="table_caisses" icon="ui-icon-circle-triangle-w" disabled="#{managedCaisses.paginator.disPrev}"/>
                        <p:outputPanel >
                            <p:inplace label="#{managedCaisses.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                <pe:inputNumber value="#{managedCaisses.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                    <p:ajax event="valueChange" listener="#{managedCaisses.gotoPagePaginator()}" update="table_caisses"/>
                                </pe:inputNumber>
                            </p:inplace><p:outputLabel value="/#{managedCaisses.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        </p:outputPanel>
                        <p:commandButton actionListener="#{managedCaisses.paginer(true)}"  update="table_caisses" icon="ui-icon-circle-triangle-e" disabled="#{managedCaisses.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedCaisses.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCaisses.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedCaisses.paginations}"/>
                            <p:ajax event="valueChange"  update="table_caisses"  />
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" >
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative" width="20" height="20"
                            styleClass="img_slide" title="cacher"/>                    
            <div class="zone_find">
                <div class="yvs_form_facture_achat display_auteur" align="right"  style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le}<h:outputText value="#{managedCaisses.selectCaisse.dateSave}" converter="LD"  styleClass="valeur" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedCaisses.selectCaisse.dateUpdate}" converter="LD" styleClass="valeur" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedCaisses.selectCaisse.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <h:panelGrid id="blog_search_caisse" columns="2" style="width: 100%" cellpadding="0" cellspacing="0">
                    <h:panelGrid columns="6" style="float: left; font-size: 0.8em" cellpadding="0" cellspacing="0">
                        <h:outputText value="#{lab.LDB_PD_agence}" />
                        <h:outputText value="Journal" />
                        <h:outputText value="#{lab.L_numero}" />
                        <h:outputText value="#{lab.L_type}" />
                        <h:outputText value="#{lab.L_principal}" />
                        <h:outputText value="#{lab.L_actif}" />
                        <h:selectOneMenu value="#{managedCaisses.agenceSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedAgence.listAgence}" var="ag" itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                            <p:ajax event="valueChange" listener="#{managedCaisses.addParamAgence()}" oncomplete="collapseList('caisses')"
                                    update=":main_form_caisses:table_caisses"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedCaisses.journalSearch}" style="min-width: 120px">
                            <f:selectItem itemValue="0" itemLabel=""/>                       
                            <f:selectItems value="#{managedJournaux.journaux}" var="joS" itemValue="#{joS.id}" itemLabel="#{joS.intitule}"/>
                            <p:ajax event="valueChange" listener="#{managedCaisses.addParamJournal()}" oncomplete="collapseList('caisses')"
                                    update=":main_form_caisses:table_caisses"/>
                        </h:selectOneMenu>
                        <h:inputText value="#{managedCaisses.numeroSearch}">
                            <p:ajax event="valueChange" listener="#{managedCaisses.addParamNumero()}" oncomplete="collapseList('caisses')"
                                    update=":main_form_caisses:table_caisses"/>
                        </h:inputText> 
                        <h:selectOneMenu value="#{managedCaisses.typeSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/> 
                            <f:selectItem itemLabel="#{lab.LDB_PCB_caisse}" itemValue="CAISSE"/> 
                            <f:selectItem itemLabel="#{lab.LDB_PCB_banque}" itemValue="BANQUE"/>
                            <p:ajax event="valueChange" listener="#{managedCaisses.addParamType()}" oncomplete="collapseList('caisses')"
                                    update=":main_form_caisses:table_caisses"/>
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{managedCaisses.principalSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/> 
                            <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                            <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                            <p:ajax event="valueChange" listener="#{managedCaisses.addParamPrincipal()}" oncomplete="collapseList('caisses')"
                                    update=":main_form_caisses:table_caisses"/>
                        </h:selectOneMenu> 
                        <h:selectOneMenu value="#{managedCaisses.actifSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/> 
                            <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                            <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                            <p:ajax event="valueChange" listener="#{managedCaisses.addParamActif()}" oncomplete="collapseList('caisses')"
                                    update=":main_form_caisses:table_caisses"/>
                        </h:selectOneMenu>
                    </h:panelGrid>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
