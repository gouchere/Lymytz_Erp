<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Cr√©dits','modMutuelle', 'smenCredit', true,managedCredit)}
    </ui:define>   
    <ui:define name="contents"> 
        #{managedMutualiste.loadActif(true)}
        #{managedTypeCredit.loadAll()}
        #{managedCredit.loadAll()}
        #{managedEchellonage.doNothing()}
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 100);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('credit');
                slideShow('zone_show_reglement_credit', 200);
            });
        </script>        

        <h:form prependId="false">
            <p:dialog widgetVar="dlgFusion" header="#{lab.LM_PC_specification_nouveau_credit}" closeOnEscape="true" width="90%">
                <p:outputPanel id="form_fusion_credit" autoUpdate="true">
                    <h:panelGrid columns="8" styleClass="yvs_nostyle" style="background: #CCC;width: 100%;margin-bottom: 5px" cellpadding="0" cellspacing="0">
                        <span>#{lab.LM_PC_date_effet}</span>
                        <h:inputText value="#{managedCredit.entityFusion.dateEffet}" converter="DATE" readonly="true"/>  
                        <span>#{lab.L_montant}</span>
                        <h:inputText value="#{managedCredit.entityFusion.montant}" converter="DNS" readonly="true"/>  
                        <span>#{lab.LCF_POD_date_echeance} </span>
                        <p:calendar value="#{managedCredit.credit.echeancier.dateEchellonage}" navigator="true" pattern="dd-MM-yyyy"/>
                        <span>#{lab.LC_PTBVs_ecart} </span>
                        <pe:inputNumber value="#{managedCredit.credit.echeancier.ecartMensualite}" symbol=" mois" symbolPosition="suffixe"/>
                    </h:panelGrid>
                    <div style="width: 39%;float: left"> 
                        <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                            <f:facet name="header">
                                <div align="left">
                                    <span>#{lab.LM_PC_conditions_generales} </span>
                                    <span style="display: inline-block; float: right">
                                        <span>#{lab.LM_PTC_titre} </span>
                                        <h:inputText value="#{typeCredit.designation}" />  
                                    </span>
                                </div>
                            </f:facet>                                        
                            <span>#{lab.LM_PTC_montant_plafone}</span>                                        
                            <h:panelGroup>
                                <h:inputText value="#{typeCredit.montantMaximal}" style="width: 100px"/>
                                <h:selectOneMenu value="#{typeCredit.natureMontant}" styleClass="yvs_nostyle"  >
                                    <f:selectItem itemLabel="#{lab.LM_PPG_fixe}" itemValue="Fixe" />
                                    <f:selectItem itemLabel="% #{lab.LM_PTC_revenue}" itemValue="Pourcentage" />
                                    <p:ajax event="valueChange" global="false" listener="#{managedTypeCredit.chooseNatureMontant()}"/>
                                </h:selectOneMenu>
                            </h:panelGroup>
                            <span>#{lab.LM_PTC_taux_interet}</span>                                      
                            <h:panelGroup>
                                <h:inputText value="#{typeCredit.tauxMaximal}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_taux_maximale_interet}"/>
                                <span> %</span>
                            </h:panelGroup>
                            <span>#{lab.LM_PTC_periode_max}. </span>                                
                            <h:panelGroup>
                                <h:inputText value="#{typeCredit.periodeMaximal}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_periode_maximale_remboursement}"/>
                                <span> #{lab.L_mois}</span>
                            </h:panelGroup>
                            <span title="#{lab.LM_PTC_text1}...">#{lab.LM_PTC_nombre_minimale_avalistes}... </span>                                                                
                            <h:panelGroup>
                                <h:inputText value="#{typeCredit.nbreAvalise}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_text1}..."/>
                                <span> #{lab.LM_PTC_avalistes}</span>
                            </h:panelGroup>
                            <span>#{lab.LM_PTC_report_credit} </span>
                            <h:selectBooleanCheckbox value="#{typeCredit.impayeDette}"
                                                     title="#{lab.LM_PTC_text2}"/>  
                            <span>#{lab.LM_PTC_pour_assistance} </span>
                            <h:selectBooleanCheckbox value="#{typeCredit.assistance}"
                                                     title="#{lab.LM_PTC_text3}"/>       
                            <span>#{lab.LM_PTC_periode_remboursement} </span>                                                                                             
                            <h:panelGroup>
                                <h:inputText value="#{typeCredit.periodicite}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_periode_maximale_remboursement}"/>
                                <span > #{lab.L_mois}</span>
                            </h:panelGroup>
                            <f:facet name="footer">

                            </f:facet>
                        </h:panelGrid>    
                        <h:panelGrid columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">
                            <f:facet name="header">
                                <div style="float: left;width: 45.5%;text-align:left">#{lab.LM_PTC_type_mensualite}</div>
                                <div style="margin-left: 40%;width: 50.5%;text-align:left">#{lab.LM_PC_formule_interet}</div>
                            </f:facet>
                            <p:selectOneRadio value="#{typeCredit.typeMensualite}" layout="pageDirection" styleClass="yvs_noStyle" style="font-size: 0.9em">
                                <f:selectItems value="#{constantes.MUT_TYPE_MENSUALITE}" var="tm" itemLabel="#{tm.label}" itemValue="#{tm.value}" />
                            </p:selectOneRadio>                                        
                            <h:panelGrid columns="1" styleClass="yvs_nostyle">                                            
                                <p:selectOneRadio value="#{typeCredit.formuleInteret}" layout="lineDirection" styleClass="yvs_noStyle" style="font-size: 0.9em">
                                    <f:selectItems value="#{constantes.MUT_FORMULE_INTERET}" var="fi" itemLabel="#{fi.label}" itemValue="#{fi.value}" />
                                </p:selectOneRadio>
                            </h:panelGrid>
                        </h:panelGrid>                     
                    </div>
                    <div style="width: 60%;margin-left: 40%"> 
                        <h:panelGrid columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">
                            <f:facet name="header">
                                <div align="left" style="float: left">#{lab.LM_PTC_modele_remboursement}</div>
                            </f:facet>
                            <p:selectOneRadio value="#{typeCredit.modelRemboursement}" layout="pageDirection" styleClass="yvs_noStyle" style="font-size: 0.9em">   
                                <f:selectItems value="#{constantes.MUT_MODEL_REMBOURSEMENT}" var="mr" itemLabel="#{mr.label}" itemValue="#{mr.value}" />  
                                <p:ajax event="valueChange" global="false" update="blog_retard_credit_fusion"/>
                            </p:selectOneRadio> 
                            <h:panelGroup id="blog_retard_credit_fusion">
                                <div style="background: #CCC;width: 100%;margin: auto;margin-bottom: 5px">
                                    <p:selectBooleanCheckbox value="#{typeCredit.penaliteRetard}" disabled="#{typeCredit.modelRemboursement != constantes.MODEL_REMBOURSEMENT_STRICT}">
                                        <p:ajax event="valueChange" global="false" update="blog_penalite_retard_credit_fusion"/>
                                    </p:selectBooleanCheckbox>
                                    <span style="font-weight: bold">#{lab.LM_PTC_appliquer_penalite_pour_absence_retard}</span>
                                </div>
                                <h:panelGroup id="blog_penalite_retard_credit_fusion">
                                    <span>#{lab.L_taux} </span>
                                    <h:inputText value="#{typeCredit.tauxPenaliteRetard}" style="width: 50px;text-align: right" disabled="#{!typeCredit.penaliteRetard}"/>
                                    <span> %</span>
                                    <h:panelGroup style="float: right">
                                        <span> #{lab.LM_PTC_sur} </span>
                                        <h:selectOneMenu value="#{typeCredit.basePenaliteRetard}" disabled="#{!typeCredit.penaliteRetard}">
                                            <f:selectItem itemLabel="#{lab.LM_PTC_mensualites_echu}" itemValue="#{constantes.PENALITE_BASE_MENSUALITE}" />
                                            <f:selectItem itemLabel="#{lab.LM_PTC_interet_mensualites_echu}" itemValue="#{constantes.PENALITE_BASE_INTERET}" />
                                        </h:selectOneMenu>                                                 
                                    </h:panelGroup>
                                </h:panelGroup>
                            </h:panelGroup>
                        </h:panelGrid>   
                        <h:panelGrid columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">
                            <f:facet name="header">
                                <div align="left">#{lab.LM_PTC_action_possible_en_cours}</div>
                            </f:facet>
                            <span title="#{lab.LM_PTC_possibilite_reechelonner_credit}">#{lab.LM_PTC_reechelonner_credit}</span>                                        
                            <p:selectBooleanCheckbox value="#{typeCredit.reechellonagePossible}" />
                            <span title="#{lab.LM_PTC_possibilite_fusionner_credit}">#{lab.LM_PTC_fusionner_credit}</span>                                        
                            <p:selectBooleanCheckbox value="#{typeCredit.fusionPossible}" />
                            <h:panelGroup>
                                <span title="#{lab.LM_PTC_possibilite_anticiper_reglement}">#{lab.LM_PTC_anticiper_reglement}</span>                                        
                                <p:selectBooleanCheckbox value="#{typeCredit.anticipationPossible}" style="float: right">
                                    <p:ajax event="valueChange" global="false" update="blog_anticipation_credit_fusion"/>                                    
                                </p:selectBooleanCheckbox>
                            </h:panelGroup>
                            <h:panelGroup id="blog_anticipation_credit_fusion">
                                <div style="background: #CCC;width: 100%;margin: auto;margin-bottom: 5px;margin-top: 4px">
                                    <p:selectBooleanCheckbox value="#{typeCredit.penaliteAnticipation}" disabled="#{!typeCredit.anticipationPossible}">
                                        <p:ajax event="valueChange" global="false" update="blog_anticipation_credit_fusion"/>                                    
                                    </p:selectBooleanCheckbox>
                                    <span style="font-weight: bold">#{lab.LM_PTC_appliquer_penalite}</span>
                                </div>
                                <h:panelGroup rendered="#{typeCredit.anticipationPossible and typeCredit.penaliteAnticipation}">
                                    <span>#{lab.L_taux} </span>
                                    <h:inputText value="#{typeCredit.tauxPenaliteAnticipation}" style="width: 50px;text-align: right"/>
                                    <span> %</span>
                                    <h:panelGroup style="float: right">
                                        <span> #{lab.LM_PTC_sur} </span>
                                        <h:selectOneMenu value="#{typeCredit.basePenaliteAnticipation}">
                                            <f:selectItems value="#{constantes.MUT_BASE_PENALITE}" var="ba" itemLabel="#{ba.label}" itemValue="#{ba.value}" />  
                                        </h:selectOneMenu>                                               
                                    </h:panelGroup>
                                </h:panelGroup>
                            </h:panelGroup>
                            <h:panelGroup>
                                <span title="#{lab.LM_PTC_possibilite_suspendre_mentualite}">#{lab.LM_PTC_suspendre_mentualite}</span>                                        
                                <p:selectBooleanCheckbox value="#{typeCredit.suspensionPossible}" style="float: right" >
                                    <p:ajax event="valueChange" global="false" update="blog_suspension_credit_fusion"/>                                    
                                </p:selectBooleanCheckbox>
                            </h:panelGroup>
                            <h:panelGroup id="blog_suspension_credit_fusion">
                                <div style="background: #CCC;width: 100%;margin: auto;margin-bottom: 5px;margin-top: 4px">
                                    <p:selectBooleanCheckbox value="#{typeCredit.penaliteSuspension}" disabled="#{!typeCredit.suspensionPossible}">
                                        <p:ajax event="valueChange" global="false" update="blog_suspension_credit_fusion"/>                                    
                                    </p:selectBooleanCheckbox>
                                    <span style="font-weight: bold">#{lab.LM_PTC_appliquer_penalite}</span>
                                </div>
                                <h:panelGroup rendered="#{typeCredit.suspensionPossible and typeCredit.penaliteSuspension}">
                                    <span>#{lab.L_taux} </span>
                                    <h:inputText value="#{typeCredit.tauxPenaliteSuspension}" style="width: 50px;text-align: right"/>
                                    <span> %</span>
                                    <h:panelGroup style="float: right">
                                        <span> #{lab.LM_PTC_sur} </span>
                                        <h:selectOneMenu value="#{typeCredit.basePenaliteSuspension}">
                                            <f:selectItems value="#{constantes.MUT_BASE_PENALITE}" var="bs" itemLabel="#{bs.label}" itemValue="#{bs.value}" />  
                                        </h:selectOneMenu>                                             
                                    </h:panelGroup>
                                </h:panelGroup>
                            </h:panelGroup>
                            <f:facet name="footer">

                            </f:facet>
                        </h:panelGrid>
                    </div>
                </p:outputPanel>
                <f:facet name="footer">
                    &copy; Lymytz 2014
                    <p:commandButton value="#{lab.L_fusionner}" actionListener="#{managedCredit.fusionnerCredit()}" style="float: right;margin-top: -5px"
                                     update="form_fusion_credit"/>
                </f:facet>             
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog widgetVar="dlgConfirmActive" header="#{lab.LM_PC_confirmer_mise_silence_condition}"
                      closeOnEscape="true" width="60%">
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <span>#{lab.LM_MC_commentaire}</span>
                    <p:inputTextarea style="width: 100%" rows="8" value="#{managedCredit.commentaire}" />
                    <f:facet name="footer">
                        <p:commandButton value="#{lab.L_valider}" style="float: right" actionListener="#{managedCredit.activeConditionCredit()}" 
                                         oncomplete="dlgConfirmActive.hide()" />
                    </f:facet>
                </h:panelGrid>                
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog widgetVar="dlgChooseCaisse" header="#{lab.LC_PEV_selectionner_caisse}" closeOnEscape="true" width="30%">
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:panelGroup style="float: left;margin-left: 10px" id="zone_edit_mode_paiement_credit">
                        <p:selectOneRadio value="#{managedCredit.reglementc.modePaiement}" styleClass="yvs_noStyle" style="float: left; font-size: 0.8em">
                            <f:selectItem itemValue="#{constantes.MUT_MODE_PAIEMENT_ESPECE}" itemLabel="#{constantes.MUT_MODE_PAIEMENT_ESPECE}" />
                            <f:selectItem itemValue="#{constantes.MUT_MODE_PAIEMENT_COMPTE}" itemLabel="#{constantes.MUT_MODE_PAIEMENT_COMPTE}" />
                            <p:ajax event="valueChange" update="zone_edit_mode_paiement_credit" global="false"/>
                        </p:selectOneRadio>
                        <span style="font-size: 0.8em">#{(managedCredit.reglementc.modePaiement eq constantes.MUT_MODE_PAIEMENT_ESPECE)?lab.L_caisse:lab.L_compte} </span>
                        <h:selectOneMenu rendered="#{(managedCredit.reglementc.modePaiement eq constantes.MUT_MODE_PAIEMENT_ESPECE)}" value="#{managedCredit.reglementc.caisse.id}" style="width:140px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedCredit.caisses}" var="cais" 
                                           itemLabel="#{cais.referenceCaisse}" itemValue="#{cais.id}"/>
                            <p:ajax event="valueChange" global="false" listener="#{managedCredit.chooseCaisse(true)}"/>
                        </h:selectOneMenu>                                                    
                        <h:selectOneMenu rendered="#{!(managedCredit.reglementc.modePaiement eq constantes.MUT_MODE_PAIEMENT_ESPECE)}" value="#{managedCredit.reglementc.compte.id}" style="width:140px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedCredit.mutualiste.comptes}" var="icmpt" 
                                           itemLabel="#{icmpt.reference}" itemValue="#{icmpt.id}"/>
                            <p:ajax event="valueChange" global="false" />
                        </h:selectOneMenu>                                                    
                    </h:panelGroup>  
                    <p:commandButton value="#{lab.L_valider}" style="float: right" actionListener="#{managedCredit.saveNewReglementCredit(managedCredit.credit.montant-managedCredit.credit.montantReste)}" 
                                     oncomplete="dlgChooseCaisse.hide()" update=":main_credit:tabview_credit:date_reglementc_credit"/>
                </h:panelGrid>                
            </p:dialog>
        </h:form>
        <!-->Boite de dialogue pour l'anticipation des mensualit√© d'un cr√©√©dit<-->
        <h:form prependId="false" >                    
            <p:dialog widgetVar="dlgAnticipation" header="#{lab.LM_PC_anticiper_paiement_mensualites}"
                      width="60%" closeOnEscape="true">
                <h:panelGrid columns="3" styleClass="yvs_table" style="width: 100%" id="FormMensualiteImpaye" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGrid columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                            <f:facet name="header">
                                <div style="font-size: 1.2em">
                                    <span>#{lab.LM_PM_credit} : </span>
                                    <h:outputText value="#{managedCredit.creditSelect.montant}" converter="DNS" style="font-weight: bold"/>
                                </div>
                            </f:facet>
                            <h:panelGrid columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                <f:facet name="header">
                                    <div align="center">
                                        <span>#{lab.LM_PC_rembourses} </span>
                                    </div>
                                </f:facet>
                                <span>#{lab.L_capital} : </span>
                                <h:outputText  style="font-weight: bold" value="#{managedCredit.creditSelect.montantEncaisse}" converter="DNS"/>
                                <span>#{lab.LM_PC_mensualites} : </span>
                                <h:outputText  style="font-weight: bold" value="#{managedCredit.echeancierSelect.mensualites.size() - managedCredit.listeMensualiteAPayer.size()}" converter="DN"/>
                            </h:panelGrid>
                            <h:panelGrid columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                <f:facet name="header">
                                    <div align="center">
                                        <span>#{lab.LM_PC_restants} </span>
                                    </div>
                                </f:facet>
                                <span>#{lab.L_capital} : </span>
                                <h:outputText  style="font-weight: bold" value="#{managedCredit.creditSelect.montant - managedCredit.creditSelect.montantEncaisse}" converter="DNS"/>
                                <span>#{lab.LM_PC_mensualites} : </span>
                                <h:outputText  style="font-weight: bold" value="#{managedCredit.listeMensualiteAPayer.size()}" converter="DN"/>
                            </h:panelGrid>
                        </h:panelGrid>
                    </f:facet>
                    <h:outputText value="#{lab.LM_PC_montant_anticipe}"/>
                    <h:outputText value="#{lab.LM_PC_montant_possible}"/>
                    <h:outputText value="#{lab.LM_PC_interets_generes}"/>
                    <h:inputText value="#{managedCredit.forcage}" id="txt_valeur_anticipation_credit"/>
                    <h:inputText readonly="true" value="#{managedCredit.amortissementA}" id="txt_montant_anticipation_credit" converter="DNS"/>
                    <h:inputText readonly="true" value="#{managedCredit.interetA}" converter="DNS" id="txt_penalite_anticipation_credit"/>
                    <f:facet name="footer">
                        <p:commandButton value="#{lab.LM_PC_revenir}" icon="ui-icon-arrowrefresh-1-w" actionListener="#{managedCredit.cancelEvaluerAnticipation()}" style="float: left"
                                         update="listMensualiteImpaye txt_penalite_anticipation_credit txt_montant_anticipation_credit txt_valeur_anticipation_credit"/>
                        <p:commandButton value="#{lab.LM_PC_avaluer}" icon="ui-icon-calculator" actionListener="#{managedCredit.evaluerAnticipation()}"
                                         style="float: right" update="listMensualiteImpaye txt_penalite_anticipation_credit txt_montant_anticipation_credit"/>
                    </f:facet>
                </h:panelGrid>
                <p:dataTable value="#{managedCredit.listeMensualiteAPayer}" var="mens_r" rowKey="#{mens_r.id}" id="listMensualiteImpaye" rowIndexVar="line_M"
                             scrollable="true" scrollHeight="300">
                    <p:column headerText="N¬∞" style="text-align: center; font-size: 0.9em" width="15" styleClass="statut_#{mens_r.marquer?'P':'W'}}">
                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{mens_r.marquer}"/>
                        <span>#{line_M+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRS_date_echeance}" style="text-align: center" width="80" styleClass="statut_#{mens_r.marquer?'P':'W'}">
                        <h:outputText value="#{mens_r.dateMensualite}" converter="DDMMYYYY"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PMC_mensualite}" style="width: 17.5%;text-align: right" styleClass="statut_#{mens_r.marquer?'P':'W'}">
                        <h:outputText value="#{mens_r.montant}" converter="DNS"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PC_amortissement}" style="width: 17.5%;text-align: right" styleClass="statut_#{mens_r.marquer?'P':'W'}">
                        <h:outputText value="#{mens_r.amortissement}" converter="DNS"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PPG_interet}" style="width: 17.5%;text-align: right" styleClass="statut_#{mens_r.marquer?'P':'W'}">
                        <h:outputText value="#{mens_r.interet}" converter="DNS"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PC_penalite}" style="width: 15%;text-align: right" styleClass="statut_#{mens_r.marquer?'P':'W'}">
                        <h:outputText value="#{mens_r.montantPenalite}" converter="DNS"/>
                    </p:column>   
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                    <h:panelGroup style="float: right;margin-top: -5px">
                        <span>Caisse : </span>
                        <h:selectOneMenu value="#{managedCredit.caisse}" style="width:140px;margin-top: 5px">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedCredit.caisses}" var="cais" 
                                           itemLabel="#{cais.referenceCaisse}" itemValue="#{cais.id}"/>
                        </h:selectOneMenu>   
                        <p:commandButton value="#{lab.L_appliquer}" icon="ui-icon-circle-check" actionListener="#{managedCredit.appliquerAnticipation()}"/>
                    </h:panelGroup>
                </f:facet> 
            </p:dialog>
        </h:form>               
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmCreate" closeOnEscape="true"
                             message="#{lab.LDB_PEX_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" onclick="dlgConfirmCreate.hide()" oncomplete="dlgAddExercice.show()" global="false"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmCreate.hide()"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmEditbaleValide" closeOnEscape="true"
                             message="#{lab.LM_PC_ce_credit_valide_continuer}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCredit.changeStatut(constantes.ETAT_EDITABLE)}" oncomplete="dlgConfirmEditbaleValide.hide()" global="false"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmEditbaleValide.hide()"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmEditbaleAnnule" closeOnEscape="true"
                             message="#{lab.LM_PC_ce_credit_attente_continuer}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCredit.changeStatut(constantes.ETAT_EDITABLE)}" oncomplete="dlgConfirmEditbaleAnnule.hide()" global="false"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmEditbaleAnnule.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LDB_PEX_creation_exercice}" widgetVar="dlgAddExercice" 
                      width="25%" modal="true" closeOnEscape="true">
                <h:panelGrid columns="1" styleClass="yvs_table" style="width: 100%">
                    <h:panelGrid columns="2" styleClass="yvs_table" style="width: 98%;margin: auto"> 
                        <span>#{lab.L_reference} </span>  
                        <h:inputText value="#{exercice.reference}"/>
                        <span>#{lab.L_date_debut}</span> 
                        <p:calendar value="#{exercice.dateDebut}" navigator="true" pattern="dd-MM-yyyy"/>
                        <span>#{lab.L_date_fin} </span>
                        <p:calendar value="#{exercice.dateFin}" navigator="true" pattern="dd-MM-yyyy"/>
                        <span>#{lab.L_actif} </span>
                        <h:selectBooleanCheckbox value="#{exercice.actif}"/>
                    </h:panelGrid>
                    <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedExercice.saveNew()}"
                                     oncomplete="dlgAddExercice.hide()" style="width: 100%"/> 
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>    

        <!-->
        *****************************************************************************
        Boite de dialogue motif de refus
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgMotifRefus_cr">
            <p:dialog id="dlgMotifRefus_cr" header="#{lab.LM_PC_motif_refus}" widgetVar="dlgMotifRefus"
                      modal="true" width="25%" closeOnEscape="true">  
                <h:panelGrid id="blog_form_motif_refus_cr" columns="1" styleClass="yvs_table" style="width: 98%;margin: auto">
                    <span>#{lab.LM_PC_motif_refus}</span>
                    <h:inputTextarea value="#{managedCredit.creditSelect.motifRefus}"
                                     style="width: 98%" rows="5" readonly="true"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_dlgMotifRefus1_cr">
            <p:dialog id="dlgMotifRefus1_cr" header="#{lab.LM_PC_motif_refus}" widgetVar="dlgMotifRefus1"
                      modal="true" width="25%" closeOnEscape="true">  
                <h:panelGrid id="blog_form_motif_refus_1cr" columns="1" styleClass="yvs_table" style="width: 98%;margin: auto">
                    <span>#{lab.LM_PC_motif_refus} </span>
                    <h:inputTextarea value="#{managedCredit.credit.motifRefus}" readonly="true"
                                     style="width: 98%" rows="5"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des conditions
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgCondition_">
            <p:dialog id="dlgCondition_" header="#{lab.LM_PC_conditions}" widgetVar="dlgCondition"
                      modal="true" width="60%" closeOnEscape="true">  
                <p:dataTable id="data_credit_condition_" value="#{managedCredit.creditSelect.conditions}" var="cond_" rowIndexVar="condIdx_">
                    <p:column headerText="N¬∞" style="width: 8%;text-align: center">
                        <span>#{condIdx_+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LM_PC_conditions}">
                        <span style="font-weight: bolder">#{cond_.libelle} </span>
                        <span>(#{lab.LM_PC_valeur_requise} '</span>
                        <i>
                            <h:outputText style="color: blue" value="#{lab.LM_PC_parametre_incorrect}" rendered="#{(cond_.valeurRequise!=null)?cond_.valeurRequise=='':true}"/>
                            <h:outputText style="color: blue" value="#{cond_.valeurRequise}" rendered="#{(cond_.valeurRequise!=null)}" converter="DNA"/>
                            <span>&nbsp;#{cond_.unite}</span>
                        </i>
                        <span>'#{lab.LM_PC_valeur_entree} '</span>
                        <i>
                            <h:outputText style="color: #{(!cond_.correct)?'red':'green'}; font-weight: bold" value="#{cond_.valeurEntree}" converter="DNA"/>
                            <span>&nbsp;#{cond_.unite}</span>
                        </i>                             
                        <span>')</span>
                    </p:column>
                    <p:column headerText="#{lab.L_valide}" style="width: 12%;text-align: center">
                        <p:commandLink rendered="#{!cond_.correct}" global="false" actionListener="#{managedCredit.askActiveCondition(cond_)}"
                                       oncomplete="dlgConfirmActive.show()">
                            <h:graphicImage library="img"  name="#{(cond_.correct)?'vu.png':'erase-128.png'}" width="15" height="15"/>                                    
                        </p:commandLink>
                        <h:graphicImage library="img" rendered="#{cond_.correct}" name="#{(cond_.correct)?'vu.png':'no.png'}" width="15" height="15"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue placement echeancier
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgEchancier_">
            <p:dialog  id="dlgEchancier_" header="#{lab.LM_PC_planification_echeancier}" widgetVar="dlgEchancier" modal="true" width="35%" closeOnEscape="true">  
                <h:panelGrid id="blog_form_echeancier" columns="2" styleClass="yvs_table" style="width: 98%;margin: auto">
                    <span>#{lab.LC_PRPF_date_effet} </span>
                    <p:calendar value="#{managedCredit.credit.echeancier.dateEchellonage}" navigator="true" pattern="dd-MM-yyyy"/>
                    <span>#{lab.LM_PC_ecart_mensualite} </span>
                    <pe:inputNumber value="#{managedCredit.credit.echeancier.ecartMensualite}" symbol=" mois" symbolPosition="suffixe"/>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedCredit.accorderCredit()}"
                                 oncomplete="dlgEchancier.hide()" style="float: right"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
            <p:dialog id="blog_reechellonage" header="#{lab.LM_PC_reecheloner_echeancier}" widgetVar="dlgReechellonage" modal="true" width="35%" closeOnEscape="true">  
                <h:panelGrid id="form_reechellonage" columns="2" styleClass="yvs_table" style="width: 98%;margin: auto">
                    <f:facet name="header">
                        <div align="center">
                            <span>#{lab.L_montant} </span>
                            <h:outputText value="#{managedCredit.credit.echeancier.montantReste}" converter="DNS" style="font-weight: bold"/>
                        </div>
                    </f:facet>
                    <span>#{lab.LC_PRPF_date_effet} </span>
                    <p:calendar value="#{managedCredit.credit.echeancier.dateEchellonage}" navigator="true" pattern="dd-MM-yyyy"/>
                    <span>#{lab.LM_PC_ecart_mensualite} </span>
                    <pe:inputNumber value="#{managedCredit.credit.echeancier.ecartMensualite}" symbol=" mois" symbolPosition="suffixe"/>
                    <span>#{lab.L_taux} </span>
                    <pe:inputNumber value="#{managedCredit.credit.echeancier.taux}" symbol=" %" symbolPosition="suffixe"/>
                    <span>#{lab.LP_PPG_duree} </span>
                    <pe:inputNumber value="#{managedCredit.credit.echeancier.dureeEcheance}"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                    <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedCredit.reechellonerEcheance()}" style="float: right"/>
                </f:facet> 
            </p:dialog>
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue de avancement
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgAvancement_">
            <p:dialog id="dlgAvancement_" header="#{lab.LM_PC_suspendre_echeances}" widgetVar="dlgAvancement" modal="true" width="80%" closeOnEscape="true">  
                <h:panelGroup>
                    <p:commandButton value="#{lab.LM_PC_revenir}" icon="ui-icon-arrowrefresh-1-w" actionListener="#{managedCredit.cancelEvaluerReport()}"
                                     style="float: left" update="date_mensualite_echeancier0_"/>
                    <h:panelGrid id="blog_form_reechellonage" columns="6" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" style="float: left">
                        <span>#{lab.LM_PTC_report} </span>              
                        <h:selectOneMenu value="#{managedCredit.report.typeReport}">
                            <f:selectItem itemValue="#{constantes.MUT_TYPE_REPORT_PARTIEL}" itemLabel="#{lab.LM_PC_partiel}"/>
                            <f:selectItem itemValue="#{constantes.MUT_TYPE_REPORT_TOTAL}" itemLabel="#{lab.L_total}"/>
                            <p:ajax event="valueChange" global="false" update="lb_duree_echeance_report txt_duree_echeance_report"/>
                        </h:selectOneMenu>
                        <span>#{lab.LM_PC_partir_echeances} </span>
                        <p:calendar value="#{managedCredit.report.dateEcheance}"  size="8" pattern="dd-MM-yyyy"/>
                        <h:panelGroup id="lb_duree_echeance_report">
                            <h:outputText value="#{lab.LM_PC_nombre_echeances}" rendered="#{managedCredit.report.typeReport == constantes.MUT_TYPE_REPORT_PARTIEL}"/>
                            <h:outputText value="#{lab.LM_PC_duree_suspension}" rendered="#{managedCredit.report.typeReport != constantes.MUT_TYPE_REPORT_PARTIEL}"/>    
                        </h:panelGroup>
                        <h:panelGroup id="txt_duree_echeance_report">
                            <h:inputText value="#{managedCredit.report.nombreEcheance}" style="width: 80px" rendered="#{managedCredit.report.typeReport == constantes.MUT_TYPE_REPORT_PARTIEL}"/>
                            <h:panelGroup rendered="#{managedCredit.report.typeReport != constantes.MUT_TYPE_REPORT_PARTIEL}">
                                <h:inputText value="#{managedCredit.report.dureeSuspension}" style="width: 80px"/>
                                <span> #{lab.L_mois}</span>
                            </h:panelGroup>
                        </h:panelGroup>
                    </h:panelGrid>
                    <p:commandButton value="#{lab.LM_PC_avaluer}" icon="ui-icon-calculator" actionListener="#{managedCredit.reportEcheances()}"
                                     style="float: right" update="date_mensualite_echeancier0_"/>
                </h:panelGroup>
                <p:dataTable id="date_mensualite_echeancier0_" value="#{managedCredit.report.mensualites}" var="mens_r"
                             rowKey="#{mens_r.id}" rowIndexVar="mens_Idx0" >
                    <p:column headerText="N¬∞" style="text-align: center; font-size: 0.9em" width="15" styleClass="marquer_#{mens_r.marquer}">
                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{mens_r.new_}"/>
                        <span>#{mens_Idx0+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRS_date_echeance}" style="text-align: center" width="80" styleClass="marquer_#{mens_r.marquer}">
                        <h:outputText value="#{mens_r.dateMensualite}" converter="DDMMYYYY"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PMC_mensualite}" style="width: 17.5%;text-align: right" styleClass="marquer_#{mens_r.marquer}">
                        <h:outputText value="#{mens_r.montant}" converter="DNS"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PC_amortissement}" style="width: 17.5%;text-align: right" styleClass="marquer_#{mens_r.marquer}">
                        <h:outputText value="#{mens_r.amortissement}" converter="DNS"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PPG_interet}" style="width: 17.5%;text-align: right" styleClass="marquer_#{mens_r.marquer}">
                        <h:outputText value="#{mens_r.interet}" converter="DNS"/>
                    </p:column>
                    <p:column headerText="#{lab.LM_PC_penalite}" style="width: 15%;text-align: right" styleClass="marquer_#{mens_r.marquer}">
                        <h:outputText value="#{mens_r.montantPenalite}" converter="DNS"/>
                    </p:column>                                
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                    <p:commandButton value="#{lab.L_appliquer}" icon="ui-icon-circle-check" actionListener="#{managedCredit.appliquerReport()}"
                                     style="float: right;margin-top: -5px" update="date_mensualite_echeancier0_" oncomplete="dlgAvancement.hide()"/>
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des types de credits
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_dlgTypeCredit_">
            <p:dialog id="dlgTypeCredit_" header="#{lab.LM_PC_cre_type_credit}" widgetVar="dlgTypeCredit"
                      modal="true" width="35%" closeOnEscape="true">  
                <h:panelGrid columns="2" styleClass="yvs_table" style="width: 98%;margin: auto">
                    <span>#{lab.L_designation} </span>
                    <h:inputText value="#{typeCredit.designation}"/>
                    <span>#{lab.L_nature} </span>
                    <p:selectOneRadio value="#{typeCredit.natureMontant}">
                        <f:selectItem itemLabel="#{lab.LM_PPG_fixe}" itemValue="Fixe" />
                        <f:selectItem itemLabel="% #{lab.LM_PPG_salaire}" itemValue="Pourcentage" />
                        <p:ajax event="valueChange" global="false" listener="#{managedTypeCredit.chooseNatureMontant()}"/>
                    </p:selectOneRadio>
                    <span>#{lab.LM_PTC_montant_max} </span>
                    <pe:inputNumber value="#{typeCredit.montantMaximal}"/>
                    <span>#{lab.LM_PC_taux_max}. </span>
                    <pe:inputNumber value="#{typeCredit.tauxMaximal}" symbol="%" symbolPosition="suffixe"/>
                    <span>#{lab.LM_PTC_periode_max}. </span>
                    <pe:inputNumber value="#{typeCredit.periodeMaximal}" symbol="mois" symbolPosition="suffixe"/>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedTypeCredit.saveNew()}" 
                                 oncomplete="dlgTypeCredit.hide()" style="float: right" update=":main_credit:type_credit"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des mutualistes 
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LM_PC_liste_avalistes}" widgetVar="dlgMutualisteAvalise" modal="true" width="50%" closeOnEscape="true">  
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:panelGroup>
                        <h:inputText value="#{managedMutualiste.numSearch}" >
                            <p:ajax event="keyup" listener="#{managedMutualiste.addParamReference()}"  update="data_mutualiste_cred data_mutualiste_avalise_cre"/>
                        </h:inputText>
                    </h:panelGroup>
                    <h:panelGroup style="float: right">
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block" >
                            <p:commandButton actionListener="#{managedMutualiste.paginer(false)}" update="data_mutualiste_cred data_mutualiste_avalise_cre" icon="ui-icon-circle-triangle-w"  disabled="#{managedMutualiste.paginator.disPrev}"/>
                            <p:outputPanel ><p:outputLabel value="#{managedMutualiste.paginator.currentPage}/#{managedMutualiste.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                            <p:commandButton action="#{managedMutualiste.paginer(true)}" update="data_mutualiste_cred data_mutualiste_avalise_cre" icon="ui-icon-circle-triangle-e"  disabled="#{managedMutualiste.paginator.disNext}"/>
                            <p:selectOneMenu value="#{managedMutualiste.imax}" label="#{lab.L_nombre_max_resultat}" style="float: right; font-size: 0.9em;" 
                                             valueChangeListener="#{managedMutualiste.choosePaginator}">
                                <f:selectItems value="#{managedMutualiste.paginations}" />
                                <p:ajax event="valueChange"  update="data_mutualiste_cred data_mutualiste_avalise_cre" />
                            </p:selectOneMenu>
                        </p:outputPanel>
                    </h:panelGroup>
                </h:panelGrid>
                <p:dataTable id="data_mutualiste_avalise_cre" value="#{managedMutualiste.mutualistes}" var="mutua_" rowKey="#{mutua_.id}" rowIndexVar="mutua_Idx"
                             scrollable="true" scrollHeight="400" selectionMode="single">
                    <p:ajax event="rowSelect" global="false" listener="#{managedCredit.loadOnViewMutualisteAvalise}" oncomplete="dlgMutualisteAvalise.hide()"
                            update=":main_credit:tabview_credit:blog_form_avalise"/>
                    <p:column headerText="N¬∞" style="text-align: center" width="15">
                        <span>#{mutua_Idx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LRH_PF_matricule}" width="80">
                        <span>#{mutua_.employe.matricule}</span>                 
                    </p:column>                               
                    <p:column headerText="#{lab.L_noms_prenoms}" width="150">
                        <span>#{mutua_.employe.nom_prenom}</span>                 
                    </p:column>                               
                    <p:column headerText="#{lab.L_agence}" width="80">
                        <span>#{mutua_.employe.agence.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_actif}" width="50" style="text-align: center">
                        <h:graphicImage library="img" name="#{mutua_.actif?'vu.png':'vu_non.png'}" width="15" height="15" />
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LM_PC_liste_mutualistes_actif}" widgetVar="dlgListMutualistes" modal="true" width="60%" height="500" closeOnEscape="true">   
                <div class="dlg_part_fixe">
                    <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                        <h:panelGroup>
                            <h:inputText value="#{managedMutualiste.numSearch}" >
                                <p:ajax event="keyup" listener="#{managedMutualiste.addParamReference()}" update="data_mutualiste_cred data_mutualiste_avalise_cre"/>
                            </h:inputText>
                        </h:panelGroup>
                        <h:panelGroup style="float: right">
                            <p:outputPanel autoUpdate="true" style="float: right" layout="block" >
                                <p:commandButton actionListener="#{managedMutualiste.paginer(false)}" update="data_mutualiste_cred data_mutualiste_avalise_cre" icon="ui-icon-circle-triangle-w"  disabled="#{managedMutualiste.paginator.disPrev}"/>
                                <p:outputPanel ><p:outputLabel value="#{managedMutualiste.paginator.currentPage}/#{managedMutualiste.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                                <p:commandButton action="#{managedMutualiste.paginer(true)}" update="data_mutualiste_cred data_mutualiste_avalise_cre" icon="ui-icon-circle-triangle-e"  disabled="#{managedMutualiste.paginator.disNext}"/>
                                <p:selectOneMenu value="#{managedMutualiste.imax}" label="#{lab.L_nombre_max_resultat}" style="float: right;"  styleClass="champ_pagination"
                                                 valueChangeListener="#{managedMutualiste.choosePaginator}">
                                    <f:selectItems value="#{managedMutualiste.paginations}" />
                                    <p:ajax event="valueChange"  update="data_mutualiste_cred data_mutualiste_avalise_cre" />
                                </p:selectOneMenu>
                            </p:outputPanel>
                        </h:panelGroup>
                    </h:panelGrid>
                </div>
                <div class="dlg_part_scroll">
                    <p:dataTable id="data_mutualiste_cred" value="#{managedMutualiste.mutualistes}" var="mutua0_" rowKey="#{mutua0_.id}" rowIndexVar="mutua0_Idx"
                                 selectionMode="single">
                        <p:ajax event="rowSelect" global="false" listener="#{managedCredit.loadOnViewMutualiste}" 
                                oncomplete="dlgListMutualistes.hide()"/>
                        <p:column headerText="N¬∞" style="text-align: center" width="15">
                            <span>#{mutua0_Idx+1}</span>
                        </p:column>
                        <p:column headerText="#{lab.LRH_PF_matricule}" width="80">
                            <span>#{mutua0_.employe.matricule}</span>                 
                        </p:column>                               
                        <p:column headerText="#{lab.L_noms_prenoms}" width="150">
                            <span>#{mutua0_.employe.nom_prenom}</span>                 
                        </p:column>                               
                        <p:column headerText="#{lab.L_agence}" width="80">
                            <span>#{mutua0_.employe.agence.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_actif}" width="50" style="text-align: center">
                            <h:graphicImage library="img" name="#{mutua0_.actif?'vu.png':'vu_non.png'}" width="15" height="15" />
                        </p:column>
                    </p:dataTable>
                </div>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteAvalise" closeOnEscape="true"
                             message="#{lab.LRH_PS_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCredit.deleteBeanAvalise()}" oncomplete="dlgConfirmDeleteAvalise.hide(); afterDeleteAvalise()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteAvalise.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LRH_PS_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedCredit.deleteBean()}" oncomplete="dlgConfirmDelete.hide(); afterDeleteCredit()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       D√©but du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_credit">              
            <div class="part_fix">
                <p:splitButton value="#{lab.L_enregistrer}" icon="ui-icon-disk" id="save_credit" actionListener="#{managedCredit.saveNew()}">
                    <p:menuitem value="#{lab.L_nouveau}" id="cancel_credit" icon="ui-icon-document" actionListener="#{managedCredit.resetFiche()}" update="blog_form_credit" />
                    <p:menuitem value="#{lab.L_suppprimer}" global="false" icon="ui-icon-trash" onclick="dlgConfirmDelete.show()"/>
                </p:splitButton>
                <p:splitButton value="#{lab.L_suppprimer}" id="delete_credit" global="false" icon="ui-icon-trash" onclick="dlgConfirmDelete.show()" style="font-size: 0.8em">
                    <p:menuitem value="#{lab.L_fusionner}" icon="ui-icon-refresh" actionListener="#{managedCredit.buildForFusion()}"/>
                </p:splitButton>
                <h:panelGroup style="margin-left: 25%">
                    <p:commandButton actionListener="#{managedCredit.parcoursInAllResult(false)}" update="txt_parc_linear_credit" global="false"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('credit')"
                                     />
                    <h:inputText value="#{managedCredit.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_credit"/>
                    <p:outputPanel autoUpdate="true">                        
                        <p:outputLabel value="/#{managedCredit.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedCredit.parcoursInAllResult(true)}" update="txt_parc_linear_credit" global="false" icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('credit')"
                                     />
                </h:panelGroup>                
                <div style="float: right">
                    <h:panelGrid columns="4" cellpadding="0" cellspacing="0">
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('credit');
                                        return false">
                            <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>            
                        <h:link title="#{lab.LM_PC_fiche_remboursement}" onclick="collapseTab('credit');
                                        return false">
                            <p:graphicImage library="icones" name="ico_arbre.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>    
                        <h:link title="#{lab.L_mode_liste}" onclick="collapseList('credit');
                                        return false" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link> 
                    </h:panelGrid>
                </div>
            </div>
            <div class="part_scroll" style="background: white">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_credit" style="background: white">
                    <h:inputHidden id="input_hide_reset_cr" value="#{managedCredit.input_reset}"/>
                    <p:outputPanel id="blog_form_credit" style="width: 100%; margin: auto; background: white">                       
                        <div style="width: 45%;float: left">
                            <p:outputPanel autoUpdate="true" style="float: left;font-size: 0.9em;background: black;color: white;float: left">                                            
                                <h:outputText  value="#{lab.L_reference}.: "  rendered="#{managedCredit.credit.id>0}" />
                                <h:outputText id="txt_reference_credit_mut" value="#{managedCredit.credit.reference}"  rendered="#{managedCredit.credit.id>0}" />
                            </p:outputPanel>
                            <h:panelGrid columns="2" styleClass="yvs_table" style="width: 100%;" cellpadding="0" cellspacing="0">  
                                <f:facet name="header">
                                    <div align="left" style="font-weight: normal; float: left">
                                        <span>#{lab.LM_PM_mutualiste} </span>
                                        <h:panelGroup id="txt_mutualiste_credit">
                                            <h:inputText value="#{managedCredit.mutualiste.matricule}" style="color: #{managedCredit.mutualiste.error?'red':''}" disabled="#{managedCredit.credit.id gt 0}" tabindex="10">
                                                <p:ajax event="blur" global="false" listener="#{managedCredit.searchMutualiste(false)}" 
                                                        update="txt_mutualiste_credit photos_mutualiste_"/>
                                            </h:inputText>    
                                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LM_PMC_liste_mutualiste}" global="false" disabled="#{managedCredit.credit.id gt 0}"
                                                             actionListener="#{managedCredit.initMutualistes(false)}" oncomplete="dlgListMutualistes.show()"/> 
                                            <h:outputText value="#{managedCredit.mutualiste.employe.nom_prenom}" style="margin-left: 10px;font-size: 0.8em"/>
                                        </h:panelGroup>
                                    </div>
                                    <div style="float: right">
                                        <p:graphicImage library="lymytz/documents/docEmps/perso/photo" style="max-height: 100px"
                                                        name="#{(managedCredit.mutualiste.employe.photos==null)?'user1.png':managedCredit.mutualiste.employe.photos}" id="photos_mutualiste_"/>
                                    </div>
                                </f:facet>                                 
                                <span>#{lab.L_compte}: </span> 
                                <h:selectOneMenu value="#{managedCredit.credit.compte.id}" id="compte_mutualiste_credit" style="min-width: 140px" tabindex="20"
                                                 valueChangeListener="#{managedCredit.chooseCompte}" >
                                    <f:selectItem itemLabel="--" itemValue="0" />
                                    <f:selectItems value="#{managedCredit.mutualiste.comptes}" var="compt_" 
                                                   itemLabel="#{compt_.reference}" itemValue="#{compt_.id}" itemDisabled="#{compt_.typeCompte.nature.equals(constantes.MUT_TYPE_COMPTE_EPARGNE)}" />
                                    <p:ajax event="valueChange" global="false"/>
                                </h:selectOneMenu>                                                
                                <span>#{lab.LM_PC_date_effet}</span>
                                <h:panelGroup>
                                    <p:calendar value="#{managedCredit.credit.dateEffet}" size="8" pattern="dd-MM-yyyy" tabindex="30" />
                                    <span style="font-size: 0.9em"  title="#{lab.LM_PC_en_mois}">#{lab.LP_PPG_duree} </span>
                                    <pe:inputNumber value="#{managedCredit.credit.duree}" style="width: 50px;text-align: center" decimalPlaces="0" tabindex="50">
                                        <p:ajax event="blur" global="false" listener="#{managedCredit.setConditionCredit()}" update="situation_mut_credit"/>
                                    </pe:inputNumber>
                                    <h:panelGroup style="float: right">
                                        <span style="font-size: 0.9em" title="#{lab.LM_PC_en_mois}">#{lab.LP_PTB_periodicite} </span>
                                        <pe:inputNumber value="#{managedCredit.credit.echeancier.ecartMensualite}" style="width: 50px;text-align: center" decimalPlaces="0" tabindex="60"/>
                                    </h:panelGroup>
                                </h:panelGroup>
                                <span>#{lab.L_type}: </span> 
                                <h:panelGroup>
                                    <h:selectOneMenu value="#{managedCredit.credit.type.id}" id="type_credit" valueChangeListener="#{managedCredit.chooseTypeCredit}" tabindex="30">
                                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItems value="#{managedTypeCredit.types}" var="typ_" 
                                                       itemLabel="#{typ_.designation}" itemValue="#{typ_.id}" />
                                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                        <f:selectItem itemLabel="#{lab.L_creer}" itemValue="-1"/>
                                        <p:ajax event="valueChange" global="false" 
                                                update="taux_appliquer_credit situation_mut_credit taux_appliquer_credit txt_reference_credit_mut"/>
                                    </h:selectOneMenu>
                                    <h:panelGroup style="float: right" id="taux_appliquer_credit">
                                        <span>#{lab.L_taux} </span>
                                        <h:inputText value="#{managedCredit.credit.echeancier.taux}" style="width: 50px;text-align: center" readonly="true"/>
                                    </h:panelGroup>
                                </h:panelGroup>
                                <span>#{lab.L_montant}:</span>
                                <h:panelGroup>
                                    <pe:inputNumber value="#{managedCredit.credit.montant}" style="width: 30%" tabindex="40">
                                        <p:ajax event="blur" global="false" listener="#{managedCredit.setConditionCredit()}" update="taux_appliquer_credit situation_mut_credit"/>
                                    </pe:inputNumber>
                                    <h:panelGroup style="float: right">
                                        <pe:inputNumber value="#{managedCredit.credit.fraisAdditionnel}" style="width: 50%;float: right;text-align: right" tabindex="70">
                                            <p:ajax event="blur" global="false" listener="#{managedCredit.setConditionCredit()}" update="situation_mut_credit"/>
                                        </pe:inputNumber>
                                        <span style="float: right;margin-top: 5px" title="#{lab.LM_PC_frais_supplementaires}">#{lab.LM_PTC_frais}: </span>
                                    </h:panelGroup>
                                </h:panelGroup>
                                <f:facet name="footer">
                                    <p:outputPanel id="result_validation_participant" autoUpdate="true">
                                        <h:panelGroup rendered="#{managedCredit.credit.visibleVote}">
                                            <div align="left" style="padding: 2px; width: 100%; background: #ccffcc; height: 80px">
                                                #{lab.LM_PC_approuve_par} : <span style="font-size: 0.8em; font-weight: bold">#{managedCredit.credit.nameApprouve}</span>
                                            </div>
                                            <div align="left" style="padding: 2px; width: 100%; background: #c78484; height: 80px">
                                                #{lab.LM_PC_desapprouve_par} : <span style="font-size: 0.8em; font-weight: bold">#{managedCredit.credit.nameDeapprouve}</span>
                                            </div>
                                        </h:panelGroup>
                                    </p:outputPanel>                                                                       
                                </f:facet>
                            </h:panelGrid>
                        </div>
                        <div style="width: 55%;margin-left: 45%">   
                            <p:outputPanel autoUpdate="true"> 
                                <p:outputPanel id="blog_statut_credit" rendered="#{managedCredit.credit.id>0}">        
                                    <p:contextMenu for="statut_refus_credit" rendered="#{managedCredit.credit.etatValidation==constantes.ETAT_ANNULE}">
                                        <p:menuitem value="Voir le motif" global="false" icon="ui-icon-circle-arrow-n" actionListener="#{managedCredit.update('blog_form_motif_refus_cr')}"
                                                    update="date_mensualite_echeancier" oncomplete="dlgMotifRefus1.show()"/>
                                    </p:contextMenu>
                                    <div style="float: left">
                                        <p:commandLink disabled="#{true}" title="#{lab.LM_PC_statut_remboursement}">
                                            <li class="file_true" title="#{lab.LM_PC_statut_remboursement}">
                                                #{(managedCredit.credit.statutRemboursement==constantes.STATUT_DOC_ATTENTE)?lab.LCF_PVC_en_attente:(managedCredit.credit.statutRemboursement==constantes.STATUT_DOC_PAYER)?lab.LC_PFV_regler:lab.LP_PSO_en_cours}
                                            </li>
                                        </p:commandLink>
                                        <p:commandLink actionListener="#{managedCredit.resetFicheReglementC()}" oncomplete="dlgChooseCaisse.show()" disabled="#{managedCredit.credit.etatValidation!=constantes.ETAT_VALIDE or managedCredit.credit.statutPaiement==constantes.STATUT_DOC_PAYER}" title="Statut du paiement">
                                            <li class="file_true" title="#{lab.LM_PC_statut_paiement}">
                                                #{managedCredit.credit.etatValidation!=constantes.ETAT_VALIDE?lab.LCF_PVC_en_attente:(managedCredit.credit.statutPaiement==constantes.STATUT_DOC_ENCOUR)?lab.LP_PSO_en_cours:(managedCredit.credit.statutPaiement==constantes.STATUT_DOC_PAYER)?'Pay√©':'Payer'}
                                            </li>
                                        </p:commandLink>
                                    </div>
                                    <div style="float: right">
                                        <p:commandLink actionListener="#{managedCredit.editableCredit()}" disabled="#{managedCredit.credit.etatValidation==constantes.ETAT_EDITABLE}">
                                            <li class="file_#{managedCredit.credit.etatValidation==constantes.ETAT_EDITABLE}" >#{lab.LC_PLV_editable}</li>
                                        </p:commandLink>
                                        <p:commandLink actionListener="#{managedCredit.soumisCredit()}" rendered="#{managedCredit.credit.etatValidation==constantes.ETAT_SOUMIS or managedCredit.credit.etatValidation==constantes.ETAT_EDITABLE}" disabled="#{managedCredit.credit.etatValidation==constantes.ETAT_SOUMIS or managedCredit.credit.etatValidation==constantes.ETAT_ENCOURS}"
                                                       >
                                            <li class="file_#{managedCredit.credit.etatValidation==constantes.ETAT_SOUMIS}">#{lab.LRH_PNF_soumettre}</li>
                                        </p:commandLink>                                                
                                        <p:commandLink id="statut_refus_credit" actionListener="#{managedCredit.annulerCredit()}" rendered="#{(managedCredit.credit.etatValidation==constantes.ETAT_SOUMIS or managedCredit.credit.etatValidation==constantes.ETAT_ANNULE or managedCredit.credit.etatValidation==constantes.ETAT_ATTENTE)}">
                                            <li class="file_#{managedCredit.credit.etatValidation==constantes.ETAT_ANNULE or managedCredit.credit.etatValidation==constantes.ETAT_ATTENTE}">#{(managedCredit.credit.etatValidation==constantes.ETAT_ANNULE)?'Refus√©':'Annuler'}</li>
                                        </p:commandLink>
                                        <p:commandLink rendered="#{(managedCredit.credit.etatValidation==constantes.ETAT_VALIDE)}" disabled="#{managedCredit.credit.etatValidation==constantes.ETAT_VALIDE}"
                                                       >
                                            <li class="file_#{managedCredit.credit.etatValidation==constantes.ETAT_VALIDE}">#{lab.LM_PC_accord√©}</li>
                                        </p:commandLink>
                                        <p:commandLink rendered="#{(managedCredit.credit.etatValidation==constantes.ETAT_ENCOURS)}" title="#{lab.LM_PC_en_cours_traitement}" disabled="#{managedCredit.credit.etatValidation==constantes.ETAT_ENCOURS}">
                                            <li class="file_#{managedCredit.credit.etatValidation==constantes.ETAT_ENCOURS}">#{lab.LC_PFA_en_cours}</li>
                                        </p:commandLink> 
                                        <p:commandLink rendered="#{(managedCredit.canAccordeCredit())}" actionListener="#{managedCredit.changeStatut(constantes.ETAT_VALIDE)}" update="tabview_credit">
                                            <li class="file_#{managedCredit.credit.etatValidation==constantes.ETAT_VALIDE}">#{lab.LM_PC_accord√©}</li>
                                        </p:commandLink>
                                    </div> 
                                    <div style="clear: right"></div>
                                </p:outputPanel>
                                <div style="width: 99%; border: solid 2px; height: #{managedCredit.credit.visibleVote?'380px':'280px'}; padding: 2px; border-radius: 5px;margin-top: 5px">
                                    <span style="display: inline-block; background: #CCC; width: 100%">
                                        #{lab.LM_PC_conditions} 
                                        <h:panelGrid rendered="#{managedCredit.credit.mensualite gt 0}" columns="2" style="font-size: 0.9em;font-style: italic; color: #0099ff;float: right" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                            <span>#{lab.LM_PMC_mensualite} </span>
                                            <h:panelGroup style="float: right">
                                                <h:outputText value="#{managedCredit.credit.mensualite}" style="font-weight: bold" converter="DN" />
                                                Fcfa
                                            </h:panelGroup>
                                        </h:panelGrid>
                                    </span>
                                    <div style="width: 99.5%; border: solid 1px; height: #{managedCredit.credit.visibleVote?'257px':'225px'}; margin: auto;overflow-y: auto">
                                        <p:dataTable id="data_credit_condition" value="#{managedCredit.credit.conditions}" var="cond" rowIndexVar="condIdx" styleClass="yvs_table">
                                            <p:column headerText="N¬∞" style="width: 8%;text-align: center">
                                                <span>#{condIdx+1}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LM_PC_conditions}" >
                                                <span style="font-weight: bolder">#{cond.libelle} </span>
                                                <span>(#{cond.textCondition} '</span>
                                                <i>
                                                    <h:outputText style="color: blue" value="#{lab.LM_PC_parametre_incorrect}" rendered="#{(cond.valeurRequise!=null)?cond.valeurRequise=='':true}"/>
                                                    <h:outputText style="color: blue" value="#{cond.valeurRequise}" rendered="#{(cond.valeurRequise!=null)}" converter="DNA"/>
                                                    <span>#{cond.unite}</span>
                                                </i>
                                                <span title="#{cond.commentaire}">' #{cond.textCondition2} '</span>
                                                <i title="#{cond.commentaire}">
                                                    <h:outputText style="color: #{(!cond.correct)?'red':'green'}; font-weight: bold" value="#{cond.valeurEntree}" converter="DNA"/>
                                                    <span>#{cond.unite}</span>
                                                </i>
                                                <span>')</span>
                                            </p:column>
                                            <p:column headerText="OK" style="width: 7%;text-align: center">
                                                <h:graphicImage library="img"  name="#{(cond.correct)?'vu.png':'erase-128.png'}" width="15" height="15"/>
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                    <h:panelGrid id="situation_mut_credit" columns="6" style="width: 100%;font-style: italic; color: #006666; margin: 5px; font-size: 0.8em" 
                                                 styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                        <span>#{lab.LM_PC_endettement}:</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedCredit.credit.compte.mutualiste.montantCredit}" style="font-weight: bold" converter="DN" />
                                            Fcfa
                                        </h:panelGroup>
                                        <span>#{lab.LM_PEA_epargne_total}:</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedCredit.findMontantTotalEpargne(managedCredit.mutualiste.id)}" style="font-weight: bold" converter="DN" />
                                            Fcfa
                                        </h:panelGroup>
                                        <span>#{lab.LRH_PCC_salaire}:</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedCredit.credit.compte.mutualiste.montantSalaire}" style="font-weight: bold" converter="DN" />
                                            Fcfa
                                        </h:panelGroup>
                                        <f:facet name="footer">
                                            <p:outputPanel id="action_validation_participant" autoUpdate="true">
                                                <div style="float: left; width: 100%">
                                                    <p:progressBar value="#{100*managedCredit.credit.votesApprouve.size()/managedCredit.parametreMutuelle.nombreVoteRequis}" style="font-size: 0.8em;"
                                                                   labelTemplate="#{100*managedCredit.credit.votesApprouve.size()/managedCredit.parametreMutuelle.nombreVoteRequis}%" displayOnly="true" />
                                                </div>
                                                <h:panelGroup style="float: left;margin-top: 10px;width: 100%" rendered="#{managedCredit.credit.visibleVote}">
                                                    <p:commandLink actionListener="#{managedCredit.voteCredit(true)}" style="float: left;border: 2px solid #666; border-radius: 5px;">
                                                        <p:graphicImage library="icones" name="ic_sentiment_good.png" width="18" height="25"/>
                                                        <span style="float: right;margin-top: 3px">J'approuve (#{managedCredit.credit.votesApprouve.size()})</span>
                                                    </p:commandLink>
                                                    <p:spacer width="30" style="float: left" />
                                                    <p:commandLink actionListener="#{managedCredit.voteCredit(false)}" style="float: left;border: 2px solid #666; border-radius: 5px;">
                                                        <p:graphicImage library="icones" name="ic_sentiment_bad.png" width="18" height="25"/>
                                                        <span style="float: right;margin-top: 3px">#{lab.LM_PC_je_desapprouve} (#{managedCredit.credit.votesDeapprouve.size()})</span>
                                                    </p:commandLink>
                                                    <p:spacer width="20" style="float: left" />
                                                    <h:outputText value="#{managedCredit.displayProgressionVote()}" style="float: left;border: 2px solid #666; border-radius: 5px; font-size: 0.8em; padding: 1px" />                                                 
                                                    <span style="float: right;margin-top: 3px; font-size: 0.9em">(#{managedCredit.credit.nombreVoteRequis}) #{lab.LM_PC_vote_attendu}</span>
                                                </h:panelGroup>                                                
                                            </p:outputPanel>                                            
                                        </f:facet>
                                    </h:panelGrid>
                                </div> 
                            </p:outputPanel>
                        </div>
                        <div style="clear: both"/>
                        <p:tabView id="tabview_credit">
                            <p:tab title="Avalises">
                                <p:outputPanel id="blog_form_avalise">
                                    <div style="width: 35%;float: left">
                                        <h:inputHidden id="input_hide_reset_avalise" value="#{managedCredit.input_reset_avalise}"/>
                                        <h:panelGrid id="form_avalise" columns="2" styleClass="yvs_table" style="width : 100%" cellpadding="0" cellspacing="0">                                  
                                            <span>#{lab.LM_PTC_avaliste} </span> 
                                            <h:panelGroup id="txt_mutualiste_avalise">
                                                <h:inputText value="#{managedCredit.avalise.mutualiste.matricule}" style="color: #{managedCredit.avalise.mutualiste.error?'red':''}">
                                                    <p:ajax event="blur" global="false" listener="#{managedCredit.searchAvaliste()}" update="txt_mutualiste_avalise"/>
                                                </h:inputText>    
                                                <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LM_PC_liste_avaliste}" global="false"
                                                                 actionListener="#{managedCredit.initMutualistes(true)}" oncomplete="dlgMutualisteAvalise.show()"/> 
                                                <h:outputText value="#{managedCredit.avalise.mutualiste.employe.nom_prenom}" style="margin-left: 10px;color: #009999"/>
                                            </h:panelGroup>
                                            <span>#{lab.L_montant} :</span>
                                            <h:panelGroup id="txt_montant_avalise">
                                                <pe:inputNumber value="#{managedCredit.avalise.montant}" style="width: 50%"/>
                                                /
                                                <h:outputText value="#{managedCredit.avalise.mutualiste.currentCouvertureAvalise}" converter="DNA" style="font-weight: bold"/>
                                            </h:panelGroup>
                                            <f:facet name="footer">
                                                <p:commandButton value="#{lab.L_nouveau}" global="false" actionListener="#{managedCredit.resetFicheAvalise()}" 
                                                                 update="form_avalise" style="float: left"/>
                                                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedCredit.saveNewAvalise()}" 
                                                                 style="float: right" update="blog_form_avalise"/>                                            
                                            </f:facet>
                                        </h:panelGrid>
                                    </div>
                                    <div style="width: 64%;float: right">
                                        <h:inputHidden id="input_hide_avalise_id" value="#{managedCredit.tabIds_avalise}"/>
                                        <p:dataTable id="data_avalise_cr" value="#{managedCredit.credit.avalises}" var="aval" rowKey="#{aval.id}" rowIndexVar="avalIdx">
                                            <p:column headerText="N¬∞" style="width: 7%;text-align: center">
                                                <span>#{avalIdx+1}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LM_PM_mutualiste}">
                                                <span>#{aval.mutualiste.employe.prenom} #{aval.mutualiste.employe.nom}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LM_PM_montant_avalise}">
                                                <h:outputText value="#{aval.montant}" converter="DN" style="text-align: right"/>
                                            </p:column>
                                            <p:column width="20" style="text-align: center">
                                                <p:contextMenu for="option_avalise_credit" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCredit.deleteBeanAvalise(aval)}" update="data_avalise_cr"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="option_avalise_credit" type="button"/> 
                                            </p:column>
                                            <p:column style="width: 7%;text-align: center">
                                                <f:facet name="header">
                                                    <h:selectBooleanCheckbox styleClass="chek_all_line_avalise" value="false"
                                                                             onclick="selectionAllLineAvalise(#{managedCredit.credit.avalises.size()})">
                                                    </h:selectBooleanCheckbox>
                                                </f:facet>
                                                <h:selectBooleanCheckbox  value="#{aval.selectActif}" styleClass="chek_line_avalise" 
                                                                          onclick="selectionLineAvalise(#{aval.id})">
                                                </h:selectBooleanCheckbox>
                                            </p:column>
                                        </p:dataTable>  
                                    </div>
                                </p:outputPanel>                                
                                <div style="clear: both"/>
                            </p:tab>
                            <p:tab title="#{lab.LM_PC_plan_remboursement}" id="tab_echeancier">
                                <p:contextMenu for="tab_echeancier" rendered="#{managedCredit.credit.echeanciers.size() lt 1}">
                                    <p:menuitem icon="ui-icon-circle-plus" value="#{lab.LDB_PC_generer}" actionListener="#{managedCredit.genereEcheancier()}"/>
                                </p:contextMenu>
                                <p:dataTable id="data_echeancier" value="#{managedCredit.credit.echeanciers}" var="eche" selectionMode="single" 
                                             rowKey="#{eche.id}" selection="#{managedCredit.echeancierSelect}" rowIndexVar="eY">
                                    <p:ajax event="rowSelect"  listener="#{managedCredit.loadOnViewEcheancier}" oncomplete="collapseTab('credit');"
                                            />
                                    <p:ajax event="rowUnselect" global="false" listener="#{managedCredit.unLoadOnViewEcheancier}"  />                                          
                                    <p:column headerText="N¬∞" width="40" styleClass="statut_#{eche.etat}">
                                        <span> #{eY+1}</span>
                                        <h:graphicImage library="img" name="vu.png" width="15" height="15" rendered="#{eche.actif}" style="float: right"/>
                                    </p:column>
                                    <p:column headerText="Id" width="40" styleClass="statut_#{eche.etat}">
                                        <span> #{eche.id}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PC_debut_paiement}" style="text-align: center" styleClass="statut_#{eche.etat}" width="100">
                                        <h:outputText value="#{eche.dateEchellonage}" converter="DATE"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PES_montant_total}" style="text-align: right" styleClass="statut_#{eche.etat}">
                                        <h:outputText value="#{eche.montant}" converter="DNS"/>
                                    </p:column>
                                    <p:column headerText="#{lab.L_taux}" style="text-align: right" styleClass="statut_#{eche.etat}">
                                        <h:outputText value="#{eche.taux}" converter="DNS"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LP_PPG_duree} " style="text-align: center" styleClass="statut_#{eche.etat}">
                                        <h:outputText value="#{eche.dureeEcheance}" converter="DN"/><span> (Mois)</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PPG_interet}" style="text-align: right" styleClass="statut_#{eche.etat}">
                                        <h:outputText value="#{eche.montantInteret}" converter="DNS" style="text-align: right"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PTBC_avance}" style="text-align: right" styleClass="statut_#{eche.etat}">
                                        <h:outputText value="#{eche.montantVerse}" converter="DNS" style="text-align: right"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PTBC_reste}" style="text-align: right" styleClass="statut_#{eche.etat}">
                                        <h:outputText value="#{eche.montantReste}" converter="DNS" style="text-align: right"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PPG_interet}" style="text-align: right" styleClass="statut_#{eche.etat}">
                                        <h:outputText value="#{eche.creditRetainsInteret?lab.LRH_PC_retenue:lab.LCF_PRV_a_payer}" title="#{eche.creditRetainsInteret?lab.LM_PC_text:lab.LM_PC_text2}" />
                                    </p:column>
                                    <p:column width="20" style="text-align: center">
                                        <p:contextMenu for="option_echeance_credit" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                            <p:menuitem value="#{lab.LM_PC_reechelonner}" icon="ui-icon-circle-arrow-n" actionListener="#{managedCredit.onReecheancement(eche)}" rendered="#{eche.actif}"/>
                                            <p:menuitem value="#{lab.L_suspendre}" icon="ui-icon-circle-close" actionListener="#{managedCredit.suspendreEcheance(eche)}" update="data_echeancier" rendered="#{eche.actif}"/>
                                            <p:menuitem value="#{lab.L_activer}" icon="ui-icon-circle-check" actionListener="#{managedCredit.activeEcheance(eche)}" update="data_echeancier" rendered="#{managedCredit.onActiveEcheance(eche)}"/>
                                            <p:separator style="width: 98%;margin: auto"/>
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCredit.deleteEcheancier(eche)}" update="data_echeancier" rendered="#{eche.mensualites.size() lt 1}"/>
                                            <p:separator style="width: 98%;margin: auto"/>
                                            <p:menuitem value="#{lab.L_telecharger}" icon="ui-icon-print" global="false" actionListener="#{managedCredit.print(eche)}" ajax="false"/>
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="option_echeance_credit" type="button"/> 
                                    </p:column>
                                </p:dataTable>
                                <div style="clear: both"/>
                            </p:tab>
                            <p:tab title="#{lab.LM_PC_paiement_credit}" disabled="#{(managedCredit.credit.echeancier.mensualites.size() eq 0)?true:(managedCredit.credit.echeancier.mensualites.get(0).id le 0)}">
                                <p:outputPanel id="blog_form_reglementc_credit">
                                    <div style="width: 35%;float: left">
                                        <h:panelGrid id="form_reglementc_credit" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                            <f:facet name="header">                                                
                                                <h:panelGrid columns="5" style="float: left; font-size: 0.9em" id="zone_edit_mode_paiement_credit" styleClass="yvs_noStyle">
                                                    <h:selectOneRadio value="#{managedCredit.reglementc.modePaiement}" styleClass="yvs_noStyle" style="font-size: 0.8em; background: #FFF"
                                                                      valueChangeListener="#{managedCredit.loadCaisseByTypeOp}" layout="pageDirection" disabled="#{managedCredit.reglementc.id gt 0 or managedCredit.parametreMutuelle.paiementParCompteStrict}">
                                                        <f:selectItem itemValue="#{constantes.MUT_MODE_PAIEMENT_ESPECE}" itemLabel="#{constantes.MUT_MODE_PAIEMENT_ESPECE}" />
                                                        <f:selectItem itemValue="#{constantes.MUT_MODE_PAIEMENT_COMPTE}" itemLabel="#{constantes.MUT_MODE_PAIEMENT_COMPTE}" />
                                                        <p:ajax event="valueChange" update="zone_edit_mode_paiement_credit" global="false"/>
                                                    </h:selectOneRadio>
                                                    <span style="font-size: 0.8em">#{(managedCredit.reglementc.modePaiement eq constantes.MUT_MODE_PAIEMENT_COMPTE)?'':lab.L_caisse}</span>
                                                    <h:selectOneMenu value="#{managedCredit.reglementc.caisse.id}" style="width:140px" rendered="#{!(managedCredit.reglementc.modePaiement eq constantes.MUT_MODE_PAIEMENT_COMPTE)}">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedCredit.caisses}" var="cais" 
                                                                       itemLabel="#{cais.referenceCaisse}" itemValue="#{cais.id}"/>
                                                        <p:ajax event="valueChange" global="false" listener="#{managedCredit.chooseCaisse(true)}"/>
                                                    </h:selectOneMenu>
                                                    <span style="font-size: 0.8em">#{(managedCredit.reglementc.modePaiement eq constantes.MUT_MODE_PAIEMENT_ESPECE)?'':lab.L_compte} </span>
                                                    <h:selectOneMenu rendered="#{!(managedCredit.reglementc.modePaiement eq constantes.MUT_MODE_PAIEMENT_ESPECE)}" value="#{managedCredit.reglementc.compte.id}" style="width:140px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedCredit.mutualiste.comptes}" var="icmpt" 
                                                                       itemLabel="#{icmpt.reference}" itemValue="#{icmpt.id}" itemDisabled="#{icmpt.typeCompte.nature eq constantes.MUT_TYPE_COMPTE_EPARGNE}"/>
                                                        <p:ajax event="valueChange" global="false" />
                                                    </h:selectOneMenu>                                                    
                                                </h:panelGrid>
                                            </f:facet>
                                            <span>#{lab.LM_PC_regler_le}</span>
                                            <p:calendar value="#{managedCredit.reglementc.dateReglement}" pattern="dd-MM-yyyy" size="10"/>
                                            <span>#{lab.L_montant}</span>
                                            <p:inputText value="#{managedCredit.reglementc.montant}"/>
                                            <span>#{lab.L_total}</span>
                                            <p:inputText value="#{managedCredit.credit.montant}" disabled="true" converter="DNS" style="text-align: right"/>
                                            <span>#{lab.LCF_PCF_reste} </span>
                                            <p:inputText value="#{managedCredit.credit.montantReste}"  disabled="true" converter="DNS" style="text-align: right"/>
                                            <span>#{lab.LM_PC_regler_par}</span>
                                            <p:inputText value="#{managedCredit.reglementc.reglerPar}" style="width: 98%"/>
                                            <f:facet name="footer">
                                                <p:commandButton value="#{lab.L_nouveau}" actionListener="#{managedCredit.resetFicheReglementC()}"
                                                                 update="form_reglementc_credit" />
                                                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedCredit.saveNewReglementCredit()}" 
                                                                 style="float: right" update="date_reglementc_credit form_reglementc_credit" />
                                            </f:facet>
                                        </h:panelGrid>
                                        <div align="center" style="padding: 2px; width: 99%; background: #aaa; font-weight: bold; font-size: 0.8em">#{managedCredit.credit.echeancier.creditRetainsInteret?'Int√©r√™t retenu':''}</div>
                                    </div>
                                    <div style="margin-left: 35%;">
                                        <p:dataTable id="date_reglementc_credit" value="#{managedCredit.credit.reglements}" var="reglc"
                                                     rowKey="#{reglc.id}" rowIndexVar="rY" selectionMode="single" style="font-size: 0.8em">
                                            <p:ajax event="rowSelect" global="false" listener="#{managedCredit.loadOnViewReglementC}" 
                                                    update=":main_credit:tabview_credit:form_reglementc_credit"  />
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedCredit.unLoadOnViewReglementC}"
                                                    update=":main_credit:tabview_credit:form_reglementc_credit"/> 
                                            <p:column headerText="N¬∞" width="30" style="text-align: left; font-size: 0.9em" styleClass="statut_#{reglc.statutPiece}">
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{reglc.new_}"/>
                                                <span>#{rY+1}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PCV_date_reglement}" style="text-align: left" styleClass="statut_#{reglc.statutPiece}">
                                                <h:outputText value="#{reglc.dateReglement}" converter="DDMMYYYY"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_montant}" style="width: 17.5%;text-align: right" styleClass="statut_#{reglc.statutPiece}">
                                                <h:outputText value="#{reglc.montant}" converter="DN"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_caisse}" style="width: 20%;text-align: center" styleClass="statut_#{reglc.statutPiece}">
                                                <span>#{reglc.caisse.referenceCaisse}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.L_compte}" style="width: 20%;text-align: center" styleClass="statut_#{reglc.statutPiece}">
                                                <span>#{reglc.comptes.reference}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LCF_PRV_mode_paiement}" style="width: 15%;text-align: center" styleClass="statut_#{reglc.statutPiece}">
                                                <span>#{reglc.modePaiement}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.L_par}." style="width: 10%;text-align: center" styleClass="statut_#{reglc.statutPiece}">
                                                <span>#{reglc.reglePar}</span>
                                            </p:column>
                                            <p:column width="20" style="text-align: center">
                                                <p:contextMenu for="option_reglementc_credit" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCredit.deleteBeanReglementC(reglc)}" update="date_reglementc_credit"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="option_reglementc_credit" type="button"/> 
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                </p:outputPanel>
                                <div style="clear: both"/>
                            </p:tab>                            
                        </p:tabView>
                    </p:outputPanel>
                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="yvs_list_credit" style="width: 99%; margin: auto; background: white">
                    <h:inputHidden id="input_hide_credit" value="#{managedCredit.tabIds}"/>
                    <p:dataTable id="data_credit" value="#{managedCredit.credits}" var="cred" rowKey="#{cred.id}" rowIndexVar="credIdx"
                                 selection="#{managedCredit.creditSelect}" selectionMode="single" style="font-size: 0.9em">
                        <p:ajax event="rowSelect" global="false" listener="#{managedCredit.loadOnView}"  update=":main_credit:input_hide_credit"
                                oncomplete="collapseForm('credit');"
                                />
                        <p:column headerText="N¬∞" width="30" styleClass="statut_#{cred.etat}">                            
                            <span>#{credIdx+1}</span>
                            <h:graphicImage library="img" name="redo.png" width="15" height="15"  rendered="#{cred.new_}"/>
                            <h:graphicImage library="img" name="pointe.png" width="15" height="15"  rendered="#{cred.id eq managedCredit.credit.id}"/>
                        </p:column>                             
                        <p:column headerText="#{lab.L_numero}" sortBy="#{cred.reference}" styleClass="statut_#{cred.etat}">
                            <span>#{cred.reference}</span>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PSL_matricule}" sortBy="#{cred.reference}" styleClass="statut_#{cred.etat}">
                            #{cred.compte.mutualiste.employe.matricule} 
                            <h:panelGroup style="float: right">
                                <h:outputText title="#{lab.LM_PC_credit_rembourse}" value="R" rendered="#{cred.statutCredit == constantes.STATUT_DOC_PAYER}"
                                              style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                                <p:spacer width="2" rendered="#{cred.statutPaiement == constantes.STATUT_DOC_PAYER}"/>
                                <h:outputText title="#{lab.LM_PC_credit_paye}" value="P" rendered="#{cred.statutPaiement == constantes.STATUT_DOC_PAYER}"
                                              style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                            </h:panelGroup>
                        </p:column>
                        <p:column headerText="#{lab.LM_PM_mutualiste}" sortBy="#{cred.compte.mutualiste.employe.nom}" styleClass="statut_#{cred.etat}">                                    
                            #{cred.compte.mutualiste.employe.nom_prenom} 
                        </p:column>                                
                        <p:column headerText="#{lab.L_compte}" sortBy="#{cred.compte.reference}" styleClass="statut_#{cred.etat}">
                            <span>#{cred.compte.reference}</span>
                        </p:column>
                        <p:column headerText="#{lab.LM_PC_type_credit}" sortBy="#{cred.type.designation}" styleClass="statut_#{cred.etat}">
                            <span>#{cred.type.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.LM_PM_date_credit}" style="width: 12%;text-align: center" sortBy="#{cred.dateCredit}" styleClass="statut_#{cred.etat}">
                            <h:outputText value="#{cred.dateCredit}" converter="DATE"/>
                        </p:column>
                        <p:column headerText="#{lab.L_montant}" styleClass="statut_#{cred.etat}"  style="width: 12%;text-align: right">
                            <h:outputText value="#{cred.montant}" converter="DN"/>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PC_reste} " styleClass="statut_#{cred.etat}"  style="width: 12%;text-align: right">
                            <h:outputText value="#{cred.montantRestant}" converter="DN" title="#{lab.LM_PC_reste_rembourser}"/>
                        </p:column>
                        <p:column headerText="#{lab.LP_PPG_duree}" width="40" style="text-align: center" styleClass="statut_#{cred.etat}">
                            <span>#{cred.duree}</span>
                        </p:column>
                        <p:column headerText="#{lab.LM_PC_mens_svt}" width="40" style="text-align: center" styleClass="statut_#{cred.etat}">
                            <h:outputText value="#{managedCredit.giveNextmensualite(cred)}" converter="DATE" title="#{lab.LM_PC_date_mensualite_suivante}"/>
                        </p:column>
                        <p:column width="20" style="text-align: center">
                            <p:contextMenu for="option_credit" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                <p:menuitem value="#{lab.LM_PC_contraintes}" global="false" icon="ui-icon-notice" update=":form_dlgCondition_:data_credit_condition_" 
                                            oncomplete="dlgCondition.show()" actionListener="#{managedCredit.buildForContrainte(cred)}" rendered="#{cred.etat==constantes.ETAT_SOUMIS or cred.etat==constantes.ETAT_ENCOURS}"/>                             
                                <p:menuitem value="#{lab.LM_PC_anticiper}" icon="ui-icon-circle-plus" actionListener="#{managedCredit.loadMensualiteImpaye(cred)}" rendered="#{cred.etat==constantes.ETAT_VALIDE}" process="@this data_credit" />
                                <p:separator style="width: 98%;margin: auto"/>
                                <p:menuitem value="#{lab.LM_PC_situation_mutualiste}" icon="ui-icon-arrowthick-1-e" actionListener="#{managedCredit.onSelectSituationCompte(cred)}" global="false" />
                                <p:separator style="width: 98%;margin: auto"/>
                                <p:menuitem icon="ui-icon-arrowthick-1-e" value="#{lab.LM_PC_aller_echeance}" actionListener="#{managedCredit.onSelectEcheancier(cred)}" global="false"/>
                                <p:menuitem icon="ui-icon-carat-2-e-w" value="#{lab.LM_PC_equilibrer_statut}" actionListener="#{managedCredit.equilibre(cred)}" global="false" update="data_credit"/>
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCredit.deleteBean(cred)}" update="data_credit"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="option_credit" type="button"/> 
                        </p:column>
                        <p:column width="20" style="text-align: center">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_credit" value="false"
                                                         onclick="selectionAllLineTab(#{managedCredit.credits.size()}, 'credit')">
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox  value="#{cred.selectActif}" styleClass="chek_line_credit" 
                                                      onclick="selectionLineTab(#{credIdx}, 'credit')">
                            </h:selectBooleanCheckbox>
                        </p:column>
                    </p:dataTable>                                   
                    <span class="nbSelectcredit" style="font-size: .8em; font-style: italic; color: #828c95;"></span>                   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block" >
                        <p:commandButton actionListener="#{managedCredit.paginer(false)}" update="data_credit" icon="ui-icon-circle-triangle-w"  disabled="#{managedCredit.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedCredit.paginator.currentPage}/#{managedCredit.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton action="#{managedCredit.paginer(true)}" update="data_credit" icon="ui-icon-circle-triangle-e"  disabled="#{managedCredit.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedCredit.imax}" label="#{lab.L_nombre_max_resultat}" style="float: right; font-size: 0.9em;" 
                                         valueChangeListener="#{managedCredit.choosePaginator}">
                            <f:selectItems value="#{managedCredit.paginations}" />
                            <p:ajax event="valueChange" update="data_credit" />
                        </p:selectOneMenu>
                    </p:outputPanel>                                            
                </div> 
                <!-->
                 *****************************************************************************
                 Vue Des Echeanciers du credit
                 *****************************************************************************
                <-->
                <div class="yvs_tab_credit" style="width: 99%; margin: auto; background: white">
                    <p:outputPanel id="blog_echeancier_credit" >
                        <div style="width: 100%; border: solid 2px; height: 385px; padding: 2px; border-radius: 5px;margin-top: 5px">
                            <span style="display: inline-block; background: #CCC; width: 100%">
                                <span style="display: inline-block; float: left; font-weight: bold">#{lab.LM_PC_mensualites} </span>
                                <h:panelGrid columns="7" style="margin-left: 2%; font-size: 0.8em; float: left" id="zone_edit_mode_paiement_mes_credit">                                    
                                    <h:selectOneRadio value="#{managedCredit.reglement.modePaiement}" styleClass="yvs_noStyle" style="margin-left: 10px; font-size: 0.8em"
                                                      valueChangeListener="#{managedCredit.loadCaisseByTypeOp}"  layout="PageDirection">
                                        <f:selectItem itemValue="#{constantes.MUT_MODE_PAIEMENT_ESPECE}" itemLabel="#{constantes.MUT_MODE_PAIEMENT_ESPECE}" />
                                        <f:selectItem itemValue="#{constantes.MUT_MODE_PAIEMENT_COMPTE}" itemLabel="#{constantes.MUT_MODE_PAIEMENT_COMPTE}" />
                                        <p:ajax event="valueChange" update="zone_edit_mode_paiement_mes_credit" global="false"/>
                                    </h:selectOneRadio>
                                    <span >#{!(managedCredit.reglement.modePaiement eq constantes.MUT_MODE_PAIEMENT_COMPTE)?'Caisse':''}</span>
                                    <h:selectOneMenu rendered="#{!(managedCredit.reglement.modePaiement eq constantes.MUT_MODE_PAIEMENT_COMPTE)}" 
                                                     value="#{managedCredit.reglement.caisse.id}" style="width:140px">
                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                        <f:selectItems value="#{managedCredit.caisses}" var="cais" 
                                                       itemLabel="#{cais.referenceCaisse}" itemValue="#{cais.id}"/>
                                        <p:ajax event="valueChange" global="false" listener="#{managedCredit.chooseCaisse(false)}"/>
                                    </h:selectOneMenu>   
                                    <span>#{!(managedCredit.reglement.modePaiement eq constantes.MUT_MODE_PAIEMENT_ESPECE)?'Compte':''}</span>
                                    <h:selectOneMenu rendered="#{!(managedCredit.reglement.modePaiement eq constantes.MUT_MODE_PAIEMENT_ESPECE)}" 
                                                     value="#{managedCredit.reglement.compte.id}" style="width:140px" >
                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                        <f:selectItems value="#{managedCredit.mutualiste.comptes}" var="icmpt" 
                                                       itemLabel="#{icmpt.reference}" itemValue="#{icmpt.id}" itemDisabled="#{(icmpt.typeCompte.nature eq constantes.MUT_TYPE_COMPTE_EPARGNE and !managedCredit.parametreMutuelle.acceptRetraitEpargne)}"/>
                                        <p:ajax event="valueChange" global="false" update="txt_reg_solde_compte"/>
                                    </h:selectOneMenu>
                                    <span>#{lab.LDB_PU_solde}: </span>
                                    <h:outputText style="font-weight: bold" id="txt_reg_solde_compte" value="#{managedCredit.findSoldeCompte(managedCredit.reglement.compte.id)}" converter="DN" />
                                </h:panelGrid>
                                <h:panelGrid columns="4" styleClass="yvs_nostyle" style="float: right" cellpadding="0" cellspacing="0">
                                    <h:panelGroup>
                                        <span>#{lab.L_total} :  </span>
                                        <h:outputText style="font-weight: bold" value="#{managedCredit.echeancierSelect.montant}" converter="DN"/> 
                                        <span style="font-size: 0.8em"> Fcfa</span>
                                    </h:panelGroup>
                                    <h:panelGroup>
                                        <span>#{lab.LM_PPG_interet} :  </span>
                                        <h:outputText style="font-weight: bold" value="#{managedCredit.echeancierSelect.montantInteret}" converter="DN"/> 
                                        <span style="font-size: 0.8em"> Fcfa</span>
                                    </h:panelGroup>
                                    <h:panelGroup>
                                        <span>#{lab.LM_PC_charge} :  </span>
                                        <h:outputText style="font-weight: bold" value="#{managedCredit.echeancierSelect.montantInteret + credit.fraisAdditionnel}" converter="DN"/> 
                                        <span style="font-size: 0.8em"> Fcfa</span>
                                    </h:panelGroup>
                                    <h:panelGroup>
                                        <span>#{lab.LCF_PCF_reste} :  </span>
                                        <h:outputText style="font-weight: bold" value="#{managedCredit.echeancierSelect.montantReste}" converter="DN" id="zone_stat_cr_reste"/> 
                                        <span style="font-size: 0.8em"> Fcfa</span>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </span>
                            <div style="width: 99.5%; border: solid 1px;height: 330px; margin: auto;overflow-y: auto">
                                <p:dataTable id="date_mensualite_echeancier" value="#{managedCredit.credit.echeancier.mensualites}" var="mens"
                                             rowKey="#{mens.id}" rowIndexVar="mens_Idx" selectionMode="single">
                                    <p:ajax event="rowSelect" global="false" listener="#{managedCredit.loadOnViewMensualite}"/>
                                    <p:ajax event="rowUnselect" global="false" listener="#{managedCredit.unLoadOnViewMensualite}"/> 
                                    <p:column headerText="N¬∞" width="50" style="text-align: left; font-size: 0.9em" styleClass="statut_#{mens.etat}"> 
                                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{mens.new_}"/>
                                        <span>#{mens_Idx+1}</span>
                                    </p:column>
                                    <p:column headerText="Id" width="50" style="text-align: center; font-size: 0.9em" styleClass="statut_#{mens.etat}"> 
                                        <span>#{mens.id}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PRS_date_echeance}" style="text-align: center" styleClass="statut_#{mens.etat}">
                                        <h:outputText value="#{mens.dateMensualite}" converter="DDMMYYYY"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PMC_mensualite}" style="width: 17.5%;text-align: right" styleClass="statut_#{mens.etat}">
                                        <h:outputText value="#{mens.montantReel}" converter="DN"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PC_amortissement}" style="width: 17.5%;text-align: right" styleClass="statut_#{mens.etat}">
                                        <h:outputText value="#{mens.amortissement}" converter="DN"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PPG_interet}" style="width: 15%;text-align: right" styleClass="statut_#{mens.etat}">
                                        <h:outputText value="#{mens.interet}" converter="DN"/>
                                        <h:graphicImage library="img" name="vu.png" width="15" height="15" rendered="#{managedCredit.credit.echeancier.creditRetainsInteret}" />
                                    </p:column>
                                    <p:column headerText="#{lab.LDB_PC_reste_a_payer}" style="width: 17.5%;text-align: right" styleClass="ligth">
                                        <h:outputText value="#{mens.montantReste}" converter="DN"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PC_capital_restant}" style="width: 17.5%;text-align: right" styleClass="statut_#{mens.etat}">
                                        <h:outputText value="#{managedCredit.getResteCapital(false, mens.amortissement, mens_Idx eq 0)}" converter="DN"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LM_PC_dette_restante}" style="width: 17.5%;text-align: right" styleClass="statut_#{mens.etat}">
                                        <h:outputText value="#{managedCredit.getReste(false, mens.montant, mens.interet, mens_Idx eq 0)}" converter="DN"/>
                                    </p:column>
                                    <p:column width="20" style="text-align: center">
                                        <p:contextMenu for="option_mensualite_credit" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                            <p:menuitem value="#{lab.LM_PC_regler}" global="false" icon="ui-icon-circle-check" actionListener="#{managedCredit.saveNewReglementMensualite(mens)}" rendered="#{mens.montantReste gt 0 and mens.etat!=constantes.ETAT_SUSPENDU}"
                                                        />
                                            <p:menuitem value="#{ab.LRH_PRS_reporter}" global="false" icon="ui-icon-circle-arrow-n" actionListener="#{managedCredit.openViewReport(mens)}" rendered="#{mens.etat==constantes.ETAT_ATTENTE}"
                                                        />
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCredit.deleteBeanMensualite(mens)}" update="date_mensualite_echeancier" rendered="#{mens.etat==constantes.ETAT_ATTENTE}"
                                                        />
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="option_mensualite_credit" type="button" disabled="#{mens.id le 0}"/> 
                                    </p:column>
                                </p:dataTable>
                            </div>   
                        </div> 
                        <div id="zone_show_reglement_credit" style="width: 100%; border: solid 2px; height: 280px; padding: 2px; border-radius: 5px;margin-top: 5px">
                            <span style="display: inline-block; background: #CCC; width: 100%;cursor: pointer" onclick="slideShow('zone_show_reglement_credit', 250)">
                                <span class="button_slide">[-]</span>
                                #{lab.LC_PCV_reglements}
                            </span>
                            <div class="zone_slide" style="width: 99.5%; border: solid 1px;">
                                <div style="width: 30%;float: left">
                                    <h:panelGrid id="form_reglement_credit" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                        <span>#{lab.LM_PC_regler_le}</span>
                                        <h:panelGroup>
                                            <p:calendar value="#{managedCredit.reglement.dateReglement}" pattern="dd-MM-yyyy" size="10"/>
                                            <h:outputText value="#{managedCredit.reglement.id}" style="float: right; padding: 3px; border: 1px solid #333" />
                                        </h:panelGroup>
                                        <span>#{lab.L_montant}</span>
                                        <pe:inputNumber value="#{managedCredit.reglement.montant}"/>
                                        <span>#{lab.L_total}</span>
                                        <p:inputText value="#{managedCredit.credit.echeancier.montant}" disabled="true" style="text-align: right" converter="DN"/>
                                        <span>#{lab.LCF_PC_reste}</span>
                                        <p:inputText value="#{managedCredit.credit.echeancier.montantReste}" disabled="true" style="text-align: right" converter="DN"/>
                                        <span>#{lab.LM_PC_regler_par}</span>
                                        <p:inputText value="#{managedCredit.reglement.reglerPar}" style="width: 98%"/>
                                        <f:facet name="footer">
                                            <p:commandButton value="#{lab.L_nouveau}" actionListener="#{managedCredit.resetFicheReglement()}"  />
                                            <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedCredit.saveNewReglementMensualite()}"  
                                                             style="float: right" update="date_reglement_mensualite_credit form_reglement_credit zone_stat_cr_reste" disabled="#{managedCredit.credit.etatValidation != constantes.ETAT_VALIDE}"/>
                                        </f:facet>
                                    </h:panelGrid>
                                </div>
                                <div style="margin-left: 31%;width: 69%">
                                    <div style="height: 235px; margin: auto;overflow-y: auto">
                                        <p:dataTable id="date_reglement_mensualite_credit" value="#{managedCredit.credit.echeancier.reglements}" var="regl"
                                                     rowKey="#{regl.id}" rowIndexVar="rY" selectionMode="single">
                                            <p:ajax event="rowSelect" global="false" listener="#{managedCredit.loadOnViewReglement}"/>
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedCredit.unLoadOnViewReglement}"/> 
                                            <p:column headerText="N¬∞" width="30" style="text-align: left; font-size: 0.9em" styleClass="statut_#{regl.statutPiece}">
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{regl.new_}"/>
                                                <span>#{rY+1}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PFA_date_reglement}" style="text-align: left" styleClass="statut_#{regl.statutPiece}">
                                                <h:outputText value="#{regl.dateReglement}" converter="DDMMYYYY"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_montant}" style="width: 17.5%;text-align: right" styleClass="statut_#{regl.statutPiece}">
                                                <h:outputText value="#{regl.montant}" converter="DNS"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_caisse}" style="width: 15%;text-align: center" styleClass="statut_#{regl.statutPiece}">
                                                <span>#{regl.caisse.referenceCaisse}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.L_par}." style="width: 15%;text-align: center" styleClass="statut_#{regl.statutPiece}">
                                                <span>#{regl.reglePar}</span>
                                            </p:column>
                                            <p:column width="20" style="text-align: center">
                                                <p:contextMenu for="option_reglement_credit" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" actionListener="#{managedCredit.deleteBeanReglement(regl)}" update="date_reglement_mensualite_credit"
                                                                />
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="option_reglement_credit" type="button"/> 
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                </div>
                            </div>
                        </div> 
                    </p:outputPanel>
                </div>

                <!-->
                 *****************************************************************************
                 Vue Attrib
                 *****************************************************************************
                <-->
                <div class="yvs_grid_credit" style="width: 100%; margin: auto; background: white">                    
                </div> 
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false">
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative" width="20" height="20"
                            styleClass="img_slide" title="#{lab.L_cacher}"/>                    
            <div class="zone_find">                                                              
                <h:panelGrid columns="6" style="font-size: 0.8em; float: left">
                    <h:outputText value="&nbsp;" />
                    <h:outputText value="#{lab.L_date}" />
                    <h:outputText value="#{lab.L_reference} " />
                    <h:outputText value="#{lab.L_type} " />  
                    <h:outputText value="#{lab.L_statut} " />  
                    <span>&nbsp;</span>
                    <p:commandButton icon="ui-icon-bullet" title="#{lab.LM_PC_reset_param}" actionListener="#{managedCredit.clearParams()}" oncomplete="collapseList('credit')"
                                     style="width: 22px; height: 22px; border-radius: 15px"/>
                    <h:panelGroup>
                        <h:selectBooleanCheckbox value="#{managedCredit.dateSearch}">
                            <p:ajax event="valueChange" listener="#{managedCredit.addParamDates()}" update="dates_search_credit" oncomplete="collapseList('credit')"/>
                        </h:selectBooleanCheckbox>
                        <h:panelGroup id="dates_search_credit" style="margin-top: -2px;float: right">
                            <p:calendar value="#{managedCredit.debutSearch}" navigator="true" pattern="dd-MM-yyyy" size="10" disabled="#{!managedCredit.dateSearch}">
                                <p:ajax event="dateSelect" listener="#{managedCredit.addParamDates()}" oncomplete="collapseList('credit')"/>
                            </p:calendar>
                            <p:calendar value="#{managedCredit.finSearch}" navigator="true" pattern="dd-MM-yyyy" size="10" disabled="#{!managedCredit.dateSearch}">
                                <p:ajax event="dateSelect" listener="#{managedCredit.addParamDates()}" oncomplete="collapseList('credit')"/>
                            </p:calendar>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:inputText value="#{managedCredit.numSearch}" >
                        <p:ajax event="keyup" listener="#{managedCredit.addParamReference()}" oncomplete="collapseList('credit')" />
                    </h:inputText>
                    <h:selectOneMenu value="#{managedCredit.typeSearch}">
                        <f:selectItem itemValue="0" itemLabel="#{lab.L_tout}" /> 
                        <f:selectItem itemValue="0" itemLabel="--" /> 
                        <f:selectItems value="#{managedTypeCredit.types}" var="typ" itemValue="#{typ.id}" itemLabel="#{typ.designation}" /> 
                        <p:ajax event="valueChange" listener="#{managedCredit.addParamType()}" oncomplete="collapseList('credit')"/>
                    </h:selectOneMenu>
                    <h:selectOneMenu value="#{managedCredit.statutSearch}">
                        <f:selectItem itemValue="#{null}" itemLabel="#{lab.L_tout}" /> 
                        <f:selectItem itemValue="" itemLabel="--" /> 
                        <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                        <f:selectItem itemLabel="#{lab.LC_PTS_transmis}" itemValue="#{constantes.ETAT_SOUMIS}"/>
                        <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                        <f:selectItem itemLabel="#{lab.L_valide}" itemValue="#{constantes.ETAT_VALIDE}"/>
                        <f:selectItem itemLabel="#{lab.L_annule}" itemValue="#{constantes.ETAT_ANNULE}"/>
                        <f:selectItem itemLabel="#{lab.LM_PC_relance}" itemValue="#{constantes.ETAT_RELANCE}"/>
                        <f:selectItem itemLabel="#{lab.LCF_POD_payer.toUpperCase()}" itemValue="#{constantes.ETAT_REGLE}"/>
                        <p:ajax event="valueChange" listener="#{managedCredit.addParamStatut()}" oncomplete="collapseList('credit')"/>
                    </h:selectOneMenu>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>

