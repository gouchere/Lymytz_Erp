<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Type Crédit','modMutuelle', 'smenTypeCredit', true,managedTypeCredit)}
    </ui:define>   
    <ui:define name="contents"> 
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 140);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('type_credit_');
            });
        </script> 
        #{managedTypeCredit.loadAll()}
        #{managedTypeCout.loadAll(constantes.MOD_MUT)}
        <h:form>
            <p:remoteCommand name="updateBeanGrilletaux_" global="false" actionListener="#{managedTypeCredit.updateBeanGrille()}"/>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmCreate" closeOnEscape="true"
                             message="#{lab.LM_PTC_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" onclick="dlgConfirmCreate.hide()" oncomplete="dlgAddExercice.show()" global="false"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmCreate.hide()"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="Création d'type_credit_" widgetVar="dlgAddExercice" 
                      width="25%" modal="true" closeOnEscape="true">
                <h:panelGrid columns="1" styleClass="yvs_table" style="width: 100%">
                    <h:panelGrid columns="2" styleClass="yvs_table" style="width: 98%;margin: auto"> 
                        <span>#{lab.L_reference} </span>  
                        <h:inputText value="#{beanExercice.reference}"/>
                        <span>#{lab.L_date_debut} </span> 
                        <p:calendar value="#{beanExercice.dateDebut}" navigator="true" pattern="dd-MM-yyyy"/>
                        <span>#{lab.L_date_fin} </span>
                        <p:calendar value="#{beanExercice.dateFin}" navigator="true" pattern="dd-MM-yyyy"/>
                        <span>#{lab.L_actif} </span>
                        <h:selectBooleanCheckbox value="#{beanExercice.actif}"/>
                    </h:panelGrid>
                    <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedExercice.saveNew()}"
                                     oncomplete="dlgAddExercice.hide()" style="width: 100%"/> 
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy; Lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>        
        <!-->
        *****************************************************************************
        Boite de dialogue de type cout
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFA_creation_type}" widgetVar="dlgAddTypeCout" modal="true" width="25%"  closeOnEscape="true"> 
                <h:panelGrid id="form_type_cout_type_credit" columns="1" cellpadding="0" cellspacing="0" style="width: 100%">
                    <h:inputText value="#{managedTypeCout.typeCout.libelle}" style="width: 100%"/>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddTypeCout.hide()" actionListener="#{managedTypeCout.saveNew()}" 
                                 update=":main_type_credit_:tabview_type_credit:select_type_frais_type_credit"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PFA_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedTypeCredit.deleteBean()}" oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->

        <h:form prependId="false" id="main_type_credit_">   
            <div class="part_fix">
                <p:splitButton value="#{lab.L_enregistrer}" id="save_type_credit_" actionListener="#{managedTypeCredit.saveNew()}"
                               update="blog_form_type_credit_ data_type_credit_">
                    <p:menuitem value="#{lab.L_nouveau}" id="cancel_type_credit_" global="false" actionListener="#{managedTypeCredit.resetFiche()}" update="blog_form_type_credit_"/>
                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" oncomplete="dlgConfirmDelete.show()" />
                </p:splitButton>
                <p:commandButton value="#{lab.L_supprimer}" icon="ui-icon-trash" id="delete_type_credit_" global="false" oncomplete="dlgConfirmDelete.show()" />
                <div style="float: right">
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('type_credit_');
                            return false">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;" />
                    </h:link>               
                    <p:spacer />
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('type_credit_');
                            return false" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;" />
                    </h:link>   
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_type_credit_">
                    <h:inputHidden id="input_hide_reset_type_credit_" value="#{managedTypeCredit.input_reset}"/>
                    <p:outputPanel id="blog_form_type_credit_" style="width: 99%; margin: auto; background: white">   
                        <div style="width: 39%;float: left"> 
                            <h:panelGrid id="form_type_credit_" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                <f:facet name="header">
                                    <div align="left">
                                        <h:panelGroup>
                                            <span>#{lab.L_code} </span>
                                            <h:inputText value="#{typeCredit.code}"/>
                                        </h:panelGroup>
                                        <span style="display: inline-block; float: right">
                                            <span>#{lab.LM_PTC_titre} </span>
                                            <h:inputText value="#{typeCredit.designation}" />  
                                        </span>
                                    </div>
                                </f:facet>                                        
                                <span>#{lab.LM_PTC_montant_plafone} </span>                                        
                                <h:panelGroup>
                                    <h:inputText value="#{typeCredit.montantMaximal}" style="width: 100px"/>
                                    <h:selectOneMenu value="#{typeCredit.natureMontant}" styleClass="yvs_nostyle"  >
                                        <f:selectItem itemLabel="#{lab.LM_PPG_fixe}" itemValue="Fixe" />
                                        <f:selectItem itemLabel="% #{ab.LM_PTC_revenue}" itemValue="Pourcentage" />
                                        <p:ajax event="valueChange" global="false" listener="#{managedTypeCredit.chooseNatureMontant()}"/>
                                    </h:selectOneMenu>
                                </h:panelGroup>
                                <span>#{lab.LM_PTC_taux_interet}</span>                                      
                                <h:panelGroup>
                                    <h:inputText value="#{typeCredit.tauxMaximal}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_taux_maximale_interet}"/>
                                    <span> %</span>
                                </h:panelGroup>
                                <span>#{lab.LM_PTC_periode_max} </span>                                
                                <h:panelGroup>
                                    <h:inputText value="#{typeCredit.periodeMaximal}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_periode_maximale_remboursement}"/>
                                    <span> #{lab.L_mois}</span>
                                </h:panelGroup>
                                <span>#{lab.LM_PTC_coefficient_cessible_salaire} </span>                                
                                <h:panelGroup>                                    
                                    <p:spinner value="#{typeCredit.coefficientRemboursement}" min="0" max="1" style="width: 50px; text-align: center"/>                                    
                                    <span> (valeur entre 0 et 1)</span>
                                </h:panelGroup>
                                <span title="#{lab.LM_PTC_text1}...">#{lab.LM_PTC_nombre_minimale_avalistes}... </span>                                                                
                                <h:panelGroup>
                                    <h:inputText value="#{typeCredit.nbreAvalise}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_text1}..."/>
                                    <span> #{lab.LM_PTC_avalistes}</span>
                                </h:panelGroup>
                                <span>#{lab.LM_PTC_report_credit} </span>
                                <h:selectBooleanCheckbox value="#{typeCredit.impayeDette}"
                                                         title="#{lab.LM_PTC_text2}"/>  
                                <span>#{lab.LM_PTC_pour_assistance} </span>
                                <h:selectBooleanCheckbox value="#{typeCredit.assistance}"
                                                         title="#{lab.LM_PTC_text3}"/>       
                                <span>#{lab.LM_PTC_periode_remboursement} </span>                                                                                             
                                <h:panelGroup>
                                    <h:inputText value="#{typeCredit.periodicite}" style="width: 100px;text-align: center" title="#{lab.LM_PTC_periode_maximale_remboursement}"/>
                                    <span > #{lab.L_mois}</span>
                                </h:panelGroup>
                                <f:facet name="footer">

                                </f:facet>
                            </h:panelGrid>    
                            <h:panelGrid columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">
                                <f:facet name="header">
                                    <div style="float: left;width: 45.5%;text-align:left">#{lab.LM_PTC_type_mensualite}</div>
                                    <div style="margin-left: 40%;width: 50.5%;text-align:left">#{lab.LM_PTC_formule_interet}</div>
                                </f:facet>
                                <p:selectOneRadio value="#{typeCredit.typeMensualite}" layout="pageDirection" styleClass="yvs_noStyle" style="font-size: 0.9em">
                                    <f:selectItems value="#{constantes.MUT_TYPE_MENSUALITE}" var="tm" itemLabel="#{tm.label}" itemValue="#{tm.value}" />
                                </p:selectOneRadio>                                        
                                <h:panelGrid columns="1" styleClass="yvs_nostyle">                                            
                                    <p:selectOneRadio value="#{typeCredit.formuleInteret}" layout="lineDirection" styleClass="yvs_noStyle" style="font-size: 0.9em">
                                        <f:selectItems value="#{constantes.MUT_FORMULE_INTERET}" var="fi" itemLabel="#{fi.label}" itemValue="#{fi.value}" />
                                    </p:selectOneRadio>
                                </h:panelGrid>
                            </h:panelGrid>                     
                        </div>
                        <div style="width: 60%;margin-left: 40%"> 
                            <h:panelGrid columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">
                                <f:facet name="header">
                                    <div align="left" style="float: left">#{lab.LM_PTC_modele_remboursement}</div>
                                </f:facet>
                                <p:selectOneRadio value="#{typeCredit.modelRemboursement}" layout="pageDirection" styleClass="yvs_noStyle" style="font-size: 0.9em">   
                                    <f:selectItems value="#{constantes.MUT_MODEL_REMBOURSEMENT}" var="mr" itemLabel="#{mr.label}" itemValue="#{mr.value}" />  
                                    <p:ajax event="valueChange" update="blog_retard_credit"/>
                                </p:selectOneRadio> 
                                <h:panelGroup id="blog_retard_credit">
                                    <div style="background: #CCC;width: 100%;margin: auto;margin-bottom: 5px">
                                        <p:selectBooleanCheckbox value="#{typeCredit.penaliteRetard}" disabled="#{typeCredit.modelRemboursement != constantes.MODEL_REMBOURSEMENT_STRICT}">
                                            <p:ajax event="valueChange" update="blog_penalite_retard_credit"/>
                                        </p:selectBooleanCheckbox>
                                        <span style="font-weight: bold">#{lab.LM_PTC_appliquer_penalite_pour_absence_retard}</span>
                                    </div>
                                    <h:panelGroup id="blog_penalite_retard_credit">
                                        <h:selectOneMenu value="#{typeCredit.naturePenaliteRetard}" disabled="#{!typeCredit.penaliteRetard}">
                                            <f:selectItem itemLabel="#{lab.L_taux.toUpperCase()}" itemValue="#{constantes.NATURE_POURCENTAGE}" />
                                            <f:selectItem itemLabel="#{lab.L_montant.toUpperCase()}" itemValue="#{constantes.NATURE_MONTANT}" />
                                            <p:ajax event="valueChange" global="false" update="blog_penalite_retard_credit"/>
                                        </h:selectOneMenu> 
                                        <h:inputText value="#{typeCredit.tauxPenaliteRetard}" style="width: 50px;text-align: right" disabled="#{!typeCredit.penaliteRetard}"/>
                                        <h:outputText value="%" rendered="#{typeCredit.naturePenaliteRetard == constantes.NATURE_POURCENTAGE}"/>
                                        <h:panelGroup style="float: right">
                                            <span> #{lab.LM_PTC_sur} </span>
                                            <h:selectOneMenu value="#{typeCredit.basePenaliteRetard}" disabled="#{!typeCredit.penaliteRetard}">
                                                <f:selectItem itemLabel="#{lab.LM_PTC_mensualites_echu}" itemValue="#{constantes.PENALITE_BASE_MENSUALITE}" />
                                                <f:selectItem itemLabel="#{lab.LM_PTC_interet_mensualites_echu}" itemValue="#{constantes.PENALITE_BASE_INTERET}" />
                                            </h:selectOneMenu>                                                 
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </h:panelGroup>
                            </h:panelGrid>   
                            <h:panelGrid columns="2" styleClass="yvs_table" cellpadding="0" cellspacing="0" style="width: 100%">
                                <f:facet name="header">
                                    <div align="left">#{lab.LM_PTC_action_possible_en_cours}</div>
                                </f:facet>
                                <span title="#{lab.LM_PTC_possibilite_reechelonner_credit}">#{lab.LM_PTC_reechelonner_credit}</span>                                        
                                <p:selectBooleanCheckbox value="#{typeCredit.reechellonagePossible}" />
                                <span title="#{lab.LM_PTC_possibilite_fusionner_credit}">#{lab.LM_PTC_fusionner_credit}</span>                                        
                                <p:selectBooleanCheckbox value="#{typeCredit.fusionPossible}" />
                                <h:panelGroup>
                                    <span title="#{lab.LM_PTC_possibilite_anticiper_reglement}">#{lab.LM_PTC_anticiper_reglement}</span>                                        
                                    <p:selectBooleanCheckbox value="#{typeCredit.anticipationPossible}" style="float: right">
                                        <p:ajax event="valueChange" update="blog_anticipation_credit"/>                                    
                                    </p:selectBooleanCheckbox>
                                </h:panelGroup>
                                <h:panelGroup id="blog_anticipation_credit">
                                    <div style="background: #CCC;width: 100%;margin: auto;margin-bottom: 5px;margin-top: 4px">
                                        <p:selectBooleanCheckbox value="#{typeCredit.penaliteAnticipation}" disabled="#{!typeCredit.anticipationPossible}">
                                            <p:ajax event="valueChange" update="blog_anticipation_credit"/>                                    
                                        </p:selectBooleanCheckbox>
                                        <span style="font-weight: bold">#{lab.LM_PTC_appliquer_penalite}</span>
                                    </div>
                                    <h:panelGroup id="blog_taux_penalite_anticipation" rendered="#{typeCredit.anticipationPossible and typeCredit.penaliteAnticipation}">
                                        <h:selectOneMenu value="#{typeCredit.naturePenaliteAnticipation}">
                                            <f:selectItem itemLabel="#{lab.L_taux.toUpperCase()}" itemValue="#{constantes.NATURE_POURCENTAGE}" />
                                            <f:selectItem itemLabel="#{lab.L_montant.toUpperCase()}" itemValue="#{constantes.NATURE_MONTANT}" />
                                            <p:ajax event="valueChange" global="false" update="blog_taux_penalite_anticipation"/>
                                        </h:selectOneMenu> 
                                        <h:inputText value="#{typeCredit.tauxPenaliteAnticipation}" style="width: 50px;text-align: right"/>
                                        <h:outputText value="%" rendered="#{typeCredit.naturePenaliteAnticipation == constantes.NATURE_POURCENTAGE}"/>
                                        <h:panelGroup style="float: right">
                                            <span> #{lab.LM_PTC_sur} </span>
                                            <h:selectOneMenu value="#{typeCredit.basePenaliteAnticipation}">
                                                <f:selectItems value="#{constantes.MUT_BASE_PENALITE}" var="ba" itemLabel="#{ba.label}" itemValue="#{ba.value}" />  
                                            </h:selectOneMenu>                                               
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </h:panelGroup>
                                <h:panelGroup>
                                    <span title="#{lab.LM_PTC_possibilite_suspendre_mentualite}">#{lab.LM_PTC_suspendre_mentualite}</span>                                        
                                    <p:selectBooleanCheckbox value="#{typeCredit.suspensionPossible}" style="float: right" >
                                        <p:ajax event="valueChange" update="blog_suspension_credit"/>                                    
                                    </p:selectBooleanCheckbox>
                                </h:panelGroup>
                                <h:panelGroup id="blog_suspension_credit">
                                    <div style="background: #CCC;width: 100%;margin: auto;margin-bottom: 5px;margin-top: 4px">
                                        <p:selectBooleanCheckbox value="#{typeCredit.penaliteSuspension}" disabled="#{!typeCredit.suspensionPossible}">
                                            <p:ajax event="valueChange" update="blog_suspension_credit"/>                                    
                                        </p:selectBooleanCheckbox>
                                        <span style="font-weight: bold">#{lab.LM_PTC_appliquer_penalite}</span>
                                    </div>
                                    <h:panelGroup id="blog_taux_penalite_suspension" rendered="#{typeCredit.suspensionPossible and typeCredit.penaliteSuspension}">
                                        <h:selectOneMenu value="#{typeCredit.naturePenaliteSuspension}">
                                            <f:selectItem itemLabel="#{lab.L_taux.toUpperCase()}" itemValue="#{constantes.NATURE_POURCENTAGE}" />
                                            <f:selectItem itemLabel="#{lab.L_montant.toUpperCase()}" itemValue="#{constantes.NATURE_MONTANT}" />
                                            <p:ajax event="valueChange" global="false" update="blog_taux_penalite_suspension"/>
                                        </h:selectOneMenu> 
                                        <h:inputText value="#{typeCredit.tauxPenaliteSuspension}" style="width: 50px;text-align: right"/>
                                        <h:outputText value="%" rendered="#{typeCredit.naturePenaliteSuspension == constantes.NATURE_POURCENTAGE}"/>
                                        <h:panelGroup style="float: right">
                                            <span> #{lab.LM_PTC_sur} </span>
                                            <h:selectOneMenu value="#{typeCredit.basePenaliteSuspension}">
                                                <f:selectItems value="#{constantes.MUT_BASE_PENALITE}" var="bs" itemLabel="#{bs.label}" itemValue="#{bs.value}" />  
                                            </h:selectOneMenu>                                             
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </h:panelGroup>
                                <f:facet name="footer">

                                </f:facet>
                            </h:panelGrid>
                        </div>
                        <div style="clear: both"/>
                        <p:tabView id="tabview_type_credit">
                            <p:tab title="#{lab.LM_PTC_grille}">
                                <p:outputPanel autoUpdate="true" id="blog_form_grille_type_credit_">
                                    <div style="width: 40%;float: left">
                                        <h:inputHidden id="input_hide_reset_grille_taux" value="#{managedTypeCredit.input_reset_grille}"/>
                                        <h:panelGrid id="form_grille_type_credit_" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                            <span>#{lab.L_montant} </span>
                                            <h:panelGroup>
                                                <pe:inputNumber value="#{managedTypeCredit.grille.montantMinimal}" style="width: 150px"/>
                                                <span> #{lab.L_a} </span>
                                                <pe:inputNumber value="#{managedTypeCredit.grille.montantMaximal}" style="width: 150px"/>
                                                <h:outputLabel value=" #{typeCredit.suffixeMontant}"/>
                                            </h:panelGroup>
                                            <span>#{lab.L_taux} </span>
                                            <pe:inputNumber value="#{managedTypeCredit.grille.taux}" symbol="%" symbolPosition="suffixe"/>
                                            <span>#{lab.LCF_PBP_duree} </span>
                                            <pe:inputNumber value="#{managedTypeCredit.grille.periodeMaximal}" symbol=" mois" symbolPosition="suffixe"/>
                                        </h:panelGrid>
                                        <p:commandButton id="cancel_grille_taux_" value="#{lab.L_nouveau}" update="form_grille_type_credit_"
                                                         style="float: left" actionListener="#{managedTypeCredit.resetFicheGrille()}"/>
                                        <p:commandButton id="save_grille_taux_" value="#{lab.L_enregistrer}" update="blog_form_grille_type_credit_"
                                                         style="float: right" actionListener="#{managedTypeCredit.saveNewGrille()}"/>
                                    </div>
                                    <div style="width: 59%;margin-left: 41%">
                                        <h:inputHidden id="input_hide_grille_taux_id" value="#{managedTypeCredit.tabIds_grille}"/>
                                        <p:dataTable id="data_grille_type_credit_" value="#{typeCredit.grilles}" var="grill" rowKey="#{grill.id}" rowIndexVar="grillIdx"
                                                     selectionMode="single">  
                                            <p:ajax event="rowSelect" global="false" listener="#{managedTypeCredit.loadOnViewGrille}" update=":main_type_credit_:tabview_type_credit:form_grille_type_credit_"/>
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedTypeCredit.unLoadOnViewGrille}" update=":main_type_credit_:tabview_type_credit:form_grille_type_credit_"/>
                                            <p:column headerText="N°" width="20" style="text-align: center">
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{grill.new_}"/>
                                                <span>#{grillIdx+1}</span>
                                            </p:column>                          
                                            <p:column headerText="#{lab.L_taux}" style="text-align: right">
                                                <h:outputText value="#{grill.taux}" converter="DN"/>
                                                <span>%</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LM_PTC_montant_min}" style="text-align: right">
                                                <h:outputText value="#{grill.montantMinimal}" converter="DN"/>
                                                <span style="text-align: right">#{typeCredit.suffixeMontant}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LM_PTC_montant_max}" style="text-align: right">
                                                <h:outputText value="#{grill.montantMaximal}" converter="DN"/>
                                                <span style="text-align: right">#{typeCredit.suffixeMontant}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_POV_periode}" style="text-align: right">
                                                <h:outputText value="#{grill.periodeMaximal}" converter="DN"/>
                                                <span> #{lab.L_mois}</span>
                                            </p:column>
                                            <p:column width="20" style="text-align: center">
                                                <p:contextMenu for="btn_option_grill_type_credit" event="left click" style="font-size: 0.8em">
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedTypeCredit.deleteBeanGrille(grill)}" update="data_grille_type_credit_"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_grill_type_credit" type="button"/>
                                            </p:column> 
                                            <p:column width="20" style="text-align: center">
                                                <f:facet name="header">
                                                    <h:selectBooleanCheckbox styleClass="chek_all_line_grille_taux" value="false"
                                                                             onclick="selectionAllLineGrilleTaux(#{typeCredit.grilles.size()})">
                                                    </h:selectBooleanCheckbox>
                                                </f:facet>
                                                <h:selectBooleanCheckbox  value="#{grill.selectActif}" styleClass="chek_line_grille_taux" 
                                                                          onclick="selectionLineGrilleTaux(#{grill.id})">
                                                </h:selectBooleanCheckbox>
                                            </p:column>
                                        </p:dataTable>
                                        <p:commandButton id="delete_grille_taux_" value="#{lab.L_supprimer}" global="false" rendered="false"
                                                         style="width: 100%" onclick="dlgConfirmDeleteGrilleTaux.show()"/>
                                    </div>
                                </p:outputPanel>
                                <div style="clear: both"/>
                            </p:tab>
                            <p:tab title="#{lab.LM_PTC_frais}">
                                <p:outputPanel autoUpdate="true" id="blog_form_frais_type_credit_">
                                    <div style="width: 40%;float: left">
                                        <h:panelGrid id="form_frais_type_credit_" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                            <span>#{lab.LM_PTC_frais} </span>
                                            <h:selectOneMenu value="#{managedTypeCredit.frais.type.id}" valueChangeListener="#{managedTypeCredit.chooseFrais}" style="width: 100%"
                                                             id="select_type_frais_type_credit">
                                                <f:selectItem itemLabel="--" itemValue="0"/>
                                                <f:selectItems value="#{managedTypeCout.types}" var="typ" itemLabel="#{typ.libelle}" itemValue="#{typ.id}"/>
                                                <f:selectItem itemLabel="--" itemValue="0"/>
                                                <f:selectItem itemLabel="#{lab.L_creer}" itemValue="-1"/>
                                                <p:ajax event="valueChange" update="@this"/>
                                            </h:selectOneMenu>
                                            <span>Montant </span>
                                            <h:inputText value="#{managedTypeCredit.frais.montant}"/>
                                        </h:panelGrid>
                                        <p:commandButton id="cancel_frais_taux_" value="#{lab.L_nouveau}" update="form_frais_type_credit_"
                                                         style="float: left" actionListener="#{managedTypeCredit.resetFicheFrais()}"/>
                                        <p:commandButton id="save_frais_taux_" value="#{lab.L_enregistrer}" update="blog_form_frais_type_credit_"
                                                         style="float: right" actionListener="#{managedTypeCredit.saveNewFrais()}"/>
                                    </div>
                                    <div style="width: 59%;margin-left: 41%">
                                        <p:dataTable id="data_frais_type_credit_" value="#{typeCredit.frais}" var="frs" rowKey="#{frs.id}" rowIndexVar="fIdx"
                                                     selectionMode="single">  
                                            <p:ajax event="rowSelect" global="false" listener="#{managedTypeCredit.loadOnViewFrais}" update=":main_type_credit_:tabview_type_credit:form_frais_type_credit_"/>
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedTypeCredit.unLoadOnViewFrais}" update=":main_type_credit_:tabview_type_credit:form_frais_type_credit_"/>
                                            <p:column headerText="N°" width="20" style="text-align: center">
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{frs.new_}"/>
                                                <span>#{fIdx+1}</span>
                                            </p:column>                          
                                            <p:column headerText="#{lab.LM_PTC_frais}" style="text-align: right">
                                                <span>#{frs.type.libelle}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.L_montant}" style="text-align: right">
                                                <h:outputText value="#{frs.montant}" converter="DN"/>
                                            </p:column>
                                            <p:column width="20" style="text-align: center">
                                                <p:contextMenu for="btn_option_frais_type_credit" event="left click" style="font-size: 0.8em">
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedTypeCredit.deleteBeanFrais(frs)}" update="data_frais_type_credit_"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_frais_type_credit" type="button"/>
                                            </p:column> 
                                        </p:dataTable>
                                    </div>
                                </p:outputPanel>
                                <div style="clear: both"/>
                            </p:tab>
                        </p:tabView>
                    </p:outputPanel>
                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="yvs_list_type_credit_" style="width: 99%; margin: auto; background: white">
                    <h:inputHidden id="input_hide_type_credit_" value="#{managedTypeCredit.tabIds}"/>
                    <p:outputPanel id="blog_list_type_credit_" style="width: 99%; margin: auto; background: white">
                        <p:dataTable id="data_type_credit_" value="#{managedTypeCredit.types}" var="typCe" rowKey="#{typCe.id}"
                                     rowIndexVar="typCeIdx" selectionMode="single">
                            <p:ajax event="rowSelect" global="false" listener="#{managedTypeCredit.loadOnView}" 
                                    update=":main_type_credit_:blog_form_type_credit_ :main_type_credit_:input_hide_type_credit_" oncomplete="collapseForm('type_credit_')"/>
                            <p:ajax event="rowUnselect" global="false" listener="#{managedTypeCredit.unLoadOnView}" update=":main_type_credit_:blog_form_type_credit_"/>
                            <p:column width="30" headerText="N°" style="text-align: center">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{typCe.new_}"/>
                                <span>#{typCeIdx+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_code}" style="width: 10%">
                                <span>#{typCe.code}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_designation}">
                                <span>#{typCe.designation}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_montant}" style="width: 15%;text-align: right">
                                <h:outputText value="#{typCe.montantMaximal}" converter="DN" style="text-align: right"/>
                                <span style="text-align: right">#{typCe.suffixeMontant}</span>
                            </p:column>
                            <p:column headerText="#{lab.LM_PPG_interet}" style="width: 12%;text-align: right">
                                <span>#{typCe.tauxMaximal}%</span>
                            </p:column>
                            <p:column headerText="#{lab.LM_PTC_delai}" style="width: 12%;text-align: right">
                                <h:outputText value="#{typCe.periodeMaximal}" converter="DN"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PCOM_periodicite}" style="width: 12%;text-align: right">
                                <h:outputText value="#{typCe.periodicite}" converter="DN"/>
                            </p:column>
                            <p:column headerText="#{lab.LM_PTC_avaliste}" style="width: 12%;text-align: right">
                                <h:outputText value="#{typCe.nbreAvalise}" converter="DN"/>
                            </p:column>
                            <p:column width="40" headerText="#{lab.LM_PTC_report}" style="text-align: center">
                                <h:graphicImage library="img"  name="#{(typCe.impayeDette)?'yes.png':'no.png'}" width="15" height="15"/>
                            </p:column>
                            <p:column width="20" style="text-align: center">
                                <p:contextMenu for="btn_option_type_credit" event="left click" style="font-size: 0.8em">
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedTypeCredit.deleteBean(typCe)}" update="data_type_credit_ :main_type_credit_:blog_form_type_credit_"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_type_credit" type="button"/>
                            </p:column> 
                            <p:column width="25" style="text-align: center">
                                <f:facet name="header">
                                    <h:selectBooleanCheckbox styleClass="chek_all_line_type_credit_" value="false"
                                                             onclick="selectionAllLineTab(#{managedTypeCredit.types.size()}, 'type_credit_')">
                                    </h:selectBooleanCheckbox>
                                </f:facet>
                                <h:selectBooleanCheckbox  value="#{typCe.selectActif}" styleClass="chek_line_type_credit_" 
                                                          onclick="selectionLineTab(#{typCeIdx}, 'type_credit_')">
                                </h:selectBooleanCheckbox>
                            </p:column>
                        </p:dataTable>     
                    </p:outputPanel>                                                    
                </div> 
            </div>
        </h:form>
    </ui:define>
</ui:composition>

