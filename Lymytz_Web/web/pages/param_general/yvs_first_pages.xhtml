<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui" 
    xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    xmlns:pe="http://primefaces.org/ui/extensions">  
    <h:head> 
        <title>Erp Lymytz : Initialisation</title>        
        <link rel="icon" type="image/ico" sizes="16x16" href="resources/icones/favicon-16.ico"/> 
        <h:outputScript library="js" name="template.js" />  
    </h:head>
    <h:body > 
        <h:form prependId="false" enctype="multipart/form-data">         
            <p:dialog widgetVar="dlgWait" modal="true" width="25%" showHeader="false" dynamic="true">
                <span style="color: #D20005; letter-spacing: 2px; font-size: 0.8em">Opération en Cours. Patientez...</span>
            </p:dialog>
            <p:ajaxStatus style="position: absolute;margin-top: 15%; left: 45%; z-index: 9999" id="ajaxStatusPanel"
                          onstart="pageDark(); dlgWait.show()" onsuccess="pageClair(); dlgWait.hide()" >  
                <f:facet name="start" >
                    <h:graphicImage library="img" name="loading_bar.gif" height="25" width="150" />
                </f:facet>  
                <f:facet name="complete">  
                    <!--<h:outputText value="" />-->
                </f:facet>  
            </p:ajaxStatus>  
            <div class="part_scroll">
                <p:wizard id="form_initialisation">
                    <p:tab id="tab_societe" title="Societe">
                        <h:panelGrid columns="1" style="width: 99%;margin: auto">
                            <p:panelGrid style="width: 100%">
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Raison Social * : "/>
                                    </p:column>
                                    <p:column colspan="3"> 
                                        <p:inputText value="#{init.societe.raisonSocial}" style="width: 100%;text-align: center" required="true" label="Raison Social">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>                                
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Abbreviation * : "/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.societe.codeAbreviation}" required="true" label="Abbreviation">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Numero Immatriculation : "/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.societe.numeroRegistreCom}" label="Numero Immatriculation">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Siege * : "/>
                                    </p:column>
                                    <p:column> 
                                        <p:inputText value="#{init.societe.siege}" required="true" label="Siege">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>    
                                    <p:column>
                                        <p:outputLabel value="Adresse Siege * : "/>
                                    </p:column>
                                    <p:column> 
                                        <p:inputText value="#{init.societe.adressSiege}" required="true" label="Adresse">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>                             
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Telephone : "/>
                                    </p:column>
                                    <p:column> 
                                        <p:inputText value="#{init.societe.telephone}" label="Telephone">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>    
                                    <p:column>
                                        <p:outputLabel value="Code postal : "/>
                                    </p:column>
                                    <p:column> 
                                        <p:inputText value="#{init.societe.codePostal}" label="Code postal">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>                             
                                </p:row>
                                <p:row> 
                                    <p:column>
                                        <p:outputLabel value="Adresse Email : "/>
                                    </p:column>
                                    <p:column> 
                                        <p:inputText value="#{init.societe.email}" converter="EMAIL">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>      
                                    <p:column>
                                        <p:outputLabel value="Site Web : "/>
                                    </p:column>
                                    <p:column> 
                                        <p:inputText value="#{init.societe.siteWeb}">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>                          
                                </p:row>
                                <p:row> 
                                    <p:column>
                                        <p:outputLabel value="Capital * : "/>
                                    </p:column>
                                    <p:column> 
                                        <pe:inputNumber value="#{init.societe.capital}" maxValue="#{init.MAX}" required="true" label="Capital">
                                            <p:ajax event="valueChange"/>
                                        </pe:inputNumber>
                                    </p:column>      
                                    <p:column>
                                        <p:outputLabel value="Devise * : "/>
                                    </p:column>
                                    <p:column> 
                                        <p:inputText value="#{init.societe.devise}" required="true" label="Devise">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>                          
                                </p:row>
                                <p:row> 
                                    <p:column>
                                        <p:outputLabel value="Forme Juridique * : "/>
                                    </p:column>
                                    <p:column colspan="3"> 
                                        <p:selectOneMenu value="#{init.societe.formeJuridique}" required="true" label="Forme Juridique">
                                            <f:selectItem itemValue="" itemLabel=""/>
                                            <f:selectItem itemValue="SA" itemLabel="SA"/>
                                            <f:selectItem itemValue="SARL" itemLabel="SARL"/>
                                            <f:selectItem itemValue="SNS" itemLabel="SNC"/>
                                            <f:selectItem itemValue="SP" itemLabel="SP"/>
                                            <p:ajax event="valueChange"/>
                                        </p:selectOneMenu>
                                    </p:column>                         
                                </p:row>
                            </p:panelGrid> 
                        </h:panelGrid> 
                    </p:tab>
                    <p:tab id="tab_agence" title="Agence">
                        <h:panelGrid columns="1" style="width: 99%;margin: auto">
                            <p:panelGrid style="width: 100%">
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Code * : " />                                            
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.agence.codeAgence}" required="true" label="Code">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Abbreviation * : " />
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.agence.abbreviation}" required="true" label="Abbreviation">  
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Designation * : " />
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.agence.designation}" required="true" label="Designation">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Telephone : " />
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.agence.telephone}" label="Telephone">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Email : " />
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.agence.email}" converter="EMAIL" label="Email">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="Adresse * : " />
                                    </p:column>
                                    <p:column>
                                        <p:inputText value="#{init.agence.adresse}" required="true" label="Adresse"> 
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Region : " />
                                    </p:column>
                                    <p:column colspan="3">
                                        <p:inputText value="#{init.agence.region}" label="Region">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                        </h:panelGrid>
                    </p:tab>
                    <p:tab id="tab_confirmation" title="Accès">
                        <h:panelGrid columns="1" style="width: 99%;margin: auto">
                            <p:panelGrid style="width: 100%">
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Login * : "/>
                                    </p:column>
                                    <p:column colspan="3"> 
                                        <p:inputText value="#{init.users.codeUsers}" required="true" label="Login">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>                              
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <p:outputLabel value="Noms et Prenoms * : "/>
                                    </p:column>
                                    <p:column colspan="3">
                                        <p:inputText value="#{init.users.nomUsers}" style="width: 95%" required="true" label="Nom">
                                            <p:ajax event="valueChange"/>
                                        </p:inputText>
                                    </p:column>                               
                                </p:row>
                                <p:row> 
                                    <p:column>
                                        <p:outputLabel value="Mot de passe * : "/>
                                    </p:column>
                                    <p:column colspan="3"> 
                                        <p:password value="#{init.users.passwordUser}" required="true" label="niveau d'acces">                                               
                                            <p:ajax event="valueChange"/>
                                        </p:password>
                                    </p:column>                         
                                </p:row>
                            </p:panelGrid>
                            <h:panelGrid styleClass="yvs_table" columns="2">
                                <f:facet name="header">Niveau d'accès</f:facet>
                                <span>Niveau</span>
                                <h:inputText value="#{init.users.niveauAcces.designation}"/>
                                <span>Description</span>
                                <h:inputText value="#{init.users.niveauAcces.description}"/>
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:tab>
                    <p:tab title="Mise en route">                        
                        <p:commandButton value="Charger les modules" actionListener="#{init.buildModuleActive()}" update="form_societe_module" style="float: right"/>
                        <p:dataTable value="#{init.modules}" var="mdl" rowKey="#{mdl.id}" rowIndexVar="idx" id="form_societe_module">
                            <p:column headerText="N°" width="20">
                                #{idx+1}
                            </p:column>                                
                            <p:column headerText="Libelle" width="100">
                                <h:outputText value="#{mdl.module.libelle}"/>
                            </p:column>
                            <p:column headerText="Description">
                                <h:outputText value="#{mdl.module.description}"/>
                            </p:column>
                            <p:column headerText="Actif" style="text-align: center">
                                <h:selectBooleanCheckbox value="#{mdl.actif}">
                                    <p:ajax event="valueChange" listener="#{init.activeModule(mdl)}" update="@this"/>
                                </h:selectBooleanCheckbox>
                            </p:column> 
                        </p:dataTable> 
                        <p:commandButton value="Debuter" actionListener="#{init.saveAll()}" process="@this" style="float: right"/>                     
                    </p:tab>
                </p:wizard>
            </div>
        </h:form>
    </h:body>
</ui:composition>
