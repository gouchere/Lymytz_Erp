<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Receptions Achat','modGescom', 'smenBonLivraisonAchat', true,managedLivraisonAchat)}
    </ui:define> 
    <ui:define name="contents">
        #{managedLotReception.doNothing()}   
        #{managedTransfertStock.doNothing()}

        #{managedAgence.loadAllUsable()}
        #{managedDepot.loadDepotsByAgence()}
        #{managedFactureAchat.loadFactureNonLivre(true,true)}
        #{Marticle.loadActifArticle(true,true)}  
        #{managedTypeDocDivers.loadAll(constantes.TYPE_FA)}
        #{managedLivraisonAchat.loadAll()}
        <script type="text/javascript">
            $(function() {
                collapseForm('contenu_livraison_achat');
                collapseForm('livraison_achat');
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
            });
            function _slideShow(node) {

            }
        </script>

        <h:form prependId="false" id="main-agence">
            <p:dialog widgetVar="dlgAgenceForDepot" header="Selectionner une agence" width="50%" closeOnEscape="true"> 
                <p:dataTable value="#{managedAgence.agences}" var="ag" rowKey="#{ag.id}" selectionMode="single" id="table_agence" rowIndexVar="line_ag">
                    <p:ajax event="rowSelect" listener="#{managedDepot.onSelectAgenceForAction}" update=":main_livraison_achat:select_depot_livraison_achat" oncomplete="dlgAgenceForDepot.hide()"/>
                    <p:column headerText="#{lab.L_code}" width="200">
                        <h:outputText value="#{ag.codeagence}"/>
                    </p:column>                                
                    <p:column headerText="#{lab.L_designation}">
                        <h:outputText value="#{ag.designation}"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>

        <h:form>
            <p:remoteCommand name="updateBeanCaisse_" actionListener="#{managedLivraisonAchat.updateBean()}"/>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="Liste lot de reception" widgetVar="dlgListLotReception" modal="true" closeOnEscape="true" width="60%"> 
                <p:outputPanel id="blog-contenu_bla_require_lot">
                    <div align="right">
                        <p:commandButton  icon="ui-icon-disk" value="Terminer" actionListener="#{managedLivraisonAchat.saveAllArticle()}" oncomplete="dlgListLotReception.hide()"
                                          update=":main_livraison_achat:blog_form_contenu_livraison_achat"/>
                    </div>
                    <div style="max-height: 400px">
                        <div style="max-height: 350px;overflow-y: auto">
                            <p:dataTable value="#{managedLivraisonAchat.contenusRequireLot}" var="aRL" rowKey="#{aRL.id}" style="width: 1000px"
                                         id="data-contenu_bla_require_lot" editable="true">
                                <f:facet name="header">
                                    Articles qui demandent un lot de reception
                                </f:facet>
                                <p:column headerText="Article" style="text-align: left">
                                    #{aRL.article.designation}
                                </p:column>
                                <p:column headerText="Quantitée" style="text-align: right">
                                    <h:outputText value="#{aRL.quantiteCommande}" converter="#{managedLivraisonAchat.converterStock}" title="#{lab.LC_PFA_numero_serie}: #{aRL.numSerie}"/>
                                    <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                </p:column>
                                <p:column headerText="Numero de lot" style="text-align: center">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{aRL.lot.numero}"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <h:inputText value="#{aRL.lot.numero}" style="width:100%;text-align: center">
                                                <p:ajax event="valueChange" listener="#{managedLivraisonAchat.findLotReceptionByEntity(aRL)}"/>
                                            </h:inputText>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>
                                <p:column headerText="Date fabrication" style="text-align: center">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{aRL.lot.dateFabrication}" converter="DATE"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:calendar value="#{aRL.lot.dateFabrication}" navigator="true" pattern="dd-MM-yyyy" style="width:100%;text-align: center"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>
                                <p:column headerText="Date expiration" style="text-align: center">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{aRL.lot.dateExpiration}" converter="DATE"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:calendar value="#{aRL.lot.dateExpiration}" navigator="true" pattern="dd-MM-yyyy" style="width:100%;text-align: center"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>
                                <p:column style="text-align: center;width: 5px">
                                    <p:rowEditor />
                                </p:column>  
                            </p:dataTable>
                        </div>
                    </div>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PRA_transferer_stock_recu}" widgetVar="dlgSendArticle" modal="true" width="70%" closeOnEscape="true"> 
                <p:outputPanel  id="blog_send_article_bla">
                    <span>#{lab.L_date} : </span>
                    <p:calendar value="#{managedLivraisonAchat.docStock.dateDoc}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                    <h:panelGrid styleClass="yvs_table" columns="4" style="width: 100%" cellpadding="0" cellspacing="0">
                        <span>#{lab.LC_PRA_source} </span> 
                        <h:inputText value="#{managedLivraisonAchat.docStock.source.designation}" style="width: 100%" disabled="true"/> 
                        <span>#{lab.LC_PRA_creneau_src} </span>   
                        <h:selectOneMenu value="#{managedLivraisonAchat.docStock.creneauSource.id}" style="width: 100%" title="#{lab.LC_PRA_creneau_depot_source}">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedLivraisonAchat.docStock.source.tranches}" var="crenS" itemLabel="#{crenS.semiReference}" itemValue="#{crenS.id}" />                                 
                            <p:ajax event="valueChange" global="false"/>
                        </h:selectOneMenu> 
                        <span>#{lab.LC_PRA_reception} </span>  
                        <h:selectOneMenu value="#{managedLivraisonAchat.docStock.destination.id}" style="width: 100%">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedLivraisonAchat.destinations}" var="recp" itemLabel="#{recp.designation}" itemValue="#{recp.id}" />                                 
                            <p:ajax event="valueChange" global="false" listener="#{managedLivraisonAchat.chooseDestination()}" update="select_creneau_reception_transfert"/>
                        </h:selectOneMenu> 
                        <span>#{lab.LC_PRA_creneau_dst} </span>  
                        <h:selectOneMenu value="#{managedLivraisonAchat.docStock.creneauDestinataire.id}" id="select_creneau_reception_transfert" style="width: 100%"
                                         title="#{lab.LC_PRA_creneau_depot_reception}">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedLivraisonAchat.docStock.destination.tranches}" var="crenD" itemLabel="#{crenD.semiReference}" itemValue="#{crenD.id}" />                                      
                            <p:ajax event="valueChange" global="false"/>
                        </h:selectOneMenu>
                    </h:panelGrid>                    
                    <div style="background: #bcbcbf;margin-top: 5px">
                        <h:panelGrid columns="8" cellpadding="0" cellspacing="0">
                            <h:outputText value="#{lab.L_article}" />
                            <h:outputText title="#{lab.LC_PRA_conditionnement_sortie}" value="#{lab.LC_PRA_cond_sortie}"/>
                            <h:outputText value="#{lab.L_quantite}" />                                            
                            <h:outputText title="#{lab.LC_PRA_conditionnement_entree}" value="#{lab.LC_PRA_cond_entree}"/>
                            <h:outputText value="#{lab.L_quantite}" />
                            <h:outputText value="#{lab.LC_PRA_lot_sortie}" />
                            <h:outputText value="#{lab.LC_PRA_lot_entree}" />        
                            <h:outputText value=""/>
                            <h:inputText value="#{managedLivraisonAchat.transfert.article.designation}" style="width: 200px" disabled="true"/> 
                            <h:inputText value="#{managedLivraisonAchat.transfert.conditionnement.unite.libelle}" disabled="true"/> 
                            <h:inputText value="#{managedLivraisonAchat.transfert.quantite}" style="text-align: right;width: 100px"/> 
                            <h:selectOneMenu value="#{managedLivraisonAchat.transfert.uniteDestination.id}" style="min-width: 120px" title="#{lab.LC_PRA_selectionner_conditionnement}" tabindex="17">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedLivraisonAchat.transfert.article.conditionnements}" var="uD" itemLabel="#{uD.unite.reference}" itemValue="#{uD.id}"/>
                                <p:ajax event="valueChange" listener="#{managedLivraisonAchat.listenChangeQuantite()}" update="txt_qte_dest_blv"/>
                            </h:selectOneMenu>
                            <p:inputText value="#{managedLivraisonAchat.transfert.resultante}"  style="width: 100px;text-align: right" readonly="true" converter="#{managedLivraisonAchat.converter}" id="txt_qte_dest_blv"/>    
                            <h:inputText value="#{managedLivraisonAchat.transfert.lotSortie.numero}" disabled="true"/> 
                            <h:selectOneMenu value="#{managedLivraisonAchat.transfert.lotEntree.id}" style="min-width: 120px">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedLotReception.lots}" var="lo"  itemLabel="#{lo.numero}" itemValue="#{lo.id}" />     
                            </h:selectOneMenu>
                            <p:commandButton icon="ui-icon-disk" style="float: right;background: white !important" value="#{lab.L_enregistrer}" 
                                             actionListener="#{managedLivraisonAchat.saveSendArticle()}"/>
                        </h:panelGrid>
                    </div>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="Ajouter un lot de reception" widgetVar="dlgAddLotReception" modal="true" closeOnEscape="true"> 
                <p:outputPanel id="blog_lot_reception">
                    <ui:include src="../param/lot_reception/form.xhtml" /> 
                    <div>
                        <p:commandButton value="#{lab.L_nouveau}" icon="ui-icon-document" actionListener="#{managedLotReception.resetFiche()}" style="float: left"
                                         update="blog_lot_reception"/>
                        <p:commandButton value="#{lab.L_enregistrer}" icon="ui-icon-disk" actionListener="#{managedLivraisonAchat.saveLotReception()}" style="float: right"
                                         oncomplete="dlgAddLotReception.hide()"/>
                    </div>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PRA_liste_articles}" widgetVar="dlgListArticle" modal="true" width="70%" 
                      closeOnEscape="true" height="500"> 
                <p:watermark for="txt_search_article_bla" value="#{lab.L_reference_article}..." />
                <h:panelGrid columns="2" style="width: 100%; font-size: 0.9em" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_article_bla" value="#{Marticle.article.refArt}"> 
                        <p:ajax event="valueChange" global="false" listener="#{Marticle.searchArticleActif(false)}" update="data_articles_livraison_achat"/>
                    </h:inputText> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(false, false)}" global="false" update="data_articles_livraison_achat" icon="ui-icon-circle-triangle-w" disabled="#{Marticle.pa.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{Marticle.pa.currentPage}/#{Marticle.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(true, false)}" global="false" update="data_articles_livraison_achat" icon="ui-icon-circle-triangle-e" disabled="#{Marticle.pa.disNext}"/>
                        <p:selectOneMenu value="#{Marticle.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{Marticle._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{Marticle.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_articles_livraison_achat"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable id="data_articles_livraison_achat" value="#{Marticle.articlesResult}" var="art" rowKey="#{art.id}"
                             selectionMode="single" rowIndexVar="line_art" style="font-size: 0.9em; max-height: 480px">
                    <p:ajax event="rowSelect" global="false" listener="#{managedLivraisonAchat.loadOnViewArticle}" oncomplete="dlgListArticle.hide()"
                            update=":main_livraison_achat:form_contenu_livraison_achat"/>
                    <p:column headerText="N°" width="20">
                        <span title="#{art.designation}">#{line_art+1}</span>
                    </p:column>
                    <p:column width="80" headerText="#{lab.L_reference}">
                        <span title="#{art.designation}">#{art.refArt}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}" width="100">
                        <span title="#{art.designation}">#{art.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_famille}" width="100">
                        <span  title="#{art.designation}">#{art.famille.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" width="80">
                        <span  title="#{art.designation}">#{art.categorie}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRA_prix_a}" width="70" style="text-align: right">
                        <h:outputText value="#{art.pua}" title="#{art.designation}" converter="#{managedLivraisonAchat.converter}" />
                    </p:column>
                    <p:column headerText="#{lab.LC_PRA_prix_v}" width="70" style="text-align: right">
                        <h:outputText value="#{art.puv}" title="#{art.designation}" converter="#{managedLivraisonAchat.converter}" />
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PRA_liste_articles}" widgetVar="dlgListConditionnement" modal="true" width="70%" height="450" closeOnEscape="true"> 
                <p:dataTable id="data_conditionnements_livraison_achat" value="#{Marticle.conditionnements}" var="art" rowIndexVar="artLine"
                             rowKey="#{art.id}" selectionMode="single">
                    <p:ajax event="rowSelect" listener="#{managedLivraisonAchat.loadOnViewConditionnement}" oncomplete="dlgListConditionnement.hide()"
                            update=":main_livraison_achat:form_contenu_livraison_achat"/>
                    <p:column headerText="N°" width="20" style="text-align: center">
                        #{artLine+1}
                    </p:column>                                                        
                    <p:column headerText="#{lab.L_reference}" width="100">
                        <span style="font-weight: bold">#{art.article.refArt}</span>
                    </p:column>
                    <p:column  headerText="#{lab.L_desigantion}" width="150"> 
                        #{art.article.designation}
                    </p:column>
                    <p:column headerText="#{lab.L_unite}" width="100">
                        #{art.unite.libelle}                                
                        <span style="font-weight: bold">[#{art.unite.reference}]</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" width="100" style="text-align: center">
                        #{art.article.categorie}
                    </p:column>
                    <p:column  headerText="#{lab.LC_PRA_prix_v}" width="80"  style="text-align: right">                                                            
                        <h:outputText value="#{art.prix}"  converter="DN" />                                                            
                    </p:column>
                    <p:column  headerText="#{lab.LC_PRA_prix_a}" width="80"  style="text-align: right">                                                            
                        <h:outputText value="#{art.prixAchat}"  converter="DN" />                                                            
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des fournisseur
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PRA_liste_fournisseurs}" widgetVar="dlgListFournisseurs" closeOnEscape="true" width="78%" modal="true" height="500" dynamic="true">   
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText value="#{managedFournisseur.numSearch_}" style="float: left;text-align: center;margin-left: -10px">
                        <p:ajax event="valueChange" listener="#{managedFournisseur.searchByNum()}" update="data_fournisseur_bla"/>
                    </h:inputText>   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedFournisseur.loadAllFournisseur(false, false)}" update="data_fournisseur_bla" icon="ui-icon-circle-triangle-w" disabled="#{managedFournisseur.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedFournisseur.paginator.currentPage}/#{managedFournisseur.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedFournisseur.loadAllFournisseur(true, false)}" update="data_fournisseur_bla" icon="ui-icon-circle-triangle-e" disabled="#{managedFournisseur.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedFournisseur.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedFournisseur.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedFournisseur.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_fournisseur_bla"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>                                 
                <p:dataTable id="data_fournisseur_bla"  value="#{managedFournisseur.fournisseurs}" var="fsseur_" rowKey="#{fsseur_.id}"
                             selectionMode="single" rowIndexVar="cltIdx" style="max-height: 450px; overflow-y: auto">
                    <p:ajax event="rowSelect" global="false" listener="#{managedLivraisonAchat.loadOnViewFsseur}" oncomplete="dlgListFournisseurs.hide()"/>
                    <p:column headerText="N°" style="width: 10%">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{fsseur_.codeFsseur}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRA_nom}">
                        <span>#{fsseur_.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}">
                        <span>#{fsseur_.categorie.libelle}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_ville}">
                        <span>#{fsseur_.tiers.ville.libele}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue plus options
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_plus_option}" width="40%"  closeOnEscape="true" widgetVar="dlgPlusOptions" resizable="false"> 
                <h:panelGrid id="blog_plus_option_livraison_achat" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">    
                    <h:outputText value="#{lab.L_agence}" rendered="#{acces.multiAgence}"/>
                    <h:selectOneMenu value="#{managedLivraisonAchat.agence_}" id="_select_agence_livraison_achat" style="width: 100%" rendered="#{acces.multiAgence}">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedAgence.listAgence}" var="ag"
                                       itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                        <p:ajax event="valueChange" listener="#{managedLivraisonAchat._chooseAgence()}" 
                                update="blog_plus_option_livraison_achat :main_livraison_achat:data_livraison_achat"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PRA_depot} " />
                    <h:selectOneMenu value="#{managedLivraisonAchat.depot_}" id="_select_depot_livraison_achat" style="width: 100%">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedDepot.depots_all}" var="de"
                                       itemLabel="#{de.designation}" itemValue="#{de.id}"/>
                        <p:ajax event="valueChange" listener="#{managedLivraisonAchat._chooseDepot()}"
                                update="_select_tranche_livraison_achat :main_livraison_achat:data_livraison_achat"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PRA_tranche}"/>
                    <h:selectOneMenu value="#{managedLivraisonAchat.tranche_}" id="_select_tranche_livraison_achat" style="width: 100%">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedLivraisonAchat.tranches_point_}" var="tr"
                                       itemLabel="#{tr.titre}" itemValue="#{tr.id}"/>
                        <p:ajax event="valueChange" listener="#{managedLivraisonAchat._chooseTranche()}"
                                update=":main_livraison_achat:data_livraison_achat"/>
                    </h:selectOneMenu>    
                    <h:outputText value="#{lab.LC_PRA_facture}"/>
                    <h:inputText value="#{managedLivraisonAchat.numFacture}" style="width: 100%">
                        <p:ajax event="valueChange" listener="#{managedLivraisonAchat.chooseFacture()}"
                                update=":main_livraison_achat:data_livraison_achat"/>
                    </h:inputText>  

                    <h:panelGroup>
                        <h:outputText value="#{lab.LDB_PC_dates}"  />
                        <h:selectBooleanCheckbox value="#{managedLivraisonAchat.date_up}" title="#{lab.LDB_PC_dates_last_modif}" style="float: right">
                            <p:ajax event="valueChange" global="false" update="blog_date_search_client" listener="#{managedLivraisonAchat.addParamDate()}"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_search_client">
                        <p:calendar value="#{managedLivraisonAchat.dateDebut_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedLivraisonAchat.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedLivraisonAchat.addParamDate}" update=":main_livraison_achat:data_livraison_achat"   />
                        </p:calendar>
                        <p:spacer style="width: 5px;background: black"/>
                        <p:calendar value="#{managedLivraisonAchat.dateFin_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedLivraisonAchat.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedLivraisonAchat.addParamDate}" update=":main_livraison_achat:data_livraison_achat"  />
                        </p:calendar>
                    </h:panelGroup>

                    <h:outputText value="Ids"/>
                    <h:inputText value="#{managedLivraisonAchat.idsSearch}" style="width: 100%" title="#{lab.LC_PRA_text1}">
                        <p:ajax event="valueChange" listener="#{managedLivraisonAchat.addParamIds()}" update=":main_livraison_achat:data_livraison_achat"/>
                    </h:inputText>                      
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de bon de commande
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PRA_liste_factures}" widgetVar="dlgListFactures" closeOnEscape="true" width="80%" modal="true" dynamic="true">                                     
                <div style="height: 100%">
                    <div class="dlg_part_fixe">
                        <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">                        
                            <h:panelGrid id="blog_search_fa_livraison" style="font-size: 0.8em" styleClass="yvs_nostyle" columns="5" cellpadding="0" cellspacing="0">   
                                <h:outputText value=""/>
                                <h:outputText value="#{lab.L_reference}"/>
                                <h:outputText value="#{lab.LC_PRA_fournisseur}"/>
                                <h:outputText value="#{lab.LC_PRA_statut}"/>
                                <h:outputText value="#{lab.LC_PRA_statut_reglee}"/>
                                <p:commandButton icon="ui-icon-bullet" actionListener="#{managedFactureAchat.clearParams()}" title="#{lab.L_reset_param}" style="width: 20px; height: 22px" 
                                                 update="blog_search_fa_livraison data_fa_livraison"/>
                                <h:inputText value="#{managedFactureAchat.numSearch_}" style="float: left;color: #009999;text-align: center;margin-left: -10px">
                                    <p:ajax event="valueChange" global="false" listener="#{managedFactureAchat.searchByNum()}" update="data_fa_livraison"/>
                                </h:inputText>   
                                <h:inputText value="#{managedFactureAchat.codeFsseur_}" style="min-width: 120px">
                                    <p:ajax event="valueChange" global="false"  listener="#{managedFactureAchat.addParamFsseur()}" update="data_fa_livraison"/>
                                </h:inputText>
                                <h:selectOneMenu value="#{managedFactureAchat.statut_}" valueChangeListener="#{managedFactureAchat.chooseStatut}" style="min-width: 120px" title="Statut de la facture">
                                    <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                                    <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                    <f:selectItem itemLabel="#{lab.L_annuler}" itemValue="#{constantes.ETAT_ANNULE}"/>
                                    <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                                    <p:ajax event="valueChange" global="false" update="data_fa_livraison"/>
                                </h:selectOneMenu>
                                <h:selectOneMenu value="#{managedFactureAchat.statutRegle_}" valueChangeListener="#{managedFactureAchat.chooseStatutRegle}" style="min-width: 120px" title="Etat de reglement de la facture">
                                    <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                                    <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.ETAT_ATTENTE}"/>
                                    <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                                    <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.ETAT_REGLE}"/>
                                    <p:ajax event="valueChange" global="false" update="data_fa_livraison"/>
                                </h:selectOneMenu>
                            </h:panelGrid>
                            <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                                <p:commandButton actionListener="#{managedFactureAchat.init(false)}" global="false" update="data_fa_livraison" icon="ui-icon-circle-triangle-w" disabled="#{managedFactureAchat.paginator.disPrev}"/>
                                <p:outputPanel ><p:outputLabel value="#{managedFactureAchat.paginator.currentPage}/#{managedFactureAchat.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                                <p:commandButton actionListener="#{managedFactureAchat.init(true)}" global="false" update="data_fa_livraison" icon="ui-icon-circle-triangle-e" disabled="#{managedFactureAchat.paginator.disNext}"/>
                                <p:selectOneMenu value="#{managedFactureAchat.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedFactureAchat.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                    <f:selectItems value="#{managedFactureAchat.paginations}"/>
                                    <p:ajax event="valueChange" global="false" update="data_fa_livraison"/>
                                </p:selectOneMenu>
                            </p:outputPanel>    
                        </h:panelGrid>
                    </div>
                    <div class="dlg_part_scroll">
                        <p:dataTable id="data_fa_livraison"  value="#{managedFactureAchat.documents}" var="bon" rowKey="#{bon.id}"
                                     selectionMode="single" rowIndexVar="bonIdx" rows="20" paginator="true" paginatorAlwaysVisible="false">
                            <p:ajax event="rowSelect" listener="#{managedLivraisonAchat.loadOnViewDoc}" oncomplete="dlgListFactures.hide()"
                                    update=":main_livraison_achat:infos_document_livraison_achat :main_livraison_achat:blog_contenu_fa_bla :data_contenus_fa_bla :main_livraison_achat:blog_article_livraison_achat"/>
                            <p:column headerText="N°" style="width: 5%;text-align: center" styleClass="statut_#{bon.statut}">
                                <span>#{bonIdx+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}">
                                <span>#{bon.numDoc}</span>
                                <h:panelGroup style="float: right">
                                    <h:outputText title="#{lab.LC_PRA_facture_reglee}" value="R" rendered="#{bon.statutRegle == constantes.ETAT_REGLE}"
                                                  style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                                    <p:spacer width="2" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE}"/>
                                    <h:outputText title="#{lab.LC_PRA_facture_livree}" value="L" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE}"
                                                  style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                                </h:panelGroup>
                            </p:column>
                            <p:column headerText="#{lab.L_date}" style="text-align: center" styleClass="statut_#{bon.statut}">
                                <h:outputText value="#{bon.dateDoc}" converter="DDMMYYYY"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PRA_numero_piece}" styleClass="statut_#{bon.statut}">
                                <span>#{bon.numPiece}</span>
                            </p:column>
                            <p:column headerText="#{lab.LC_PRA_fournisseur}" styleClass="statut_#{bon.statut}">
                                <h:outputText value="#{bon.fournisseur.tiers.nom_prenom}"/>
                            </p:column>
                        </p:dataTable> 
                    </div>
                </div>  
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue creation des types de cout
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PRA_ajout_article_fournisseur}" widgetVar="dlgAddArticleFsseur" modal="true" width="40%" closeOnEscape="true"> 
                <h:panelGrid id="blog_form_article_fournisseur_bla" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        #{lab.LC_PRA_fournisseur} : <b><span>#{managedFournisseur.article.fournisseur.nom_prenom}</span></b>
                    </f:facet>
                    <span>#{lab.L_article} </span>
                    <h:inputText value="#{managedFournisseur.article.article.designation}" style="width: 98%" readonly="true"/>   
                    <span>#{lab.L_conditionnement} </span>
                    <h:selectOneMenu value="#{managedFournisseur.article.conditionnement.unite.id}">
                        <f:selectItem itemLabel="" itemValue="0" />
                        <f:selectItems value="#{managedUniteMesure.unites}" var="cond_" itemLabel="#{cond_.reference}" itemValue="#{cond_.id}"/>   
                        <p:ajax event="valueChange" global="false" listener="#{managedFournisseur.chooseCondit()}"/>
                    </h:selectOneMenu>  
                    <span>#{lab.LC_PRA_delai_livraison} </span>
                    <h:panelGroup>
                        <pe:inputNumber value="#{managedFournisseur.article.delaiLivraison}" style="width: 35%" decimalPlaces="0"/>  
                        <p:spacer/>
                        <h:selectOneMenu value="#{managedFournisseur.article.uniteDelaisLiv}">
                            <f:selectItems value="#{constantes.UNITES_TIMES}" var="tps" itemLabel="#{tps[1]}" itemValue="#{tps[0]}" />    
                        </h:selectOneMenu> 
                    </h:panelGroup>
                    <span>#{lab.LC_PRA_prix_achat} </span>
                    <pe:inputNumber value="#{managedFournisseur.article.prix}" style="width: 70%"/>
                    <span>#{lab.LC_PRA_duree_garantie} </span>
                    <h:panelGroup>
                        <pe:inputNumber value="#{managedFournisseur.article.dureeGarantie}" style="width: 35%" decimalPlaces="0"/>  
                        <p:spacer/>
                        <h:selectOneMenu value="#{managedFournisseur.article.uniteDureeGaranti}">
                            <f:selectItems value="#{constantes.UNITES_TIMES}" var="tps" itemLabel="#{tps[1]}" itemValue="#{tps[0]}" />    
                        </h:selectOneMenu> 
                    </h:panelGroup> 
                    <span>#{lab.LC_PRA_remise} </span>                    
                    <h:panelGroup>
                        <pe:inputNumber value="#{managedFournisseur.article.remise}" style="width: 36.5%"/>  
                        <h:selectOneMenu value="#{managedFournisseur.article.natureRemise}">
                            <f:selectItem itemLabel="#{constantes.NATURE_TAUX}" itemValue="#{constantes.NATURE_TAUX}"/>                              
                            <f:selectItem itemLabel="#{constantes.NATURE_MTANT}" itemValue="#{constantes.NATURE_MTANT}"/>   
                        </h:selectOneMenu>  
                    </h:panelGroup> 
                    <span>#{lab.LC_PRA_duree_vie} </span>
                    <h:panelGroup>
                        <pe:inputNumber value="#{managedFournisseur.article.dureeVie}" style="width: 35%" decimalPlaces="0"/>      
                        <p:spacer/>
                        <h:selectOneMenu value="#{managedFournisseur.article.uniteDureeVie}">
                            <f:selectItems value="#{constantes.UNITES_TIMES}" var="tps" itemLabel="#{tps[1]}" itemValue="#{tps[0]}" />    
                        </h:selectOneMenu> 
                    </h:panelGroup> 
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddArticleFsseur.hide()" actionListener="#{managedFournisseur.saveNewArticle()}" 
                                 update="blog_form_article_fournisseur_bla :main_livraison_achat:form_contenu_livraison_achat"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue creation des articles depot
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PRA_ajout_article_depot}" widgetVar="dlgAddArticleDepot" modal="true" width="40%"  closeOnEscape="true"> 
                <h:panelGrid id="blog_form_article_depot_bla" columns="2" style="width: 98%;margin: auto">
                    <f:facet name="header">
                        #{lab.LC_PRA_depot} : <b><span>#{managedStockArticle.article.depot.designation}</span></b>
                    </f:facet>
                    <span>#{lab.L_article} </span>
                    <h:inputText value="#{managedStockArticle.article.article.designation}" style="width: 98%" readonly="true"/>                                                  
                    <span>#{lab.LC_PRA_marge_stock}</span>
                    <h:panelGroup>
                        <pe:inputNumber value="#{managedStockArticle.article.stockMin}" style="width: 30%;text-align: right" decimalPlaces="0">
                            <p:ajax event="blur" global="false" update="_txt_stock_alert_art_depot_dep"/>
                        </pe:inputNumber>
                        <span> #{lab.L_a} </span>
                        <pe:inputNumber value="#{managedStockArticle.article.stockMax}" style="width: 30%;text-align: right" decimalPlaces="0"/>
                    </h:panelGroup>            
                    <span>#{lab.LC_PRA_stock_securite}</span>
                    <h:panelGroup>
                        <pe:inputNumber value="#{managedStockArticle.article.stockSecurite}" style="width: 30%;text-align: right" decimalPlaces="0">
                            <p:ajax event="blur" global="false" update="_txt_stock_alert_art_depot_dep"/>
                        </pe:inputNumber>
                        <div style="float: right;font-size: 0.8em;font-style: italic;margin-top: 5px">
                            #{lab.LC_PRA_stock_alerte} :
                            <h:outputText value="#{managedStockArticle.article.stockAlert}" converter="#{managedLivraisonAchat.converterStock}" style="color: blue" id="_txt_stock_alert_art_depot_dep"/>
                        </div>
                    </h:panelGroup>   
                    <span title="#{lab.LC_PRA_mode_approvisionnement}">#{lab.LC_PRA_approv} </span>
                    <h:selectOneMenu value="#{managedStockArticle.article.modeAppro}">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>   
                        <f:selectItems value="#{constantes.MODES_APPRO}" var="MA" itemLabel="#{MA.libelle}" itemValue="#{MA.valeur}"/>                          
                        <p:ajax event="valueChange" global="false" listener="#{managedStockArticle.chooseModeApprovisionnement()}"/>
                    </h:selectOneMenu>  
                    <span title="#{lab.LC_PRA_mode_reapprovisionnement}">#{lab.LC_PRA_reapprov} </span>
                    <h:selectOneMenu value="#{managedStockArticle.article.modeReappro}">
                        <f:selectItems value="#{constantes.MODES_REAPPRO}" var="MRA" itemLabel="#{MRA.libelle}" itemValue="#{MRA.valeur}"/>                    
                        <p:ajax event="valueChange" global="false" listener="#{managedStockArticle.chooseModeReApprovisionnement()}" update="_val_delai_alert"/>
                    </h:selectOneMenu>    
                    <span title="#{lab.LC_PRA_lot_reapprovisionnement}">#{lab.LC_PRA_lot_reapprov} </span>
                    <pe:inputNumber value="#{managedStockArticle.article.lotLivraison}"/>   
                    <span title="#{lab.LC_PRA_interval_reapprovisionnement}">Int.Reappro </span>
                    <h:panelGroup id="_val_delai_alert">
                        <pe:inputNumber value="#{managedStockArticle.article.intervalApprov}" style="width: 30%"
                                        disabled="#{(managedStockArticle.article.modeReappro != 'PERIODIQUE')}"/>
                        <p:spacer/>
                        <h:selectOneMenu value="#{managedStockArticle.article.uniteInterval}" disabled="#{(managedStockArticle.article.modeReappro != 'PERIODIQUE')}">
                            <f:selectItems value="#{constantes.UNITES_TIMES_ALL}" var="tps" 
                                           itemLabel="#{tps[1]}" itemValue="#{tps[0]}" />    
                        </h:selectOneMenu> 
                    </h:panelGroup>   
                    <f:facet name="footer">
                        <div align="right">
                            <span>#{lab.LC_PRA_operation_dans_lot} </span>
                            <h:selectBooleanCheckbox value="#{managedStockArticle.article.requiereLot}"/>
                        </div>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddArticleDepot.hide()"
                                 actionListener="#{managedStockArticle.saveNewArticle()}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de la commande liée a la facture
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="data_contenus_fa_bla">
            <p:dialog widgetVar="dlgContenuFABLA" modal="true" width="80%"  closeOnEscape="true"> 
                <f:facet name="header">
                    <span>#{lab.LC_PRA_facture} N° </span>           
                    <h:panelGroup rendered="#{managedLivraisonAchat.selectDoc.id gt 0}">
                        <p:commandLink style="color:white" global="false" value="#{managedLivraisonAchat.selectDoc.documentLie.numDoc}" actionListener="#{managedLivraisonAchat.onSelectDistantObject(managedLivraisonAchat.selectDoc.documentLie)}"/>                        
                    </h:panelGroup>
                    <h:panelGroup rendered="#{managedLivraisonAchat.selectDoc != null?managedLivraisonAchat.selectDoc.id le 0:true}">
                        <span>#{managedLivraisonAchat.facture.numDoc}</span> 
                    </h:panelGroup>
                    <p:spacer width="5" height="5" styleClass="#{managedLivraisonAchat.facture.statutLivre}" title="#{lab.LC_PRA_statut} : #{managedLivraisonAchat.giveNameStatut(managedLivraisonAchat.facture.statutLivre)}"
                              style="border: 2px solid white; border-radius: 5px;padding: 3px;margin-top: 2px;margin-left: 10px;float: right;cursor: pointer"/>
                </f:facet>
                <p:dataTable value="#{managedLivraisonAchat.facture.contenus}" var="y" rowKey="#{y.id}" rowIndexVar="yIdx">
                    <p:column headerText="N°" style="width: 5%">
                        <span title="#{lab.LC_PRA_numero_serie}: #{y.numSerie}">#{yIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRA_ref}. " style="width: 12%">
                        <span title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}">#{y.article.refArt}</span>
                        <h:graphicImage library="img" name="comment.png" width="15" height="15" rendered="#{y.onComment}" style="float: right" title="#{lab.LC_PRA_commenté}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_article}">
                        <span title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}">#{y.article.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_qte}" style="width: 8%;text-align: center">
                        <h:outputText value="#{y.quantiteRecu}" converter="#{managedLivraisonAchat.converterStock}" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_prix}" style="width: 10%;text-align: right">
                        <h:outputText value="#{(y.prixAchat)}" converter="#{managedLivraisonAchat.converter}" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRA_rem}" style="width: 10%;text-align: right">
                        <h:outputText value="#{y.remise}" converter="#{managedLivraisonAchat.converter}" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PRA_taxe}" style="width: 10%;text-align: right">
                        <h:outputText value="#{y.taxe}" converter="DNS" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_total}" style="width: 12%;text-align: right">
                        <h:outputText value="#{y.prixTotal}" converter="#{managedLivraisonAchat.converter}" title="#{lab.LC_PRA_numero_serie} : #{y.numSerie}"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAddArticle" closeOnEscape="true"
                             message="#{lab.LC_PRA_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" onclick="dlgConfirmAddArticle.hide();
                        dlgAddArticleDepot.show()" global="false"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedLivraisonAchat.resetFicheArticle()}" oncomplete="dlgConfirmAddArticle.hide()" global="false"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAddArticleS" closeOnEscape="true"
                             message="#{lab.LC_PRA_text3}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" onclick="dlgConfirmAddArticleS.hide();
                        dlgAddArticleFsseur.show()" global="false"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedLivraisonAchat.resetFicheArticle()}" oncomplete="dlgConfirmAddArticleS.hide()" global="false"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PRA_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.deleteBean()}" oncomplete="dlgConfirmDelete.hide();collapseList('livraison_achat')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LC_PRA_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide();collapseList('livraison_achat')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog id="id_confirm_close_bla" hideEffect="explode" widgetVar="dlgConfirmClose" closeOnEscape="true"
                             message="Êtes-vous sûr de vouloir #{managedLivraisonAchat.selectDoc.cloturer?'dévérrouiller':'vérrouiller'}?" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.cloturer()}" oncomplete="dlgConfirmClose.hide()" update=":main_livraison_achat:data_livraison_achat"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmClose.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle" closeOnEscape="true"
                             message="#{lab.LC_PRA_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.deleteBeanArticle()}" oncomplete="dlgConfirmDeleteArticle.hide();collapseForm('contenu_livraison_achat')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle_" closeOnEscape="true"
                             message="#{lab.LC_PRA_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.deleteBeanArticle_()}" oncomplete="dlgConfirmDeleteArticle_.hide();collapseForm('contenu_livraison_achat')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeInventaireByCancel" closeOnEscape="true" header="#{lab.LC_PBRA_attention}"
                             message="#{lab.LC_PRA_text5}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedLivraisonAchat.annulerOrderByForce()}" oncomplete="dlgConfirmChangeInventaireByCancel.hide()"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeInventaireByCancel.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog widgetVar="dlgConfirmChangeInventaireByValid" closeOnEscape="true" header="#{lab.LC_PBRA_attention}"
                             message="#{lab.LC_PRA_text5}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedLivraisonAchat.validerOrderByForce()}"
                                 oncomplete="dlgConfirmChangeInventaireByValid.hide()"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeInventaireByValid.hide()"/>
            </p:confirmDialog>
        </h:form> 
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuler" closeOnEscape="true"
                             message="#{lab.LC_PRA_text6}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.annulerOrder(true)}" oncomplete="dlgConfirmAnnuler.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAnnuler.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmRefuser" closeOnEscape="true"
                             message="#{lab.LC_PRA_text6}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.refuserOrder(true)}" oncomplete="dlgConfirmRefuser.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmRefuser.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanAchat" closeOnEscape="true"
                             message="#{lab.LC_PRA_text7}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedLivraisonAchat.cleanAchat()}" oncomplete="dlgCleanAchat.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanAchat.hide()"/>
            </p:confirmDialog>
        </h:form>       
        <h:form prependId="false">
            <p:confirmDialog header="#{lab.L_confirmation}" width="40%" widgetVar="dlgValidDocAll" message="#{lab.LCF_POD_text8}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedLivraisonAchat.validerOrderAll()}" oncomplete="dlgValidDocAll.hide()"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgValidDocAll.hide()" />
            </p:confirmDialog>
        </h:form>
        <!-->
        *****************************************************************************
        Début du formulaire
        *****************************************************************************
        <-->
        <h:form prependId="false" id="main_livraison_achat">    
            <div class="part_fix">
                <p:splitButton value="#{lab.L_enregistrer}" id="save_livraison_achat" actionListener="#{managedLivraisonAchat.saveNew()}" update="form_entete_livraison_achat @this"
                               icon="ui-icon-disk">
                    <p:menuitem value="#{lab.L_nouveau}" id="cancel_livraison_achat"  actionListener="#{managedLivraisonAchat.resetFiche()}" update="blog_form_livraison_achat save_livraison_achat" oncomplete="collapseForm('livraison_achat');"
                                icon="ui-icon-document"/>
                    <p:menuitem icon="ui-icon-print" value="#{lab.L_telecharger}" global="false" actionListener="#{managedLivraisonAchat.print(managedLivraisonAchat.selectDoc)}" 
                                ajax="false" title="#{lab.LC_PFV_telecharger_facture}" rendered="#{managedLivraisonAchat.docAchat.id gt 0}"/>                   
                    <p:menuitem icon="ui-icon-print" value="#{lab.L_telecharger_sans_entete}" global="false" actionListener="#{managedLivraisonAchat.print(managedLivraisonAchat.selectDoc, false)}" 
                                ajax="false" title="#{lab.LC_PFV_telecharger_facture}" rendered="#{managedLivraisonAchat.docAchat.id gt 0}"/>                   
                    <p:separator />
                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash"  onclick="dlgConfirmDelete.show()" global="false"/>
                </p:splitButton>
                <p:splitButton value="Valider" id="delete_livraison_achat" icon="ui-icon-check" onclick="dlgValidDocAll.show()"  global="false" style="font-size: 0.8em">
                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" onclick="dlgConfirmDelete.show()" global="false"/>
                </p:splitButton>
                <h:panelGroup style="margin-left: 25%">
                    <p:commandButton actionListener="#{managedLivraisonAchat.parcoursInAllResult(false)}" update="txt_parc_linear_livraison_achat save_livraison_achat" icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('livraison_achat')"/>
                    <h:inputText value="#{managedLivraisonAchat.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_livraison_achat"/>
                    <p:outputPanel autoUpdate="true">                        
                        <p:outputLabel value="/#{managedLivraisonAchat.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedLivraisonAchat.parcoursInAllResult(true)}" update="txt_parc_linear_livraison_achat save_livraison_achat" icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('livraison_achat')"/>
                </h:panelGroup>  
                <div style="float: right">
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('livraison_achat');
                            return false">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>               
                    <p:spacer />
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('livraison_achat');
                            return false" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>              
                    <p:spacer />        
                    <h:link style="display: none" title="#{lab.LC_PRA_mode_consultation}" onclick="collapseGrid('livraison_achat');
                            return false">
                        <p:graphicImage library="icones" name="ico_arbre.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link> 
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_livraison_achat">
                    <p:outputPanel id="blog_form_livraison_achat" style="width: 99%; margin: auto; background: white">
                        <h:panelGrid columns="1" style="width: 100%">
                            <p:outputPanel id="form_entete_livraison_achat">
                                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%;margin-bottom: -10px;margin-top: -10px" rendered="#{managedLivraisonAchat.docAchat.update}">
                                    <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: left;font-size: large;background: black;color: white">                                            
                                        <span style="font-size: initial">Num.Piece : </span>
                                        <h:outputText id="txt_reference_document_livraison_achat" value="#{managedLivraisonAchat.docAchat.numDoc}"/>
                                    </h:panelGrid>
                                    <h:panelGroup style="padding: 7px;float: right; position: relative; margin-top: 1%">
                                        <p:outputPanel id="grp_btn_etat_livraison_achat" styleClass="yvs_form_of">                                    
                                            <p:commandLink value="#{lab.L_editable}" styleClass="button-stateOF #{(managedLivraisonAchat.docAchat.statut == constantes.ETAT_EDITABLE)?'button-stateOF_actif':''}" 
                                                           disabled="#{!(managedLivraisonAchat.docAchat.statut != constantes.ETAT_SOUMIS
                                                                       or docAchat.statut == constantes.ETAT_VALIDE
                                                                       or docAchat.statut == constantes.ETAT_ANNULE)}"
                                                           actionListener="#{managedLivraisonAchat.annulerOrder(false)}"
                                                           process="@this" update="grp_btn_etat_livraison_achat"  />
                                            <p:commandLink value="#{(managedLivraisonAchat.docAchat.statut==constantes.ETAT_VALIDE)?'VALID&Eacute;':'VALIDER'}" styleClass="button-stateOF #{(managedLivraisonAchat.docAchat.statut==constantes.ETAT_VALIDE)?'button-stateOF_actif':''}" 
                                                           disabled="#{!(managedLivraisonAchat.docAchat.statut == constantes.ETAT_EDITABLE)}" 
                                                           actionListener="#{managedLivraisonAchat.validerOrder()}"
                                                           process="@this" update="grp_btn_etat_livraison_achat"  />
                                            <p:commandLink value="#{(managedLivraisonAchat.docAchat.statut==constantes.ETAT_ANNULE)?'ANNUL&Eacute;':'ANNULER'}" styleClass="button-stateOF #{(managedLivraisonAchat.docAchat.statut==constantes.ETAT_ANNULE)?'button-stateOF_actif':''}" 
                                                           disabled="#{managedLivraisonAchat.docAchat.statut == constantes.ETAT_ANNULE}" 
                                                           actionListener="#{managedLivraisonAchat.refuserOrder(false)}"
                                                           process="@this" update="grp_btn_etat_livraison_achat" />
                                        </p:outputPanel>                                                
                                    </h:panelGroup>                                     
                                </h:panelGrid> 
                            </p:outputPanel>
                            <p:outputPanel>
                                <div style="width: 40%;float: left">
                                    <h:panelGrid id="infos_document_livraison_achat" styleClass="yvs_table" columns="2" style="width: 100%" cellpadding="0" cellspacing="0">
                                        <f:facet name="header">
                                            <div align="left">
                                                <h:panelGroup id="zone_facture_bla" style="margin-left: 10px">
                                                    <span>#{lab.LC_PRA_facture} </span>  
                                                    <p:commandButton icon="ui-icon-cart" style="width: 20px;height: 22px;margin-left: 10px;background: white!important" title="#{lab.LC_PRA_contenu_facture}" global="false"
                                                                     update=":data_contenus_fa_bla" oncomplete="dlgContenuFABLA.show()" disabled="#{managedLivraisonAchat.facture.id lt 1}"/>
                                                    <h:inputText id="select_document_facture_achat" value="#{managedLivraisonAchat.facture.numDoc}" disabled="#{managedLivraisonAchat.docAchat.update and managedLivraisonAchat.facture.id gt 0}" 
                                                                 style="width: 150px;color: #{managedLivraisonAchat.facture.error?'red':''}">                
                                                        <p:ajax event="valueChange" listener="#{managedLivraisonAchat.searchFacture()}"
                                                                update="infos_document_livraison_achat blog_contenu_fa_bla :data_contenus_fa_bla blog_article_livraison_achat"/>                                                        
                                                    </h:inputText>
                                                    <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white!important" title="#{lab.LC_PRA_liste_facture}" oncomplete="dlgListFactures.show()"
                                                                     disabled="#{managedLivraisonAchat.docAchat.update and managedLivraisonAchat.facture.id gt 0}" global="false"/>
                                                    <h:panelGroup>
                                                        <h:outputText value="#{managedLivraisonAchat.facture.fournisseur.nom_prenom}" style="margin-left: 5px;font-size: 0.9em" rendered="#{managedLivraisonAchat.facture.id gt 0}"/>
                                                        <p:selectBooleanCheckbox value="#{managedLivraisonAchat.docAchat.genererFactureAuto}" style="margin-top: 3px" itemLabel="#{lab.LC_PRA_generer_facture}" rendered="#{managedLivraisonAchat.facture.id le 0}">
                                                            <p:ajax event="valueChange" global="false"/>
                                                        </p:selectBooleanCheckbox>
                                                    </h:panelGroup>
                                                    <h:panelGroup style="float: right;margin-right: 10px">
                                                        <h:panelGroup style="float: right; background: #FFF; color: #000; border: 1px solid #045491; padding: 3px; margin-right: -9px">
                                                            #{managedLivraisonAchat.docAchat.id}
                                                        </h:panelGroup>
                                                        <p:commandButton icon="ui-icon-gear" style="width: 25px; height: 25px" type="button" id="btn_print_opt" />
                                                        <p:contextMenu for="btn_print_opt" event="left click" style="width:220px">
                                                            <p:separator/>
                                                            <p:menuitem icon="ui-icon-trash" value="#{lab.L_supprimer}" global="false" actionListener="#{managedLivraisonAchat.deleteBean_(managedLivraisonAchat.selectDoc)}" oncomplete="dlgConfirmDelete_.show()"/>
                                                        </p:contextMenu>
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                            </div>
                                        </f:facet>
                                        <span>Date edition </span>
                                        <p:calendar value="#{managedLivraisonAchat.docAchat.dateDoc}" pattern="dd-MM-yyyy" size="10"
                                                    disabled="#{managedLivraisonAchat.docAchat.statut != constantes.ETAT_EDITABLE}"/>
                                        <span>#{lab.LC_PRA_fournisseur} </span>                                                                                          
                                        <h:panelGroup id="txt_fsseur_livraison_achat">
                                            <h:panelGroup rendered="#{!managedLivraisonAchat.isBon}">
                                                <h:inputText value="#{managedLivraisonAchat.docAchat.fournisseur.codeFsseur}" style="color: #{managedLivraisonAchat.docAchat.fournisseur.error?'red':''}"
                                                             readonly="#{managedLivraisonAchat.isBon}">
                                                    <p:ajax event="valueChange" global="false" listener="#{managedLivraisonAchat.searchFsseur()}" update="infos_document_livraison_achat"/>
                                                </h:inputText>    
                                                <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PRA_liste_fournisseurs}" global="false"
                                                                 rendered="#{!managedLivraisonAchat.isBon}"
                                                                 actionListener="#{managedLivraisonAchat.initFsseurs()}" oncomplete="dlgListFournisseurs.show()"/> 
                                                <h:outputText value="#{managedLivraisonAchat.docAchat.fournisseur.nom_prenom}" style="margin-left: 10px;color: #009999"/>
                                            </h:panelGroup>                                            
                                            <h:inputText value="#{managedLivraisonAchat.docAchat.fournisseur.codeFsseur}" style="color: #{managedLivraisonAchat.docAchat.fournisseur.error?'red':''};width: 95%"
                                                         rendered="#{managedLivraisonAchat.isBon}"/>   
                                        </h:panelGroup> 
                                        <span title="#{lab.LC_PRA_categorie_comptable}">#{lab.L_categorie} </span>
                                        <h:inputText id="txt_cc_livraison_achat" value="#{managedLivraisonAchat.docAchat.categorieComptable.codeCategorie}" style="width: 95%" readonly="true"/>
                                        <span>#{lab.LC_PRA_depot} </span>
                                        <h:panelGroup>
                                            <h:selectOneMenu value="#{managedLivraisonAchat.docAchat.depotReception.id}" id="select_depot_livraison_achat"
                                                             disabled="#{managedLivraisonAchat.docAchat.statut != constantes.ETAT_EDITABLE}"
                                                             style="min-width: #{managedAgence.agences.size() gt 1?'160px':'95%'}; max-width: #{managedAgence.agences.size() gt 1?'300px':'95%'}">
                                                <f:selectItem itemLabel="--" itemValue="0"/>
                                                <f:selectItems value="#{managedDepot.depots}" var="dep_" itemLabel="#{dep_.designation}" itemValue="#{dep_.id}" />                                
                                                <p:ajax event="valueChange" global="false" listener="#{managedLivraisonAchat.chooseDepot()}"/>
                                            </h:selectOneMenu>
                                            <p:commandLink value="Selectionner agence" onclick="dlgAgenceForDepot.show()" global="false" rendered="#{managedAgence.agences.size() gt 1}"/> 
                                        </h:panelGroup>
                                        <span>#{lab.LC_PRA_tranche} </span>
                                        <h:selectOneMenu id="select_tranche_livraison_achat" value="#{managedLivraisonAchat.docAchat.tranche.id}" style="width: 95%"
                                                         disabled="#{managedLivraisonAchat.docAchat.statut != constantes.ETAT_EDITABLE}">
                                            <f:selectItem itemLabel="--" itemValue="0"/>
                                            <f:selectItems value="#{managedLivraisonAchat.tranches}" var="trh0" 
                                                           itemLabel="#{trh0.titre}" itemValue="#{trh0.id}" />                                
                                        </h:selectOneMenu> 
                                        <span>#{lab.LC_PRA_date_livr} </span>
                                        <h:panelGroup>
                                            <p:calendar value="#{managedLivraisonAchat.docAchat.dateLivraison}" pattern="dd-MM-yyyy" size="10"
                                                        disabled="#{managedLivraisonAchat.docAchat.statut != constantes.ETAT_EDITABLE}"/>
                                            <h:panelGroup style="float: right ;margin-right: 5%;margin-top: 3px"> 
                                                <h:outputText value=" #{lab.LC_PFA_type_achat} : " />
                                                <h:selectOneMenu value="#{managedLivraisonAchat.docAchat.typeAchat.id}" style="min-width: 120px" styleClass="yvs_table">
                                                    <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{0}"/>
                                                    <f:selectItems value="#{managedTypeDocDivers.typesDocDivers}" var="is_type" itemLabel="#{is_type.libelle}" itemValue="#{is_type.id}"/>
                                                    <p:ajax event="valueChange" global="false" listener="#{managedLivraisonAchat.chooseTypeAchat()}"/>
                                                </h:selectOneMenu> 
                                            </h:panelGroup>
                                        </h:panelGroup>
                                        <span>#{lab.L_reference} </span>
                                        <h:inputText id="txt_reference_livraison_achat" value="#{managedLivraisonAchat.docAchat.numPiece}" style="width: 95%"
                                                     disabled="#{managedLivraisonAchat.docAchat.statut != constantes.ETAT_EDITABLE}"/>
                                    </h:panelGrid>
                                </div>
                                <div style="width: 59%;margin-left: 41%">
                                    <p:outputPanel id="blog_contenu_fa_bla">
                                        <div style="border: solid 2px; height: 200px; padding: 2px; border-radius: 5px;">
                                            <span style="display: inline-block; background: #CCC; width: 100%; font-size: 0.9em">
                                                <span style="font-weight: bold">#{lab.LC_PRA_articles_livrer}</span>   
                                                <div style="float: right;margin-top: -3px">
                                                    <span style="float: left">#{lab.LC_PRA_ttc} :</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedLivraisonAchat.facture.montantTotal}" converter="#{managedLivraisonAchat.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                        <span style="font-size: 0.8em">Fcfa</span>
                                                    </h:panelGroup>  
                                                </div>
                                            </span>
                                            <div style="width: 99.5%; height: 163px; border: solid 1px; margin: auto;overflow-y: auto">                                                
                                                <p:dataTable id="data_contenu_fa_bla" value="#{managedLivraisonAchat.contenus_fa}" var="artb" rowKey="#{artb.id}"
                                                             rowIndexVar="artb_" selectionMode="single" style="max-height: 160px;overflow-y: auto">
                                                    <p:ajax event="rowSelect" listener="#{managedLivraisonAchat.loadOnViewArticleContenu}" update=":main_livraison_achat:form_contenu_livraison_achat"/>
                                                    <p:ajax event="rowUnselect" listener="#{managedLivraisonAchat.unLoadOnViewArticle}" update=":main_livraison_achat:form_contenu_livraison_achat"/>
                                                    <p:column headerText="N°" width="30">
                                                        <span>#{artb_+1}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_reference}" style="width: 18%">
                                                        <span>#{artb.article.refArt}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_article}">
                                                        <span>#{artb.article.designation}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_quantite}" style="text-align: right;width: 20%">
                                                        <h:outputText value="#{artb.quantiteRecu}" converter="#{managedLivraisonAchat.converterStock}"/>
                                                        <span title="#{artb.conditionnement.unite.libelle}">#{artb.conditionnement.unite.reference}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_total}" style="text-align: right;width: 12%">
                                                        <h:outputText value="#{artb.prixTotal}" converter="#{managedLivraisonAchat.converter}"/>
                                                    </p:column>
                                                    <p:column style="text-align: center" width="30">
                                                        <f:facet name="header" >
                                                            <p:commandButton icon="ui-icon-circle-plus" styleClass="button_gear" update=":main_livraison_achat:blog_form_contenu_livraison_achat" actionListener="#{managedLivraisonAchat.tryToSaveAllArticle()}"
                                                                             title="Ajouter tout le contenu dans le box de livraison"/>
                                                        </f:facet>
                                                        <p:commandButton icon="ui-icon-circle-plus" styleClass="button_gear"/>
                                                    </p:column>
                                                </p:dataTable>
                                            </div>
                                            <div>
                                                <p:outputPanel id="chp_bla_net_a_payer">
                                                    <h:panelGrid columns="4" style="font-size: 0.8em;width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                                        <span style="float: left">#{lab.LC_PRA_ttc} :</span>
                                                        <h:panelGroup style="float: right">
                                                            <h:outputText value="#{managedLivraisonAchat.docAchat.montantTotal}" converter="#{managedLivraisonAchat.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                            <span style="font-size: 0.8em">Fcfa</span>
                                                        </h:panelGroup>  
                                                        <span style="float: left">#{lab.LC_PRA_taxes} :</span>
                                                        <h:panelGroup style="float: right">
                                                            <h:outputText value="#{managedLivraisonAchat.docAchat.montantTaxe}" converter="#{managedLivraisonAchat.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                            <span style="font-size: 0.8em">Fcfa</span>
                                                        </h:panelGroup>
                                                    </h:panelGrid>  
                                                </p:outputPanel>
                                            </div>
                                        </div>  
                                    </p:outputPanel> 
                                </div>
                            </p:outputPanel>
                            <h:panelGrid class="headline_data" columns="2" styleClass="yvs_nostyle" style="width: 100%; font-size: 0.8em;cursor: pointer" onclick="slideZone()">
                                <b><span> #{lab.LC_PRA_contenus}</span></b>
                                <p:commandButton icon="ui-icon-circle-arrow-s" style="float: right;width: 20px;height: 20px;color: white;background:#FFF !important"
                                                 title="#{lab.LC_PRA_ajouter_contenu}" onclick="slideZone()" type="button" rendered="false"/>
                            </h:panelGrid> 
                            <h:panelGrid id="blog_form_contenu_livraison_achat" columns="1" style="width: 100%" styleClass="yvs_table">
                                <p:outputPanel id="form_contenu_livraison_achat">
                                    <div style="width: 100%;background: white;border: 2px solid #045491; border-radius: 5px">
                                        <p:outputPanel id="desc_contenu_livraison_achat" style="position: relative;width: 100%;padding-top: -2px;padding-bottom: -3px">
                                            <h:panelGrid columns="2" style="font-size:0.8em;width: 100%;background: #bcbcbf" styleClass="yvs_nostyle" rendered="#{managedLivraisonAchat.selectArt}">
                                                <h:panelGroup style="float: left">
                                                    <span style="font-weight: bold;color: #009999">#{managedLivraisonAchat.contenu.article.designation}</span>
                                                    <span> #{lab.LC_PRA_achete_a}</span>
                                                    <h:outputText value="#{managedLivraisonAchat.contenu.article.pua}" converter="#{managedLivraisonAchat.converter}" style="font-weight: bold;color: #009999"/>
                                                    <span>#{managedLivraisonAchat.currentScte.devise}  (#{lab.LC_PRA_vendu_a} </span>
                                                    <h:outputText value="#{managedLivraisonAchat.contenu.conditionnement.prix}" converter="#{managedLivraisonAchat.converter}" style="font-weight: bold;color: #000"/>
                                                    <span>#{managedLivraisonAchat.currentScte.devise})  </span>
                                                </h:panelGroup>
                                                <h:panelGroup style="float: right">
                                                    <h:outputText value="#{managedLivraisonAchat.contenu.article.stock}" converter="#{managedLivraisonAchat.converterStock}" style="font-weight: bold;color: #009999"/>
                                                    <h:outputText value=" #{managedLivraisonAchat.contenu.conditionnement.unite.reference}"/>
                                                    <span> #{lab.LC_PRA_en_stock} </span>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                        <h:panelGrid columns="#{managedLivraisonAchat.contenu.article.requiereLot?'7':'6'}" styleClass="yvs_nostyle" style="font-size: 0.9em" cellpadding="0" cellspacing="0"> 
                                            <h:outputText value="#{lab.L_article}" />
                                            <h:outputText value="#{lab.L_conditionnement}" />
                                            <h:outputText value="#{lab.LC_PRA_prix_u}" />
                                            <h:outputText value="#{lab.L_quantite}" title="#{lab.LC_PRA_quantite_a_recevoir}"/>
                                            <h:outputText value="#{lab.LC_PRA_qte_commandee}" title="#{lab.LC_PRA_quantite_commandee}" />
                                            <h:outputText value="#{lab.LC_PRA_lot}" rendered="#{managedLivraisonAchat.contenu.article.requiereLot}"/>
                                            <span style="margin-left: 100%">&nbsp;</span>  
                                            <h:panelGroup id="blog_article_livraison_achat">
                                                <h:panelGroup rendered="#{!managedLivraisonAchat.isBon}">
                                                    <h:inputText value="#{managedLivraisonAchat.contenu.article.refArt}" style="color: #{managedLivraisonAchat.contenu.article.error?'red':''}" disabled="#{managedLivraisonAchat.contenu.id gt 0}">
                                                        <p:ajax event="valueChange" global="false" listener="#{managedLivraisonAchat.searchArticle()}" update="form_contenu_livraison_achat" oncomplete="collapseForm('contenu_livraison_achat')"/>
                                                    </h:inputText>    
                                                    <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="Liste Articles" global="false"
                                                                     actionListener="#{managedLivraisonAchat.initArticles()}" oncomplete="dlgListArticle.show()" disabled="#{managedLivraisonAchat.contenu.id gt 0}"/>
                                                </h:panelGroup> 
                                                <h:inputText value="#{managedLivraisonAchat.contenu.article.refArt}" readonly="true" rendered="#{managedLivraisonAchat.isBon}" style="width: 95%"
                                                             title="#{lab.LC_PRA_text8}"/>
                                            </h:panelGroup>     
                                            <h:panelGroup>
                                                <h:selectOneMenu value="#{managedLivraisonAchat.contenu.conditionnement.id}" style="min-width: 120px" title="#{lab.LC_PRA_selectionner_conditionnement}" tabindex="15" rendered="#{!managedLivraisonAchat.isBon}">
                                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                                    <f:selectItems value="#{managedLivraisonAchat.contenu.article.conditionnements}" var="un" itemLabel="#{un.unite.reference}" itemValue="#{un.id}"/>
                                                    <p:ajax event="valueChange" global="false" listener="#{managedLivraisonAchat.chooseConditionnement()}" update="desc_contenu_livraison_achat txt_prix_achat_livraison_achat"/>
                                                </h:selectOneMenu>   
                                                <h:inputText  value="#{managedLivraisonAchat.contenu.conditionnement.unite.reference}" readonly="true" rendered="#{managedLivraisonAchat.isBon}"/>                            
                                            </h:panelGroup>
                                            <h:inputText id="txt_prix_achat_livraison_achat" value="#{managedLivraisonAchat.contenu.prixAchat}"  style="width: 100px">
                                                <p:ajax event="blur" global="false" listener="#{managedLivraisonAchat.onPrixBlur(false)}" />
                                            </h:inputText>
                                            <h:inputText value="#{managedLivraisonAchat.contenu.quantiteRecu}" style="width: 100px;text-align: right">
                                                <p:ajax event="blur" global="false" listener="#{managedLivraisonAchat.onQuantiteBlur()}" />
                                            </h:inputText>
                                            <h:panelGroup>
                                                <h:inputText  value="#{managedLivraisonAchat.contenu.quantiteCommende}" style="text-align: center;width: #{managedLivraisonAchat.contenu.quantiteBonus gt 0?'100px':'125px'}" converter="#{managedLivraisonAchat.converterStock}" readonly="true"/>  
                                                <h:panelGroup style="margin-left: -5px" rendered="#{managedLivraisonAchat.contenu.quantiteBonus gt 0}">
                                                    <span> + </span>
                                                    <h:inputText value="#{managedLivraisonAchat.contenu.quantiteBonus}" style="width: 100px;text-align: center" converter="#{managedLivraisonAchat.converterStock}" readonly="true"/>  
                                                </h:panelGroup>
                                            </h:panelGroup>
                                            <h:inputText id="select_lot_livraison_achat" value="#{managedLivraisonAchat.contenu.lot.numero}" style="color: #{managedLivraisonAchat.contenu.lot.id lt 1?'red':''}"
                                                         rendered="#{managedLivraisonAchat.contenu.article.requiereLot}">
                                                <p:ajax event="valueChange" listener="#{managedLivraisonAchat.findLotReception(managedLivraisonAchat.contenu)}" update="@this"/>
                                            </h:inputText>
                                            <p:commandButton id="save_contenu_livraison_achat" value="#{lab.L_ajouter}" update="blog_form_contenu_livraison_achat :main_livraison_achat:chp_bla_net_a_payer"
                                                             actionListener="#{managedLivraisonAchat.saveNewArticle()}" oncomplete="collapseForm('contenu_livraison_achat')" icon="ui-icon-circle-plus"/>
                                        </h:panelGrid>
                                    </div>
                                </p:outputPanel>
                                <p:outputPanel>
                                    <h:inputHidden id="input_hide_contenu_livraison_achat" value="#{managedLivraisonAchat.tabIds_article}"/>
                                    <p:dataTable id="data_contenu_livraison_achat" value="#{managedLivraisonAchat.docAchat.contenus}" var="artf" rowKey="#{artf.id}" 
                                                 rowIndexVar="artfIdx" selectionMode="single" style="max-height: 400px;overflow-y: auto">
                                        <p:ajax event="rowSelect" listener="#{managedLivraisonAchat.loadOnViewContenu}" 
                                                oncomplete="collapseForm('contenu_livraison_achat')"/>
                                        <p:ajax event="rowUnselect" listener="#{managedLivraisonAchat.unLoadOnViewContenu}" oncomplete="collapseForm('contenu_livraison_achat')"/>
                                        <p:column width="30" headerText="N°">
                                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{artf.new_}"/>
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                #{artfIdx+1}
                                            </span>
                                        </p:column>
                                        <p:column width="30" headerText="ID">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                #{artf.id}
                                            </span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_reference}" style="width: 15%">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                #{artf.article.refArt}
                                            </span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_article}">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                #{artf.article.designation}
                                            </span>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PRA_lot}" style="text-align: center;width: 10%" rendered="#{managedLivraisonAchat.currentParam.useLotReception}">
                                            <span >#{artf.lot.numero}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_quantite}" style="text-align: right;width: 10%">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                <h:outputText value="#{artf.quantiteRecu}" converter="#{managedLivraisonAchat.converterStock}" />
                                            </span>
                                            <span title="#{artf.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{artf.conditionnement.unite.reference}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PRA_prix_a}" style="text-align: right;width: 10%">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                <h:outputText value="#{artf.prixAchat}" converter="#{managedLivraisonAchat.converter}"  />
                                            </span>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PRA_rem}" style="text-align: right;width: 10%" rendered="false">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                <h:outputText value="#{artf.remise}" converter="#{managedLivraisonAchat.converter}" />
                                            </span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_total}" style="text-align: right;width: 12%">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                <h:outputText value="#{artf.prixTotal}" converter="#{managedLivraisonAchat.converter}" />
                                            </span>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PRA_prix_v}" style="text-align: right;width: 10%">
                                            <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                                <h:outputText value="#{artf.conditionnement.prix}" converter="#{managedLivraisonAchat.converter}"  />
                                            </span>
                                        </p:column>
                                        <p:column style="text-align: center;" width="25">
                                            <p:commandLink style="width: 80%" styleClass="contenu contenu_#{artf.statut}" actionListener="#{managedLivraisonAchat.changeStatutLine(artf)}" global="false"
                                                           value="#{artf.statut}" title="Statut : #{managedLivraisonAchat.giveNameStatut(artf.statut)}" update="data_contenu_livraison_achat"/>
                                        </p:column>
                                        <p:column width="20" style="text-align: center">
                                            <f:facet name="header">
                                                <p:contextMenu for="btn_option_head_contenu_livraison_achat" event="left click" style="font-size: 0.8em;width: 220px">
                                                    <p:menuitem id="menu-search_contenu_bla" value="#{lab.L_rechercher}" icon="ui-icon-search" global="false"/>
                                                </p:contextMenu>
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_head_contenu_livraison_achat" type="button"/>
                                                <p:overlayPanel for="menu-search_contenu_bla" hideEffect="fade" style="width: 200px;background: black;color: white">
                                                    <h:inputText value="#{managedLivraisonAchat.articleContenu}" style="width:100%">
                                                        <p:ajax event="blur" listener="#{managedLivraisonAchat.findContenusByArticle()}" update="data_contenu_livraison_achat"/>
                                                    </h:inputText>
                                                </p:overlayPanel>
                                            </f:facet>
                                            <p:contextMenu for="btn_option_contenu_livraison_achat" event="left click" style="font-size: 0.8em;width: 200px" styleClass="context_menu">
                                                <p:menuitem value="#{artf.calculPr?'Désactiver':'Activer'} le calcul du pr" icon="#{artf.calculPr?'ui-icon-pause':'ui-icon-play'}"
                                                            actionListener="#{managedLivraisonAchat.changeCalculPr(artf)}" update="data_contenu_livraison_achat"/>
                                                <p:menuitem value="#{lab.LC_PRA_transferer}" icon="ui-icon-arrowthickstop-1-e" actionListener="#{managedLivraisonAchat.buildTransfertArticle(artf)}" oncomplete="dlgSendArticle.show()"
                                                            disabled="#{managedLivraisonAchat.docAchat.statut != constantes.ETAT_VALIDE}"/>
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedLivraisonAchat.deleteBeanArticle_(artf)}" oncomplete="dlgConfirmDeleteArticle_.show()"/>
                                            </p:contextMenu>                           
                                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_contenu_livraison_achat" type="button"/>
                                        </p:column> 
                                        <p:column width="20" style="text-align: center">
                                            <f:facet name="header">
                                                <h:selectBooleanCheckbox styleClass="chek_all_line_contenu_livraison_achat" value="false"
                                                                         onclick="selectionAllLineTab(#{managedLivraisonAchat.docAchat.contenus.size()}, 'contenu_livraison_achat')">
                                                </h:selectBooleanCheckbox>
                                            </f:facet>
                                            <h:selectBooleanCheckbox  value="#{artf.selectActif}" styleClass="chek_line_contenu_livraison_achat"  
                                                                      onclick="selectionLineTab(#{artf.id}, 'contenu_livraison_achat')">
                                            </h:selectBooleanCheckbox>
                                        </p:column>
                                    </p:dataTable>
                                    <p:commandButton id="delete_contenu_livraison_achat" value="Supprimer" style="float: right"
                                                     onclick="dlgConfirmDeleteArticle.show()"/>
                                </p:outputPanel>
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:outputPanel>
                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="yvs_list_livraison_achat" style="width: 99%; margin: auto; background: white">
                    <div class="part_list">
                        <h:inputHidden id="input_hide_livraison_achat" value="#{managedLivraisonAchat.tabIds}"/>
                        <p:dataTable id="data_livraison_achat"  value="#{managedLivraisonAchat.documents}" var="fichf" rowKey="#{fichf.id}"
                                     selectionMode="single" rowIndexVar="fichfIdx">
                            <p:ajax event="rowSelect" listener="#{managedLivraisonAchat.loadOnView}" update="data_livraison_achat :main_livraison_achat:input_hide_livraison_achat"
                                    oncomplete="collapseForm('livraison_achat');collapseForm('contenu_livraison_achat')"/>
                            <p:ajax event="rowToggle" listener="#{managedLivraisonAchat.displayContent(fichf)}" global="false"/>
                            <p:column width="30" >
                                <p:rowToggler/>
                            </p:column>
                            <p:column width="30" headerText="N°" styleClass="statut_#{fichf.statut}">
                                <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{fichf.id eq managedLivraisonAchat.docAchat.id}"/>
                                <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{fichf.cloturer}"/>     
                                <span>#{fichfIdx+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" style="width: 15%" styleClass="statut_#{fichf.statut}">
                                <span>#{fichf.numDoc}</span>      
                                <h:panelGroup style="float: right">
                                    <h:outputText title="#{lab.LC_PRA_facturation_auto}" value="A" rendered="#{fichf.genererFactureAuto and fichf.documentLie eq null}" styleClass="style_statut" style="font-size: 0.8em"/>
                                </h:panelGroup>
                            </p:column>
                            <p:column headerText="#{lab.LC_PRA_date_livraison}" style="text-align: center;width: 12%" styleClass="statut_#{fichf.statut}">
                                <h:outputText value="#{fichf.dateDoc}" converter="DDMMYYYY" />
                            </p:column>
                            <p:column headerText="#{lab.LC_PRA_fournisseur}" styleClass="statut_#{fichf.statut}">
                                <h:outputText value="#{fichf.fournisseur.tiers.nom_prenom}" />
                            </p:column>
                            <p:column headerText="#{lab.LC_PRA_depot}" style="width: 12%" styleClass="statut_#{fichf.statut}">
                                <span>#{fichf.depotReception.designation}</span>
                            </p:column>
                            <p:column headerText="#{lab.LC_PRA_tranche}" style="text-align: center;width: 12%" styleClass="statut_#{fichf.statut}">
                                <h:outputText value="#{fichf.tranche.heureDebut}" converter="TIME" />
                                -
                                <h:outputText value="#{fichf.tranche.heureFin}" converter="TIME" />
                            </p:column>
                            <p:column headerText="#{lab.LC_PRA_facture}" style="width: 15%" styleClass="statut_#{fichf.statut}">
                                <span>#{fichf.documentLie.numDoc}</span>
                                <p:spacer width="10px" style="float: right;margin-top: 2px" styleClass="#{fichf.documentLie.statut}"/>
                            </p:column>
                            <p:column width="20" style="text-align: center" styleClass="statut_#{bon.statut}">
                                <p:contextMenu for="btn_option_livraison_achat" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                    <p:menuitem icon="ui-icon-document" value="Voir la facture" actionListener="#{managedLivraisonAchat.setSelectDoc(fichf)}" global="false" update=":data_contenus_fa_bla" oncomplete="dlgContenuFABLA.show()" rendered="#{fichf.documentLie.id > 0}"/>
                                    <p:menuitem icon="ui-icon-carat-2-e-w" value="#{lab.LC_PRA_generer_facture}" actionListener="#{managedLivraisonAchat.genereFactureAchat(fichf)}" rendered="#{fichf.documentLie !=null?fichf.documentLie.id lt 1 :true}"/>
                                    <p:separator style="width: 100%"/>
                                    <p:menuitem value="#{fichf.cloturer?'Dévérrouiller':'Vérrouiller'}" icon="#{fichf.cloturer?'ui-icon-unlocked':'ui-icon-locked'}" 
                                                global="false" actionListener="#{managedLivraisonAchat.cloturer(fichf)}" oncomplete="dlgConfirmClose.show()"/>
                                    <p:menuitem value="#{lab.LC_PRA_reconstruire_ref}" icon="ui-icon-refresh"  actionListener="#{managedLivraisonAchat.reBuildNumero(fichf,true,true)}" title="#{lab.LC_PRA_reconstruire_reference}"  />
                                    <p:menuitem value="Valider" icon="ui-icon-check" actionListener="#{managedLivraisonAchat.validerOrderOne(bon, true, true)}" update="data_livraison_achat"/>  
                                    <p:separator style="width: 100%"/>
                                    <p:menuitem value="#{lab.L_telecharger}" icon="ui-icon-circle-arrow-s" global="false"  
                                                actionListener="#{managedLivraisonAchat.print(fichf)}" ajax="false"/>
                                    <p:menuitem value="#{lab.L_telecharger_sans_entete}" icon="ui-icon-circle-arrow-s" global="false"  actionListener="#{managedLivraisonAchat.print(fichf, false)}" ajax="false"/>
                                    <p:separator style="width: 100%"/>
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedLivraisonAchat.deleteBean_(fichf)}" oncomplete="dlgConfirmDelete_.show()"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_livraison_achat" type="button"/>
                            </p:column> 
                            <p:column width="25" style="text-align: center" styleClass="statut_#{fichf.statut}">
                                <f:facet name="header">
                                    <h:selectBooleanCheckbox styleClass="chek_all_line_livraison_achat" value="false"
                                                             onclick="selectionAllLineTab(#{managedLivraisonAchat.documents.size()}, 'livraison_achat')">
                                    </h:selectBooleanCheckbox>
                                </f:facet>
                                <h:selectBooleanCheckbox  value="#{fichf.selectActif }" styleClass="chek_line_livraison_achat" 
                                                          onclick="selectionLineTab(#{fichfIdx}, 'livraison_achat')">
                                </h:selectBooleanCheckbox>
                            </p:column>   
                            <p:rowExpansion>
                                <p:dataTable id="dt_row_ex_#{fichf.id}" value="#{fichf.contenus}" var="artf" rowKey="#{artf.id}" rowIndexVar="artfIdx">
                                    <p:column width="30" headerText="N°">
                                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{artf.new_}"/>
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            #{artfIdx+1}
                                        </span>
                                    </p:column>
                                    <p:column width="30" headerText="ID">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            #{artf.id}
                                        </span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_reference}" style="width: 15%">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            #{artf.article.refArt}
                                        </span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_article}">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            #{artf.article.designation}
                                        </span>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PRA_lot}" style="text-align: center;width: 10%" rendered="#{managedLivraisonAchat.currentParam.useLotReception}">
                                        <span >#{artf.lot.numero}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_quantite}" style="text-align: right;width: 10%">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            <h:outputText value="#{artf.quantiteRecu}" converter="#{managedLivraisonAchat.converterStock}" />
                                        </span>
                                        <span title="#{artf.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{artf.conditionnement.unite.reference}</span>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PRA_prix_a}" style="text-align: right;width: 10%">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            <h:outputText value="#{artf.prixAchat}" converter="#{managedLivraisonAchat.converter}"  />
                                        </span>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PRA_rem}" style="text-align: right;width: 10%" rendered="false">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            <h:outputText value="#{artf.remise}" converter="#{managedLivraisonAchat.converter}" />
                                        </span>
                                    </p:column>
                                    <p:column headerText="#{lab.L_total}" style="text-align: right;width: 12%">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            <h:outputText value="#{artf.prixTotal}" converter="#{managedLivraisonAchat.converter}" />
                                        </span>
                                    </p:column>
                                    <p:column headerText="#{lab.LC_PRA_prix_v}" style="text-align: right;width: 10%">
                                        <span title="#{managedLivraisonAchat.currentParam.useLotReception ? managedLivraisonAchat.ldf.format(artf.dateSave) : 'Lot N° '.concat(artf.lot.numero)}" >
                                            <h:outputText value="#{artf.conditionnement.prix}" converter="#{managedLivraisonAchat.converter}"  />
                                        </span>
                                    </p:column>
                                    <p:column style="text-align: center;" width="25">
                                        <p:commandLink style="width: 80%" styleClass="contenu contenu_#{artf.statut}" actionListener="#{managedLivraisonAchat.changeStatutLine(artf)}" global="false"
                                                       value="#{artf.statut}" title="Statut : #{managedLivraisonAchat.giveNameStatut(artf.statut)}" update="data_contenu_livraison_achat"/>
                                    </p:column>
                                </p:dataTable>
                            </p:rowExpansion>
                        </p:dataTable>                                 
                        <span class="nbSelectlivraison_achat" style="font-size: .8em; font-style: italic; color: #828c95;"></span>
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                            <p:commandButton actionListener="#{managedLivraisonAchat.init(false)}" global="false" update="data_livraison_achat" icon="ui-icon-circle-triangle-w" disabled="#{managedLivraisonAchat.paginator.disPrev}"/>
                            <p:outputPanel >
                                <p:inplace label="#{managedLivraisonAchat.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                    <pe:inputNumber value="#{managedLivraisonAchat.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                        <p:ajax event="blur" listener="#{managedLivraisonAchat.gotoPagePaginator()}" update="data_livraison_achat"/>
                                    </pe:inputNumber>
                                </p:inplace><p:outputLabel value="/#{managedLivraisonAchat.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                            </p:outputPanel>
                            <p:commandButton actionListener="#{managedLivraisonAchat.init(true)}" global="false" update="data_livraison_achat" icon="ui-icon-circle-triangle-e" disabled="#{managedLivraisonAchat.paginator.disNext}"/>
                            <p:selectOneMenu value="#{managedLivraisonAchat.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedLivraisonAchat.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                <f:selectItems value="#{managedLivraisonAchat.paginations}"/>
                                <p:ajax event="valueChange" global="false" update="data_livraison_achat"/>
                            </p:selectOneMenu>
                        </p:outputPanel>       
                    </div>                                             
                </div>
                <!-->
                 *****************************************************************************
                 Vue Grid
                 *****************************************************************************
                <-->
                <div class="yvs_grid_livraison_achat" style="width: 99%; margin: auto; background: white">

                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">            
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative; bottom: -20px" width="20" height="20"
                            styleClass="img_slide" title="cacher"/>  
            <div class="zone_find">
                <div class="yvs_form_livraison_achat display_auteur" align="right" style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedLivraisonAchat.selectDoc.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le}<h:outputText value="#{managedLivraisonAchat.selectDoc.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedLivraisonAchat.selectDoc.author.users.nomUsers}" styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <h:panelGrid id="blog_search_bla" columns="2" style="width: 100%; font-size: 0.8em" cellpadding="0" cellspacing="0">
                    <h:panelGrid columns="7" style="float: left; font-size: 1.0em" cellpadding="0" cellspacing="0">
                        <h:outputText value="" />
                        <h:panelGroup>
                            <h:selectBooleanCheckbox value="#{managedLivraisonAchat.date_}">
                                <p:ajax event="valueChange" listener="#{managedLivraisonAchat.chooseDateSearch()}" update="blog_date_search_livraison_achat :main_livraison_achat:data_livraison_achat"
                                        />
                            </h:selectBooleanCheckbox>
                            <h:outputText value="#{lab.L_date}" />
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputText value="#{lab.LC_PRA_statut}" style="float:left;margin-top: 2px"/>
                            <h:selectOneMenu value="#{managedLivraisonAchat.egaliteStatut}" style="float:right;margin-right: 5px;">
                                <f:selectItem itemLabel="#{lab.LC_PRA_egale}" itemValue="="/>
                                <f:selectItem itemLabel="#{lab.LC_PRA_different}" itemValue="!="/>
                                <p:ajax event="valueChange" update=":main_livraison_achat:data_livraison_achat" listener="#{managedLivraisonAchat.addParamStatut()}" />
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <h:outputText value="#{lab.L_cloturer}" />
                        <h:outputText value="#{lab.L_reference}" />
                        <h:outputText value="#{lab.LC_PRA_lier_facture}" />
                        <h:outputText value="" />
                        <p:commandButton icon="ui-icon-bullet" actionListener="#{managedLivraisonAchat.clearParams()}" title="#{lab.L_reset_param}" style="width: 20px; height: 22px" 
                                         update="blog_date_search_livraison_achat :main_livraison_achat:data_livraison_achat blog_search_bla"/>                        
                        <h:panelGroup id="blog_date_search_livraison_achat">
                            <p:calendar value="#{managedLivraisonAchat.dateDebut_}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedLivraisonAchat.date_}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" listener="#{managedLivraisonAchat.chooseDateSearch()}" update=":main_livraison_achat:data_livraison_achat"
                                        />
                            </p:calendar>
                            <p:spacer width="5px" style="background: black"/>
                            <p:calendar value="#{managedLivraisonAchat.dateFin_}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedLivraisonAchat.date_}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" listener="#{managedLivraisonAchat.chooseDateSearch()}" update=":main_livraison_achat:data_livraison_achat"
                                        />
                            </p:calendar>
                        </h:panelGroup>
                        <h:selectOneMenu value="#{managedLivraisonAchat.statut_}" valueChangeListener="#{managedLivraisonAchat.chooseStatut}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            <f:selectItem itemLabel="#{lab.L_annuler}" itemValue="#{constantes.ETAT_ANNULE}"/>
                            <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            <p:ajax event="valueChange" update=":main_livraison_achat:data_livraison_achat" />
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedLivraisonAchat.cloturer_}" valueChangeListener="#{managedLivraisonAchat.chooseCloturer}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                            <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                            <p:ajax event="valueChange" update=":main_livraison_achat:data_livraison_achat"/>
                        </h:selectOneMenu>
                        <h:inputText value="#{managedLivraisonAchat.numSearch_}">
                            <p:ajax event="valueChange" listener="#{managedLivraisonAchat.searchTranferts()}" update=":main_livraison_achat:data_livraison_achat"/>
                        </h:inputText>
                        <h:selectOneMenu value="#{managedLivraisonAchat.lieSearch}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                            <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                            <p:ajax event="valueChange" listener="#{managedLivraisonAchat.addParamLie()}" update=":main_livraison_achat:data_livraison_achat"/>
                        </h:selectOneMenu>
                        <p:commandLink type="button" onclick="dlgPlusOptions.show()" style="border: 2px solid #666; border-radius: 5px;padding: 2px" 
                                       value="#{lab.L_avancee}" global="false"/>
                    </h:panelGrid>
                    <h:panelGroup style="float: right">
                        <p:commandLink onclick="dlgCleanAchat.show()" type="button" style="border: 2px solid black; border-radius: 5px;padding: 3px;float: right" title="#{lab.LC_PRA_nettoyage_stock}">
                            <h:graphicImage library="img" name="clean.png" width="15" height="18"/>  
                        </p:commandLink>
                    </h:panelGroup>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>