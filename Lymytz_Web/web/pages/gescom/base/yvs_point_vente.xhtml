<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Points Ventes','modGescom', 'smenPointVente', true,managedPointVente)}
    </ui:define> 
    <ui:define name="contents">  
        #{managedUser.doNothing()}
        #{managedDepot.doNothing()}
        #{managedPointVente.loadAll()}
        #{Marticle.loadActifArticle('V')}
        #{Mdico.loadSecteurs()}
        #{managedAgence.loadAgence()}
        #{managedCreneauEmploye.load(true, false)} 
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 135);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('article_point');
                collapseForm('point_vente');
                collapseForm('point_vente_depot');
                slideZoneUp();
                _slideZoneUp();
            });
            function slideZoneUp() {
                $('.zone_editPC').slideUp();
            }
            function slideZoneDown() {
                $('.zone_editPC').slideDown();
            }
            function slideZone() {
                $('.zone_editPC').slideToggle("fast", function() {
                    //legend.children("span").html(value);
                });
            }
            function _slideZoneUp() {
                $('._zone_editPC').slideUp();
            }
            function _slideZoneDown() {
                $('._zone_editPC').slideDown();
            }
            function _slideZone() {
                $('._zone_editPC').slideToggle("fast", function() {
                    //legend.children("span").html(value);
                });
            }
        </script>

        <h:form>
            <p:remoteCommand name="updateBeanCaisse_" actionListener="#{managedPointVente.updateBean()}"/>
        </h:form> 

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des clients
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PC_liste_clients}" widgetVar="dlgListClients" closeOnEscape="true" width="50%" height="450" modal="true" dynamic="true">   
                <p:watermark for="txt_search_client_point_vente" value="#{lab.LC_PC_code_client}" />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_client_point_vente" value="#{managedClient.numSearch_}" style="float: left;text-align: center;margin-left: -10px">
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.searchByNum()}" update="data_client_point_vente"/>
                    </h:inputText>   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedClient.init(false)}" global="false" update="data_client_point_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedClient.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedClient.paginator.currentPage}/#{managedClient.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedClient.init(true)}" global="false" update="data_client_point_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedClient.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedClient.max}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedClient.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedClient.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_client_point_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>                               
                <p:dataTable id="data_client_point_vente"  value="#{managedClient.clients}" var="clt_" rowKey="#{clt_.id}"
                             selectionMode="single" rowIndexVar="cltIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedPointVente.loadOnViewClient}" oncomplete="dlgListClients.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{clt_.codeClient}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PC_nom}">
                        <span>#{clt_.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PC_zone}">
                        <span>#{clt_.tiers.region}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des livreurs
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCP_liste_users}" widgetVar="dlgListUsers" modal="true" width="50%"  closeOnEscape="true"> 
                <p:dataTable id="data_employe_creneau" value="#{managedUser.listUser}" var="art" rowKey="#{art.id}"
                             selectionMode="single" paginator="true" rows="20" paginatorAlwaysVisible="false" >
                    <p:ajax event="rowSelect" global="false" listener="#{managedCreneauEmploye.loadOnViewUsers}" oncomplete="dlgListUsers.hide()"/>
                    <p:column  style="width: 2%">
                        <span>#{art.codeUsers}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCP_noms}" style="width: 6%">
                        <span>#{art.nomUsers}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCP_groupe}" style="width: 4%">
                        <span>#{art.categorie.libelle}</span>
                    </p:column>
                </p:dataTable>
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:panelGroup>
                        <h:inputText value="#{managedUser.numSearch}" style="margin-left: -10px">
                            <p:ajax event="valueChange" global="false" update="data_employe_creneau" listener="#{managedUser.searchUsersActif(false)}"/>
                        </h:inputText>
                    </h:panelGroup>                    
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedUser.loadAll(false,false)}" global="false" update="data_employe_creneau" icon="ui-icon-circle-triangle-w" disabled="#{managedUser.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedUser.paginator.currentPage}/#{managedUser.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedUser.loadAll(true,false)}" global="false" update="data_employe_creneau" icon="ui-icon-circle-triangle-e" disabled="#{managedUser.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedUser.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedUser.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedUser.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_employe_creneau"/>
                        </p:selectOneMenu>
                    </p:outputPanel>  
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false" enctype="multipart/form-data">
            <p:dialog widgetVar="dlgUploadImg" width="300" height="100" closeOnEscape="true" resizable="false" modal="true">
                <p:fileUpload sizeLimit="100000" mode="advanced" dragDropSupport="true" 
                              allowTypes="/(\.|\/)(gif|jpe?g|png)$/" fileUploadListener="#{managedPointVente.handleFileUpload}"
                              uploadLabel="#{lab.L_envoyer}" label="#{lab.L_parcourir}" auto="true" oncomplete="dlgUploadImg.hide()"> 
                </p:fileUpload>
                <f:facet name="footer">
                    &copy; Lymytz
                </f:facet>
            </p:dialog>
        </h:form>

        <h:form id="main_creneau_employe" prependId="false">
            <p:dialog header="Ajouter un planning" widgetVar="dlgAddPlanning" closeOnEscape="true" resizable="false">
                <div class="dlg_part_fix">
                    <p:commandButton value="#{lab.L_enregistrer}" id="save_creneau_employe" actionListener="#{managedCreneauEmploye.saveNew()}" icon="ui-icon-disk"/>
                </div>
                <ui:include src="creneau_horaire/form.xhtml"/>
                <f:facet name="footer">
                    &copy; Lymytz
                </f:facet>
            </p:dialog>
        </h:form>

        <h:form id="main-more_infos" prependId="false">
            <p:dialog header="Plus de propriètes" widgetVar="dlgMoreInfos" closeOnEscape="true" resizable="false" width="30%">
                <h:panelGrid id="form-more_infos" columns="1" style="width: 100%">
                    <span>Code PIN : </span>
                    <h:inputText value="#{managedPointVente.pointVente.codePin}" style="color: #006666;width: 100%;text-align: center" >
                        <p:ajax event="valueChange" global="false"/>
                    </h:inputText>
                </h:panelGrid>
                <f:facet name="footer">
                    &copy; Lymytz
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
                *****************************************************************************
                Boite de dialogue des grilles de rabais
                *****************************************************************************
                <-->  
        <h:form prependId="false" id="main-grille_rabais">
            <p:dialog widgetVar="dlgGrilleRabais" header="#{lab.LC_PPV_grilles_rabais}" width="60%" closeOnEscape="true"> 
                <p:outputPanel id="blog-grille_rabais">
                    <h:panelGrid id="form-grille_rabais" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                        <f:facet name="header">
                            <div align="left">
                                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: left;font-weight: bold" cellpadding="0" cellspacing="0">
                                    <span>#{lab.LC_PPV_base} </span>
                                    <h:selectOneRadio value="#{managedPointVente.grille.base}" layout="grid"  styleClass="yvs_nostyle">
                                        <f:selectItem itemLabel="#{constantes.BASE_QTE} " itemValue="#{constantes.BASE_QTE}" />
                                        <f:selectItem itemLabel="#{constantes.BASE_CA} " itemValue="#{constantes.BASE_CA}" />
                                        <p:ajax event="valueChange" global="false"/>
                                    </h:selectOneRadio>
                                </h:panelGrid>
                            </div>
                        </f:facet>
                        <span>#{lab.LC_PPV_interval} </span>
                        <h:panelGrid columns="2" style="width: 100%;margin-left: -10px" styleClass="yvs_nostyle">
                            <h:selectBooleanCheckbox value="#{managedPointVente.grille.unique}" style="float: right">
                                <p:ajax event="valueChange" global="false"  update="txt-intervale_montant_rabais"/>
                            </h:selectBooleanCheckbox>
                            <h:panelGroup id="txt-intervale_montant_rabais">
                                <p:inputText value="#{managedPointVente.grille.montantMinimal}" disabled="#{managedPointVente.grille.unique}" style="text-align: right"/>
                                <p:spacer style="background: #000" width="5"/>
                                <p:inputText value="#{managedPointVente.grille.montantMaximal}" disabled="#{managedPointVente.grille.unique}" style="text-align: right"/>                                                                
                            </h:panelGroup>
                        </h:panelGrid>
                        <span>#{lab.LC_PPV_nature_montant} </span>
                        <h:selectOneRadio value="#{managedPointVente.grille.natureMontant}" layout="grid" styleClass="yvs_nostyle">
                            <f:selectItem itemLabel="#{constantes.NATURE_MTANT} " itemValue="#{constantes.NATURE_MTANT}" />
                            <f:selectItem itemLabel="#{constantes.NATURE_TAUX} " itemValue="#{constantes.NATURE_TAUX}" />
                        </h:selectOneRadio>
                        <span>#{lab.LC_PPV_valeur}</span>
                        <p:inputText value="#{managedPointVente.grille.montantRabais}" style="text-align: right;width: 120px"/> 
                    </h:panelGrid>
                    <div style="margin-top: 5px">                        
                        <p:commandButton value="#{lab.L_nouveau}" global="false" actionListener="#{managedPointVente.resetFicheGrilleRabais()}"
                                         update="form-grille_rabais" style="float: left"/>
                        <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedPointVente.saveNewGrille()}"
                                         update="blog-grille_rabais" style="float: right"/>
                    </div>
                    <p:outputPanel>
                        <p:dataTable id="data-grille_rabais" value="#{managedPointVente.selectRabais.tranches}" var="gril"
                                     rowKey="#{gril.id}" rowIndexVar="comIdx_" selectionMode="single" >
                            <p:ajax event="rowSelect" global="false" listener="#{managedPointVente.loadOnViewGrilleRabais}"/>
                            <p:ajax event="rowUnselect" global="false" listener="#{managedPointVente.unLoadOnViewGrilleRabais}"/>
                            <p:column headerText="N°" style="width: 0.25%">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{gril.new_}"/>
                                <span>#{comIdx_+1}</span>
                            </p:column>
                            <p:column headerText="#{lab.LC_PPV_valeur_min}" style="text-align: right;width: 1%">
                                <h:outputText rendered="#{gril.montantMinimal gt 0}" value="#{gril.montantMinimal}" converter="DN"/>
                                <h:outputText rendered="#{gril.montantMinimal le 0}" value=" #{lab.LC_PPV_min}"/> 
                            </p:column>
                            <p:column headerText="#{lab.LC_PPV_valeur_max}" style="text-align: right;width: 1.5%">
                                <h:outputText rendered="#{constantes.MAX_DOUBLE gt gril.montantMaximal}" value="#{gril.montantMaximal}" converter="DN"/>
                                <h:outputText rendered="#{gril.montantMaximal ge constantes.MAX_DOUBLE}" value=" #{lab.LC_PPV_max}"/> 
                            </p:column>
                            <p:column headerText="#{lab.LC_PPV_rabais}" style="text-align: right;width: 2%">
                                <h:outputText value="#{gril.montantRistourne}" converter="DN"/>
                                <h:outputText value="#{gril.natureMontant == constantes.NATURE_MTANT?'':'%'}"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PPV_base}" style="text-align: right;width: 1.5%">
                                <h:outputText value="#{gril.base}"/>
                            </p:column>
                            <p:column style="width: 1%;text-align: center">
                                <p:contextMenu for="btn_option-grille_rabais" event="left click" style="font-size: 0.8em">
                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPointVente.deleteBeanGrilleRabais(gril)}"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option-grille_rabais" type="button"/>
                            </p:column> 
                        </p:dataTable>
                    </p:outputPanel>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des rabais
        *****************************************************************************
        <-->  
        <h:form id="main-rabais_article_point" prependId="false">
            <p:dialog header="#{lab.LC_PPV_plan_rabais}" widgetVar="dlgRabais" width="50%" closeOnEscape="true"> 
                <p:outputPanel id="bloc-rabais_article_point">
                    <h:panelGrid id="form-rabais_article_point" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">                        
                        <f:facet name="header">
                            <h:panelGroup>
                                <div style="float: left">
                                    [<span>#{managedPointVente.selectArticle.article.article.refArt}</span>]
                                    <span>#{managedPointVente.selectArticle.article.article.designation}</span>
                                </div>
                                <div style="float: right">
                                    <p:selectBooleanCheckbox value="#{managedPointVente.rabais.actif}" itemLabel="Actif ?"/>
                                </div>
                            </h:panelGroup>
                        </f:facet>
                        <span>#{lab.LC_PPV_conditionnement} </span>             
                        <h:panelGroup id="select_unite_rabais_article_point">
                            <h:selectOneMenu value="#{managedPointVente.rabais.conditionnement.id}" style="min-width: 120px" title="#{lab.LC_PPV_selectionner_conditionnement}">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedPointVente.selectArticle.conditionnement.article.conditionnements}" var="un" 
                                               itemLabel="#{un.unite.reference}" itemValue="#{un.id}"/>
                                <p:ajax event="valueChange" global="false" listener="#{managedPointVente.chooseConditionnementRabais()}" update="select_unite_rabais_article_point"/>
                            </h:selectOneMenu>
                            <h:outputText value="#{managedPointVente.rabais.conditionnement.unite.libelle}" style="font-weight: bold; margin-left: 5px;color: #006666"/>  
                            <h:panelGroup style="float: right;margin-top: 5px;font-style: italic">
                                <span>#{lab.LC_PPV_vendu_a}</span>
                                <h:outputText value="#{managedPointVente.rabais.conditionnement.prix}" converter="DN" style="font-weight: bold"/>
                                <span style="font-size: 0.9em"> Fcfa</span>
                            </h:panelGroup>
                        </h:panelGroup>
                        <h:panelGroup>
                            <span>#{lab.LC_PPV_dates} </span>
                            <h:selectBooleanCheckbox value="#{managedPointVente.rabais.permanent}" title="#{lab.LC_PPV_permanent}" style="float: right">
                                <p:ajax event="valueChange" global="false" update="select_dates_rabais_article_point"/>
                            </h:selectBooleanCheckbox>
                        </h:panelGroup>
                        <h:panelGroup id="select_dates_rabais_article_point">
                            <span>#{lab.L_du} </span>
                            <p:calendar value="#{managedPointVente.rabais.dateDebut}" navigator="true" pattern="dd-MM-yyyy" disabled="#{managedPointVente.rabais.permanent}" size="8"/>
                            <span> #{lab.L_au} </span>
                            <p:calendar value="#{managedPointVente.rabais.dateFin}" navigator="true" pattern="dd-MM-yyyy" disabled="#{managedPointVente.rabais.permanent}" size="8"/>
                        </h:panelGroup>
                        <span>#{lab.LC_PPV_montant} </span>   
                        <h:panelGroup>
                            <h:inputText value="#{managedPointVente.rabais.montant}" style="text-align: right"/>
                            <span style="font-size: 0.9em"> Fcfa</span>
                        </h:panelGroup>
                        <f:facet name="footer">
                            <p:commandButton value="#{lab.L_nouveau}" style="float: left" actionListener="#{managedPointVente.resetFicheRabais()}" 
                                             update="form-rabais_article_point"/>
                            <p:commandButton value="#{lab.L_enregistrer}" style="float: right" actionListener="#{managedPointVente.saveNewRabais()}" 
                                             update="bloc-rabais_article_point"/>
                        </f:facet>
                    </h:panelGrid>
                    <p:dataTable id="data-rabais_article_point" value="#{managedPointVente.listRabais}" var="rab" rowKey="#{rab.id}"
                                 selectionMode="single" paginator="true" rows="20" paginatorAlwaysVisible="false" >
                        <p:ajax event="rowSelect" global="false" listener="#{managedPointVente.loadOnViewRabais}"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedPointVente.unLoadOnViewRabais}"/>
                        <p:column headerText="#{lab.LC_PPV_conditionnement}" style="text-align: center">
                            <span style="font-weight: bold">#{rab.article.conditionnement.unite.libelle}</span>
                        </p:column>
                        <p:column headerText="#{lab.LC_PPV_periodes}" style="text-align: center">
                            <h:outputText value="--#{lab.LC_PPV_permanent}--" rendered="#{rab.permanent}"/>
                            <h:panelGroup rendered="#{!rab.permanent}">
                                <h:outputText value="#{rab.dateDebut}" converter="DATE" style="margin-right: 2px"/>
                                <p:spacer width="5" style="background: black"/>
                                <h:outputText value="#{rab.dateFin}" converter="DATE" style="margin-left: 2px"/>                                
                            </h:panelGroup>
                        </p:column>
                        <p:column headerText="#{lab.LC_PPV_rabais}" style="text-align: right">
                            <h:outputText value="#{rab.montant}" converter="DN"/>
                            <span style="font-size: 0.9em"> Fcfa</span>
                        </p:column>
                        <p:column headerText="#{lab.L_actif}" style="width: 5%;text-align: center">
                            <h:graphicImage title="#{(rab.actif)?'Desactiver':'Activer'}" library="img"  name="#{(rab.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                        </p:column>
                        <p:column style="width: 5%;text-align: center">
                            <p:contextMenu for="btn_option-rabais_article_point" event="left click" style="font-size: 0.8em">
                                <p:menuitem value="Grille" icon="ui-icon-note" global="false" actionListener="#{managedPointVente.setSelectRabais(rab)}" 
                                            oncomplete="dlgGrilleRabais.show()" update=":main-grille_rabais:blog-grille_rabais"/>
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPointVente.deleteBeanRabais(rab)}" update="data-rabais_article_point"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option-rabais_article_point" type="button"/>
                        </p:column> 
                    </p:dataTable>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>  

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des conditionnements
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PPV_liste_conditionnements}" widgetVar="dlgListConditionnement" width="50%" closeOnEscape="true"> 
                <p:outputPanel id="blog_conditionnement_point">
                    <h:panelGrid id="form_conditionnement_point" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                        <f:facet name="header">
                            <div align="left" style="padding-left: 10px">
                                <span style="font-weight: normal">Article : <span style="font-weight: bold">#{managedPointVente.article.article.designation}</span></span>
                            </div>
                        </f:facet>
                        <span>#{lab.LC_PPV_conditionnement}</span>
                        <h:selectOneMenu value="#{managedPointVente.conditionnement.conditionnement.id}" style="width: 100%">
                            <f:selectItem itemValue="0" itemLabel="--"/>
                            <f:selectItems value="#{managedPointVente.article.article.conditionnements}" var="y" 
                                           itemValue="#{y.id}" itemLabel="#{y.unite.libelle}"/>
                            <p:ajax event="valueChange" global="false" listener="#{managedPointVente.chooseConditionnement()}"/>
                        </h:selectOneMenu>
                        <span>#{lab.LC_PPV_prix}</span>
                        <p:inputText value="#{managedPointVente.conditionnement.puv}" style="text-align: right"/>
                        <span>#{lab.LC_PPV_prix_min}</span>
                        <h:panelGroup>
                            <p:inputText value="#{managedPointVente.conditionnement.prixMin}" style="text-align: right"/>
                            <h:selectOneMenu value="#{managedPointVente.conditionnement.naturePrixMin}">
                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT} " itemValue="#{constantes.NATURE_MTANT}" />
                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX} " itemValue="#{constantes.NATURE_TAUX}" />
                            </h:selectOneMenu>
                        </h:panelGroup>
                        <span>#{lab.LC_PPV_remise}</span>
                        <h:panelGroup>
                            <p:inputText value="#{managedPointVente.conditionnement.remise}" style="text-align: right"/>
                            <h:selectOneMenu value="#{managedPointVente.conditionnement.natureRemise}">
                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT} " itemValue="#{constantes.NATURE_MTANT}" />
                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX} " itemValue="#{constantes.NATURE_TAUX}" />
                            </h:selectOneMenu>
                        </h:panelGroup>
                        <f:facet name="footer">
                            <p:commandButton value="#{lab.L_nouveau}" style="float: left" actionListener="#{managedPointVente.resetFicheConditionnement()}" 
                                             update="form_conditionnement_point"/>
                            <p:commandButton value="#{lab.L_enregistrer}" style="float: right" actionListener="#{managedPointVente.saveNewConditionnement()}" 
                                             update="blog_conditionnement_point"/>
                        </f:facet>
                    </h:panelGrid>
                    <p:dataTable id="data_conditionnement_point" value="#{managedPointVente.article.conditionnements}" var="cond" rowKey="#{cond.id}"
                                 selectionMode="single" paginator="true" rows="20" paginatorAlwaysVisible="false" >
                        <p:ajax event="rowSelect" global="false" listener="#{managedPointVente.loadOnViewConditionnement}"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedPointVente.unLoadOnViewConditionnement}"/>
                        <p:column headerText="#{lab.LC_PPV_conditionnement}" style="text-align: center">
                            <span>#{cond.conditionnement.unite.libelle}</span>
                        </p:column>
                        <p:column headerText="#{lab.LC_PPV_puv}" style="text-align: right">
                            <h:outputText value="#{cond.puv}" converter="DN"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PPV_prix_min}" style="text-align: right">
                            <h:outputText value="#{cond.prixMin}" converter="DN"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PPV_remise}" style="text-align: right">
                            <h:outputText value="#{cond.remise}" converter="DN"/>
                        </p:column>
                        <p:column width="20" style="text-align: center">
                            <p:commandButton actionListener="#{managedPointVente.deleteBeanConditionnement(cond)}" icon="ui-icon-circle-minus"
                                             global="false"  style="width: 20px; height: 20px" update="data_conditionnement_point"/>
                        </p:column>
                    </p:dataTable>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>  
        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PPV_liste_articles}" widgetVar="dlgListArticle" modal="true" width="50%"  closeOnEscape="true"> 
                <h:panelGrid columns="2" style="width: 100%;margin-bottom: -5px;margin-top: -5px" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <p:outputPanel style="float: left;margin-left: -10px">
                        <h:inputText value="#{Marticle.numSearch}">
                            <p:ajax event="valueChange" listener="#{Marticle.addParamReference()}" update="data_articles_point"/>
                        </h:inputText>
                    </p:outputPanel>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(false,false)}" global="false" update="data_articles_point" icon="ui-icon-circle-triangle-w" disabled="#{Marticle.pa.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{Marticle.pa.currentPage}/#{Marticle.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{Marticle.loadActifArticle(true,false)}" global="false" update="data_articles_point" icon="ui-icon-circle-triangle-e" disabled="#{Marticle.pa.disNext}"/>
                        <p:selectOneMenu value="#{Marticle.pa.rows}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{Marticle._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{Marticle.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_articles_point"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>
                <p:dataTable id="data_articles_point" value="#{Marticle.articlesResult}" var="art" rowKey="#{art.id}" selectionMode="single">
                    <p:ajax event="rowSelect" global="false" listener="#{managedPointVente.loadOnViewArticle_}" oncomplete="dlgListArticle.hide()" update=":main_point:blog_form_point_vente:form_article_point"/>
                    <p:column filterBy="#{art.refArt}" style="width: 2%">
                        <span title="#{art.designation}">#{art.refArt}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}" style="width: 6%">
                        <span title="#{art.designation}">#{art.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" style="width: 4%">
                        <span title="#{art.designation}">#{art.categorie}</span>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBean()}" oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticleAll" closeOnEscape="true"
                             message="#{lab.LC_PPV_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteAllBeanArticle()}"  update=":main_point:blog_form_point_vente:data_article_point"
                                 oncomplete="dlgConfirmDeleteArticleAll.hide();collapseForm('depot');collapseForm('depot');collapseForm('article_depot');collapseForm('liaison_depot');collapseForm('point_vente_depot0');collapseForm('emplacement_depot')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticleAll.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBeanArticle()}" update=":main_point:blog_form_point_vente:data_article_point"
                                 oncomplete="dlgConfirmDeleteArticle.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle_" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBeanArticle_()}" update=":main_point:blog_form_point_vente:data_article_point"
                                 oncomplete="dlgConfirmDeleteArticle_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePoint" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBeanPoint(true)}" oncomplete="dlgConfirmDeletePoint.hide();collapseForm('point_vente_depot')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeletePoint.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePoint_" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBeanPoint(false)}" oncomplete="dlgConfirmDeletePoint_.hide();collapseForm('point_vente_depot')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeletePoint_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCreneau" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBeanCreneau()}" update=":main_point:blog_form_point_vente:data_creneau_point"
                                 oncomplete="dlgConfirmDeleteCreneau.hide();collapseForm('creneau')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCreneau.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCreneau_" closeOnEscape="true"
                             message="#{lab.LC_PPV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedPointVente.deleteBeanCreneau_()}" update=":main_point:blog_form_point_vente:data_creneau_point"
                                 oncomplete="dlgConfirmDeleteCreneau_.hide();collapseForm('creneau')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCreneau_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAddArticles" closeOnEscape="true"
                             message="#{lab.LC_PPV_text3}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}"  actionListener="#{managedPointVente.insertAllArticle()}" 
                                 update=":main_point:blog_form_point_vente:data_article_point"
                                 oncomplete="dlgConfirmAddArticles.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAddArticles.hide()"/>
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_point">     
            <div class="part_fix">
                <p:splitButton value="#{lab.L_enregistrer}" id="save_point_vente" actionListener="#{managedPointVente.saveNew()}" icon="ui-icon-disk" update=":main_point:blog_form_point_vente:select-parent_point">
                    <p:menuitem value="#{lab.L_nouveau}" id="cancel_point_vente"  actionListener="#{managedPointVente.resetFiche()}" update="blog_form_point_vente" oncomplete="collapseForm('point_vente');collapseForm('point_vente_depot')"
                                icon="ui-icon-document"/>
                    <p:separator />
                    <p:menuitem value="#{lab.LC_PTBS_type}" disabled="true"/>
                    <p:menuitem value="Commerce Général" icon="#{managedPointVente.pointVente.type eq constantes.SERVICE_COMMERCE_GENERAL ?'ui-icon-bullet':'ui-icon-radio-on'}" 
                                actionListener="#{managedPointVente.pointVente.setType(constantes.SERVICE_COMMERCE_GENERAL)}"
                                style="font-weight: #{managedPointVente.pointVente.type eq constantes.SERVICE_COMMERCE_GENERAL ?'bold':'normal'};" update="save_point_vente blog_form_point_vente:blog-form_point_vente"/>
                    <p:menuitem value="Restaurant / Snack" icon="#{managedPointVente.pointVente.type eq constantes.SERVICE_RESTAURANT ?'ui-icon-bullet':'ui-icon-radio-on'}"
                                actionListener="#{managedPointVente.pointVente.setType(constantes.SERVICE_RESTAURANT)}"
                                style="font-weight: #{managedPointVente.pointVente.type eq constantes.SERVICE_RESTAURANT?'bold':'normal'};" update="save_point_vente blog_form_point_vente:blog-form_point_vente"/>
                    <p:separator rendered="#{managedPointVente.currentScte.venteOnline}" />
                    <p:menuitem value="Options" disabled="true" rendered="#{managedPointVente.currentScte.venteOnline}"/>
                    <p:menuitem value="#{lab.LC_PPV_vente_ligne}" icon="ui-icon-arrowreturn-1-n" actionListener="#{managedPointVente.pointVente.setVenteOnline(!managedPointVente.pointVente.venteOnline)}"
                                style="font-weight: #{managedPointVente.pointVente.venteOnline?'bold':'normal'};" rendered="#{managedPointVente.currentScte.venteOnline}"
                                update="save_point_vente blog_form_point_vente:blog-form_point_vente"/>
                    <p:separator />
                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" onclick="dlgConfirmDelete.show()" global="false"/>
                </p:splitButton>
                <p:commandButton value="#{lab.L_supprimer}" id="delete_point_vente"  icon="ui-icon-trash" onclick="dlgConfirmDelete.show()" type="button"/>
                <h:panelGroup style="margin-left: 25%">
                    <p:commandButton actionListener="#{managedPointVente.parcoursInAllResult(false)}" update="txt_parc_linear_point_vente"   icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('point_vente');slideZoneUp();_slideZoneUp()"/>
                    <h:inputText value="#{managedPointVente.offset}" style="width: 35px; text-align: center;"  title="Aller au N°..." id="txt_parc_linear_point_vente"/>
                    <p:outputPanel autoUpdate="true">                        
                        <p:outputLabel value="/#{managedPointVente.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedPointVente.parcoursInAllResult(true)}" update="txt_parc_linear_point_vente"  icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('point_vente');slideZoneUp();_slideZoneUp()"/>
                </h:panelGroup>
                <div style="float: right" >
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('point_vente');
                            return false">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>               
                    <p:spacer />
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('point_vente');
                            return false" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>   
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_point_vente">
                    <p:tabView style="clear: left; height: 100%" id="blog_form_point_vente">
                        <p:tab title="#{lab.LDB_PA_generale}">
                            <div style="width: 70%;float: left">
                                <ui:include src="point_vente/form.xhtml"/>
                            </div>
                            <div style="margin-left: 70%">
                                <h:panelGrid columns="1" style="width: 100%; font-size: 0.8em" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                    <f:facet name="header">
                                        <span style="float: left">#{lab.LC_PPV_depot_lies}</span>
                                    </f:facet>
                                    <p:outputPanel id="blog_form_point_vente_depot">
                                        <p:dataTable id="data_point_vente_depot" value="#{managedPointVente.liaisons}" var="com_" rowKey="#{com_.id}" rowIndexVar="comIdx_">
                                            <p:column headerText="N°" width="20">
                                                <span>#{comIdx_+1}</span>
                                                <h:graphicImage title="#{lab.LC_PPV_depot_liaison}" library="icones" name="alert.png" width="15" height="15" rendered="#{managedPointVente.occurence(com_)}" style="float: right"/>  
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PPV_depot}">
                                                <span>#{com_.depot.designation}</span>
                                                <h:graphicImage title="#{lab.LC_PPV_depot_principal}" library="img"  name="bookmark.png" width="15" height="15" rendered="#{com_.principal}" style="float: right"/>
                                            </p:column>       
                                            <p:column headerText="#{lab.LDB_PD_agence}">
                                                <span>#{com_.depot.agence.designation}</span>
                                            </p:column>                                                                              
                                            <p:column  width="20" style="text-align: center">
                                                <p:commandButton icon="ui-icon-minusthick" style="width: 20px;height: 20px" actionListener="#{managedPointVente.activePoint(com_)}"
                                                                 title="#{lab.LC_PPV_retirer_depot}" rendered="#{com_.actif}" update="data_point_vente_depot"/>
                                                <p:commandButton icon="ui-icon-plusthick" style="width: 20px;height: 20px" actionListener="#{managedPointVente.saveNewPoint(com_)}"
                                                                 title="#{lab.LC_PPV_ajouter_depot}" rendered="#{com_.id le 0 or !com_.actif}" update="data_point_vente_depot"/>
                                            </p:column>     
                                            <p:column style="width: 7%;text-align: center">
                                                <p:contextMenu for="btn_option_point_vente_depot" event="left click" style="font-size: 0.8em">
                                                    <p:menuitem value="#{lab.L_set_principal}" icon="ui-icon-star" global="false" actionListener="#{managedPointVente.activePrincipal(com_)}" update="data_point_vente_depot"/>
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" oncomplete="dlgConfirmDeletePoint_.show()" 
                                                                global="false" actionListener="#{managedPointVente.deleteBeanPoint_(com_)}"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_point_vente_depot" type="button" disabled="#{com_.id lt 0}"/>
                                            </p:column> 
                                        </p:dataTable>
                                        <p:commandButton value="#{lab.L_supprimer}" id="delete_point_vente_depot" global="false"
                                                         onclick="dlgConfirmDeletePoint.show()" style="float: right"/>
                                        <div style="clear: both"/>
                                    </p:outputPanel>
                                </h:panelGrid>    
                            </div>
                            <div style="clear: both"/>
                        </p:tab>
                        <p:tab title="#{lab.LDB_PD_articles}" disabled="#{managedPointVente.pointVente.id le 0}">
                            <p:outputPanel id="blog_form_article_point"> 
                                <div style="float: left;width: 30%">
                                    <h:panelGrid id="form_article_point" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0"> 
                                        <f:facet name="header">  
                                            <div align="left" style="margin: auto">
                                                <p:commandLink title="#{lab.LC_PPV_importer_tous_articles}" type="button"   onclick="dlgConfirmAddArticles.show()"
                                                               style="float: left;border: 2px solid black; border-radius: 5px;padding: 3px;margin-top: 3px">
                                                    <p:graphicImage library="icones" name="db_update.png" width="15" height="18" />
                                                </p:commandLink> 
                                            </div>
                                        </f:facet>
                                        <h:panelGroup>
                                            <p:outputLabel value="#{lab.LC_PPV_article} "/>
                                            <h:outputText value="#{managedPointVente.article.id}" style="padding: 2px; background: #333; color: #FFF; float: right"/>  
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <h:inputText value="#{managedPointVente.article.article.refArt}" style="color: #{managedPointVente.article.article.error?'red':''};width: 100px">
                                                <p:ajax event="valueChange" global="false" listener="#{managedPointVente.searchArticle()}" update="form_article_point"/>
                                            </h:inputText>    
                                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PPV_liste_articles}" global="false"
                                                             actionListener="#{managedPointVente.initArticles()}" oncomplete="dlgListArticle.show()"/>
                                        </h:panelGroup>         
                                        <span>#{lab.L_unite}</span>
                                        <h:selectOneMenu value="#{managedPointVente.article.conditionnement.id}" style="width: 100%">
                                            <f:selectItem itemValue="-1" itemLabel="" />
                                            <f:selectItems value="#{managedPointVente.article.article.conditionnements}" var="condV" itemValue="#{condV.id}" itemLabel="#{condV.unite.reference}" />
                                        </h:selectOneMenu>                                        
                                        <span>#{lab.LC_PPV_prix_vente}</span>
                                        <h:panelGroup>
                                            <p:inputText value="#{managedPointVente.article.puv}" style="text-align: right; width: 120px" title="#{lab.LC_PPV_prix_point}"/>
                                            <p:selectBooleanCheckbox itemLabel="#{lab.LC_PPV_variable} ?" value="#{managedPointVente.article.changePrix}" disabled="#{!managedPointVente.article.article.changePrix}" style="float: right;margin-top: 5px"/>
                                        </h:panelGroup>
                                        <span title="#{lab.LC_PPV_minimal}">#{lab.LC_PPV_puv_min}</span>
                                        <h:panelGroup>
                                            <p:selectBooleanCheckbox itemLabel="#{lab.LC_PPV_taux} ?" value="#{managedPointVente.article.prixMinIsTaux}" style="float: left;margin-top: 5px"/>
                                            <p:inputText value="#{managedPointVente.article.puvMin}" style="width: 120px;margin-left: 5px" title="#{lab.LC_PPV_prix_minimal}"/>
                                        </h:panelGroup>
                                        <span>#{lab.LC_PPV_remise} </span>
                                        <h:panelGroup>
                                            <h:selectOneMenu value="#{managedPointVente.article.natureRemise}">
                                                <f:selectItem itemLabel="#{constantes.NATURE_MTANT} " itemValue="#{constantes.NATURE_MTANT}" />
                                                <f:selectItem itemLabel="#{constantes.NATURE_TAUX} " itemValue="#{constantes.NATURE_TAUX}" />
                                            </h:selectOneMenu>
                                            <p:inputText value="#{managedPointVente.article.remise}" style="text-align: right;width: 120px"/>
                                        </h:panelGroup>
                                        <p:outputLabel value="#{lab.LC_PCC_avance} " rendered="#{managedPointVente.currentScte.venteOnline}" title="#{lab.LC_PPV_text9}"/>
                                        <h:panelGroup>
                                            <p:inputText value="#{managedPointVente.article.avanceCommance}" rendered="#{managedPointVente.currentScte.venteOnline}" 
                                                         title="#{lab.LC_PPV_text9}" style="width: 100px;text-align: center"/>%
                                        </h:panelGroup>
                                        <f:facet name="footer">                                            
                                            <div align="right">
                                                <span style="font-style: italic">Activer la détermination du prix de vente en fonction du prix d'achat &nbsp;</span>
                                                <h:panelGroup>
                                                    <p:selectBooleanCheckbox value="#{managedPointVente.article.proportionPua}" >
                                                        <p:ajax event="valueChange" global="false" update="taux_proportionnalite"/>
                                                    </p:selectBooleanCheckbox>
                                                </h:panelGroup>
                                                <p:separator />
                                                <h:panelGrid columns="2" styleClass="yvs_nostyle">
                                                    <span>Taux de majoration </span>
                                                    <p:inputText id="taux_proportionnalite" value="#{managedPointVente.article.tauxPua}"  style="width: 80px"
                                                                 disabled="#{!managedPointVente.article.proportionPua}"  title="Taux de proportionnalité"/>
                                                </h:panelGrid>
                                                <br />
                                                <p:commandButton id="cancel_article_point" value="#{lab.L_nouveau}" oncomplete="collapseForm('article_point')"
                                                                 update="form_article_point" actionListener="#{managedPointVente.resetFicheArticle()}" icon="ui-icon-document"/>
                                                <p:commandButton id="save_article_point" value="#{lab.L_enregistrer}" oncomplete="collapseForm('article_point')"
                                                                 update="blog_form_article_point" actionListener="#{managedPointVente.saveNewArticle(true)}" icon="ui-icon-disk"/>
                                            </div> 
                                        </f:facet>
                                    </h:panelGrid>                               
                                </div>
                                <div style="margin-left: 31%;width: 69%">
                                    <p:outputPanel id="blog_data_article_point">
                                        <h:inputHidden id="input_hide_article_point" value="#{managedPointVente.tabIds_article}"/> 
                                        <p:dataTable id="data_article_point" value="#{managedPointVente.pointVente.articles}" var="artf" rowKey="#{artf.id}" 
                                                     rowIndexVar="artfIdx" style="clear: right" selection="#{managedPointVente.articlesSelect}">
                                            <p:ajax event="rowSelect" global="false" listener="#{managedPointVente.loadOnViewArticle}" update=":main_point:blog_form_point_vente:form_article_point" oncomplete="slideZoneDown()"/>
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedPointVente.unLoadOnViewArticle}" update=":main_point:blog_form_point_vente:form_article_point" oncomplete="slideZoneUp()"/>
                                            <p:column style="width: 5%" headerText="N°">
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{artf.new_}"/>
                                                <span>#{artfIdx+1}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PPV_article}">
                                                <span>#{artf.article.article.designation}</span>
                                                <h:graphicImage title="#{lab.LC_PPV_text10}" library="img"  name="bookmark.png" width="15" height="15" 
                                                                rendered="#{artf.article.prioritaire}" style="float: right"/>
                                                <span style="font-size: 0.7em; background: #006666; color: white" title="#{artf.conditionnement.unite.libelle}">#{artf.conditionnement.unite.reference}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PPV_prix}" style="width: 20%;text-align: right">
                                                <div style="float: left; font-size: 0.8em;margin-top: 2px">
                                                    <span style="color: blue;font-style: italic">Min. : </span>
                                                    <h:outputText value="#{artf.prixMin}" converter="DN" style="font-weight: bold"/>
                                                    <h:outputText value="%" rendered="#{artf.naturePrixMin == constantes.NATURE_TAUX}"/>
                                                </div>
                                                <h:outputText value="#{artf.puv}" converter="DN" style="font-weight: bold"/>
                                                <h:graphicImage title="#{lab.LC_PPV_text11}" library="icones"  name="update.png" width="15" height="15" 
                                                                rendered="#{artf.article.changePrix}" style="float: right"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PPV_remise}" style="width: 10%;text-align: right">
                                                <h:outputText value="#{artf.remise}" converter="DN" style="font-weight: bold"/>
                                                <h:outputText value="%" rendered="#{artf.natureRemise == constantes.NATURE_TAUX}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_actif}" style="width: 8%;text-align: center">
                                                <p:commandLink title="#{(artf.actif and artf.article.actif)?lab.L_desactiver:lab.L_activer}" actionListener="#{managedPointVente.activeArticle(artf)}"  update="data_article_point" style="margin-top: 5px">
                                                    <h:graphicImage library="img"  name="#{(artf.actif and artf.article.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                                                </p:commandLink>
                                            </p:column>

                                            <p:column style="width: 5%;text-align: center">
                                                <f:facet name="header">
                                                    <p:contextMenu for="delete_article_point" event="left click">
                                                        <p:menuitem value="#{lab.LC_PPV_active_change_prix}" icon="ui-icon-star" global="false" actionListener="#{managedPointVente.activeAllChangePrix()}" update="data_article_point"/>
                                                        <p:menuitem value="#{lab.LC_PPV_activer_desactiver}"  icon="ui-icon-transferthick-e-w" actionListener="#{managedPointVente.toogleActiveAllBeanArticle()}"
                                                                    update="data_article_point"/>
                                                        <p:separator />
                                                        <p:menuitem value="#{lab.LC_PPV_sup_selection}" onclick="dlgConfirmDeleteArticleAll.show()" icon="ui-icon-trash" />
                                                    </p:contextMenu>
                                                    <p:commandButton id="delete_article_point" icon="ui-icon-gear"  type="button" style="width: 22px; height: 22px"/>   
                                                </f:facet>
                                                <p:contextMenu for="btn_option_article_point" event="left click" style="font-size: 0.8em;width: 200px">
                                                    <p:menuitem value="#{artf.article.changePrix?'Désactiver Change prix':'Active Change prix'}" icon="ui-icon-star" global="false" actionListener="#{managedPointVente.activeChangePrix(artf)}" update="data_article_point"
                                                                title="#{artf.article.changePrix?'Désactiver la modification du prix lors de la vente':'Activer la modification du prix lors de la vente'}"/>                                                        
                                                    <p:menuitem value="Rabais" icon="ui-icon-suitcase" actionListener="#{managedPointVente.setSelectArticle(artf)}" 
                                                                oncomplete="dlgRabais.show()"
                                                                update=":main-rabais_article_point:bloc-rabais_article_point"/>
                                                    <p:menuitem value="#{(artf.article.actif)?lab.L_desactiver:lab.L_activer}"  icon="#{(artf.article.actif)?'ui-icon-circle-close':'ui-icon-circle-check'}" actionListener="#{managedPointVente.activeArticle(artf)}"
                                                                update="data_article_point"/>
                                                    <p:separator />
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPointVente.deleteBeanArticle_(artf)}" oncomplete="dlgConfirmDeleteArticle_.show()"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_article_point" type="button"/>
                                            </p:column> 
                                            <p:column selectionMode="multiple" style="width:16px;text-align:center"/>
                                        </p:dataTable>
                                        <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                            <h:panelGroup style="margin-left: -10px">
                                                <h:inputText value="#{managedPointVente.numSearch_}">
                                                    <p:ajax event="valueChange" update="data_article_point" listener="#{managedPointVente.filterArticle()}"/>
                                                </h:inputText>
                                                <h:selectOneMenu value="#{managedPointVente.actif_}">
                                                    <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                                                    <f:selectItem itemLabel="#{lab.L_actif}" itemValue="#{true}"/>
                                                    <f:selectItem itemLabel="#{lab.L_inactif}" itemValue="#{false}"/>
                                                    <p:ajax event="valueChange" global="false" update="data_article_point" 
                                                            listener="#{managedPointVente.addParamActifArticle()}"/>
                                                </h:selectOneMenu>
                                            </h:panelGroup>   
                                            <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                                                <p:commandButton actionListener="#{managedPointVente.initArticle(false)}" global="false" update="data_article_point" icon="ui-icon-circle-triangle-w" disabled="#{managedPointVente.pa.disPrev}"/>
                                                <p:outputPanel ><p:outputLabel value="#{managedPointVente.pa.currentPage}/#{managedPointVente.pa.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                                                <p:commandButton actionListener="#{managedPointVente.initArticle(true)}" global="false" update="data_article_point" icon="ui-icon-circle-triangle-e" disabled="#{managedPointVente.pa.disNext}"/>
                                                <p:selectOneMenu value="#{managedPointVente.max}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedPointVente._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                                                    <f:selectItems value="#{managedPointVente.paginations}"/>
                                                    <p:ajax event="valueChange" global="false" update="data_article_point"/>
                                                </p:selectOneMenu>
                                            </p:outputPanel> 
                                        </h:panelGrid>
                                    </p:outputPanel>
                                </div>
                            </p:outputPanel>
                            <div style="clear: both"/>
                        </p:tab>
                        <p:tab title="#{lab.LDB_PD_creneaux}" disabled="#{managedPointVente.pointVente.id le 0}">
                            <p:outputPanel id="blog_form_creneau_point">
                                <div style="float: left;width: 30%">
                                    <h:panelGrid columns="2" style="width: 100%" id="form_creneau_point_depot" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                        <span>#{lab.LC_PPV_critere_creneau} </span>
                                        <h:selectOneMenu value="#{managedPointVente.creneau.critere}" id="select_critere" disabled="#{managedPointVente.creneau.id gt 0}">
                                            <f:selectItem itemLabel="--" itemValue="" noSelectionOption="true"/>
                                            <f:selectItems value="#{managedPointVente.criteres}" var="cri_" 
                                                           itemLabel="#{cri_}" itemValue="#{cri_}"/>                                 
                                            <p:ajax event="valueChange" global="false" listener="#{managedPointVente.chooseCritere()}" update="select_type_creneau_point"/>
                                        </h:selectOneMenu>
                                        <span>#{lab.L_jour} </span>
                                        <h:panelGroup>
                                            <h:selectOneMenu id="txt_jour_creneau_point" value="#{managedPointVente.creneau.jour.id}" disabled="#{managedPointVente.creneau.permanent}">
                                                <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                                <f:selectItems value="#{managedPointVente.jours}" var="jr_" 
                                                               itemLabel="#{jr_.jour}" itemValue="#{jr_.id}" />                                 
                                            </h:selectOneMenu>
                                            <h:selectBooleanCheckbox value="#{managedPointVente.creneau.permanent}" title="#{lab.LC_PPV_creneau_permanent}" style="float: right">
                                                <p:ajax event="valueChange" global="false" update="txt_jour_creneau_point"/>
                                            </h:selectBooleanCheckbox>
                                        </h:panelGroup>
                                        <span>#{lab.LC_PPV_tranche_horaire} </span>
                                        <h:selectOneMenu value="#{managedPointVente.creneau.tranche.id}" id="select_type_creneau_point">
                                            <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                            <f:selectItems value="#{managedPointVente.types}" var="typC_" 
                                                           itemLabel="#{typC_.titre}" itemValue="#{typC_.id}" />                             
                                            <p:ajax event="valueChange" global="false" listener="#{managedPointVente.chooseType()}"
                                                    update="gpe_heure_travail_point"/>
                                        </h:selectOneMenu>
                                        <span>#{lab.LC_PPV_heure_travail} </span>
                                        <h:panelGroup id="gpe_heure_travail_point">
                                            <span>#{lab.L_de} </span>
                                            <h:inputText value="#{managedPointVente.creneau.tranche.heureDebut}" converter="TIME" readonly="true" style="width: 25%"/>
                                            <span> #{lab.L_a} </span>
                                            <h:inputText value="#{managedPointVente.creneau.tranche.heureFin}" converter="TIME" readonly="true" style="width: 25%"/>
                                        </h:panelGroup>
                                        <f:facet name="footer">
                                            <div align="right">
                                                <p:commandButton value="#{lab.L_nouveau}" id="cancel_creneau_point" actionListener="#{managedPointVente.resetFicheCreneau()}"
                                                                 update="form_creneau_point_depot" oncomplete="collapseForm('creneau')" icon="ui-icon-document"/>
                                                <p:commandButton value="#{lab.L_enregistrer}" id="save_creneau_point" actionListener="#{managedPointVente.saveNewCreneau()}"
                                                                 update="form_creneau_point_depot data_creneau_point" icon="ui-icon-disk"/>
                                            </div>
                                        </f:facet>
                                    </h:panelGrid>

                                </div>
                                <div style="margin-left: 31%;width: 69%">
                                    <h:inputHidden id="input_hide_creneau_point" value="#{managedPointVente.tabIds_creneau}"/>
                                    <p:dataTable id="data_creneau_point" value="#{managedPointVente.creneaux}" var="cren_" rows="7" paginator="true"
                                                 rowKey="#{cren_.id}" rowIndexVar="crenIdx_" selectionMode="single" paginatorAlwaysVisible="false">
                                        <p:ajax event="rowSelect" global="false" listener="#{managedPointVente.loadOnViewCreneau}" update=":main_point:blog_form_point_vente:form_creneau_point_depot" oncomplete="_slideZoneDown()"/>
                                        <p:ajax event="rowUnselect" global="false" listener="#{managedPointVente.unLoadOnViewCreneau}" update=":main_point:blog_form_point_vente:form_creneau_point_depot" oncomplete="_slideZoneUp()"/>
                                        <p:column style="width: 7%;;color: #{cren_.tranche.actif?'':'red'}" headerText="N°">
                                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{cren_.new_}"/>
                                            <span>#{crenIdx_+1}</span>
                                        </p:column>
                                        <p:column headerText="Id" width="25" style=";color: #{cren_.tranche.actif?'':'red'}">
                                            <span>#{cren_.id}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_jour}" style="width: 20%;color: #{cren_.tranche.actif?'':'red'}">
                                            <span>#{(cren_.permanent)?'-- Permanent -- ':cren_.jour.jour}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_type}" style="width: 20%;color: #{cren_.tranche.actif?'':'red'}">
                                            <span>#{cren_.critere}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PPV_heure_travail}" style=";color: #{cren_.tranche.actif?'':'red'}">
                                            <span>#{lab.L_de} </span>
                                            <h:outputText value="#{cren_.tranche.heureDebut}" converter="TIME"/>
                                            <span> #{lab.L_a} </span>
                                            <h:outputText value="#{cren_.tranche.heureFin}" converter="TIME"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_actif}" style="width: 8%;text-align: center;color: #{cren_.tranche.actif?'':'red'}">
                                            <p:commandLink style="margin-top: 5px" title="#{(cren_.actif)?'Desactiver':'Activer'}" global="false" actionListener="#{managedPointVente.activeCreneau(cren_)}" update="data_creneau_point">
                                                <h:graphicImage library="img"  name="#{(cren_.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                                            </p:commandLink>
                                        </p:column>
                                        <p:column style="width: 5%;text-align: center;color: #{cren_.tranche.actif?'':'red'}">
                                            <p:contextMenu for="btn_option_creneau_point" event="left click" style="font-size: 0.8em">
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPointVente.deleteBeanCreneau_(cren_)}" oncomplete="dlgConfirmDeleteCreneau_.show()"/>
                                            </p:contextMenu>                           
                                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_creneau_point" type="button"/>
                                        </p:column>                                            
                                    </p:dataTable>
                                    <p:commandButton value="#{lab.L_supprimer}" id="delete_creneau_point" onclick="dlgConfirmDeleteCreneau.show()" rendered="false"
                                                     global="false" style="float: right"/>
                                </div>

                            </p:outputPanel>
                            <div style="clear: both"/>
                        </p:tab>
                        <p:tab title="#{lab.LC_PPV_commerciaux}" disabled="#{managedPointVente.pointVente.id le 0}">
                            <p:dataTable id="data_point_vente_commerciaux" value="#{managedPointVente.pointVente.commerciaux}" var="usr" rows="15" paginator="true"
                                         rowKey="#{usr.id}" rowIndexVar="IdxC" paginatorAlwaysVisible="false">
                                <p:column style="width: 16px" headerText="N°">
                                    <span>#{IdxC+1}</span>
                                </p:column>                                
                                <p:column headerText="#{lab.LC_PPV_civilite}" width="50">
                                    <h:outputText value="#{usr.commercial.utilisateur.civilite}"/>
                                </p:column>
                                <p:column headerText="#{lab.L_code}" styleClass="#{(usr.id gt 0)?'line_actiftrue':'_'}">
                                    <h:outputText value="#{usr.commercial.codeRef}"/>
                                </p:column>
                                <p:column headerText="#{lab.LC_PPV_nom}">
                                    <h:outputText value="#{usr.commercial.utilisateur.nomUsers}"/>
                                </p:column>
                                <p:column headerText="#{lab.L_agence}" style="text-align: center" width="100">
                                    <h:outputText value="#{usr.commercial.agence.designation}"/>
                                </p:column>                                                                               
                                <p:column  width="20" style="text-align: center">
                                    <p:commandButton icon="ui-icon-minusthick" style="width: 20px;height: 20px" actionListener="#{managedPointVente.saveNewCommercial(usr)}"
                                                     title="#{lab.LC_PPV_supprimer_commercial}" rendered="#{usr.id gt 0}" update="data_point_vente_commerciaux"/>
                                    <p:commandButton icon="ui-icon-plusthick" style="width: 20px;height: 20px" actionListener="#{managedPointVente.saveNewCommercial(usr)}"
                                                     title="#{lab.LC_PPV_ajouter_commercial}" rendered="#{usr.id lt 1}" update="data_point_vente_commerciaux"/>
                                </p:column>                                           
                            </p:dataTable>
                            <div style="clear: both"/>
                        </p:tab>
                        <p:tab title="#{lab.LDB_PD_accessibilite}" disabled="#{managedPointVente.pointVente.id le 0}">
                            <p:dataTable value="#{managedPointVente.pointVente.utilisateurs}" var="iuser" selectionMode="single" rowIndexVar="line_u" rowKey="#{iuser.id}"
                                         id="table_2_user" style="max-height: 400px; overflow-y: auto; width: 40%">
                                <p:column headerText="N°" width="15">
                                    #{line_u+1}
                                </p:column>
                                <p:column headerText="#{lab.LDB_PD_noms_prenoms}" styleClass="#{(iuser.point ne null and iuser.point.id gt 0)?'line_actiftrue':'_'}"
                                          filterBy="#{iuser.nomUsers}">
                                    #{iuser.nomUsers}
                                </p:column>
                                <p:column headerText="#{lab.L_agence}" styleClass="#{(iuser.point ne null and iuser.point.id gt 0)?'line_actiftrue':'_'}">
                                    #{iuser.agence.designation}
                                </p:column>
                                <p:column headerText="#{lab.LDB_PD_vu}" width="15" style="text-align: center">
                                    <p:commandButton icon="#{(iuser.new_)?'ui-icon-circle-minus':'ui-icon-circle-plus'}" title="#{(iuser.new_)?'Dépôt invisible pour cet utilisateur':'Rendre visible pour cet utilisateur'}"
                                                     actionListener="#{managedPointVente.addLiaisonPointUser(iuser)}" update="table_2_user @this" style="width: 22px; height: 22px"/>
                                </p:column>
                            </p:dataTable>
                        </p:tab>
                    </p:tabView>

                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="yvs_list_point_vente" style="width: 99%; margin: auto; background: white">
                    <h:inputHidden id="input_hide_point_vente" value="#{managedPointVente.tabIds}"/>
                    <p:dataTable id="data_point_vente" value="#{managedPointVente.pointsvente}" var="point"
                                 rowKey="#{point.id}" rowIndexVar="comIdx" selectionMode="single">
                        <p:ajax event="rowSelect" listener="#{managedPointVente.loadOnView}" update=":main_point:input_hide_point_vente"
                                oncomplete="collapseForm('point_vente_depot');collapseForm('point_vente');slideZoneUp();_slideZoneUp()"/>
                        <p:column width="30">
                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{point.new_}"/>
                            <span>#{comIdx+1}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}">
                            <span>#{point.code}</span>
                            <p:spacer style="width: 10px;background: #{point.color};float: right;margin-top: 2px"/>
                        </p:column>
                        <p:column headerText="#{lab.L_designation}">
                            <span>#{point.libelle}</span>
                        </p:column>
                        <p:column headerText="#{lab.LC_PPV_adresse}">
                            <span>#{point.adresse}</span>
                        </p:column>   
                        <p:column headerText="#{lab.L_secteur}">
                            <span>#{point.secteur.libele}</span>
                        </p:column>   
                        <p:column headerText="#{lab.L_parent}">
                            <span>#{point.parent.libelle}</span>
                        </p:column>   
                        <p:column headerText="#{lab.L_agence}">
                            <span>#{point.agence.designation}</span>
                        </p:column>   
                        <p:column headerText="#{lab.LC_PTBS_type}">
                            <span>#{point.type eq constantes.SERVICE_RESTAURANT?'RESTAURANT / SNACK-BAR':'COMMERCE GENERAL'}</span>
                        </p:column>   
                        <p:column headerText="#{lab.L_actif}" style="width: 5%;text-align: center">
                            <p:commandLink style="margin-top: 5px" title="#{(point.actif)?'Desactiver':'Activer'}" global="false" actionListener="#{managedPointVente.activePointVente(point)}" update="data_point_vente">
                                <h:graphicImage library="img"  name="#{(point.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                            </p:commandLink>
                        </p:column>
                        <p:column width="20" style="text-align: center"> 
                            <p:contextMenu for="btn_option_point_vente" event="left click" style="font-size: 0.8em;width: 220px">
                                <p:menuitem value="Planifier" icon="ui-icon-calendar" actionListener="#{managedPointVente.addPlanning(point)}" oncomplete="dlgAddPlanning.show()"/>
                                <p:menuitem value="#{point.actif?'Désactiver':'Activer'}" icon="#{point.actif?'ui-icon-circle-close':'ui-icon-circle-check'}" actionListener="#{managedPointVente.activePointVente(point)}" update="data_point_vente"/>
                                <p:menuitem value="#{point.venteOnline?'Désactiver':'Activer'} #{lab.LC_PPV_vente_ligne.toLowerCase()}" icon="#{point.venteOnline?'ui-icon-bullet':'ui-icon-radio-on'}"
                                            actionListener="#{managedPointVente.venteOnlinePointVente(point)}" rendered="#{managedPointVente.currentScte.venteOnline}" update="data_point_vente"/>
                                <p:separator />
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedPointVente.deleteBean_(point)}" oncomplete="dlgConfirmDelete_.show()"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_point_vente" type="button"/>
                        </p:column> 
                        <p:column width="30" style="text-align: center">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_point_vente" value="false"
                                                         onclick="selectionAllLineTab(#{managedPointVente.pointsvente.size()}, 'point_vente')">
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox  value="#{point.select}" styleClass="chek_line_point_vente" 
                                                      onclick="selectionLineTab(#{point.id}, 'point_vente')">
                            </h:selectBooleanCheckbox>
                        </p:column>
                    </p:dataTable> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedPointVente.init(false)}" global="false" update="data_point_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedPointVente.paginator.disPrev}"/>
                        <p:outputPanel >
                            <p:inplace label="#{managedPointVente.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                <p:inputText value="#{managedPointVente.paginator.gotoPage}" style="width: 30px;text-align: center">
                                    <p:ajax event="blur" listener="#{managedPointVente.gotoPagePaginator()}" update="data_point_vente"/>
                                </p:inputText>
                            </p:inplace><p:outputLabel value="/#{managedPointVente.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        </p:outputPanel>
                        <p:commandButton actionListener="#{managedPointVente.init(true)}" global="false" update="data_point_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedPointVente.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedPointVente.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedPointVente.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedPointVente.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_point_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </div> 
            </div>
        </h:form>
    </ui:define>    
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">            
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative; bottom: -20px" width="20" height="20"
                            styleClass="img_slide" title="#{lab.L_cacher}"/>  
            <div class="zone_find">
                <div class="yvs_form_point_vente display_auteur" align="right" style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedPointVente.selectPoint.dateSave}" converter="LD" styleClass="valeur" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedPointVente.selectPoint.dateUpdate}" converter="LD" styleClass="valeur" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedPointVente.selectPoint.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <h:panelGrid columns="6" cellpadding="0" cellspacing="0" id="zone_search_point_vente">
                    <h:outputText value="" />
                    <h:outputText value="#{lab.LDB_PD_agence}" />
                    <h:outputText value="Secteur" />
                    <h:outputText value="Type" />
                    <h:outputText value="#{lab.L_actif}" />
                    <h:outputText value="#{lab.LDB_PD_reference}" />
                    <p:commandButton icon="ui-icon-bullet" styleClass="button_gear" actionListener="#{managedPointVente.clearParams()}" 
                                     update=":main_point:data_point_vente zone_search_point_vente"/>
                    <h:selectOneMenu value="#{managedPointVente.agenceSearch}">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedAgence.listAgence}" var="ag" itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                        <p:ajax event="valueChange" listener="#{managedPointVente.addParamAgence()}" update=":main_point:data_point_vente" oncomplete="collapseList('point_vente')"/>
                    </h:selectOneMenu>
                    <h:selectOneMenu value="#{managedPointVente.lieuSearch}">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{Mdico.secteurs}" var="ilieu" itemValue="#{ilieu.id}" itemLabel="#{ilieu.libele} - #{ilieu.parent.libele}" />
                        <p:ajax event="valueChange" listener="#{managedPointVente.addParamLieu()}" update=":main_point:data_point_vente" oncomplete="collapseList('point_vente')"/>
                    </h:selectOneMenu>
                    <h:selectOneMenu value="#{managedPointVente.typeSearch}">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="Commerce Général" itemValue="#{constantes.SERVICE_COMMERCE_GENERAL}"/>
                        <f:selectItem itemLabel="Restaurant / Snack" itemValue="#{constantes.SERVICE_RESTAURANT}"/>
                        <p:ajax event="valueChange" listener="#{managedPointVente.addParamType()}" update=":main_point:data_point_vente" oncomplete="collapseList('point_vente')"/>
                    </h:selectOneMenu>
                    <h:selectOneMenu value="#{managedPointVente.actifSearch}">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" listener="#{managedPointVente.addParamActif()}" update=":main_point:data_point_vente" oncomplete="collapseList('point_vente')"/>
                    </h:selectOneMenu>
                    <h:inputText value="#{managedPointVente.codeSearch}" style="width: 140px">
                        <p:ajax event="valueChange" listener="#{managedPointVente.addParamCode()}" update=":main_point:data_point_vente" oncomplete="collapseList('point_vente')"/>
                    </h:inputText>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>

