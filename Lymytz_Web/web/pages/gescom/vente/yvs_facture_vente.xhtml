<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Factures Vente','modGescom', 'smenFactureVente', true,managedFactureVenteV2)}
    </ui:define> 
    <ui:define name="contents">  
        <style type="text/css">
            .part_fix{
                height: 70px !important;
            }
        </style>

        #{managedReglementAchat.doNothing()}
        #{managedReservation.doNothing(null)}
        #{managedVente.doNothing()}     
        #{managedSaisiePiece.doNothing()}  
        #{managedRetenue.doNothing()}  
        #{managedClient.doNothing()}        
        #{navigations.doNothing()}
        #{managedTiers.doNothing()}
        #{managedBonVente.doNothing()}
        #{managedLivraisonVente.doNothing()}
        #{managedCommerciaux.doNothing()}     
        #{managedRemise.doNothing()}
        #{managedStockArticle.load(false)}  
        #{managedTypeCreneau.doNothing()}
        #{Mdico.doNothing()} 
        #{managedTaxes.doNothing()}
        #{Marticle.doNothing()}
        #{managedLotReception.doNothing()}
        #{managedPrintFactureVente.doNothing()}
        #{managedCaisses.doNothing()}  

        #{managedAgence.loadAllUsable()}
        #{managedPointLivraison.loadAll()}
        #{managedPointVente.loadPointsByAgence()} 
        #{managedModeReglement.loadModels('C')}
        #{managedCatCompt.loadAllCategorieVente()}        
        #{managedTypeCout.loadTypeByType(constantes.COUT_VENTE)}
        #{managedFactureVenteV2.loadAll()}

        #{managedFactureVenteV2.setVenteDirecte(false)}           
        #{managedFactureVenteV2.openDlgFactures(false)}    
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height()- $('body').find('#bottom').height()-30);                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 135);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('facture_vente');
                collapseForm('mensualite_facture_vente');
                collapseContenu();
            });
        </script>
        <h:form prependId="false">
            <p:remoteCommand name="collapseContenu" actionListener="#{managedFactureVenteV2.collapseContenu()}"/>
        </h:form>
        <h:form>
            <p:remoteCommand name="updateBeanCaisse_" actionListener="#{managedFactureVenteV2.updateBean()}"/>
        </h:form>
        <h:form prependId="false">
            <p:remoteCommand name="openPrintDialog" actionListener="#{managedFactureVenteV2.openPrintDialog()}"/>
        </h:form>

        <h:form prependId="false"> 
            #{managedPrintFactureVente.loadAll()}
            <p:dialog hideEffect="explode" widgetVar="dlgPrintFactureVente" closeOnEscape="true" header="Choisir un model" resizable="false" modal="true" width="70%">
                <p:outputPanel autoUpdate="true" style="font-size: 0.8em">
                    <div align="center">     
                        <div align="left" style="width: 750px; border: 1px solid black;padding: 20px">
                            <h:panelGroup rendered="#{managedPrintFactureVente.bean.header.id gt 0}">
                                <f:subview id="header_v1" rendered="#{managedPrintFactureVente.bean.header.model eq 'header_v1'}">
                                    <ui:include src="../../param_general/header/header_v1.xhtml"/>                                            
                                </f:subview>
                                <f:subview id="header_v2" rendered="#{managedPrintFactureVente.bean.header.model eq 'header_v2'}">
                                    <ui:include src="../../param_general/header/header_v2.xhtml"/>                                            
                                </f:subview>
                            </h:panelGroup> 
                            <f:subview id="facture_vente_v1" rendered="#{managedPrintFactureVente.model eq 'facture_vente_v1'}">
                                <ui:include src="../../param_general/vente/facture_vente_v1.xhtml"/>                                            
                            </f:subview>
                            <f:subview id="facture_vente_v2" rendered="#{managedPrintFactureVente.model eq 'facture_vente_v2'}">
                                <ui:include src="../../param_general/vente/facture_vente_v2.xhtml"/>                                            
                            </f:subview>
                        </div>
                    </div>
                </p:outputPanel>
                <p:dataTable value="#{managedPrintFactureVente.list}" var="prt" rowKey="#{prt.id}" rowIndexVar="idx" selectionMode="single">
                    <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewModelPrint}"/>
                    <p:column headerText="N°" width="20">
                        #{idx+1}
                        <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{prt.id eq managedPrintFactureVente.bean.id}"/>
                    </p:column>                                
                    <p:column headerText="#{lab.L_libelle}" width="100">
                        <h:outputText value="#{prt.nom}"/>
                    </p:column>
                    <p:column headerText="Model" style="text-align: center">
                        <h:outputText value="#{prt.model}"/>
                    </p:column>
                    <p:column headerText="Header" style="text-align: center">
                        <h:outputText value="#{prt.header.nom}"/>
                    </p:column>
                    <p:column headerText="Défaut" style="text-align: center">
                        <h:graphicImage library="img" name="#{(prt.defaut)?'vu.png':'erase-128.png'}" width="10" height="10"/>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer">
                    <div align="left">
                        <p:selectBooleanCheckbox itemLabel="Avec entête ?" value="#{managedFactureVenteV2.withHeader}"/>
                        <p:commandButton icon="ui-icon-print" value="#{lab.L_telecharger}" global="false"
                                         actionListener="#{managedFactureVenteV2.print(managedFactureVenteV2.selectDoc, managedFactureVenteV2.model, managedFactureVenteV2.withHeader)}"
                                         ajax="false" title="#{lab.LC_PFV_telecharger_facture}" style="float:right"/> 
                    </div>                  
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form-print"> 
            <p:dialog hideEffect="explode" widgetVar="dlgPrint" closeOnEscape="true" header="#{lab.LC_PFV_imprimer_facture}" resizable="false" modal="true" width="90%">
                <p:outputPanel id="media-print">
                    <p:media value="#{managedFactureVenteV2.docVente.printPath}" width="100%" height="600px" rendered="#{managedFactureVenteV2.docVente.printPath ne null}"/>
                </p:outputPanel>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_pptes_compta">
            <p:dialog  width="60%" widgetVar="dlgPpteCompta" closeOnEscape="true" header="Pièces comptable"
                       dynamic="true">
                <ui:include src="../../finance_compta/compta_general/yvs_schema_compta.xhtml" />
                <f:facet name="footer">
                    &copy;Lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_ppte_valid_fv">
            <p:dialog header="#{lab.LC_PFV_propriete_validation}" widgetVar="dlgppteValid" width="60%" 
                      dynamic="true">
                <p:dataTable value="#{managedFactureVenteV2.docVente.etapesValidations}" var="iValid" id="table_ppte_valid_fv">
                    <p:column headerText="#{lab.LC_PFV_etapes}" >#{iValid.etape.labelStatut}</p:column>
                    <p:column headerText="#{lab.LC_PFV_valider_par}" >
                        <h:outputText value="#{iValid.author.users.nomUsers}" rendered="#{iValid.etapeValid or iValid.motif != null}" />
                    </p:column>
                    <p:column headerText="#{lab.L_dates} " style="text-align: center">
                        <h:outputText value="#{iValid.dateUpdate}" converter="DATETIME" rendered="#{iValid.etapeValid}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_motif} " >
                        <h:outputText value="#{managedFactureVenteV2.resumeText(iValid.motif)}"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>

        <h:form prependId="false" id="form_change_num_doc"> 
            <p:dialog header="#{lab.LC_PFV_model_numerotation}" widgetVar="dlgChangeNumDoc" width="40%" dynamic="true">
                <h:panelGrid columns="2" style="width: 100%" id="form_num_doc">                    
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.changeNumdocAuto}" itemLabel="#{lab.LC_PFV_automatique}">
                        <p:ajax event="valueChange" update="form_num_doc_"/> 
                    </p:selectBooleanCheckbox>
                    <h:panelGrid columns="2" id="form_num_doc_">
                        <span>#{lab.LC_PFV_numero_actuel}</span>
                        <h:inputText value="#{managedFactureVenteV2.selectDoc.numDoc}" readonly="true"/>
                        <span>#{lab.LC_PFV_nouveau_numero}</span>
                        <h:inputText value="#{managedFactureVenteV2.selectDoc.numDoc}" disabled="#{managedFactureVenteV2.changeNumdocAuto}"/>
                    </h:panelGrid>
                    <p:commandButton value="#{lab.L_appliquer}" actionListener="#{managedFactureVenteV2.changeNumero()}" icon="ui-icon-arrowthickstop-1-s"
                                     style="margin-left: 60%"/>
                </h:panelGrid>
            </p:dialog>
        </h:form>
        <!-->Cette boite permet la recharche par statut<-->
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_status}" widgetVar="dlgMoreStatuts" modal="true" closeOnEscape="true">                 
                <p:selectManyMenu value="#{managedFactureVenteV2.statuts}" showCheckbox="true" style="min-width: 120px;size: 20px">
                    <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                    <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                    <f:selectItem itemLabel="#{lab.L_annuler}" itemValue="#{constantes.ETAT_ANNULE}"/>
                    <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                    <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                    <f:selectItem itemLabel="#{lab.LC_PFV_terminer}" itemValue="#{constantes.ETAT_SOUMIS}"/>
                    <p:ajax event="valueChange" update=":main_facture_vente:data_facture_vente" 
                            listener="#{managedFactureVenteV2.chooseStatuts()}"/>
                </p:selectManyMenu>
            </p:dialog>
        </h:form>
        <!--->Pour la compensation au règlement<-->
        <h:form prependId="false" id="select_fv_compensation">
            <p:dialog header="Compensation client-fournisseur" width="70%" widgetVar="dlgCompensation" modal="true" closeOnEscape="true"
                      footer="&copy; Lymytz 2014">
                <div style="border: solid 2px; height: 170px; padding: 2px; border-radius: 5px;">
                    <span style="display: inline-block; background: #CCC; width: 100%; font-size: 0.9em">
                        <span style="font-weight: bold">#{lab.LC_PFV_facture}</span> 
                        <h:panelGroup style="float:right" id="total_achat_compensation">
                            <span>#{lab.LC_PFV_total_facture} : </span>
                            <h:outputText style="font-weight: bold" value="#{managedCompensation.achat.montantTotal}" converter="#{managedFactureVenteV2.converter}"/>
                            <span style="font-size:0.8em">#{managedFactureVenteV2.currentScte.devise} </span>
                        </h:panelGroup>
                    </span>
                    <div style="width: 99.5%; height: 130px; border: solid 1px; margin: auto;overflow-y: auto">
                        <p:dataTable value="#{managedCompensation.achats}" var="ac" rowKey="#{ac.id}" selectionMode="single" rowIndexVar="Idx" id="data_achat_compensation">
                            <p:ajax event="rowSelect" listener="#{managedCompensation.loadOnViewAchat}"
                                    update=":select_fv_compensation:total_achat_compensation :select_fv_compensation:blog_compensation_facture_vente"/>
                            <p:column width="30" headerText="N°" styleClass="statut_#{ac.statut}">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{ac.new_}"/> 
                                <span>#{Idx+1}</span>
                                <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{ac.cloturer}"/>      
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" style="width: 20%" styleClass="statut_#{ac.statut}">
                                <span>#{ac.numDoc}</span>
                                <h:outputText value="vide" style="float: right;color: blue;font-style: italic;font-size: 0.8em" rendered="#{0>=ac.contenus.size()}"/>
                                <h:panelGroup style="float: right">
                                    <h:outputText title="#{lab.LDB_PU_facture_livree}" value="L" rendered="#{ac.statutLivre == constantes.ETAT_LIVRE}"
                                                  styleClass="style_statut"/>
                                </h:panelGroup>
                            </p:column>
                            <p:column headerText="#{lab.L_date}" style="text-align: center;width: 15%" styleClass="statut_#{ac.statut}">
                                <h:outputText value="#{ac.dateDoc}" converter="DDMMYYYY"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_fournisseur}" styleClass="statut_#{ac.statut}">
                                <h:outputText value="#{ac.fournisseur.tiers.nom_prenom}"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_piece_externe}" style="width: 20%" styleClass="statut_#{ac.statut}">
                                <span>#{ac.numPiece}</span>
                            </p:column>
                            <p:column headerText="" width="15"  style="text-align: center" styleClass="statut_#{ac.statut}">
                                <p:contextMenu event="left click" for="btn_opt_nav_fa">
                                    <p:menuitem icon="ui-icon-arrowthick-1-e" actionListener="#{managedFactureVenteV2.onLoadFactureAchat(ac)}" value="#{lab.L_aller_a}" />
                                </p:contextMenu>
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px;" id="btn_opt_nav_fa" type="button"/>
                            </p:column>
                        </p:dataTable>
                    </div>
                    <div style="font-size:0.9em">
                        <h:panelGroup style="float: left">
                            <span>#{lab.LC_PFV_total_reglement} : </span>
                            <h:outputText style="font-weight: bold" value="#{managedCompensation.selectPieceVente.montant}" converter="#{managedFactureVenteV2.converter}"/>
                            <span style="font-size:0.8em">#{managedFactureVenteV2.currentScte.devise} </span>
                        </h:panelGroup>
                        <h:panelGroup style="float: right" id="total_achat_compensation_equilibre">
                            <span>#{lab.LC_PFV_total_equilibre} : </span>
                            <h:outputText style="font-weight: bold" value="#{managedCompensation.selectPieceVente.sommeAchat}" converter="#{managedFactureVenteV2.converter}"/>
                            <span style="font-size:0.8em">#{managedFactureVenteV2.currentScte.devise} </span>
                        </h:panelGroup>
                    </div>
                </div> 
                <p:separator/>
                <p:outputPanel id="blog_compensation_facture_vente">
                    <h:panelGrid id="form_compensation_facture_vente" columns="4" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" 
                                 style="padding-top: 2px;padding-bottom: -5px;background: #CCC;width: 100%">
                        <h:outputText value="#{lab.L_montant}" />
                        <h:outputText value="#{lab.LC_PFV_date_paiement}" />
                        <h:outputText value="#{lab.LC_PFV_caisse}" />
                        <h:outputText value="#{lab.L_reference}"/>
                        <pe:inputNumber value="#{managedCompensation.pieceAchat.montant}"  style="text-align: right"/>
                        <p:calendar value="#{managedCompensation.pieceAchat.datePaiementPrevu}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                        <h:selectOneMenu value="#{managedCompensation.pieceAchat.caisse.id}">
                            <f:selectItem itemLabel="" itemValue="0" />
                            <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}"
                                           itemValue="#{icaiss.id}" />
                        </h:selectOneMenu>
                        <h:panelGroup>
                            <h:inputText value="#{managedCompensation.pieceAchat.numRefExterne}" />
                            <p:commandButton icon="ui-icon-circle-plus" style="width: 22px; height: 22px;float: right"
                                             update="blog_compensation_facture_vente" actionListener="#{managedCompensation.saveNew()}"/>
                        </h:panelGroup> 
                    </h:panelGrid>                                            
                    <p:dataTable id="data_compensation_facture_vente" value="#{managedCompensation.selectPieceVente.compensations}" var="acc" rowKey="#{acc.id}" rowIndexVar="Idx" selectionMode="single">
                        <p:ajax event="rowSelect" global="false" listener="#{managedCompensation.loadOnView}" 
                                update=":select_fv_compensation:form_compensation_facture_vente :select_fv_compensation:total_achat_compensation :select_fv_compensation:data_achat_compensation"/>
                        <p:ajax event="rowUnselect" global="false" listener="#{managedCompensation.unLoadOnView}" 
                                update=":select_fv_compensation:form_compensation_facture_vente :select_fv_compensation:total_achat_compensation"/>
                        <p:column headerText="N°" width="20" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{acc.achat.new_}"/>
                            <h:outputText value="#{Idx+1}"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_facture_numero}" filterBy="#{acc.achat.numeroPiece}" sortBy="#{acc.achat.datePiece}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            #{acc.achat.achat.numDoc}
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_piece_numero}"  sortBy="#{acc.achat.datePiece}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            #{acc.achat.numeroPiece}
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_date_edition}" sortBy="#{acc.achat.datePiece}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:outputText value="#{acc.achat.datePiece}" converter="DDMMYYYY"/>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFV_date_reglement}" sortBy="#{acc.achat.datePaimentPrevu}" style="text-align: center" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:outputText value="#{(acc.achat.statutPiece eq constantes.STATUT_DOC_PAYER)?acc.achat.datePaiement:acc.achat.datePaimentPrevu}" converter="DDMMYYYY"/>
                        </p:column>
                        <p:column headerText="#{lab.L_montant}" style="width: 17%;text-align: right" styleClass="statut_#{managedCompensation.giveStringStatut(acc.achat.statutPiece)}">
                            <h:outputText value="#{acc.achat.montant}" converter="#{managedFactureVenteV2.converter}"/>
                        </p:column>                                                                                    
                        <p:column style="width: 5%;text-align: center">
                            <p:commandButton icon="#{acc.id gt 0? 'ui-icon-minusthick':'ui-icon-plusthick'}" title="#{acc.id gt 0? 'Enlever':'Associer'}"
                                             style="width: 20px;height: 20px" actionListener="#{managedCompensation.addComprensation(acc)}" 
                                             update="data_compensation_facture_vente :select_fv_compensation:total_achat_compensation_equilibre"/>
                        </p:column>  
                    </p:dataTable>
                </p:outputPanel>
            </p:dialog>
        </h:form>


        <!-->
        *****************************************************************************
        Boite de dialogue des livraisons liée au contenu
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_livraison_fv">
            <p:dialog header="#{lab.LC_PFV_modifier_quantite}"  widgetVar="dlgDefinedContenu" modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGroup id="form_defined_contenu" style="width: 100%">
                    <h:inputText value="#{managedLivraisonVente.quantite_livree}" style="width: 100px"/> 
                    <span> / </span>
                    <h:inputText value="#{managedLivraisonVente.selectContenu.qteRestant}"  style="width: 100px" disabled="true"/>                     
                    <p:commandButton value="#{lab.L_appliquer}" oncomplete="dlgDefinedContenu.hide()" icon="ui-icon-circle-check"
                                     actionListener="#{managedLivraisonVente.insertInLivraison()}" style="margin-left: 10px"/>
                </h:panelGroup>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PFV_liste_bon_livraison}" widgetVar="dlgOpenLivraison" modal="true" width="80%"  closeOnEscape="true"> 
                <p:dataTable id="data_livraison_content" value="#{managedLivraisonVente.livraisons}" var="bon" rowKey="#{bon.id}"
                             selectionMode="single" rowIndexVar="bonIdx">
                    <p:ajax event="rowSelect" global="false" listener="#{managedLivraisonVente.loadOnViewLivraison}" 
                            oncomplete="dlgDefinedContenu.show()" update=":main_livraison_fv:form_defined_contenu"/>
                    <p:ajax event="rowUnselect" global="false" listener="#{managedLivraisonVente.unLoadOnViewLivraison}" 
                            oncomplete="dlgDefinedContenu.show()" update=":main_livraison_fv:form_defined_contenu"/>
                    <p:column headerText="N°" width="30" styleClass="statut_#{bon.statut}">
                        <span>#{bonIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}">
                        <span>#{bon.numDoc}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_clients}" styleClass="statut_#{bon.statut}">
                        #{bon.client.nom_prenom}
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_depot}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.depotLivrer.designation}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_tranche}" styleClass="statut_#{bon.statut}" style="text-align: center">
                        <h:outputText value="#{bon.trancheLivrer.heureDebut}" converter="TIME"/>
                        -
                        <h:outputText value="#{bon.trancheLivrer.heureFin}" converter="TIME"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_date_livraison}" style="text-align: center;width: 10%" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.dateLivraison}" converter="DDMMYYYY"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_livreur}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.livreur.nomUsers}"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des depots du contenu
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_change_depot_contenu">
            <p:dialog header="#{lab.LC_PFV_depot_livraison_prevu}" widgetVar="dlgChangeDepot" modal="true" width="40%"  closeOnEscape="true"> 
                <h:panelGrid id="form_change_depot_contenu" columns="2" styleClass="yvs_table" style="width: 100%;margin: auto" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_agence}" rendered="#{managedAgence.agences.size() gt 1}"/> 
                    <h:selectOneMenu value="#{managedLivraisonVente.agenceChange}" style="width: 100%"  rendered="#{managedAgence.agences.size() gt 1}">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedAgence.agences}" var="ag" 
                                       itemLabel="#{ag.designation}" itemValue="#{ag.id}" />  
                        <p:ajax event="valueChange" listener="#{managedLivraisonVente.chooseAgenceLivraison()}" update="selec-depot_contenu"/>
                    </h:selectOneMenu> 
                    <span>#{lab.LC_PFV_depot} : </span> 
                    <h:panelGroup>
                        <h:selectOneMenu value="#{managedLivraisonVente.depotChange.id}" style="min-width: 120px" id="selec-depot_contenu">
                            <f:selectItem itemLabel="--" itemValue="0"/>
                            <f:selectItems value="#{managedLivraisonVente.depotsLivraison}" var="dpl" itemLabel="#{dpl.designation}" itemValue="#{dpl.id}" />    
                            <p:ajax event="valueChange" global="false" listener="#{managedLivraisonVente.chooseDepotContenu()}" update="txt_stock_article_in_depot"/>
                        </h:selectOneMenu> 
                        <h:panelGroup style="float: right;margin-top: 5px" id="txt_stock_article_in_depot">
                            <h:outputText value="#{managedLivraisonVente.depotChange.stock}" converter="#{managedFactureVenteV2.converterStock}" title="Plus #{selectContenu.quantiteBonus} Bonus"/>
                            <span title="#{managedLivraisonVente.selectContenu.conditionnement.unite.libelle}" 
                                  style="font-size: 0.6em;color: #003399">#{managedLivraisonVente.selectContenu.conditionnement.unite.reference}</span>
                        </h:panelGroup>
                    </h:panelGroup>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgChangeDepot.hide()"
                                 actionListener="#{managedFactureVenteV2.changeDepotContenu()}" 
                                 update=":main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des unites de mesure
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_zone_fv">
            <p:dialog header="#{lab.LC_PFV_creation_zone}" widgetVar="dlgAddZone" modal="true" width="30%"  closeOnEscape="true" > 
                <h:panelGrid id="form_zone_fv" columns="2" styleClass="yvs_table" style="width: 100%;margin: auto" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGroup style="float: left">
                            <span>#{lab.LC_PFV_titre} </span>
                            <h:selectOneMenu value="#{Mdico.dictionnaire.titre}">                   
                                <f:selectItem itemLabel="--" itemValue="#{null}"/>                    
                                <f:selectItem itemLabel="#{constantes.t_VILLES}" itemValue="#{constantes.t_VILLES}"/>                    
                                <f:selectItem itemLabel="#{constantes.t_SECTEURS}" itemValue="#{constantes.t_SECTEURS}"/>                    
                                <p:ajax event="valueChange" global="false" listener="#{Mdico.chooseTitre()}" update="txt_parent_zone_fv"/>
                            </h:selectOneMenu>    
                        </h:panelGroup>
                    </f:facet>
                    <span>#{lab.LC_PFV_abbreviation}</span>
                    <h:inputText value="#{Mdico.dictionnaire.abreviation}" style="width: 100%"/>
                    <span>#{lab.L_libelle}</span>
                    <h:inputText value="#{Mdico.dictionnaire.libelle}" style="width: 100%"/> 
                    <span>#{lab.L_parent}</span>
                    <h:selectOneMenu value="#{Mdico.dictionnaire.parent.id}" id="txt_parent_zone_fv" style="width: 100%">
                        <f:selectItem itemLabel="--" itemValue="0"/>                    
                        <f:selectItems value="#{Mdico.parents}" var="dP"
                                       itemLabel="#{dP.libele}" itemValue="#{dP.id}"/>                    
                    </h:selectOneMenu> 
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" update="form_zone_fv :main_facture_vente:txt_zone_client"
                                 actionListener="#{managedFactureVenteV2.saveZone()}" oncomplete="dlgAddZone.hide()"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false" id="dglnote">
            <p:dialog widgetVar="dlgAddNote" closeOnEscape="true" header="#{lab.LC_PFV_ajouter_note}" 
                      height="200" width="400">
                <p:watermark for="txt_note_facture" value="Entrez une note ici..." />
                <h:inputTextarea value="#{managedFactureVenteV2.notes}" id="txt_note_facture" style="width: 98%; height: 90%"/>
                <f:facet name="footer">
                    <p:commandButton value="#{lab.L_valider}"  icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.addNote()}" oncomplete="dlgAddNote.hide()"/>
                    <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgAddNote.hide()"  type="button" icon="ui-icon-circle-close"/>
                </f:facet>
            </p:dialog>
        </h:form>



        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgAnnulerPcv" closeOnEscape="true"
                             message="#{lab.LC_PFV_text1} ">
                <p:commandButton value="#{lab.L_oui}"  icon="ui-icon-circle-check" actionListener="#{managedReglementVente.suspendreReglementVente()}" 
                                 oncomplete="dlgAnnulerPcv.hide()" update=":main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" onclick="dlgAnnulerPcv.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv" closeOnEscape="true"
                             message="#{lab.LC_PFV_text2} ">
                <span>#{lab.LC_PFV_text11}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}"  icon="ui-icon-circle-check" actionListener="#{managedReglementVente.cancelStatutPayeOfPCV()}" oncomplete="dlgCancelPcv.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv1" closeOnEscape="true"
                             message="#{lab.LC_PFV_text3} ">
                <span>#{lab.LC_PFV_text10}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedReglementVente.cancelStatutPayeOfPCVForBanque()}" oncomplete="dlgCancelPcv1.hide()" />
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv1.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv2" closeOnEscape="true"
                             message="#{lab.LC_PFV_text4} ">
                <span>#{lab.LC_PFV_text9}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedReglementVente.cancelStatutPayeOfPCVBySalaire()}" oncomplete="dlgCancelPcv2.hide()" />
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv2.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgCancelPcv3" closeOnEscape="true"
                             message="#{lab.LC_PFV_text5} ">
                <span>#{lab.LC_PFV_text9}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedReglementVente.cancelStatutPayeOfPCVByCompensation()}" oncomplete="dlgCancelPcv3.hide()" />
                <p:commandButton value="#{lab.LC_PFV_annuler}" onclick="dlgCancelPcv3.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeMode" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="#{lab.LC_PFV_text6} ">
                <span>#{lab.LC_PFV_text7}</span>
                <p:commandButton value="Ok" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeMode.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmDeletePhase" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="#{lab.LC_PFV_text8}">
                <span>#{lab.LC_PFV_text12}</span>
                <p:commandButton value="#{lab.LC_PFV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.saveNewReglement(true)}" 
                                 update=":main_facture_vente:tabview_facture_vente:form_mensualite_facture_vente" oncomplete="dlgConfirmDeletePhase.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmDeletePhase.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeInventaire" closeOnEscape="true" header="#{lab.LC_PFV_attention}"
                             message="#{lab.LC_PFV_text13}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.transmisOrderByForce()}" oncomplete="dlgConfirmChangeInventaire.hide()"
                                 update=":main_facture_vente:tabview_facture_vente: :main_facture_vente:data_facture_vente :main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeInventaire.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeInventaireByValid" closeOnEscape="true" header="#{lab.LC_PFV_attention}"
                             message="#{lab.LC_PFV_text13}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.onValideDistantLivraisonByForce()}" oncomplete="dlgConfirmChangeInventaireByValid.hide()"
                                 update=":main_facture_vente:tabview_facture_vente: :main_facture_vente:data_facture_vente :main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeInventaireByValid.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeInventaireByCancel" closeOnEscape="true" header="#{lab.LC_PFV_attention}"
                             message="#{lab.LC_PFV_text13}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.onAnnulerDistantLivraisonByForce()}" oncomplete="dlgConfirmChangeInventaireByCancel.hide()"
                                 update=":main_facture_vente:tabview_facture_vente: :main_facture_vente:data_facture_vente :main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeInventaireByCancel.hide()"/>
            </p:confirmDialog>
        </h:form> 
        <!-->Règlement par salaire<-->
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_text14}" modal="true" closeOnEscape="true"
                      widgetVar="dlgChoixTypeRet" width="70%" footer="&copy;Lymytz 2014"> 
                <h:panelGrid columns="6" style="width: 100%" id="zone_choix_retenu_vente">
                    <span>#{lab.LC_PFV_text15}</span>
                    <p:calendar size="8" pattern="dd-MM-yyyy" value="#{managedRetenue.debutPlanif}" >
                        <p:ajax global="false" event="dateSelect" />
                    </p:calendar>
                    <span>#{lab.LC_PFV_type_retenue}</span>
                    <h:selectOneMenu value="#{managedRetenue.elementAdd.typeElt.id}" >
                        <f:selectItem itemValue="0" itemLabel="" />
                        <f:selectItems value="#{managedRetenue.listTypesElts}" var="typE"
                                       itemValue="#{typE.id}" itemLabel="#{typE.libelle}" rendered="#{typE.visibleEnGescom}"/>
                        <p:ajax event="valueChange" update="tab_prelevement_detail_vente" listener="#{managedRetenue.placerRetenu(managedReglementVente.pieceVente.montant)}" />
                    </h:selectOneMenu>
                    <span>#{lab.LC_PFV_plan}</span>
                    <h:selectOneMenu value="#{managedRetenue.elementAdd.plan.id}">
                        <f:selectItem itemValue="0" itemLabel="" noSelectionOption="true" />
                        <f:selectItems value="#{managedRetenue.plansRetenues}" var="planR" itemValue="#{planR.id}" itemLabel="#{planR.referencePlan}" rendered="#{(planR.actif and planR.visibleEnGescom)}"/>
                        <p:ajax event="valueChange" update="tab_prelevement_detail_vente" listener="#{managedRetenue.placerRetenu(managedReglementVente.pieceVente.montant)}" />
                    </h:selectOneMenu>                    
                    <f:facet name="footer" >
                        <p:dataTable value="#{managedRetenue.elementAdd.listPrelevement}" var="det_" rowKey="#{det_.id}"
                                     widgetVar="tableauDetailPlanPrelevement" rowIndexVar="line_detailP"
                                     selectionMode="single" id="tab_prelevement_detail_vente" selection="#{managedRetenue.selectedDetailPrelevement}">
                            <p:column width="20" headerText="N°" style="text-align: center"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                #{line_detailP+1}
                                <p:graphicImage library="img" name="blocked.png" rendered="#{det_.retenuFixe}" />
                            </p:column>                                
                            <p:column headerText="#{lab.LC_PFV_date_prevelement}" width="100" style="text-align: left"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                <h:outputText value="#{det_.datePrelevement}" converter="LD"/>
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" width="200" style="text-align: center"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                <h:outputText value="#{det_.reference}" />
                            </p:column>
                            <p:column headerText=" #{lab.LC_PFV_montant_prevelement}" width="100" style="text-align: right"
                                      styleClass="statutMesn_#{det_.statutReglement}">
                                <h:outputText value="#{det_.valeur}" converter="#{managedFactureVenteV2.converter}"/>
                            </p:column>
                        </p:dataTable>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="float: right" actionListener="#{managedReglementVente.valideReglementFacture()}" oncomplete="dlgChoixTypeRet.hide()"/>
            </p:dialog>            
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue de type cout
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_creation_type}" widgetVar="dlgAddTypeCout" modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGrid id="form_type_cout_facture_vente" columns="4" cellpadding="0" cellspacing="0" style="width: 100%">
                    <p:commandLink actionListener="#{managedTypeCout.typeCout.setAugmentation(!managedTypeCout.typeCout.augmentation)}" global="false" update="@this">
                        <h:graphicImage title="#{managedTypeCout.typeCout.augmentation?'Augmente':'diminu'} le net à payer" library="img/icones" name="#{managedTypeCout.typeCout.augmentation?'plus.png':'moins.png'}"
                                        width="15" height="15" style="padding: 2px;margin-top: 3px;border: 2px solid black; border-radius: 5px;"/>  
                    </p:commandLink>
                    <h:inputText value="#{managedTypeCout.typeCout.libelle}" style="width: 100%"/>
                    <h:selectOneMenu value="#{managedTypeCout.typeCout.module}" style="width: 100%">
                        <f:selectItems value="#{constantes.COUTS(constantes.MOD_COM)}" var="mol" itemValue="#{mol.value}" itemLabel="#{mol.label}"/>
                    </h:selectOneMenu>
                    <p:commandButton icon="ui-icon-circle-plus" oncomplete="dlgAddTypeCout.hide()" actionListener="#{managedTypeCout.saveNew()}" 
                                     update=":main_facture_vente:tabview_facture_vente:select_type_cout_facture_vente"
                                     style="width: 22px; height: 22px;float: right;margin-top: 0px;float: right;background: white!important"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des taxes d'un contenu
        *****************************************************************************
        <-->  
        <h:form id="data_taxes_contenu_facture_vente" prependId="false">
            <p:dialog header="#{lab.LC_PFV_taxe_sur_article} '#{managedFactureVenteV2.contenu.name}'" widgetVar="dlgListTaxesContenu" 
                      width="50%"  closeOnEscape="true"> 
                <p:dataTable value="#{managedFactureVenteV2.contenu.taxes}" var="tx" rowKey="#{tx.id}" id="tbl_data_taxes">
                    <p:column headerText="#{lab.L_taxe}" >
                        <span>#{tx.taxe.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_taux}" style="text-align: right;width: 15%">
                        <h:outputText value="#{tx.taxe.taux}" converter="DNS"/>
                        %
                    </p:column>
                    <p:column headerText="#{lab.L_montant}" style="text-align: right;width: 35%">
                        <h:outputText value="#{tx.montant}" converter="#{managedFactureVenteV2.converter}"/>
                        #{managedFactureVenteV2.currentScte.devise}
                    </p:column>
                    <p:column width="20" style="text-align: center">
                        <p:commandButton icon="#{tx.id gt 0?'ui-icon-minus':'ui-icon-plus'}" styleClass="button_gear" 
                                         actionListener="#{managedFactureVenteV2.applyOrRemoveTaxe(tx)}" update="tbl_data_taxes"/>
                    </p:column>
                </p:dataTable>  
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue d'ajout des commentaires
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_bonus}" widgetVar="dlgAddBonus" modal="true" width="40%"  closeOnEscape="true"
                      > 
                <h:panelGrid id="txt_bonus_contenu_facture_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGrid columns="2" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" 
                                     style="font-size: 0.8em;width: 100%" rendered="#{managedFactureAchat.bonus.articleBonus.selectArt}">
                            <h:panelGroup>
                                <span style="font-weight: bold;color: #000">#{managedFactureVenteV2.bonus.articleBonus.designation}</span>
                                <span>#{lab.LC_PFV_vendu_a} </span>
                                <h:outputText value="#{managedFactureVenteV2.bonus.articleBonus.puv}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold;color: #000"/>
                                <span>#{managedFactureVenteV2.currentScte.devise}  </span>
                            </h:panelGroup>
                            <h:panelGroup style="float: right">
                                <h:outputText value="#{managedFactureVenteV2.bonus.articleBonus.stock}" converter="#{managedFactureVenteV2.converterStock}" style="font-weight: bold;color: #000"/>
                                <h:outputText value=" #{managedFactureVenteV2.bonus.conditionnementBonus.unite.reference}"/>
                                <span> #{lab.LC_PFV_en_stock}</span>
                            </h:panelGroup>
                        </h:panelGrid>
                    </f:facet>
                    <span>#{lab.L_article}</span>
                    <h:panelGroup id="blog_bonus_facture_vente">
                        <h:panelGroup style="float: left">
                            <h:inputText value="#{managedFactureVenteV2.bonus.articleBonus.refArt}" style="color: #{managedFactureVenteV2.bonus.articleBonus.error?'red':''}; width: 120px">
                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchArticle(true)}" update="blog_bonus_facture_vente chp_bonus_facture_vente"/>
                            </h:inputText>    
                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="Liste Articles" global="false"
                                             actionListener="#{managedFactureVenteV2.initArticles(true)}" oncomplete="dlgListArticle.show()"/>
                        </h:panelGroup>
                        <div align="center" style="font-size: 0.9em;float: left;margin-top: 10px;margin-left: 5px">#{managedFactureVenteV2.bonus.articleBonus.designation}</div>
                    </h:panelGroup>   
                    <span>#{lab.L_conditionnement}</span>
                    <h:selectOneMenu id="chp_bonus_facture_vente" value="#{managedFactureVenteV2.bonus.conditionnementBonus.id}" title="#{lab.LC_PRA_selectionner_conditionnement}" tabindex="15" style="min-width: 120px">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedFactureVenteV2.bonus.articleBonus.conditionnements}" var="un" itemLabel="#{un.unite.reference}" itemValue="#{un.id}"/>
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseConditionnement(true)}"/>
                    </h:selectOneMenu>     
                    <span>#{lab.L_quantite}</span>
                    <h:inputText value="#{managedFactureVenteV2.bonus.quantiteBonus}" style="text-align: right"/>      
                    <f:facet name="footer">
                        <p:commandButton actionListener="#{managedFactureVenteV2.addBonusContenu()}" style="width: 99%"
                                         oncomplete="dlgAddBonus.hide()" value="#{lab.L_enregistrer}"/>                        
                    </f:facet>              
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false" >
            <p:dialog header="#{lab.LC_PCV_commentaire}" widgetVar="dlgAddCommentaire" modal="true" width="26%"  closeOnEscape="true"
                      > 
                <p:watermark for="txt_commentaire_contenu_facture_vente" value="Entrez votre commentaire ici..." />
                <h:inputTextarea value="#{managedFactureVenteV2.commentaire}" style="width: 99%" rows="5" 
                                 id="txt_commentaire_contenu_facture_vente"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    <p:commandButton actionListener="#{managedFactureVenteV2.addCommentaireContenu()}" style="width: 99%"
                                     oncomplete="dlgAddCommentaire.hide()" value="#{lab.L_enregistrer}"/>
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_numero_serie}" widgetVar="dlgAddNumSerie" modal="true" width="26%"  closeOnEscape="true"> 
                <h:inputText value="#{managedFactureVenteV2.numSerie}" style="width: 99%;text-align: center" id="txt_num_serie_contenu_facture_vente"/>
                <p:commandButton actionListener="#{managedFactureVenteV2.addNumSerieContenu()}" style="width: 99%"
                                 oncomplete="dlgAddNumSerie.hide()" value="#{lab.L_enregistrer}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_montant_rabais}" widgetVar="dlgAddRabais" modal="true" width="40%"  closeOnEscape="true"> 
                <h:panelGrid id="txt_rabais_contenu_facture_vente" columns="2" style="width: 100%"
                             styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.LC_PFV_prix_unitaire}"/>
                    <h:outputText value="#{lab.LC_PTBV_prix_total} "/>
                    <pe:inputNumber id="txt_rabais_contenu_fv_1" value="#{managedFactureVenteV2.montant_rabais}" style="width: 99%;text-align: right">
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onRabaisBlur(false)}" update="txt_rabais_contenu_fv_2"/>
                    </pe:inputNumber>
                    <pe:inputNumber id="txt_rabais_contenu_fv_2" value="#{managedFactureVenteV2.montant_rabais_total}" style="width: 99%;text-align: right">
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onRabaisBlur(true)}" update="txt_rabais_contenu_fv_1"/>
                    </pe:inputNumber>
                    <f:facet name="footer">
                        <span>#{lab.L_description}</span>
                        <h:inputTextarea value="#{managedFactureVenteV2.commentaire}" style="width: 99%" rows="5"/>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton actionListener="#{managedFactureVenteV2.addRabaisContenu()}" style="width: 99%"
                                 oncomplete="dlgAddRabais.hide()" value="#{lab.L_enregistrer}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_appliquer_remise}" widgetVar="dlgAddRemise" modal="true" width="45%"  closeOnEscape="true"> 
                <h:panelGrid id="txt_remise_contenu_facture_vente" columns="4" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_type}" />
                    <h:outputText value="#{lab.L_remise}" />
                    <h:outputText value="#{lab.L_total}" />
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.docVente.propagerRemise}" title="#{lab.LC_PFV_propager_remise}"/>
                    <h:selectOneMenu id="value-select_remise_fv" value="#{managedFactureVenteV2.remiseContenu}" style="min-width: 120px" title="#{lab.LC_PFV_selectionner_remise}">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedRemise.remises}" var="rem_" 
                                       itemLabel="#{rem_.refRemise}" itemValue="#{rem_.id}"/>
                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseRemiseContenu()}" 
                                update="txt_remise_contenu_facture_vente"/>
                    </h:selectOneMenu>  
                    <h:panelGroup>
                        <h:inputText id="txt_remise_contenu_fv_2" value="#{managedFactureVenteV2.taux_remise}"  style="width: 100px;text-align: right" 
                                     title="#{lab.LC_PFA_remise_pourcentage}" readonly="true"/>   
                        <h:outputText value="%" rendered="#{managedFactureVenteV2.remise_is_taux}"/>
                    </h:panelGroup>
                    <h:inputText id="txt_remise_contenu_fv_1" value="#{managedFactureVenteV2.montant_remise}" style="text-align: right"
                                 title="#{lab.LC_PFA_remise_valeur}" readonly="true"/>  
                    <p:commandButton icon="ui-icon-circle-check" value="Appliquer" actionListener="#{managedFactureVenteV2.addRemiseContenu()}" oncomplete="dlgAddRemise.hide()"
                                     style="float: right;margin-top: 0px;float: right;background: white!important"/>                 
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des tranches horaires
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_liste_tranche_depot}" widgetVar="dlgListTranche" modal="true" width="40%"  closeOnEscape="true"> 
                <p:dataTable id="data_tranche_fv" value="#{managedFactureVenteV2.tranches}" var="trh" rowKey="#{trh.id}" selectionMode="single" rowIndexVar="line_trh">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewTranche}" oncomplete="dlgListTranche.hide()"/>
                    <p:column headerText="N°" width="20">
                        <span>#{line_trh+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_titre}" width="130">
                        <span>#{trh.titre}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_heure_debut}" width="90">
                        <h:outputText value="#{trh.heureDebut}" converter="TIME"/>
                    </p:column>
                    <p:column headerText="#{lab.L_heure_fin}" width="90">
                        <h:outputText value="#{trh.heureFin}" converter="TIME"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des commerciaux
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PFV_liste_commerciaux}" widgetVar="dlgListCommerciaux" modal="true" width="70%" minHeight="300" closeOnEscape="true"> 
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText value="#{managedCommerciaux.numSearch}" style="float: left">
                        <p:ajax event="valueChange" listener="#{managedCommerciaux.addParamCode()}" 
                                update="data_commerciaux_facture_vente"/>
                    </h:inputText>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedCommerciaux.loadAllCommerciaux(false, false)}" global="false" update="data_commerciaux_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedCommerciaux.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedCommerciaux.paginator.currentPage}/#{managedCommerciaux.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedCommerciaux.loadAllCommerciaux(true, false)}" global="false" update="data_commerciaux_facture_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedCommerciaux.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedCommerciaux.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedCommerciaux.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedCommerciaux.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_commerciaux_facture_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <p:dataTable id="data_commerciaux_facture_vente" value="#{managedCommerciaux.commerciaux}" var="icomm" rowKey="#{icomm.id}"
                             selectionMode="single" rowIndexVar="line_art" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewCommercial}" oncomplete="dlgListCommerciaux.hide()"/>
                    <p:column headerText="N°" width="20">
                        <span>#{line_art+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" width="50">
                        <h:outputText value="#{icomm.codeRef}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_nom_prenom}" width="100">
                        <h:outputText value="#{icomm.nom_prenom}"/>
                    </p:column>                                                        
                    <p:column headerText="#{lab.L_agence}" style="text-align: center" width="75">
                        <h:outputText value="#{icomm.agence.designation}"/>
                    </p:column>                            
                    <p:column width="20" headerText="Actif" style="text-align: center">
                        <h:graphicImage library="img" name="#{(icomm.actif)?'yes.png':'no.png'}" width="15" height="15"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="Vendre le pack ?" widgetVar="dlgListArticlePack" modal="true" width="50%" height="450" closeOnEscape="true"> 
                <p:dataTable id="data_articles_pack_facture_vente" value="#{managedFactureVenteV2.contenu.conditionnement.packs}" var="pck" rowKey="#{pck.id}"
                             selectionMode="single" rowIndexVar="line_art" style="overflow-y: auto">
                    <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewArticlePack}" oncomplete="dlgListArticlePack.hide()"
                            update=":main_facture_vente:tabview_facture_vente:form_contenu_facture_vente :main_facture_vente:blog_commercial_vente"/>
                    <p:column headerText="N°" style="width : 5%">
                        <span>#{line_art+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LDB_PA_designation}">
                        <span>#{pck.designation}</span>                                                                     
                    </p:column>
                    <p:column headerText="#{lab.LDB_PA_montant}" width="100" style="text-align: right">
                        <h:outputText value="#{pck.montant}" converter="DNA"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
            <p:dialog header="#{lab.LDB_PA_liste_articles}" widgetVar="dlgListArticle" modal="true" width="70%" height="450" 
                      closeOnEscape="true"> 
                <p:watermark for="txt_search_article_fv" value="Reference article..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_article_fv" value="#{managedStockArticle.article.article.refArt}">
                        <p:ajax event="valueChange" listener="#{managedStockArticle.searchArticleActifByPoint(false)}" update="data_articles_facture_vente"/>
                    </h:inputText> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedStockArticle.loadActifArticleByPoint(false, false)}" update="data_articles_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedStockArticle.pv.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedStockArticle.pv.currentPage}/#{managedStockArticle.pv.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedStockArticle.loadActifArticleByPoint(true, false)}" update="data_articles_facture_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedStockArticle.pv.disNext}"/>
                        <p:selectOneMenu value="#{managedStockArticle.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedStockArticle._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                            <f:selectItems value="#{managedStockArticle.paginations}"/>
                            <p:ajax event="valueChange" update="data_articles_facture_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </h:panelGrid>
                <div style="height: 385px">
                    <p:dataTable id="data_articles_facture_vente" value="#{managedStockArticle.articles}" var="art" rowKey="#{art.id}"
                                 selectionMode="single" rowIndexVar="line_art" style="overflow-y: auto">
                        <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewArticle}" oncomplete="dlgListArticle.hide()"
                                update=":main_facture_vente:tabview_facture_vente:form_contenu_facture_vente :main_facture_vente:blog_commercial_vente"/>
                        <p:column headerText="N°" style="width : 5%">
                            <span title="#{art.designation}">#{line_art+1}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}" style="width : 15%">
                            <span title="#{art.designation}" style="font-size: 0.9em">#{art.refArt}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_designation}" style="width : 45%">
                            <span title="#{art.designation}" style="font-size: 0.9em">#{art.designation}</span>
                        </p:column>
                        <p:column headerText="#{lab.L_categorie}" style="width : 15%">
                            <span title="#{art.designation}" style="font-size: 0.9em">#{art.categorie}</span>
                        </p:column>
                        <p:column headerText="#{lab.LC_POV_prix_a}" width="10" style="text-align: right; width : 10%">
                            <h:outputText value="#{art.pua}" title="#{art.designation}" converter="#{managedFactureVenteV2.converter}" style="font-size: 0.9em" />
                        </p:column>
                        <p:column headerText="#{lab.LC_POV_prix_v}" width="10" style="text-align: right; width : 10%">
                            <h:outputText value="#{art.puv}" title="#{art.designation}" converter="#{managedFactureVenteV2.converter}" style="font-size: 0.9em" />
                        </p:column>
                    </p:dataTable>
                </div>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des entetes de vente
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_plus_option}" width="40%"  closeOnEscape="true" widgetVar="dlgPlusOption" resizable="false"> 
                <h:panelGrid id="blog_entete_facture_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <div align="right" style="padding:5px">
                            <p:selectBooleanCheckbox itemLabel="Recherche automatique" value="#{managedFactureVenteV2.searchAutomatique}">
                                <p:ajax event="valueChange"/>
                            </p:selectBooleanCheckbox>
                        </div>
                    </f:facet>
                    <h:outputText value="#{lab.L_agence} " />
                    <h:selectOneMenu value="#{managedFactureVenteV2.agence_}" id="_select_agence2" style="width: 100%">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedAgence.listAgence}" var="ag"
                                       itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2._chooseAgence()}" 
                                update="blog_entete_facture_vente :main_facture_vente:data_facture_vente"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.L_point_vente}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.point_}" style="width: 100%">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedPointVente.pointsvente_all}" var="_po" 
                                       itemLabel="#{_po.libelle}" itemValue="#{_po.id}" />  
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2._choosePoint()}"
                                update=":main_facture_vente:data_facture_vente @this"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PFV_vendeur}"/>                    
                    <h:inputText value="#{managedFactureVenteV2.codeVendeur_}" style="width: 100%">
                        <p:ajax event="valueChange"  listener="#{managedFactureVenteV2._searchVendeur()}" 
                                update=":main_facture_vente:data_facture_vente @this"/>
                    </h:inputText>       
                    <h:outputText value="Dépôt de livraison" />
                    <h:panelGroup> 
                        <h:selectOneMenu value="#{managedFactureVenteV2.egaliteDepot}">
                            <f:selectItem itemLabel="#{lab.LC_PCV_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.LC_PCV_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":main_facture_vente:data_facture_vente" listener="#{managedFactureVenteV2.addParamDepotLivraison()}"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVenteV2.depot_}" id="_select_depot_2" style="width: 73%">
                            <f:selectItem itemLabel="" itemValue="0"/>
                            <f:selectItems value="#{managedDepot.depots_all}" var="dep"
                                           itemLabel="#{dep.designation}" itemValue="#{dep.id}"/>
                            <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamDepotLivraison()}" update=":main_facture_vente:data_facture_vente"/>
                        </h:selectOneMenu>    
                        <p:commandButton icon="ui-icon-refresh" actionListener="#{managedDepot.loadAllDepot()}" title="Charger" style="width: 20px; height: 22px" update="_select_depot_2"/>
                    </h:panelGroup>         
                    <h:outputText value="#{lab.L_type}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.typeSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{constantes.TYPE_FV_NAME}" itemValue="#{constantes.TYPE_FV}"/>
                        <f:selectItem itemLabel="#{constantes.TYPE_BCV_NAME}" itemValue="#{constantes.TYPE_BCV}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamType()}" update=":main_facture_vente:data_facture_vente"/>
                    </h:selectOneMenu> 
                    <h:outputText value="#{lab.LC_PCV_statut_liv}"/>
                    <h:panelGroup> 
                        <h:selectOneMenu value="#{managedFactureVenteV2.egaliteStatutL}">
                            <f:selectItem itemLabel="#{lab.LC_PCV_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.LC_PCV_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":main_facture_vente:data_facture_vente" listener="#{managedFactureVenteV2.addParamStatutLivre()}"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVenteV2.statutLivre_}" valueChangeListener="#{managedFactureVenteV2.chooseStatutLivre}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_livrer}" itemValue="#{constantes.STATUT_DOC_LIVRER}"/>
                            <p:ajax event="valueChange" update=":main_facture_vente:data_facture_vente"/>
                        </h:selectOneMenu>
                        <h:panelGroup style="float: right">
                            <h:outputText value="#{lab.LC_PFV_automatique} "/>
                            <h:selectOneMenu value="#{managedFactureVenteV2.autoLivreSearch}">
                                <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                                <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                                <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                                <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamAutoLivre()}" update=":main_facture_vente:data_facture_vente"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:outputText value="#{lab.LC_PFV_statut_reg}"/>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{managedFactureVenteV2.egaliteStatutR}">
                            <f:selectItem itemLabel="#{lab.LC_PRPF_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.LC_PRPF_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":main_facture_vente:data_facture_vente" listener="#{managedFactureVenteV2.addParamStatutRegle()}"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVenteV2.statutRegle_}" valueChangeListener="#{managedFactureVenteV2.chooseStatutRegle}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.STATUT_DOC_PAYER}"/>
                            <p:ajax event="valueChange" update=":main_facture_vente:data_facture_vente"/>
                        </h:selectOneMenu> 
                    </h:panelGroup>                   
                    <h:outputText value="#{lab.LC_PCV_verrouille}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.cloturer_}" valueChangeListener="#{managedFactureVenteV2.chooseCloturer}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" update=":main_facture_vente:data_facture_vente"/>
                    </h:selectOneMenu>                    
                    <h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_heures}"/>
                        <h:selectBooleanCheckbox value="#{managedFactureVenteV2.date_}" style="margin-top: 2px;float: right">
                            <p:ajax event="valueChange" listener="#{managedFactureVenteV2.chooseDateSearch()}"
                                    update="blog_date_search_facture_vente :main_facture_vente:data_facture_vente"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_search_facture_vente">
                        <pe:timePicker value="#{managedFactureVenteV2.dateDebut_}" disabled="#{!managedFactureVenteV2.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedFactureVenteV2.chooseDateSearch()}" update=":main_facture_vente:data_facture_vente"/>
                        </pe:timePicker>
                        <p:spacer width="5px" style="background: black"/>
                        <pe:timePicker value="#{managedFactureVenteV2.dateFin_}" disabled="#{!managedFactureVenteV2.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedFactureVenteV2.chooseDateSearch()}" update=":main_facture_vente:data_facture_vente"/>
                        </pe:timePicker>
                    </h:panelGroup>                  
                    <h:outputText value="#{lab.LC_PFV_representant}" />
                    <h:inputText value="#{managedFactureVenteV2.otherSearch_}" style="width: 100%">
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.searchByRepr()}" update=":main_facture_vente:data_facture_vente"/>
                    </h:inputText>  
                    <h:outputText value="#{lab.LC_PFV_commande}"/>
                    <h:inputText value="#{managedFactureVenteV2.numBon}" style="width: 100%" title="#{lab.LC_PFV_text16}">
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.chooseCommande()}" update=":main_facture_vente:data_facture_vente"/>
                    </h:inputText>                   
                    <h:outputText value="#{lab.LC_PFV_tiers_associes}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.withTiersSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamWithTiers()}" update=":main_facture_vente:data_facture_vente"/>
                    </h:selectOneMenu> 
                    <h:outputText value="#{lab.LC_PFV_comptabiliser}"/>
                    <h:selectOneMenu value="#{managedFactureVenteV2.comptaSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamComptabilised()}" update=":main_facture_vente:data_facture_vente"/>
                    </h:selectOneMenu>

                    <h:panelGroup>
                        <h:outputText value="#{lab.LDB_PC_dates}"  />
                        <h:selectBooleanCheckbox value="#{managedFactureVenteV2.date_up}" title="#{lab.LDB_PC_dates_last_modif}" style="float: right">
                            <p:ajax event="valueChange" global="false" update="blog_date_search_client" listener="#{managedFactureVenteV2.addParamDates()}"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_search_client">
                        <p:calendar value="#{managedFactureVenteV2.dateDebut_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedFactureVenteV2.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedFactureVenteV2.addParamDates}"   />
                        </p:calendar>
                        <p:spacer style="width: 5px;background: black"/>
                        <p:calendar value="#{managedFactureVenteV2.dateFin_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedFactureVenteV2.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedFactureVenteV2.addParamDates}"  />
                        </p:calendar>
                    </h:panelGroup>

                    <h:outputText value="Ids"/>
                    <h:inputText value="#{managedFactureVenteV2.idsSearch}" style="width: 100%" title="#{lab.LDB_PA_text1}" rendered="#{!managedFactureVenteV2.listing}">
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamIds()}" update=":main_facture_vente:data_facture_vente"/>
                    </h:inputText>
                    <h:inputText value="#{managedFactureVenteV2.idsContenu}" style="width: 100%" title="#{lab.LDB_PA_text1}" rendered="#{managedFactureVenteV2.listing}">
                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.addParamIdsContenus()}"/>
                    </h:inputText>
                    <p:commandButton value="#{lab.LC_PFV_facture_non_comptabiliser}" actionListener="#{managedFactureVenteV2.addParamNonComptabiliser()}" />
                </h:panelGrid>                
                <f:facet name="footer">     
                    <h:panelGroup>
                        <h:panelGroup style="float:left">
                            <p:contextMenu for="btn_option_more_facture_vente" event="left click" style="font-size: 0.8em;width: 230px">
                                <p:menuitem value="#{lab.LC_PFV_listing_factures}" icon="ui-icon-print" title="#{lab.LC_PFV_telecharger_listing_factures_vente}"
                                            actionListener="#{managedFactureVenteV2.printListing()}" ajax="false"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_more_facture_vente" type="button"/>
                        </h:panelGroup>
                        <p:commandLink actionListener="#{managedFactureVenteV2.maintenanceComptable()}" style="border: 2px solid black; border-radius: 5px;padding: 2px;float: right">
                            <span>#{lab.LC_PFV_maintenance_comptable}</span>
                        </p:commandLink> 
                        <p:commandLink onclick="dlgCleanEntete.show()" global="false" style="border: 2px solid black; border-radius: 5px;padding: 2px;float: right" 
                                       title="#{lab.LC_PFV_nettoyage_entete_journal_vente}" rendered="#{accesRessource.fv_clean_header}">
                            <h:graphicImage library="img" name="clean.png" width="15" height="15"/>  
                        </p:commandLink>
                    </h:panelGroup>
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de bon de commande
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PRA_liste_facture}" widgetVar="dlgListBonCommande" closeOnEscape="true" width="80%" height="450" modal="true">  
                <p:watermark for="txt_search_blc_fv" value="#{lab.LC_PFV_numero_commande}" />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_blc_fv" value="#{managedBonVente.numSearch_}">
                        <p:ajax event="valueChange" listener="#{managedBonVente.searchByNum()}" update="data_bon_commande_fv"/>
                    </h:inputText>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedBonVente.init(false)}" global="false" update="data_bon_commande_fv" icon="ui-icon-circle-triangle-w" disabled="#{managedBonVente.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedBonVente.paginator.currentPage}/#{managedBonVente.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedBonVente.init(true)}" global="false" update="data_bon_commande_fv" icon="ui-icon-circle-triangle-e" disabled="#{managedBonVente.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedBonVente.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedBonVente.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedBonVente.paginations}"/>
                            <p:ajax event="valueChange"  update="data_bon_commande_fv"/>
                        </p:selectOneMenu>
                    </p:outputPanel>  
                </h:panelGrid>                                
                <p:dataTable id="data_bon_commande_fv" value="#{managedBonVente.documents}" var="bon" rowKey="#{bon.id}"
                             selectionMode="single" rowIndexVar="bonIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewBon}" oncomplete="dlgListBonCommande.hide()"/>
                    <p:column headerText="N°" style="width: 5%" styleClass="statut_#{bon.statut}">
                        <span>#{bonIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}">
                        <span>#{bon.numDoc}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_date} " style="text-align: center" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.enteteDoc.dateEntete}" converter="DATE"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_client}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.client.tiers.nom_prenom}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_vendeur}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.enteteDoc.creneau.users.nomUsers}"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFV_point}" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.enteteDoc.creneau.creneauPoint.point.libelle}"/>
                    </p:column>
                </p:dataTable> 
            </p:dialog>
        </h:form>       

        <h:form prependId="false" id="main_update_header">
            <p:dialog header="#{lab.LC_PFV_date_entete}" widgetVar="dlgUpdateHeader" modal="true" width="20%"  closeOnEscape="true" resizable="false"
                      dynamic="true"> 
                <h:panelGrid id="date_update_header" columns="1" style="width: 100%" styleClass="yvs_nostyle"> 
                    <p:selectBooleanCheckbox itemLabel="#{lab.LC_PFV_actualiser_reference}" value="#{managedFactureVenteV2.changeNumeroWhenChangeDate}"/>
                    <h:panelGroup>
                        <p:calendar value="#{managedFactureVenteV2.dateEntete}" pattern="dd-MM-yyyy" size="8" navigator="true"/>
                        <p:commandButton value="#{lab.L_modifier}" actionListener="#{managedFactureVenteV2.updateEntete()}" icon="ui-icon-disk" 
                                         oncomplete="dlgUpdateHeader.hide()" style="float: right;margin-top: -5px"/> 
                    </h:panelGroup>
                </h:panelGrid>  
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de client
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_client_fv">
            <p:dialog header="#{lab.LC_PC_liste_template}" widgetVar="dlgListTemplate" modal="true" width="85%" height="450" closeOnEscape="true">
                <p:watermark for="txt_search_template_tiers_client_fv" value="#{lab.LC_PFV_libelle_template}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_template_tiers_client_fv" value="#{managedTiersTemplate.nameSearch}">
                        <p:ajax event="valueChange" listener="#{managedTiersTemplate.addParamName()}" update="data_template_tiers_client_fv"/>
                    </h:inputText>   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedTiersTemplate.init(false)}" global="false" update="data_template_tiers_client_fv" icon="ui-icon-circle-triangle-w" disabled="#{managedTiersTemplate.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedTiersTemplate.paginator.currentPage}/#{managedTiersTemplate.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedTiersTemplate.init(true)}" global="false" update="data_template_tiers_client_fv" icon="ui-icon-circle-triangle-e" disabled="#{managedTiersTemplate.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedTiersTemplate.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedTiersTemplate.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedTiersTemplate.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_template_tiers_client_fv"/>
                        </p:selectOneMenu>
                    </p:outputPanel>  
                </h:panelGrid>
                <p:dataTable value="#{managedTiersTemplate.templates}" var="clt" rowKey="#{clt.id}" id="data_template_tiers_client_fv" scrollable="true"
                             rowIndexVar="cltIdx" selectionMode="single" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedClient.loadOnViewTemplate}"  oncomplete="dlgListTemplate.hide()" update=":main_client_fv:infos_tiers_facture_vente"/>
                    <p:column style="width: 0.25%">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_libelle}" style="width: 1%">
                        <span>#{clt.libelle}</span>
                    </p:column>
                    <p:column headerText="#{lab.LDB_PP_compte}" style="width: 1%;text-align: center">
                        <span>#{clt.compteCollectif.numCompte}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_pays}" style="width: 1.5%">
                        <span>#{clt.pays.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_ville}" style="width: 1.75%">
                        <span>#{clt.ville.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_secteur}" style="width: 2%">
                        <span>#{clt.secteur.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.LDB_PMR_apercu}" style="width: 1.75%">
                        <span>#{clt.apercu}</span>
                    </p:column>
                </p:dataTable> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PCV_creation_client}" widgetVar="dlgAddClient" modal="true" width="40%" closeOnEscape="true"> 
                <h:panelGrid id="infos_tiers_facture_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%" cellpadding="0" cellspacing="0">
                            <h:panelGrid columns="2" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                <span>#{lab.LC_PCV_societe} </span>  
                                <h:selectBooleanCheckbox value="#{client.tiers.societe}" tabindex="1">
                                    <p:ajax event="valueChange" global="false" update="infos_tiers_facture_vente"/>
                                </h:selectBooleanCheckbox>                                                    
                            </h:panelGrid> 
                            <h:panelGroup id="txt_code_client_facture_vente" style="float: right">
                                <h:inputText  value="#{client.codeClient}" tabindex="3" style="background: #009999;font-weight: bold" title="#{lab.LC_PCV_code_client}">
                                    <p:ajax event="valueChange" global="false"/>
                                </h:inputText>
                                <p:commandLink title="#{lab.LC_PCV_template}" actionListener="#{managedTiersTemplate.loadTemplate(true, true)}" oncomplete="dlgListTemplate.show()" global="false" style="float: right"
                                               update=":main_client_fv:data_template_tiers_client_fv">
                                    <p:graphicImage library="icones" name="ico_facture2.png" width="20" height="22" style="border: 2px solid #666; border-radius: 5px;"/>
                                </p:commandLink>  
                            </h:panelGroup>                            
                        </h:panelGrid>
                    </f:facet>
                    <h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_nom}" rendered="#{!client.tiers.societe}"/>
                        <h:outputText value="#{lab.L_designation}" rendered="#{client.tiers.societe}"/>    
                        <p:commandLink title="#{managedClient.generation?'Déactiver':'Activer'} #{lab.LC_PCV_generation_code_tiers}" actionListener="#{managedClient.activeGenerationCode()}" 
                                       global="false" style="float: right;margin-top: 4px" update="@this">
                            <p:graphicImage library="img" name="#{managedClient.generation?'connecte.png':'deconnecte.png'}" width="12" height="12"/>
                        </p:commandLink>                                                     
                    </h:panelGroup>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{client.tiers.civilite}" rendered="#{!client.tiers.societe}" tabindex="5">
                            <f:selectItem itemLabel="Mme" itemValue="Mme"/>
                            <f:selectItem itemLabel="M." itemValue="M."/>
                        </h:selectOneMenu>
                        <p:spacer width="2"/>
                        <h:inputText value="#{client.nom}" tabindex="7" style="width: 75%">
                            <p:ajax event="valueChange" global="false" listener="#{managedClient.changeName()}" update="txt_code_client_facture_vente"/>
                        </h:inputText>
                    </h:panelGroup>
                    <h:outputText value="#{lab.LC_PCV_prenom}" rendered="#{!client.tiers.societe}"/>  
                    <h:inputText value="#{client.prenom}" rendered="#{!client.tiers.societe}" tabindex="9" style="width: 90%">
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.changeName()}" update="txt_code_client_facture_vente"/>
                    </h:inputText>
                    <span>#{lab.LC_PCV_categorie_comptable}</span>
                    <h:selectOneMenu value="#{client.categorieComptable.id}" tabindex="11" style="width: 90%">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{managedCatCompt.categoriesVente}" var="catC" itemLabel="#{catC.designation}" itemValue="#{catC.id}" />                                
                    </h:selectOneMenu> 
                    <span>#{lab.LC_PCV_adresse} </span>
                    <h:inputText value="#{client.tiers.adresse}" tabindex="13" style="width: 90%"/>
                    <span>#{lab.LC_PCV_email} </span>
                    <h:inputText value="#{client.tiers.email}" converter="EMAIL" tabindex="15" style="width: 90%"/>
                    <span>#{lab.LC_PCV_code_postal} </span>
                    <h:inputText value="#{client.tiers.codePostal}" tabindex="17" style="width: 90%"/>
                    <span>#{lab.LC_PCV_telephones} </span>
                    <h:inputText value="#{client.tiers.telephone}"  style="width: 90%" tabindex="19" title="#{lab.LC_PCV_separer_numeros} (/)"/>
                    <span>#{lab.L_pays} </span>
                    <h:selectOneMenu value="#{client.tiers.pays.id}" id="pays_client_facture_vente"  style="width: 90%" tabindex="21">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{Mdico.pays}" var="pys" itemLabel="#{pys.libele}" itemValue="#{pys.id}" />                                
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.choosePays()}" update="ville_client_facture_vente secteur_client_facture_vente"/>
                    </h:selectOneMenu>
                    <span>#{lab.L_ville} </span>
                    <h:selectOneMenu value="#{client.tiers.ville.id}" id="ville_client_facture_vente"  style="width: 90%" tabindex="23">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{Mdico.villes}" var="dic" itemLabel="#{dic.libele}" itemValue="#{dic.id}" />                          
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.chooseVille()}" update="secteur_client_facture_vente"/>
                    </h:selectOneMenu> 
                    <span>#{lab.L_secteur} </span>
                    <h:selectOneMenu value="#{client.tiers.secteur.id}" id="secteur_client_facture_vente"  style="width: 90%" tabindex="25">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{Mdico.secteurs}" var="sec"  itemLabel="#{sec.libele}" itemValue="#{sec.id}" />                                  
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.chooseSecteur()}"/>
                    </h:selectOneMenu> 
                    <f:facet name="footer">
                        <span>#{lab.L_representant} : </span>
                        <h:outputText style="font-weight: bold" value="#{client.representant.nomUsers}"/>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddClient.hide()"
                                 actionListener="#{managedClient.saveNewAll()}"  tabindex="27"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    &copy;
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des clients
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PC_liste_clients}" widgetVar="dlgListClients" closeOnEscape="true" width="50%" height="450" modal="true" dynamic="true">   
                <p:watermark for="txt_search_client_facture_vente" value="#{lab.LC_PC_code_client}" />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_client_facture_vente" value="#{managedClient.numSearch_}" style="float: left;text-align: center;margin-left: -10px">
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.searchByNum()}" update="data_client_facture_vente"/>
                    </h:inputText>   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedClient.init(false)}" global="false" update="data_client_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedClient.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedClient.paginator.currentPage}/#{managedClient.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedClient.init(true)}" global="false" update="data_client_facture_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedClient.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedClient.max}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedClient.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedClient.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_client_facture_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>                               
                <p:dataTable id="data_client_facture_vente"  value="#{managedClient.clients}" var="clt_" rowKey="#{clt_.id}"
                             selectionMode="single" rowIndexVar="cltIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewClient}" oncomplete="dlgListClients.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{clt_.codeClient}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PC_nom}">
                        <span>#{clt_.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PC_zone}">
                        <span>#{clt_.tiers.region}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dgvTraitementLot" closeOnEscape="true" header="Traitement par lot" width="35%"
                      height="100">
                <h:panelGrid id="main-traitement-lot" columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.lotFV}"> 
                        <p:ajax event="valueChange" update="traitement-lot-fv"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-fv">
                        <span style="font-weight: bold">Facture </span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedFactureVenteV2.statutLotFV}" disabled="#{!managedFactureVenteV2.lotFV}">
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.lotBL}"> 
                        <p:ajax event="valueChange" update="traitement-lot-bl"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-bl">
                        <span style="font-weight: bold">Bon de livraison </span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedFactureVenteV2.statutLotBL}" disabled="#{!managedFactureVenteV2.lotBL}">
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                                <f:selectItem itemLabel="#{lab.L_annuler.toUpperCase()}" itemValue="#{constantes.ETAT_ANNULE}"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.lotPiece}"> 
                        <p:ajax event="valueChange" update="traitement-lot-piece"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-piece">
                        <span style="font-weight: bold">Pièce de règlement</span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedFactureVenteV2.statutLotPiece}" disabled="#{!managedFactureVenteV2.lotPiece}">
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.ETAT_REGLE}"/>
                                <f:selectItem itemLabel="#{lab.L_annuler.toUpperCase()}" itemValue="#{constantes.ETAT_ANNULE}"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                </h:panelGrid>
                <f:facet name="footer">
                    <h:panelGroup style="float: right">
                        <p:commandButton value="#{lab.LC_PFV_lancer}" actionListener="#{managedFactureVenteV2.traitementLot()}" oncomplete="dgvTraitementLot.hide()"/>
                        <p:commandButton type="button"  value="#{lab.L_annuler}" onclick="dgvTraitementLot.hide()"/>
                    </h:panelGroup>
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="main-motif_etape_vente">
            <p:dialog hideEffect="explode" widgetVar="dglMotifCancelEtape" closeOnEscape="true" header="#{lab.LC_PFV_motif_annulation_etape}" width="35%">
                <h:panelGrid id="value_motif_etape_vente" columns="1" cellpadding="0" cellspacing="0" style="width: 100%">
                    <h:inputTextarea value="#{managedFactureVenteV2.motifEtape}" style="width: 100%" rows="4"/>                
                    <f:facet name="footer">
                        <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedFactureVenteV2.annulEtapeFacture()}" oncomplete="dglMotifCancelEtape.hide();" style="float: right" rendered="#{!managedFactureVenteV2.lastEtape}"
                                         update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                    </f:facet>
                </h:panelGrid>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dglEtatComptabilised" closeOnEscape="true" resizable="false" width="25%">
                <p:commandButton value="#{lab.LC_PFV_toutes_factures}" actionListener="#{managedFactureVenteV2.verifyComptabilised(null)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LC_PFV_factures_comptabiliser}" actionListener="#{managedFactureVenteV2.verifyComptabilised(true)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LC_PFV_factures_non_comptabiliser}" actionListener="#{managedFactureVenteV2.verifyComptabilised(false)}" style="width: 99%"/>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmdeleteTaxe" closeOnEscape="true"
                             message="#{lab.LC_PFV_text17}" header="#{lab.L_confirmation}">
                <p:commandButton icon="ui-icon-circle-check" value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.confirmDeleteTaxe()}" 
                                 oncomplete="dlgConfirmdeleteTaxe.hide()" />
                <p:commandButton icon="ui-icon-circle-close" type="button" value="#{lab.L_non}" onclick="dlgConfirmdeleteTaxe.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmChangeCategorie" closeOnEscape="true"
                             message="#{lab.LC_PFV_text43}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.updatePrixArticle()}" oncomplete="dlgConfirmChangeCategorie.hide()"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.noChangeCategorie()}" oncomplete="dlgConfirmChangeCategorie.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmContinueWithOutStock" closeOnEscape="true"
                             message="#{lab.LC_PFV_text42}" header="#{lab.L_confirmation}">
                <div >
                    <span>#{lab.LC_PFV_memoriser_choix_session}</span>
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.rememberChoixWithOutStock}" />
                </div>
                <p:commandButton value="#{lab.L_oui}" global="false" actionListener="#{managedFactureVenteV2.continueWithOutStock(true)}" oncomplete="dlgConfirmContinueWithOutStock.hide()"/>
                <p:commandButton value="#{lab.L_non}" global="false" actionListener="#{managedFactureVenteV2.continueWithOutStock(false)}" oncomplete="dlgConfirmContinueWithOutStock.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCout" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanCout()}" oncomplete="dlgConfirmDeleteCout.hide();collapseForm('cout_facture_vente')"
                                 update=":main_facture_vente:tabview_facture_vente:blog_form_cout_facture_vente :main_facture_vente:chp_fv_net_a_payer"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCout.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCout_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanCout_()}" oncomplete="dlgConfirmDeleteCout_.hide();collapseForm('cout_facture_vente')" 
                                 update=":main_facture_vente:tabview_facture_vente:blog_form_cout_facture_vente :main_facture_vente:chp_fv_net_a_payer"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCout_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteCommercial_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanCommercial_()}" oncomplete="dlgConfirmDeleteCommercial_.hide()" 
                                 update=":main_facture_vente:tabview_facture_vente:data_commercial_vente :main_facture_vente:chp_fv_net_a_payer"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteCommercial_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteRemise" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanRemise()}" oncomplete="dlgConfirmDeleteRemise.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteRemise.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteRemise_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanRemise_()}" oncomplete="dlgConfirmDeleteRemise_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteRemise_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteReglement" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanReglement()}" oncomplete="dlgConfirmDeleteReglement.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteReglement.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteReglement_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanReglement_()}" oncomplete="dlgConfirmDeleteReglement_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteReglement_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteMensualite" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanReglement()}" oncomplete="dlgConfirmDeleteMensualite.hide();collapseForm('mensualite_facture_vente')"
                                 update=":main_facture_vente:tabview_facture_vente:form_mensualite_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteMensualite.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteMensualite_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanReglement_()}" oncomplete="dlgConfirmDeleteMensualite_.hide();collapseForm('mensualite_facture_vente')"
                                 update=":main_facture_vente:tabview_facture_vente:form_mensualite_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteMensualite_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAddClient" closeOnEscape="true"
                             message="#{lab.LC_PFV_text41}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.saveDefautClient()}" oncomplete="dlgConfirmAddClient.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAddClient.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanContenu()}" oncomplete="dlgConfirmDeleteArticle.hide();collapseForm('contenu_facture_vente')"
                                 update=":main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticles" closeOnEscape="true"
                             message="#{lab.LC_PLV_text9}" header="#{lab.L_confirmation}">
                <div >
                    <span>#{lab.LC_PFV_memoriser_choix_session}</span>
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.memoriserDeleteContenu}" />
                </div>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanArticles(true)}" oncomplete="dlgConfirmDeleteArticles.hide();collapseForm('contenu_facture_vente')"
                                 update=":main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticles.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanContenu_()}" oncomplete="dlgConfirmDeleteArticle_.hide();collapseForm('contenu_facture_vente')"
                                 update=":main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog id="dlg_confirm_rabais_fv" hideEffect="explode" widgetVar="dlgConfirmAlertRabais" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="Vous essayez de vendre l'article '#{managedFactureVenteV2.contenu.article.designation}' au prix '#{managedFactureVenteV2.contenu.prix}' inferieur au prix minimal '#{managedFactureVenteV2.contenu.prixMin}'. Appliquer un rabais?">
                <p:commandButton type="button" value="#{lab.L_oui}" onclick="dlgConfirmAlertRabais.hide();
                        dlgAddCommentaire.show()"/>
                <p:commandButton value="#{lab.L_non}" oncomplete="dlgConfirmAlertRabais.hide()" actionListener="#{managedFactureVenteV2.saveNewContenu(true)}"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBean()}" oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">            
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteLie" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBeanLie()}" oncomplete="dlgConfirmDeleteLie.hide()"
                                 update=":main_facture_vente:tabview_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteLie.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
        </h:form >
        <h:form prependId="false">
            <p:confirmDialog id="id_confirm_close_fv" hideEffect="explode" widgetVar="dlgConfirmClose" closeOnEscape="true"
                             message="Êtes-vous sûr de vouloir #{managedFactureVenteV2.selectDoc.cloturer?'déverrouiller':'verrouiller'}?" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cloturer()}" oncomplete="dlgConfirmClose.hide()" update=":main_facture_vente:data_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmClose.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_details_annulation}" widgetVar="dlgAnnuleCommande" modal="true" closeOnEscape="true"> 
                <h:panelGrid columns="3" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_date}"/>
                    <h:outputText value="#{lab.LCF_PC_caisse}"/>
                    <h:outputText value=""/>
                    <p:calendar value="#{managedBonVente.dateAnnule}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                    <h:selectOneMenu value="#{managedBonVente.caisseAnnule.id}" style="min-width: 160px">
                        <f:selectItem itemLabel="" itemValue="0" />
                        <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}" itemValue="#{icaiss.id}" />
                        <p:ajax event="valueChange" listener="#{managedBonVente.chooseCaisseAnnule()}"/>
                    </h:selectOneMenu>  
                    <p:commandButton icon="ui-icon-disk" value="#{lab.L_enregistrer}" actionListener="#{managedBonVente.refuserOrder()}" oncomplete="dlgAnnuleCommande.hide()"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dlgConfirmAnnulerCmde" closeOnEscape="true" header="#{lab.L_confirmation}" resizable="false">
                <span>Selectionner les documents à annuler?</span>
                <h:panelGrid id="blog-annule_bcv_fv" columns="3" styleClass="yvs_nostyle">
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleCmde}" label="#{lab.LC_PFV_annuler_commande}" rendered="#{managedBonVente.visibleCmde}"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_commande}" rendered="#{managedBonVente.visibleCmde}"/>
                    <p:outputLabel rendered="#{managedBonVente.visibleCmde}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleFact}" label="#{lab.LC_PFV_annuler_facture}" rendered="#{managedBonVente.visibleFact}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_facture}" rendered="#{managedBonVente.visibleFact}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteFact}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleFact}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleLivr}" label="#{lab.LC_PFV_annuler_livraison}" rendered="#{managedBonVente.visibleLivr}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_livraison}" rendered="#{managedBonVente.visibleLivr}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteLivr}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleLivr}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleRegl}" label="#{lab.LC_PFV_annuler_reglement}" rendered="#{managedBonVente.visibleRegl}"/>
                    <h:outputText value="#{lab.LC_PFV_annuler_reglement}" rendered="#{managedBonVente.visibleRegl}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteRegl}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleRegl}"/>
                </h:panelGrid>
                <f:facet name="footer">
                    <div align="right">
                        <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.annulerOrderForce()}" oncomplete="dlgConfirmAnnulerCmde.hide();collapseForm('commande_vente')"/>
                        <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAnnulerCmde.hide()"/>                        
                    </div>
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuler" closeOnEscape="true"
                             message="#{lab.LC_PFV_text40}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.annulerOrder_()}" oncomplete="dlgConfirmAnnuler.hide();collapseForm('facture_vente')"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.annulerOrder(true)}"  oncomplete="dlgConfirmAnnuler.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmCancelForcer" closeOnEscape="true"
                             message="#{lab.LC_PFV_text39}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelOrder(true, false)}" oncomplete="dlgConfirmCancelForcer.hide();collapseForm('facture_vente')"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmCancelForcer.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmCancel" closeOnEscape="true"
                             message="#{lab.LC_PFV_text38}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelOrder(false, false)}" oncomplete="dlgConfirmCancel.hide();collapseForm('facture_vente')"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.cancelOrder(false, true)}" oncomplete="dlgConfirmCancel.hide();collapseForm('facture_vente')"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmRefuserForcer" closeOnEscape="true"
                             message="#{lab.LC_PFV_text37}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.refuserOrder(true, false)}" oncomplete="dlgConfirmRefuserForcer.hide();collapseForm('facture_vente')"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmRefuserForcer.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmRefuser" closeOnEscape="true"
                             message="#{lab.LC_PFV_text36}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.refuserOrder(false, false)}" oncomplete="dlgConfirmRefuser.hide();collapseForm('facture_vente')"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.refuserOrder(false, true)}" oncomplete="dlgConfirmRefuser.hide();collapseForm('facture_vente')"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmValide" closeOnEscape="true"
                             message="#{lab.LC_PFV_text35}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.validerFacture(true)}" oncomplete="dlgConfirmValide.hide();collapseForm('facture_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmValide.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmSoumis" closeOnEscape="true"
                             message="#{lab.LC_PFV_text34}" 
                             header="#{lab.L_confirmation}">
                <div align="center">
                    <div>
                        <p:calendar id="date-livraison_fv" value="#{managedFactureVenteV2.dateLivraison}" size="8" pattern="dd-MM-yyyy" navigator="true">
                            <p:ajax event="dateSelect" listener="#{managedFactureVenteV2.onChangeDateLivraison()}"/>
                        </p:calendar>
                        <h:selectOneMenu value="#{managedFactureVenteV2.statutLivraison}">
                            <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            <p:ajax event="valueChange" global="false"/>
                        </h:selectOneMenu>                    
                    </div>
                    <div style="display: block">
                        <p:outputPanel id="blog-contenu_fv_require_lot">
                            <p:outputPanel  rendered="#{!managedFactureVenteV2.contenusRequireLot.isEmpty()}">
                                <div style="max-height: 400px">
                                    <div style="max-height: 350px;overflow-y: auto">
                                        <c:forEach items="#{managedFactureVenteV2.contenusRequireLot}" var="aRL" id="data-contenu_fv_require_lot">
                                            <p:dataTable value="#{aRL.lots}" var="lot" rowKey="#{lot.id}" style="width: 1000px;clear:both" editable="true">
                                                <p:ajax event="rowEdit" listener="#{managedFactureVenteV2.onRowLotEdit}"/>
                                                <f:facet name="header">
                                                    <div align="left">
                                                        <h:outputText value="#{aRL.quantite}" converter="#{managedFactureVenteV2.converterStock}" title="#{lab.LC_PFA_numero_serie}: #{aRL.numSerie}"/>
                                                        <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                        de
                                                        #{aRL.article.designation}
                                                        <div style="float:right">
                                                            <h:outputText value="#{aRL.article.quantite}" converter="#{managedFactureVenteV2.converterStock}"/>
                                                            <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                            <h:outputText value="#{lab.LC_PFV_en_stock}"/>
                                                        </div>
                                                    </div>
                                                </f:facet>
                                                <p:column headerText="Numero de lot" style="text-align: center">
                                                    #{lot.numero}
                                                </p:column>
                                                <p:column headerText="Date fabrication" style="text-align: center">
                                                    <h:outputText value="#{lot.dateFabrication}" converter="DATE"/>
                                                </p:column>
                                                <p:column headerText="Date expiration" style="text-align: center">
                                                    <h:outputText value="#{lot.dateExpiration}" converter="DATE"/>
                                                </p:column>
                                                <p:column headerText="Stock" style="text-align: right">
                                                    <h:outputText value="#{lot.stock}" converter="#{managedFactureAchat.converterStock}"/>
                                                    <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                </p:column>
                                                <p:column headerText="Quantitée" style="text-align: right">
                                                    <p:cellEditor>
                                                        <f:facet name="output">
                                                            <h:outputText value="#{lot.quantitee}"/>
                                                            <span title="#{aRL.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{aRL.conditionnement.unite.reference}</span>
                                                        </f:facet>
                                                        <f:facet name="input">
                                                            <h:inputText value="#{lot.quantitee}" style="width:100%;text-align: right">
                                                                <p:ajax event="valueChange" listener="#{managedFactureVenteV2.onBlurQuantiteeLot(aRL, lot)}"/>
                                                            </h:inputText>
                                                        </f:facet>
                                                    </p:cellEditor>
                                                </p:column>
                                                <p:column style="text-align: center;width: 5px">
                                                    <p:rowEditor />
                                                </p:column> 
                                            </p:dataTable>                                
                                        </c:forEach>
                                    </div>
                                </div>
                            </p:outputPanel>
                        </p:outputPanel>
                    </div>
                </div>
                <div align="center">
                    <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.transmisOrder()}" 
                                     oncomplete="dlgConfirmSoumis.hide()" update=":main_facture_vente:tabview_facture_vente:"/>
                    <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmSoumis.hide()"/>
                </div>                
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCancelV" closeOnEscape="true"
                             message="#{lab.LC_PFV_text33}" header="#{lab.L_confirmation}">
                <p:outputPanel rendered="#{accesRessource.encais_piece_espece}" >
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.cancelReglement}" itemLabel="Annuler le reglement ?"/><br/>
                </p:outputPanel>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelEtapeFacture(false, false)}" oncomplete="dlgCancelV.hide();" 
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCancelV.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgSuspendFact" closeOnEscape="true"
                             message="#{lab.LC_PFV_text32}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelEtapeFacture(false, true, false)}" oncomplete="dlgSuspendFact.hide();"
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgSuspendFact.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgSaveEntete" closeOnEscape="true"
                             message="#{lab.LC_PFV_text31}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.saveNewEntete()}" oncomplete="dlgSaveEntete.hide();collapseForm('facture_vente');collapseForm('article_facture_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgSaveEntete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgResetEntete" closeOnEscape="true"
                             message="#{lab.LC_PFV_text30}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.resetFicheEntete()}" oncomplete="dlgResetEntete.hide();collapseForm('facture_vente');collapseForm('article_facture_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgResetEntete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanEntete" closeOnEscape="true"
                             message="#{lab.LC_PFV_text29}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cleanEnteteVente()}" oncomplete="dlgCleanEntete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanEntete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanVente" closeOnEscape="true"
                             message="#{lab.LC_PFV_text28}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cleanVente()}" oncomplete="dlgCleanVente.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanVente.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanVenteDate" closeOnEscape="true"
                             message="#{lab.LC_PFV_text28}" header="#{lab.L_confirmation}">
                <p:calendar value="#{managedFactureVenteV2.dateClean}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cleanVenteByDate()}" oncomplete="dlgCleanVente.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanVenteDate.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmPaye" closeOnEscape="true"
                             message="#{lab.LC_PFV_text27}" header="#{lab.L_confirmation}">
                <div >
                    <span>#{lab.LC_PFV_memoriser_choix_session}</span>
                    <p:selectBooleanCheckbox value="#{managedReglementVente.needConfirmation}" />
                </div>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedReglementVente.reglerPieceTresorerie(true)}" oncomplete="dlgConfirmPaye.hide();" 
                                 update=":main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmPaye.hide()"/>                
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmResetFiche" closeOnEscape="true"
                             message="#{lab.LC_PFV_vider_champs}" header="#{lab.L_confirmation}">
                <div >
                    <span>#{lab.LC_PFV_memoriser_choix_session}</span>
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.needConfirmation}" />
                </div>
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.resetFiche(true)}" update=":main_facture_vente:blog_form_facture_vente"
                                 oncomplete="dlgConfirmResetFiche.hide();collapseForm('facture_vente');collapseForm('contenu_facture_vente')"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedFactureVenteV2.resetFiche(false)}" oncomplete="dlgConfirmResetFiche.hide()"/>            
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmUpdatePrix" closeOnEscape="true"
                             message="Vous avez changer le client ou la catégorie comptable" header="#{lab.L_confirmation}">
                <div >
                    <span>Appliquer le changement des prix du contenu?</span>
                    <p:selectBooleanCheckbox value="#{managedFactureVenteV2.majPrixContenu}" />
                </div>
                <p:commandButton value="#{lab.L_enregistrer}" actionListener="#{managedFactureVenteV2.saveNew(true)}" icon="ui-icon-disk" oncomplete="dlgConfirmUpdatePrix.hide()"/>          
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmGenereBL" closeOnEscape="true"
                             message="#{lab.LC_PFV_text26}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.genereLivraison()}" oncomplete="dlgConfirmGenereBL.hide();" />
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmGenereBL.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuleDoc" closeOnEscape="true"
                             message="#{lab.LC_PFV_text25}" header="#{lab.L_confirmation}">
                <p:commandButton type="button" value="#{lab.L_oui}" onclick="dglMotifCancelEtape.show();
                        dlgConfirmAnnuleDoc.hide()" />
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnuleDoc.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnulerDoc" closeOnEscape="true"
                             message="#{lab.LC_PFV_text25}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.cancelEtapeFacture(false, false, false)}" oncomplete="dlgConfirmAnnulerDoc.hide()" 
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnulerDoc.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnulePiece" closeOnEscape="true"
                             message="#{lab.LC_PFV_text24}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedFactureVenteV2.openConfirmPaiement()}" oncomplete="dlgConfirmAnnulePiece.hide()" 
                                 update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnulePiece.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabiliseManyDoc" message="#{lab.LC_PFV_text23}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.comptabiliseFacture()}"
                                 update=":main_facture_vente:btn_comptabilised_fv :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente" oncomplete="dlgComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabiliseManyDoc.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabiliseDoc" message="#{lab.LC_PFV_text22}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.comptabiliserVente(managedFactureVenteV2.selectDoc)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente" oncomplete="dlgComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabiliseDoc.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form>
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabiliseManyDoc" message="#{lab.LC_PFV_text21}"
                              >
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.uncomptabiliseFacture()}"
                                 update=":main_facture_vente:btn_comptabilised_fv :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente" 
                                 oncomplete="dlgUnComptabiliseManyDoc.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabiliseManyDoc.hide()" />                
            </p:confirmDialog>
        </h:form>
        <h:form>
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabiliseDoc" message="#{lab.LC_PFV_text20}"
                              >
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.unComptabiliserVente(managedFactureVenteV2.selectDoc, true)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente" oncomplete="dlgUnComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabiliseDoc.hide()" />                
            </p:confirmDialog>
        </h:form>
        <h:form>
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabilisePiece" message="#{lab.LC_PFV_text19}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.comptabiliserCaisseVente(managedFactureVenteV2.selectReglement, true)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente" oncomplete="dlgComptabilisePiece.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabilisePiece.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form>
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabilisePiece" message="#{lab.LC_PFV_text18}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.unComptabiliserCaisseVente(managedFactureVenteV2.selectReglement, true)}"
                                 update=":main_facture_vente:btn_comptabilised_fv :main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente" oncomplete="dlgUnComptabilisePiece.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabilisePiece.hide()" />
            </p:confirmDialog>
        </h:form>           
        <h:form prependId="false">
            <p:confirmDialog header="#{lab.L_confirmation}" width="40%" widgetVar="dlgValidDocAll" message="#{lab.LCF_POD_text8}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.validerOrderAll()}" oncomplete="dlgValidDocAll.hide()"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgValidDocAll.hide()" />
            </p:confirmDialog>
        </h:form>
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_facture_vente">    
            <div class="part_fix">                
                <div style="float: left;width: 20%">
                    <p:splitButton value="#{lab.L_enregistrer}" id="save_facture_vente" actionListener="#{managedFactureVenteV2.saveNew()}" icon="ui-icon-disk">
                        <p:menuitem value="#{lab.L_nouveau}" id="cancel_facture_vente" actionListener="#{managedFactureVenteV2.resetFiche()}" update="blog_form_facture_vente" oncomplete="collapseForm('facture_vente');collapseForm('contenu_facture_vente')"
                                    icon="ui-icon-document"/>
                        <p:separator />
                        <p:menuitem icon="ui-icon-print" value="#{lab.L_telecharger}" global="false" actionListener="#{managedFactureVenteV2.print(managedFactureVenteV2.selectDoc)}" ajax="false" title="#{lab.LC_PFV_telecharger_facture}"/>                   
                        <p:menuitem icon="ui-icon-print" value="#{lab.L_telecharger_sans_entete}" global="false" actionListener="#{managedFactureVenteV2.print(managedFactureVenteV2.selectDoc, false)}" ajax="false" title="#{lab.LC_PFV_telecharger_facture}"/>                   
                        <p:menuitem icon="ui-icon-print" value="#{lab.LC_PFV_telecharger_ticket}" actionListener="#{managedFactureVenteV2.printTicket(managedFactureVenteV2.selectDoc)}"
                                    title="#{lab.LC_PFV_telecharger_ticket_vente}" oncomplete="openPrintDialog()"/> 
                        <p:menuitem icon="ui-icon-print" value="Télécharger à partir d'un modèl" onclick="dlgPrintFactureVente.show()" global="false"/> 
                        <p:separator />
                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" onclick="dlgConfirmDelete_.show()"  global="false"/>
                    </p:splitButton>
                    <p:outputPanel id="btn_action-fv">
                        <p:splitButton value="Valider" id="delete_facture_vente" icon="ui-icon-check" onclick="dlgValidDocAll.show()"  global="false" style="font-size: 0.8em" rendered="#{managedFactureVenteV2.selections.size() gt 0}">
                            <p:menuitem value="#{lab.LC_PFV_generer_livraison}" icon="ui-icon-refresh" onclick="dlgConfirmGenereBL.show()" global="false"/>
                            <p:menuitem value="#{lab.LC_PFV_generer_fiche_entree}" icon="ui-icon-arrowstop-1-s" actionListener="#{managedFactureVenteV2.genererFicheEntree()}" rendered="#{accesRessource.fv_generer_entree}"/>
                            <p:menuitem value="#{lab.LC_PFA_reconstruire_reference}" icon="ui-icon-refresh" actionListener="#{managedFactureVenteV2.reBuildNumero()}" 
                                        update=":main_facture_vente:data_facture_vente"/>
                            <p:separator/>
                            <p:menuitem value="#{lab.LC_PA_equilibrer_statut}" icon="ui-icon-carat-2-e-w" actionListener="#{managedFactureVenteV2.equilibreAll()}"/>  
                            <p:menuitem value="#{lab.LC_PFV_modifier_date}" icon="ui-icon-pencil" global="false"  onclick="dlgUpdateHeader.show()" update=":main_update_header:date_update_header"/>
                            <p:menuitem value="#{lab.LC_PFV_definir_tiers}" icon="ui-icon-person" actionListener="#{managedFactureVenteV2.definedTiersVente()}" update=":main_facture_vente:data_facture_vente"/>
                            <p:separator />
                            <p:menuitem value="#{lab.LC_PFV_comptabiliser}" icon="ui-icon-arrowthickstop-1-e" global="false" onclick="dlgComptabiliseManyDoc.show()"/>
                            <p:menuitem value="#{lab.LC_PFV_annuler_comptabiliser}" icon="ui-icon-arrowthickstop-1-w" global="false" onclick="dlgUnComptabiliseManyDoc.show()" />
                            <p:separator/>
                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" onclick="dlgConfirmDelete.show()"/>
                        </p:splitButton>
                    </p:outputPanel>
                </div> 
                <div style="float: right">
                    <div style="float: right">
                        <p:commandLink title="#{lab.L_mode_creation}" oncomplete="collapseForm('facture_vente');
                                       return false" global="false" actionListener="#{managedFactureVenteV2.openDlgFactures(false)}">
                            <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </p:commandLink>               
                        <p:spacer />
                        <p:commandLink title="#{lab.L_mode_liste}" oncomplete="collapseList('facture_vente');
                                       return false" global="false" actionListener="#{managedFactureVenteV2.openDlgFactures(false)}">
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </p:commandLink>            
                        <p:spacer />        
                        <p:commandLink title="#{lab.LC_PRA_mode_consultation}" oncomplete="collapseGrid('facture_vente');
                                       return false" global="false" actionListener="#{managedFactureVenteV2.openDlgFactures(true)}">
                            <p:graphicImage library="icones" name="ico_arbre.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </p:commandLink>  
                    </div>
                    <h:panelGroup style="float: right">
                        <p:commandButton actionListener="#{managedFactureVenteV2.parcoursInAllResult(false)}" update="txt_parc_linear_facture_vente"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('facture_vente')"
                                         />
                        <h:inputText value="#{managedFactureVenteV2.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_facture_vente"/>
                        <p:outputPanel autoUpdate="true">                        
                            <p:outputLabel value="/#{managedFactureVenteV2.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedFactureVenteV2.parcoursInAllResult(true)}" update="txt_parc_linear_facture_vente"  icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('facture_vente')"
                                         />
                    </h:panelGroup> 
                </div>
                <div style="width: 50%;float: right;margin-right: 5%" title="#{lab.LC_PFV_entete_journal_vente}">
                    <h:panelGrid id="save_entete_facture_vente" columns="2" style="border: 2px solid black; border-radius: 5px;color: white;background: #CCC" cellpadding="0" cellspacing="0">
                        <h:panelGrid columns="#{managedAgence.agences.size() gt 1?'4':'3'}" style="width: 98%;margin: auto;font-size: 0.8em" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0"
                                     title="Journal de vente N° #{managedFactureVenteV2.docVente.enteteDoc.id}">
                            <h:outputText value="#{lab.L_date}"/>                            
                            <h:outputText value="#{lab.L_agence}" rendered="#{managedAgence.agences.size() gt 1}"/>                                
                            <h:outputText value="#{lab.L_point_vente}"/>                                
                            <h:outputText value="#{lab.LC_PFV_vendeur}"/>
                            <p:calendar value="#{managedFactureVenteV2.docVente.enteteDoc.dateEntete}" navigator="true" pattern="dd-MM-yyyy" size="10" 
                                        disabled="#{managedFactureVenteV2.docVente.enteteDoc.id gt 0}" style="text-align: center!important">
                                <p:ajax event="dateSelect" global="false" listener="#{managedFactureVenteV2.chooseDate()}" update="infos_document_facture_vente"/>
                            </p:calendar> 
                            <h:selectOneMenu value="#{managedPointVente.agenceFind}" disabled="#{managedFactureVenteV2.docVente.enteteDoc.id gt 0}"
                                             style="min-width: 120px"  rendered="#{managedAgence.agences.size() gt 1}">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedAgence.agences}" var="ag" 
                                               itemLabel="#{ag.designation}" itemValue="#{ag.id}" />  
                                <p:ajax event="valueChange" listener="#{managedPointVente.onChooseAgenceForAction()}" update="select_point2 @this"/>
                            </h:selectOneMenu> 
                            <h:selectOneMenu value="#{managedFactureVenteV2.docVente.enteteDoc.point.id}" disabled="#{managedFactureVenteV2.docVente.enteteDoc.id gt 0}"
                                             id="select_point2" style="min-width: 120px; max-width: 160px" valueChangeListener="#{managedFactureVenteV2.choosePoint_}">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedPointVente.pointsvente}" var="poi" 
                                               itemLabel="#{poi.libelle}" itemValue="#{poi.id}" />  
                                <p:ajax event="valueChange" update="select_auto_facture_vente select_vendeur @this"/>
                            </h:selectOneMenu> 
                            <h:selectOneMenu value="#{managedFactureVenteV2.docVente.enteteDoc.crenauHoraire.personnel.id}" disabled="#{managedFactureVenteV2.docVente.enteteDoc.id gt 0}"
                                             valueChangeListener="#{managedFactureVenteV2.chooseVendeur}" id="select_vendeur" style="min-width: 120px; max-width: 150px">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedFactureVenteV2.vendeurs}" var="vend_" 
                                               itemLabel="#{vend_.nomUsers}" itemValue="#{vend_.id}" />                                
                                <p:ajax event="valueChange" update="select_auto_facture_vente select_vendeur @this"/>
                            </h:selectOneMenu> 
                        </h:panelGrid>
                        <h:panelGroup style="float: right;">
                            <p:commandLink title="#{lab.LC_PCV_reinitialiser_entete_journal_vente}" onclick="dlgResetEntete.show()" global="false" rendered="#{accesRessource.fv_update_header}"
                                           style="border: 2px solid black; border-radius: 5px;padding: 2px;background: white">
                                <h:graphicImage library="icones" name="kedit.png" width="15" height="15"/>    
                            </p:commandLink>
                            <p:commandLink id="btnMontantsEntete" global="false" style="border: 2px solid black; border-radius: 5px;padding: 2px;background: white" title="#{lab.LC_PFV_montants}">
                                <h:graphicImage library="icones" name="ico_facture2.png" width="15" height="15"/>  
                            </p:commandLink>
                        </h:panelGroup>
                    </h:panelGrid>
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_facture_vente">
                    <p:outputPanel id="blog_form_facture_vente" style="width: 99%; margin: auto; background: white">
                        <h:panelGrid columns="1" style="width: 100%">
                            <p:outputPanel id="form_entete_facture_vente">
                                <h:panelGrid columns="3" styleClass="yvs_nostyle" style="width: 100%;margin-bottom: -5px;margin-top: -5px" cellpadding="0" cellspacing="0" rendered="#{managedFactureVenteV2.docVente.update}">
                                    <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: left;font-size: large;background: black;color: white">                                            
                                        <span style="font-size: initial">#{lab.L_numero} : </span>
                                        <h:outputText id="txt_reference_document_facture_vente" value="#{managedFactureVenteV2.docVente.numDoc}"/>
                                    </h:panelGrid>                                    
                                    <p:outputPanel id="grp_btn_etat_facture_vente" styleClass="yvs_form_of">
                                        <p:commandLink value="#{(managedFactureVenteV2.docVente.statutRegle == constantes.ETAT_REGLE)?'Réglé':(managedFactureVenteV2.docVente.statutRegle == constantes.ETAT_ENCOURS)?lab.L_en_cours:lab.L_en_attente}" styleClass="button-stateOF #{(true)?'button-stateOF_actif':''}" 
                                                       disabled="true"/>
                                        <p:commandLink value="#{(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE)?lab.LC_PCV_livre:'LIVRER'} #{(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_ENCOURS)?'(P)':(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE)?'':'(E)'}" 
                                                       styleClass="button-stateOF #{(managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE)?'button-stateOF_actif':''}" 
                                                       disabled="#{!(managedFactureVenteV2.docVente.statut == constantes.ETAT_VALIDE) or managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_LIVRE}" 
                                                       actionListener="#{managedFactureVenteV2.buildToSend()}" update="grp_btn_etat_facture_vente"/> <br />
                                        <h:outputText value="#{lab.L_en_cours_livraison}" style="text-align: center; margin-left: 8%; font-style: italic; color: #009999; font-size: 0.8em; font-weight: bold" rendered="#{managedFactureVenteV2.docVente.statutLivre == constantes.ETAT_ENCOURS}"/>
                                    </p:outputPanel>
                                    <h:panelGroup style="float: right">                                               
                                        <p:outputPanel id="etapes_valide_facture_vente" styleClass="yvs_form_of">                                              
                                            <ui:repeat value="#{managedFactureVenteV2.docVente.etapesValidations}" var="etapeM">
                                                <p:contextMenu for="etape_valide_facture_vente" style="font-size: 0.7em" rendered="#{etapeM.etapeValid or etapeM.motif != null}">
                                                    <p:menuitem icon="ui-icon-newwin" value="#{lab.LC_PFA_proprietes}" title="#{lab.LC_PFA_voir_proprietes_validations}" oncomplete="dlgppteValid.show()" rendered="#{etapeM.etapeValid}"
                                                                update=":form_ppte_valid_fv:table_ppte_valid_fv"/>
                                                    <p:menuitem icon="ui-icon-clipboard" value="#{lab.LC_PFA_motif_annulation}" title="#{lab.LC_PA_voir_motif_annulation}" oncomplete="dglMotifCancelEtape.show()" rendered="#{etapeM.motif != null}"
                                                                update=":main-motif_etape_vente:value_motif_etape_vente" actionListener="#{managedFactureVenteV2.motifEtapeFacture(etapeM.motif, true)}"/>
                                                    <p:separator rendered="#{etapeM.etapeValid}"/>
                                                    <p:menuitem icon="ui-icon-circle-arrow-w" value="#{lab.L_annuler}" rendered="#{etapeM.etapeValid}"
                                                                update=":main-motif_etape_vente:value_motif_etape_vente" actionListener="#{managedFactureVenteV2.annulEtapeFacture(etapeM, false)}"/>
                                                </p:contextMenu>
                                                <p:commandLink id="etape_valide_facture_vente" value="#{etapeM.etape.labelStatut}" disabled="#{(!etapeM.etapeActive or etapeM.etapeValid)}" title="#{etapeM.etape.titreEtape}" 
                                                               update=":main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:etapes_valide_facture_vente :main_facture_vente:data_facture_vente :main_facture_vente:tabview_facture_vente:data_contenu_facture_vente"
                                                               styleClass="#{(etapeM.etapeValid)?'statut_valide':'etat_formation_true'}" actionListener="#{managedFactureVenteV2.validEtapeFacture(etapeM)}"/>                        
                                                <h:outputText value=" A " rendered="#{!etapeM.etapeValid and etapeM.motif ne null}" title="#{lab.LC_PFV_annulee_pour}: #{etapeM.motif}" style="position: relative;left: -10px; top: 5px; font-size: 0.7em; color: #FFF; background: red; border-radius: 5px;"/>
                                            </ui:repeat>                                            
                                            <h:panelGroup style="float: right">
                                                <p:commandLink value="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_VALIDE)?'VALIDE':'VALIDER'}" rendered="#{managedFactureVenteV2.docVente.etapesValidations.size() lt 1}" process="@this"  
                                                               disabled="#{!(managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)}" styleClass="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_VALIDE)?'statut_valide':'etat_formation_true'}"                                                           
                                                               actionListener="#{managedFactureVenteV2.validerFacture(false)}" update="grp_btn_etat_facture_vente etapes_valide_facture_vente"/>
                                                <p:commandLink value="#{managedFactureVenteV2.writeEtape(((managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)?'EN EDITION':'EDITABLE'), managedFactureVenteV2.docVente.firstEtape)}" onclick="dlgCancelV.show()" type="button"
                                                               disabled="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)}" global="false" styleClass="#{(managedFactureVenteV2.docVente.statut == constantes.ETAT_EDITABLE)?'statut_valide':'etat_formation_true'}"/>
                                                <p:commandLink value="#{managedFactureVenteV2.writeEtape(((managedFactureVenteV2.isComptabiliseBean(managedFactureVenteV2.docVente))?'COMPTABILIS&Eacute;':'COMPTABILISER'), managedFactureVenteV2.docVente.firstEtape)}"
                                                               type="button" styleClass="#{(managedFactureVenteV2.docVente.comptabilise)?'statut_valide':'etat_formation_true'}"
                                                               onclick="dlgComptabiliseDoc.show()" rendered="#{managedFactureVenteV2.docVente.statut==constantes.STATUT_DOC_VALIDE and managedFactureVenteV2.docVente.typeDoc eq constantes.TYPE_FV}" global="false" id="btn_comptabilised_fv"/>
                                                <p:contextMenu for="btn_comptabilised_fv" style="font-size: 0.7em">
                                                    <p:menuitem icon="ui-icon-eject" value="#{lab.LC_PFA_proprietes}" actionListener="#{managedSaisiePiece.displayPieceComptable(managedFactureVenteV2.docVente.id, constantes.SCR_VENTE)}" 
                                                                update=":form_pptes_compta:table_pptes_compta" oncomplete="dlgPpteCompta.show()"/>
                                                    <p:separator style="width: 100%" />                                                    
                                                    <p:menuitem icon="ui-icon-circle-arrow-w" value="#{lab.L_annuler}" onclick="dlgUnComptabiliseDoc.show()" global="false"/>
                                                </p:contextMenu>
                                            </h:panelGroup>
                                        </p:outputPanel>                                                 
                                    </h:panelGroup>                                     
                                </h:panelGrid> 
                            </p:outputPanel>
                            <p:outputPanel style="width: 100%" id="form_facture_vente">
                                <div style="width: 61%;float: left">                                             
                                    <p:outputPanel id="infos_document_facture_vente" style="width: 100%">
                                        <p:outputPanel>
                                            <h:panelGrid id="infos_facture_vente" columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                                <f:facet name="header">
                                                    <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">                                                        
                                                        <h:panelGroup style="float: left;">
                                                            <pe:timePicker value="#{managedFactureVenteV2.docVente.heureDoc}" disabled="#{managedFactureVenteV2.docVente.statut != constantes.ETAT_EDITABLE}" style="width: 80px"/>
                                                        </h:panelGroup>   
                                                        <h:panelGroup style="float: right">
                                                            <h:panelGroup id="blog_choose_commande_fv" style="float: right; background: #FFF; color: #000; border: 1px solid #045491; padding: 3px; margin-right: -9px">
                                                                #{managedFactureVenteV2.docVente.id}
                                                            </h:panelGroup>
                                                            <p:commandButton icon="ui-icon-gear" style="width: 25px; height: 25px" type="button" id="btn_print_opt" />
                                                            <p:contextMenu for="btn_print_opt" event="left click" style="width:220px">
                                                                <p:menuitem icon="ui-icon-print" value="#{lab.LC_PFV_telecharger_ticket}" actionListener="#{managedFactureVenteV2.printTicket(managedFactureVenteV2.selectDoc)}"
                                                                            title="#{lab.LC_PFV_telecharger_ticket_vente}" oncomplete="openPrintDialog()"/> 
                                                                <p:separator/>
                                                                <p:menuitem icon="ui-icon-trash" value="#{lab.L_supprimer}" global="false" actionListener="#{managedFactureVenteV2.deleteBean_(managedFactureVenteV2.selectDoc)}" oncomplete="dlgConfirmDelete_.show()"/>
                                                            </p:contextMenu>
                                                        </h:panelGroup>
                                                    </h:panelGrid>
                                                </f:facet>
                                                <h:panelGroup>
                                                    <span>#{lab.LC_PFV_client} </span>       
                                                    <p:outputPanel autoUpdate="true" style="float: right;margin-top: -2px">
                                                        [<p:commandLink value="#{managedFactureVenteV2.docVente.client.codeClient}" style="color: #003399"
                                                                        title="#{lab.LC_PFV_cliquer_afficher_solde_client}" actionListener="#{managedFactureVenteV2.displayDetailsClient()}" update="info_solde_detail_clt"/>]
                                                    </p:outputPanel>
                                                </h:panelGroup>
                                                <h:panelGroup id="select_client_facture_vente">
                                                    <h:inputText value="#{managedFactureVenteV2.docVente.client.nom}" style="color: #{managedFactureVenteV2.docVente.client.error?'red':''}"
                                                                 disabled="#{managedFactureVenteV2.docVente.statut != constantes.ETAT_EDITABLE or managedFactureVenteV2.isBon}">
                                                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.searchClient()}" update="infos_facture_vente txt_zone_client"/>
                                                    </h:inputText>    
                                                    <h:inputText value="#{managedFactureVenteV2.docVente.nomClient}" style="margin-left: 5px"/>
                                                    <h:panelGroup style="float: right">
                                                        <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PPL_liste_client}" global="false"
                                                                         disabled="#{managedFactureVenteV2.docVente.statut != constantes.ETAT_EDITABLE or managedFactureVenteV2.isBon}"
                                                                         actionListener="#{managedFactureVenteV2.initClients()}" oncomplete="dlgListClients.show()"/>
                                                        <p:commandButton icon="ui-icon-circle-plus"  style="width: 20px; height: 22px;" oncomplete="dlgAddClient.show()" title="#{lab.LC_PCV_creer_client}"
                                                                         rendered="#{accesRessource.fv_create_client}" actionListener="#{managedFactureVenteV2.initCreateClient()}" update=":main_client_fv:infos_tiers_facture_vente"/>   
                                                    </h:panelGroup>
                                                </h:panelGroup> 
                                                <span title="#{lab.LC_PFV_categorie_comptable}">#{lab.LC_PFV_c_comptable}</span>
                                                <h:selectOneMenu value="#{managedFactureVenteV2.docVente.categorieComptable.id}" id="select_categorie_comptable_facture_vente"
                                                                 disabled="#{managedFactureVenteV2.isBon}" style="min-width: 120px">
                                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                                    <f:selectItems value="#{managedCatCompt.categoriesVente}" var="cat" 
                                                                   itemLabel="#{cat.designation}" itemValue="#{cat.id}" />                               
                                                    <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseCategorie()}"  update="tabview_facture_vente"/>
                                                </h:selectOneMenu>
                                                <span title="#{lab.LC_PFV_model_reglement}">#{lab.LC_PFV_m_reglement} </span>
                                                <h:panelGroup style="width: 100%">
                                                    <h:selectOneMenu value="#{managedFactureVenteV2.docVente.modeReglement.id}" id="select_model_facture_vente"
                                                                     style="min-width: 120px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedModeReglement.models}" var="model" itemLabel="#{model.reference}" itemValue="#{model.id}" />                                
                                                    </h:selectOneMenu> 
                                                    <h:panelGroup style="float: right; font-size: 0.8em;margin-top: 4px" id="select_auto_facture_vente">
                                                        <p:selectBooleanCheckbox itemLabel="#{lab.LC_PFV_livrer} " value="#{managedFactureVenteV2.docVente.livraisonAuto}"/>
                                                        <p:spacer width="5"/>
                                                        <p:selectBooleanCheckbox itemLabel="#{lab.LC_PFV_regler}" value="#{managedFactureVenteV2.docVente.validationReglement}">
                                                            <p:ajax event="valueChange"/>
                                                        </p:selectBooleanCheckbox>
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <h:panelGroup>
                                                    <span>#{lab.LC_PFV_adresse}</span>
                                                    <h:panelGroup style="float: right">
                                                        <p:commandButton icon="ui-icon-circle-plus"  style="width: 20px; height: 22px;" oncomplete="dlgAddZone.show()" rendered="#{!managedFactureVenteV2.docVente.enteteDoc.point.venteOnline}"
                                                                         actionListener="#{Mdico.resetFiche()}" update=":main_zone_fv:form_zone_fv" title="#{lab.LC_PFV_creer_nouvelle_adress}"/>   
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <h:panelGroup id="txt_zone_client">
                                                    <h:panelGroup id="Adresse_fv">
                                                        <h:selectOneMenu value="#{managedFactureVenteV2.docVente.adresse.id}" style="width: 250px" rendered="#{!(managedFactureVenteV2.docVente.enteteDoc.point.venteOnline and managedFactureVenteV2.currentAgence.societe.venteOnline)}">
                                                            <f:selectItem itemValue="0" itemLabel="" />
                                                            <f:selectItems value="#{managedFactureVenteV2.lieux}" var="ilieu" itemValue="#{ilieu.id}" itemLabel="#{ilieu.parent.libele} - #{ilieu.libele}" />
                                                            <p:ajax event="valueChange" global="false"/>
                                                        </h:selectOneMenu> 
                                                        <h:panelGroup rendered="#{managedFactureVenteV2.docVente.enteteDoc.point.venteOnline and managedFactureVenteV2.currentAgence.societe.venteOnline}">
                                                            <h:selectOneMenu value="#{managedFactureVenteV2.docVente.information.adresseLivraison.id}" style="width: 180px">
                                                                <f:selectItem itemLabel="--" itemValue="0"/>
                                                                <f:selectItems value="#{managedPointLivraison.points}" var="ptl" itemLabel="#{ptl.ville.libele} - #{ptl.libelle}" itemValue="#{ptl.id}" />  
                                                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.choosePointLivraison()}" update="blog_livraison"/>                              
                                                            </h:selectOneMenu>
                                                            <p:commandButton id="btn_livraison" icon="ui-icon-info" style="width: 20px; height: 22px;" type="button"/>  
                                                            <p:overlayPanel for="btn_livraison" style="width: 500px">
                                                                <h:panelGrid id="blog_livraison" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" columns="1" style="width: 100%">
                                                                    <f:facet name="header">
                                                                        <div align="left" style="padding:5px">
                                                                            <h:outputText value="#{managedFactureVenteV2.docVente.information.adresseLivraison.libelle}"/>
                                                                        </div>
                                                                    </f:facet>
                                                                    <span style="color:#bbb;font-style:italic">#{lab.LC_PPL_lieu_dit} </span>
                                                                    <h:outputText value="#{managedFactureVenteV2.docVente.information.adresseLivraison.lieuDit}"/>
                                                                    <span style="color:#bbb;font-style:italic">Téléphone </span>
                                                                    <h:outputText value="#{managedFactureVenteV2.docVente.information.adresseLivraison.telephone}"/>
                                                                    <span style="color:#bbb;font-style:italic">Description </span>
                                                                    <h:outputText value="#{managedFactureVenteV2.docVente.information.adresseLivraison.description}"/>
                                                                </h:panelGrid>
                                                            </p:overlayPanel>
                                                        </h:panelGroup>
                                                    </h:panelGroup>
                                                    <h:panelGroup style="float: right">
                                                        <span>#{lab.LC_PFV_telephone} : </span>
                                                        <h:inputText value="#{managedFactureVenteV2.docVente.telephone}" style="text-align: center"/>
                                                    </h:panelGroup>
                                                </h:panelGroup>                                                 
                                                <h:panelGroup>
                                                    <span title="#{lab.LC_PCV_depot_livraison_prevu}">#{lab.LC_PFV_depot} </span>                                                    
                                                    <h:selectBooleanCheckbox value="#{managedFactureVenteV2.loadOnlyDepotPoint}" title="#{lab.LC_PFV_charge_seulement_depots_point_vente}" >
                                                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.choosePointById(managedFactureVenteV2.docVente.enteteDoc.point.id)}"/>
                                                    </h:selectBooleanCheckbox>
                                                </h:panelGroup>
                                                <h:panelGroup>
                                                    <h:selectOneMenu value="#{managedFactureVenteV2.docVente.depot.id}" id="select_depot_liv_prevu" style="min-width: 120px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedFactureVenteV2.depotsLivraison}" var="dpl" itemLabel="#{dpl.designation}" itemValue="#{dpl.id}" />  
                                                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseDepot()}" update="select_tranche_livraison_fv"/>                              
                                                    </h:selectOneMenu> 
                                                    <span>#{lab.L_le}</span>
                                                    <p:calendar value="#{managedFactureVenteV2.docVente.dateLivraisonPrevu}" pattern="dd-MM-yyyy HH:mm:ss" navigator="true" size="15" >
                                                        <p:ajax event="dateSelect" global="false"/>
                                                    </p:calendar>
                                                    <h:panelGroup style="float: right;margin-top: 3px">
                                                        <span title="#{lab.LC_PFV_tranche_livraison_prevu}">#{lab.L_tranche} : </span>   
                                                        <h:selectOneMenu value="#{managedFactureVenteV2.docVente.tranche.id}" id="select_tranche_livraison_fv" style="width: 180px"
                                                                         title="#{lab.LC_PFA_selectionner_tranche_livraison_prevu}">
                                                            <f:selectItem itemLabel="--" itemValue="0"/>
                                                            <f:selectItems value="#{managedFactureVenteV2.tranches}" var="tdL" itemLabel="#{tdL.titre}" itemValue="#{tdL.id}" />  
                                                            <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseTrancheDepot()}"/>                              
                                                        </h:selectOneMenu>
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <h:outputText value="#{lab.LC_PFV_reference_externe}"/>
                                                <h:panelGroup>
                                                    <p:watermark for="txt_reference_externe" value="#{lab.LC_PFV_reference_externe}"/>   
                                                    <h:inputText value="#{managedFactureVenteV2.docVente.numeroExterne}" id="txt_reference_externe" style="width: 100%;"/> 
                                                </h:panelGroup>
                                                <f:facet name="footer">                                             
                                                    <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" id="info_solde_detail_clt">
                                                        <h:panelGroup style="color: #9a0000; font-size: 0.8em; font-style: italic; display: #{managedFactureVenteV2.docVente.client.solde lt -(managedFactureVenteV2.docVente.client.seuilSolde) ? 'inline':'none'}">
                                                            <span>
                                                                #{lab.LC_PFV_solde_client}
                                                                <h:outputText value="#{managedFactureVenteV2.abs(managedFactureVenteV2.docVente.client.solde)}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold"/>
                                                                <span> #{managedFactureVenteV2.currentScte.devise}</span>
                                                            </span>
                                                        </h:panelGroup>
                                                        <h:panelGroup style="color: #9a0000; font-size: 0.8em;margin-top: 2px;font-style: italic;float:right" rendered="#{managedFactureVenteV2.displayDetailClient}">
                                                            <span>
                                                                <h:outputText value="#{managedFactureVenteV2.docVente.client.nbrFactureImpayee}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold"/>
                                                                <span> #{lab.LC_PFV_facture_impayes}</span>
                                                            </span>
                                                        </h:panelGroup>
                                                    </h:panelGrid>   
                                                </f:facet>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                        <p:overlayPanel for="btnMontantsEntete" hideEffect="fade" style="width: 35%;background: black;color: white">
                                            <p:outputPanel id="blog_form_montant_entete">
                                                <div style="width: 100%">
                                                    <span columns="2" style="font-weight: bolder;margin-top: 5px;color: white">#{lab.LC_PCV_statistique_journal_vente}</span>
                                                    <p:commandButton icon="ui-icon-refresh" value="#{lab.L_actualiser}" actionListener="#{managedFactureVenteV2.setMontantEntete(null)}" 
                                                                     update="blog_form_montant_entete" style="background: #FFF !important;float: right"/>
                                                </div>
                                                <h:panelGrid columns="2" style="width: 100%;font-weight: bolder;margin-top: 5px;color: white">
                                                    <span>#{lab.LC_PFV_total_taxe}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantTaxe}" converter="DNS"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_ht}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantHT}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_remise_article}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantRemise}" converter="DNS"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_ttc}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantTTC}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_ristourne}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantRistourne}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_remise_facture}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantRemises}" converter="DNS" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_cout_suppl}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantCoutSup}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_chiffre_affaire}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantTotal}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_commande_encours}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.avanceCommande}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #0099ff">#{lab.LC_PFV_total_avance}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantAvance}" converter="#{managedFactureVenteV2.converter}" style="color: #0099ff"/>
                                                        <span style="font-size: small;color: #0099ff"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #009999">#{lab.LC_PFA_net_a_payer}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.montantNetApayer}" converter="#{managedFactureVenteV2.converter}" style="color: #009999"/>
                                                        <span style="font-size: small;color: #009999"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #99ccff">#{lab.LC_PTBVs_versement_attendu}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.enteteDoc.versementAttendu}" converter="#{managedFactureVenteV2.converter}" style="color: #99ccff"/>
                                                        <span style="font-size: small;color: #99ccff"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                </h:panelGrid>
                                            </p:outputPanel>
                                        </p:overlayPanel>
                                        <p:overlayPanel for="btnMontantsFV" hideEffect="fade" style="width: 35%;background: black;color: white">
                                            <p:outputPanel id="blog_form_montant_doc_fv">
                                                <h:panelGrid columns="2" style="width: 100%;font-weight: bolder;margin-top: 5px;color: white">
                                                    <span>#{lab.LC_PFV_total_taxe}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantTaxe}" converter="DNS"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_ht}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantHT}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_remise_article}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantRemise}" converter="DNS"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_ttc}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantTTC}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_ristourne}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantRistourne}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_remise_facture}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantRemises}" converter="DNS" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PFV_total_cout_suppl}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantCS}" converter="#{managedFactureVenteV2.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PFV_total_facture}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantTotal}" converter="#{managedFactureVenteV2.converter}"/>
                                                        <span style="font-size: small"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #0099ff">Total Avance</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantAvance}" converter="#{managedFactureVenteV2.converter}" style="color: #0099ff"/>
                                                        <span style="font-size: small;color: #0099ff"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                    <span style="color: #009999">Net A Payer</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedFactureVenteV2.docVente.montantResteApayer}" converter="#{managedFactureVenteV2.converter}" style="color: #009999"/>
                                                        <span style="font-size: small;color: #009999"> #{managedFactureVenteV2.currentScte.devise}</span>
                                                    </h:panelGroup>
                                                </h:panelGrid>
                                            </p:outputPanel>
                                        </p:overlayPanel>
                                        <p:overlayPanel for="btnTaxesFV" hideEffect="fade" style="width: 35%">
                                            <p:commandButton value="Actualiser" icon="ui-icon-refresh" style="float: right"
                                                             actionListener="#{managedFactureVenteV2.loadTaxesVente(managedFactureVenteV2.selectDoc)}" />
                                            <p:dataTable id="data_taxes_facture_vente" value="#{managedFactureVenteV2.taxes}" var="tx" rowKey="#{tx.id}">
                                                <p:column headerText="#{lab.L_taxe}" >
                                                    <span>#{tx.designation}</span>
                                                </p:column>
                                                <p:column headerText="#{lab.L_montant}" style="text-align: right;width: 35%">
                                                    <h:outputText value="#{tx.taux}" converter="DNS"/>
                                                    #{managedFactureVenteV2.currentScte.devise}
                                                </p:column>
                                            </p:dataTable>
                                        </p:overlayPanel>
                                    </p:outputPanel>
                                </div>
                                <div style="margin-left: 62%;border-bottom: 1px solid #bbb; background: #FFF;">
                                    <p:outputPanel id="blog_commercial_vente" layout="block">
                                        <h1 style="padding-left: 10px">Détails du produit</h1>
                                        <div style="float: left; width: 59%; border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;
                                             border-bottom: 2px solid #bbb; padding-left: 10px; padding-bottom: 10px; padding-top: 5px">
                                            <span style="font-weight: bold;color: #000">
                                                #{managedFactureVenteV2.contenu.article.designation}
                                            </span>
                                            <p:outputPanel rendered="#{accesRessource.base_view_article_pua}" layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <h:outputText value="Prix d'achat = " />
                                                <h:outputText value="#{managedFactureVenteV2.contenu.conditionnement.prixAchat}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel>
                                            <p:outputPanel layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <h:outputText value="#{lab.LC_PFV_prix_minimum} = " />
                                                <h:outputText value="#{managedFactureVenteV2.contenu.article.puvMin}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel>
                                            <p:outputPanel layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <span>#{lab.LC_PFV_prix_recommander} = </span>
                                                <h:outputText value="#{managedFactureVenteV2.contenu.article.puv}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel> 
                                            <p:outputPanel rendered="#{accesRessource.base_view_article_pr}" layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <h:outputText value="#{lab.LC_PFA_cout_unitaire_stock} = " /> 
                                                <h:outputText value="#{managedFactureVenteV2.contenu.article.pr}" converter="#{managedFactureVenteV2.converter}"  style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel>
                                            <p:outputPanel layout="block" rendered="#{managedFactureVenteV2.contenu.article.categorie ne constantes.CAT_SERVICE}" 
                                                           style="padding-top: 5px; padding-bottom: 5px" id="blog_commercial_vente-stock">
                                                <h:outputText value="#{managedFactureVenteV2.contenu.article.stock}" converter="#{managedFactureVenteV2.converterStock}" style="font-weight: bold;color: #000"/>
                                                <h:outputText value=" #{managedFactureVenteV2.contenu.conditionnement.unite.reference} #{lab.LC_PFV_en_stock}"/>
                                            </p:outputPanel>
                                        </div>
                                        <div style="margin-left: 61%;" align="center">
                                            <h:graphicImage id="img_article" style="max-width: 100%;max-height: 180px" value="data:image/#{Marticle.photoArticle(managedFactureVenteV2.contenu.article)[1]};base64,#{Marticle.photoArticle(managedFactureVenteV2.contenu.article)[0]}"/>
                                        </div>                                        
                                    </p:outputPanel>                                    
                                    <p:outputPanel id="chp_fv_net_a_payer" layout="block" style="background: #FFF;padding-top:5px;margin-bottom: 22px">
                                        <div style="width: 90%;float: left">      
                                            <h:panelGrid columns="3" style="font-size: 0.8em;width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                                <span style="float: left">TTC :</span>
                                                <h:outputText value="#{lab.LC_PFV_ristourne} :"  />
                                                <h:outputText value="#{lab.LC_PFV_reste_a_payer} :"/>
                                                <h:panelGroup  >
                                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantTotal}" converter="#{managedFactureVenteV2.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                    <span style="font-size: 0.8em">#{managedFactureVenteV2.currentScte.devise}</span>
                                                </h:panelGroup>  
                                                <h:panelGroup >                                                            
                                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantRistourne}" converter="#{managedFactureVenteV2.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                    <span style="font-size: 0.8em">#{managedFactureVenteV2.currentScte.devise}</span>
                                                </h:panelGroup>  
                                                <h:panelGroup  >
                                                    <h:outputText value="#{managedFactureVenteV2.docVente.montantResteApayer}" converter="#{managedFactureVenteV2.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                    <span style="font-size: 0.8em">#{managedFactureVenteV2.currentScte.devise}</span>
                                                </h:panelGroup>
                                            </h:panelGrid>  
                                        </div>
                                        <div style="margin-left: 91%;width:9%">                                            
                                            <p:commandLink id="btnMontantsFV" global="false" style="border: 2px solid black; border-radius: 5px;padding: 3px;background: white" title="#{lab.LC_PFV_montants}">
                                                <h:graphicImage library="icones" name="ico_facture2.png" width="15" height="15"/>  
                                            </p:commandLink>
                                            <p:spacer width="3"/>
                                            <p:commandLink id="btnTaxesFV" global="false" style="border: 2px solid black; border-radius: 5px;padding: 3px;background: white" title="#{lab.LC_PFV_taxes}">
                                                <h:graphicImage library="icones" name="coffre.png" width="15" height="15"/>  
                                            </p:commandLink>
                                        </div>
                                    </p:outputPanel>
                                </div>
                                <div style="clear: right"/>
                            </p:outputPanel>
                            <p:tabView id="tabview_facture_vente">
                                <p:tab title="#{lab.LC_PFV_contenus}">      
                                    <p:focus id="fcs_article_facture_vente" for="txt_article_facture_vente"/>
                                    <p:focus id="fcs_prix_vente_facture_vente" for="txt_prix_vente_facture_vente"/>
                                    <p:outputPanel id="blog_form_contenu_facture_vente">
                                        <h:panelGrid id="form_contenu_facture_vente" columns="1" style="width: 100%;background: white;border: 2px solid #045491!important; border-radius: 5px; font-size: 0.9em" cellpadding="0" cellspacing="0">                                            
                                            <h:panelGrid styleClass="yvs_nostyle" style="font-size: 0.9em" cellpadding="0" cellspacing="0" columns="#{managedFactureVenteV2.colonneContenu()}" >  
                                                <h:outputText value="#{lab.L_article}"/>
                                                <h:outputText value="#{lab.L_conditionnement}" rendered="#{composantsVisible.fv_conditionnement}"  />
                                                <h:outputText value="#{lab.L_quantite}" />
                                                <h:outputText value="#{lab.L_prix}"/>
                                                <h:outputText value="#{lab.LC_PFV_rabais}" rendered="#{managedFactureVenteV2.contenu.rabais gt 0}" />
                                                <h:outputText value="#{lab.L_total}"/>
                                                <h:outputText value="#{lab.LC_PFV_depot}" rendered="#{composantsVisible.fv_depot_content}"/>
                                                <span>&nbsp;</span>
                                                <h:panelGroup id="blog_article_facture_vente">
                                                    <h:inputText id="txt_article_facture_vente" value="#{managedFactureVenteV2.contenu.article.refArt}" style="color: #{managedFactureVenteV2.contenu.article.error?'red':''};width: 80%" disabled="#{managedFactureVenteV2.contenu.update}" tabindex="10">
                                                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.searchArticle(false)}" update="form_contenu_facture_vente, :main_facture_vente:blog_commercial_vente"/>
                                                    </h:inputText>    
                                                    <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="Liste Articles" global="false"
                                                                     onclick="dlgListArticle.show()" update=":main_facture_vente:img_article" disabled="#{managedFactureVenteV2.contenu.update}"/>
                                                </h:panelGroup> 
                                                <h:selectOneMenu value="#{managedFactureVenteV2.contenu.conditionnement.id}" style="min-width: 120px" title="#{lab.LDB_PA_selectionner_conditionnement}" tabindex="15"
                                                                 rendered="#{composantsVisible.fv_conditionnement}" disabled="#{!composantsEditable.fv_conditionnement}" id="txt_cond_vente">
                                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                                    <f:selectItems value="#{managedFactureVenteV2.contenu.article.conditionnements}" var="un" 
                                                                   itemLabel="#{un.unite.reference}" itemValue="#{un.id}"/>
                                                    <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseConditionnement(false)}" 
                                                            update="txt_prix_vente_facture_vente txt_prix_total_facture_vente :main_facture_vente:blog_commercial_vente-stock"/>
                                                </h:selectOneMenu>
                                                <h:inputText value="#{managedFactureVenteV2.contenu.quantite}" style="max-width: 100px;text-align: right" readonly="#{managedFactureVenteV2.isBon}" tabindex="20">
                                                    <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onQuantiteBlur()}" update="txt_prix_total_facture_vente txt_prix_vente_facture_vente fcs_prix_vente_facture_vente
                                                            txt_cond_vente"/>
                                                </h:inputText>
                                                <h:panelGroup id="txt_prix_vente_facture_vente"> 
                                                    <h:inputText value="#{managedFactureVenteV2.contenu.prix}" style="max-width: 120px;text-align: right" readonly="#{!managedFactureVenteV2.contenu.article.changePrix}" tabindex="30"
                                                                 title="#{lab.LDB_PC_rabais} : #{managedFactureVenteV2.contenu.rabais} #{managedFactureVenteV2.currentScte.devise}">
                                                        <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onPrixBlur()}" update="txt_prix_total_facture_vente txt_cond_vente"/>
                                                    </h:inputText>
                                                    <span> #{managedFactureVenteV2.currentScte.devise}</span>
                                                </h:panelGroup>                                            
                                                <h:panelGroup id="txt_rabais_vente_facture_vente" rendered="#{managedFactureVenteV2.contenu.rabais gt 0}"> 
                                                    <h:inputText value="#{managedFactureVenteV2.contenu.rabais}" style="max-width: 120px;text-align: right" readonly="true"/>
                                                    <span> #{managedFactureVenteV2.currentScte.devise}</span>
                                                </h:panelGroup>                                            
                                                <h:panelGroup id="txt_prix_total_facture_vente">
                                                    <h:inputText value="#{managedFactureVenteV2.contenu.prixTotal}" style="text-align: right" readonly="true" converter="#{managedFactureVenteV2.converter}"/>
                                                    <span> #{managedFactureVenteV2.currentScte.devise}</span>
                                                </h:panelGroup>
                                                <h:selectOneMenu value="#{managedFactureVenteV2.contenu.depoLivraisonPrevu.id}" style="min-width: 120px"
                                                                 rendered="#{composantsVisible.fv_depot_content}">
                                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                                    <f:selectItems value="#{managedFactureVenteV2.depotsLivraison}" var="dpl_" itemLabel="#{dpl_.designation}" itemValue="#{dpl_.id}" />  
                                                    <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.chooseDepot()}" />                              
                                                </h:selectOneMenu> 
                                                <p:commandButton id="save_contenu_facture_vente" value="Ajouter" icon="ui-icon-circle-plus" oncomplete="collapseForm('contenu_facture_vente')" tabindex="40"
                                                                 update="fcs_article_facture_vente" actionListener="#{managedFactureVenteV2.saveNewContenu(false)}"/>
                                            </h:panelGrid>                                        
                                        </h:panelGrid>                                          
                                        <p:outputPanel>
                                            <h:inputHidden id="input_hide_contenu_facture_vente" value="#{managedFactureVenteV2.tabIds_contenu}"/>
                                            <p:dataTable id="data_contenu_facture_vente" value="#{managedFactureVenteV2.docVente.contenus}" var="artf" rowKey="#{artf.id}" 
                                                         rowIndexVar="artfIdx" selection="#{managedFactureVenteV2.selectContenus}">
                                                <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewContenu}" oncomplete="collapseForm('contenu_facture_vente')" update=":main_facture_vente:tabview_facture_vente:form_contenu_facture_vente :main_facture_vente:blog_commercial_vente"/>
                                                <p:ajax event="rowUnselect" listener="#{managedFactureVenteV2.unLoadOnViewContenu}" oncomplete="collapseForm('contenu_facture_vente')" update=":main_facture_vente:tabview_facture_vente:form_contenu_facture_vente :main_facture_vente:blog_commercial_vente"/>
                                                <p:column headerText="N°" style="width: 30px;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                                    <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{artf.new_}"/>
                                                    <span title="#{lab.LDB_PC_compte} : #{artf.compte.numCompte}">#{artfIdx+1}</span>                  
                                                    <h:panelGroup style="float: right">                                      
                                                        <h:graphicImage library="img" name="danger.png" rendered="#{artf.errorComptabilise}" width="23" height="23" title="#{artf.messageError}"/>
                                                        <h:graphicImage library="img" name="comment.png" width="15" height="15" rendered="#{artf.onComment}" title="#{lab.LDB_PC_a_ete_commente}"/>
                                                    </h:panelGroup>
                                                </p:column>
                                                <p:column headerText="#{lab.L_article}" style="color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                                    [<span style="font-weight: bold" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artf.article.refArt}</span>]
                                                    <span title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artf.article.designation}</span>
                                                    <h:outputText title="#{lab.LDB_PC_facture_consignee}" value="C" rendered="#{artf.idReservation ne null}"
                                                                  style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 1px;background: black;color: white; float: right"/>
                                                </p:column>
                                                <p:column headerText="#{lab.L_qte}" style="width: 8%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                                    <h:outputText value="#{artf.quantite}" title="Plus #{artf.quantiteBonus} #{lab.L_bonus}"/>
                                                    <span title="#{artf.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{artf.conditionnement.unite.reference}</span>
                                                </p:column>
                                                <p:column headerText="#{lab.L_bonus}" style="width: 8%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{!managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.quantiteBonus}" title="Sur l'article #{artf.articleBonus.designation}"/>
                                                    <span title="#{artf.conditionnementBonus.unite.libelle}" style="font-size: 0.6em;color: #003399; display: #{(artf.quantiteBonus gt 0)?'inline':'none'}">#{artf.conditionnementBonus.unite.reference}</span>
                                                </p:column>
                                                <p:column headerText="#{lab.L_prix}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                                    <h:outputText value="#{artf.prix}" converter="#{managedFactureVenteV2.converter}" title="#{artf.etat()=='R'?lab.LC_PCV_prix_vente_inferieur_prix_minimal:(artf.etat()=='P'?lab.LC_PCV_prix_vente_inferieur_prix_revient:lab.LC_PCV_numero_serie.concat(artf.numSerie))}"/>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PFV_rem}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{!managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.remise}" converter="DNS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PFV_rabais}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{!managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.quantite*artf.rabais}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText="Rist." style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{!managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.ristourne}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LDB_PC_ristourne}"/>
                                                </p:column>
                                                <p:column headerText="#{lab.L_taxe}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{!managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.taxe}" converter="DNS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText="Auteur" style="width: 10%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.author.users.nomUsers}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText="Date Save" style="width: 10%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.dateSave}" converter="DATETS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText="Date Update" style="width: 10%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{managedFactureVenteV2.displayAuteurContenu}">
                                                    <h:outputText value="#{artf.dateUpdate}" converter="DATETS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText="#{lab.L_total}" style="width: 12%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}">
                                                    <h:outputText value="#{artf.prixTotal}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText="Dépôt" style="width: 12%;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}" styleClass="statut_#{artf.statutLivree}" rendered="#{managedFactureVenteV2.displayDepotContenu}">
                                                    <h:outputText value="#{artf.depoLivraisonPrevu.designation}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                </p:column>
                                                <p:column headerText=""  rendered="#{managedFactureVenteV2.docVente.error}">
                                                    <h:graphicImage library="icones" name="alert_info.png" rendered="#{artf.messageError ne null}"
                                                                    title="#{lab.LC_PFV_insuffissance_stock} #{artf.messageError}"/>
                                                    <h:graphicImage library="icones" name="bien.png" rendered="#{artf.messageError eq null}" width="18" height="18"
                                                                    title="#{lab.LC_PFV_peut_etre_livre}"/>
                                                </p:column>
                                                <p:column style="width: 30px;text-align: center">
                                                    <f:facet name="header">
                                                        <p:contextMenu for="btn_option_head_contenu_facture_vente" event="left click" style="font-size: 0.8em;width: 220px">
                                                            <p:menuitem value="#{lab.LC_PFV_verifier_comptabilite}" icon="ui-icon-lightbulb" actionListener="#{managedFactureVenteV2.findContenusErrorComptabilite()}" update="data_contenu_facture_vente"/>
                                                            <p:menuitem id="menu-search_contenu_fv" value="#{lab.L_rechercher}" icon="ui-icon-search" global="false"/>
                                                            <p:menuitem value="#{lab.LC_PFV_depot}" icon="ui-icon-person" actionListener="#{managedFactureVenteV2.beginLivraison()}"
                                                                        oncomplete="dlgChangeDepot.show()" update=":main_change_depot_contenu:form_change_depot_contenu"/>
                                                            <p:separator/>
                                                            <p:menuitem value="#{managedFactureVenteV2.displayAuteurContenu?'Cacher':'Afficher'} l'auteur" icon="ui-icon-notice"
                                                                        actionListener="#{managedFactureVenteV2.setDisplayAuteurContenu(!managedFactureVenteV2.displayAuteurContenu)}"
                                                                        update="data_contenu_facture_vente"/>
                                                            <p:menuitem value="#{managedFactureVenteV2.displayDepotContenu?'Cacher':'Afficher'} le dépôt" icon="ui-icon-notice"
                                                                        actionListener="#{managedFactureVenteV2.setDisplayDepotContenu(!managedFactureVenteV2.displayDepotContenu)}"
                                                                        update="data_contenu_facture_vente"/>
                                                            <p:menuitem value="#{lab.LC_PFV_afficher_statut}" icon="ui-icon-notice" actionListener="#{managedFactureVenteV2.canLivrer()}"
                                                                        update="data_contenu_facture_vente"/>
                                                            <p:separator/>
                                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanArticles(false)}"/>
                                                        </p:contextMenu>
                                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_head_contenu_facture_vente" type="button"/>
                                                        <p:overlayPanel for="menu-search_contenu_fv" hideEffect="fade" style="width: 200px;background: black;color: white">
                                                            <h:inputText value="#{managedFactureVenteV2.articleContenu}" style="width:100%">
                                                                <p:ajax event="blur" listener="#{managedFactureVenteV2.findContenusByArticle()}" update="data_contenu_facture_vente"/>
                                                            </h:inputText>
                                                        </p:overlayPanel>
                                                    </f:facet>
                                                    <p:contextMenu for="btn_option_contenu_facture_vente" event="left click" style="font-size: 0.8em;width: 220px">
                                                        <p:menuitem value="#{artf.idReservation ne null?'Annuler la consigne':'Consigner le stock'}" icon="#{artf.idReservation ne null?'ui-icon-pin-w':'ui-icon-pin-s'}" 
                                                                    global="false" actionListener="#{managedFactureVenteV2.consignerContent(artf)}" update="data_contenu_facture_vente :main_facture_vente:data_facture_vente"/>
                                                        <p:separator style="width: 98%;margin: auto"/>
                                                        <p:menuitem value="#{lab.LC_PFV_rabais}" icon="ui-icon-suitcase" global="false" actionListener="#{managedFactureVenteV2.addRabaisContenu(artf)}" oncomplete="dlgAddRabais.show()"/>
                                                        <p:menuitem value="#{lab.L_remise}" icon="ui-icon-suitcase" global="false" actionListener="#{managedFactureVenteV2.addRemiseContenu(artf)}" oncomplete="dlgAddRemise.show()"/>                                                            
                                                        <p:menuitem value="#{lab.L_bonus}" icon="ui-icon-suitcase" global="false" actionListener="#{managedFactureVenteV2.addBonusContenu(artf)}" oncomplete="dlgAddBonus.show()"/>
                                                        <p:menuitem value="#{lab.L_taxe}" icon="ui-icon-copy" global="false" actionListener="#{managedFactureVenteV2.loadTaxesVente(artf)}" oncomplete="dlgListTaxesContenu.show()"/>
                                                        <p:separator style="width: 98%;margin: auto"/>
                                                        <p:menuitem value="#{lab.LC_PFV_depot}" icon="ui-icon-person" actionListener="#{managedLivraisonVente.beginLivraison(managedFactureVenteV2.selectDoc, artf, true)}"
                                                                    oncomplete="dlgChangeDepot.show()" update=":main_change_depot_contenu:form_change_depot_contenu"/>
                                                        <p:menuitem value="#{lab.LC_PFV_envoyer_livraison}" icon="ui-icon-transferthick-e-w" actionListener="#{managedLivraisonVente.loadLivraisonByClient(artf,managedFactureVenteV2.docVente.dateLivraisonPrevu)}"
                                                                    update=":main_livraison_fv:data_livraison_content" rendered="false"/>
                                                        <p:menuitem value="#{lab.LC_PFA_generer_livraison}" icon="ui-icon-circle-plus" actionListener="#{managedLivraisonVente.generedLivraison(artf,managedFactureVenteV2.docVente.dateLivraisonPrevu)}"
                                                                    update=":main_livraison_fv:form_defined_contenu"/>
                                                        <p:separator style="width: 98%;margin: auto"/>
                                                        <p:menuitem value="#{lab.LC_PCV_note}" icon="ui-icon-comment" global="false" actionListener="#{managedFactureVenteV2.addCommentaireContenu(artf)}" 
                                                                    oncomplete="dlgAddCommentaire.show()"/>
                                                        <p:menuitem value="#{lab.LC_PCV_numero_serie}" icon="ui-icon-info" global="false" actionListener="#{managedFactureVenteV2.addNumSerieContenu(artf)}" oncomplete="dlgAddNumSerie.show()"/>
                                                        <p:separator style="width: 98%;margin: auto"/>
                                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanContenu_(artf)}" oncomplete="dlgConfirmDeleteArticle_.show()"/>
                                                    </p:contextMenu>                           
                                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_contenu_facture_vente" type="button"/>
                                                </p:column> 
                                                <p:column selectionMode="multiple" style="width:16px;text-align:center"/>
                                            </p:dataTable>
                                        </p:outputPanel>
                                    </p:outputPanel> 
                                    <div style="clear: both"/>
                                </p:tab>
                                <p:tab title="#{lab.LC_PFV_cout_services_sup} (#{managedFactureVenteV2.docVente.nbreCout})" >
                                    <p:outputPanel id="blog_form_cout_facture_vente">
                                        <div style="width: 30%;float: left; font-size: 0.9em">
                                            <h:panelGrid id="form_cout_facture_vente" styleClass="yvs_table" columns="2" style="width: 100%" cellpadding="0" cellspacing="0">  
                                                <f:facet name="header">
                                                    <div align="right">
                                                        <span title="#{lab.LC_PFV_service_participent_au_ca}">#{lab.LC_PFV_service} ? </span>
                                                        <h:selectBooleanCheckbox value="#{managedFactureVenteV2.cout.service}"/>
                                                    </div>
                                                </f:facet>
                                                <span>#{lab.L_type}</span>                                                    
                                                <h:selectOneMenu value="#{managedFactureVenteV2.cout.type.id}" id="select_type_cout_facture_vente" style="min-width: 120px"
                                                                 onchange="openDialog(dlgAddTypeCout, $(this))">
                                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                                    <f:selectItems value="#{managedTypeCout.types}" var="typ" itemLabel="#{typ.libelle}" itemValue="#{typ.id}" />     
                                                    <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                                                    <f:selectItem itemLabel="#{lab.LDB_PTA_creer}" itemValue="-1"/>                               
                                                </h:selectOneMenu>  
                                                <span>#{lab.L_montant} </span>
                                                <pe:inputNumber value="#{managedFactureVenteV2.cout.montant}" style="text-align: right" decimalPlaces="0"/>                                                    
                                            </h:panelGrid>
                                            <div style="margin-top: 5px">
                                                <p:commandButton id="cancel_cout_facture_vente" value="#{lab.L_nouveau}" oncomplete="collapseForm('cout_facture_vente')" global="false"
                                                                 update="blog_form_cout_facture_vente" actionListener="#{managedFactureVenteV2.resetFicheCout()}" style="float: left"/>
                                                <p:commandButton id="save_cout_facture_vente" value="#{lab.L_enregistrer}" oncomplete="collapseForm('cout_facture_vente')"
                                                                 update="blog_form_cout_facture_vente" actionListener="#{managedFactureVenteV2.saveNewCout()}" style="float: right"/>
                                            </div>
                                        </div>
                                        <div style="width: 69%;margin-left: 31%">
                                            <p:outputPanel>
                                                <h:inputHidden id="input_hide_cout_facture_vente" value="#{managedFactureVenteV2.tabIds_cout}"/>
                                                <p:dataTable id="data_cout_facture_vente" value="#{managedFactureVenteV2.docVente.couts}" var="coux" rowKey="#{coux.id}" 
                                                             rowIndexVar="couIdx" selectionMode="single">
                                                    <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewCout}" update=":main_facture_vente:tabview_facture_vente:form_cout_facture_vente"/>
                                                    <p:ajax event="rowUnselect" global="false" listener="#{managedFactureVenteV2.unLoadOnViewCout}" update=":main_facture_vente:tabview_facture_vente:form_cout_facture_vente"/>
                                                    <p:column headerText="N°" style="width: 7%">
                                                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{coux.new_}"/>
                                                        <span>#{couIdx+1}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.LC_PFV_type_coup}">
                                                        <span>#{coux.typeCout.libelle}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_montant}" style="text-align: right;width: 30%">
                                                        <h:outputText value="#{coux.montant}" converter="#{managedFactureVenteV2.converter}"/>
                                                    </p:column>
                                                    <p:column headerText="#{lab.LC_PFV_serv}." style="width: 15%;text-align: center">
                                                        <h:graphicImage library="img" name="#{(coux.service)?'yes.png':'no.png'}" width="15" height="15"/>
                                                    </p:column>
                                                    <p:column style="width: 7%;text-align: center">
                                                        <p:contextMenu for="btn_option_cout_facture_vente" event="left click" style="font-size: 0.8em">
                                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanCout_(coux)}" oncomplete="dlgConfirmDeleteCout_.show()"/>
                                                        </p:contextMenu>                           
                                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_cout_facture_vente" type="button"/>
                                                    </p:column> 
                                                    <p:column style="width: 7%;text-align: center" rendered="false">
                                                        <f:facet name="header">
                                                            <h:selectBooleanCheckbox styleClass="chek_all_line_cout_facture_vente" value="false"
                                                                                     onclick="selectionAllLineTab(#{managedFactureVenteV2.docVente.couts.size()}, 'cout_facture_vente')">
                                                            </h:selectBooleanCheckbox>
                                                        </f:facet>
                                                        <h:selectBooleanCheckbox  value="#{coux.selectActif}" styleClass="chek_line_cout_facture_vente"
                                                                                  onclick="selectionLineTab(#{coux.id}, 'cout_facture_vente')">
                                                        </h:selectBooleanCheckbox>
                                                    </p:column>
                                                </p:dataTable>
                                                <div align="right">
                                                    <p:commandButton actionListener="#{managedFactureVenteV2.openDlgCoutS()}" title="#{lab.LC_PFV_actualiser_liste_cout_supp}"
                                                                     update="data_cout_facture_vente" icon="ui-icon-refresh" value="#{lab.L_actualiser}"/>
                                                </div>
                                                <p:commandButton id="delete_cout_facture_vente" value="#{lab.L_supprimer}" style="float: right" rendered="false"
                                                                 onclick="dlgConfirmDeleteCout.show()"/>
                                            </p:outputPanel>
                                        </div>                                        
                                    </p:outputPanel>
                                    <div style="clear: both"/>
                                </p:tab>
                                <p:tab title="#{lab.LC_PFV_reglements} (#{managedFactureVenteV2.docVente.nbreReglement})">
                                    <p:outputPanel id="form_mensualite_facture_vente">
                                        <h:panelGrid columns="3" style="width: 100%;background: white;border: 2px solid #045491!important; border-radius: 5px" cellpadding="0" cellspacing="0" rendered="#{accesRessource.fv_create_reglement}"> 
                                            <p:commandButton actionListener="#{managedFactureVenteV2.genereMensualite()}" style="float: left; border-radius: 5px; background: white;margin-left: 3px"
                                                             oncomplete="collapseForm('mensualite_facture_vente');" rendered="#{0==managedFactureVenteV2.docVente.nbreReglement}" title="#{lab.LC_PFV_generer_mode_reglement}"
                                                             update="form_mensualite_facture_vente" icon="ui-icon-arrowthickstop-1-s" />
                                            <h:panelGrid id="blog_form_mensualite_facture_vente" columns="7" cellpadding="0" cellspacing="0" style="padding-top: 3px;padding-bottom: -5px">
                                                <h:outputText value="#{lab.LC_PFV_mode}" />
                                                <h:outputText value="#{lab.L_montant}" />
                                                <h:outputText value="#{lab.LC_PFV_date_paiement}" />
                                                <h:outputText value="#{lab.LC_PFV_caisse}" />
                                                <h:outputText value="#{lab.LC_PFV_caissier}" />
                                                <h:outputText value="#{lab.LC_PFV_statut}"  />
                                                <h:outputText value="#{lab.LC_PFV_reference_externe}"/>
                                                <h:panelGroup>                                                    
                                                    <h:outputText value="#{managedFactureVenteV2.reglement.id}" rendered="#{managedFactureVenteV2 .reglement.id gt 0}"/>
                                                    <h:selectOneMenu value="#{managedFactureVenteV2.reglement.mode.id}" id="select_model_mens_facture_vente" style="min-width: 120px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedModeReglement.modes}" var="modelm" itemLabel="#{modelm.designation}" itemValue="#{modelm.id}" />     
                                                    </h:selectOneMenu>  
                                                </h:panelGroup>
                                                <pe:inputNumber value="#{managedFactureVenteV2.reglement.montant}"  style="text-align: right; width: 120px"/>
                                                <p:calendar value="#{managedFactureVenteV2.reglement.datePaiementPrevu}" navigator="true" pattern="dd-MM-yyyy" size="8"/>
                                                <h:selectOneMenu id="chmp_caisse_reglement_fv" value="#{managedFactureVenteV2.reglement.caisse.id}" valueChangeListener="#{managedFactureVenteV2.chooseCaisses}" style="max-width: 160px;min-width: 140px">
                                                    <f:selectItem itemLabel="" itemValue="0" />
                                                    <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}" itemValue="#{icaiss.id}" />
                                                    <f:selectItem itemLabel="" itemValue="0" />
                                                    <f:selectItem itemLabel="Plus de choix..." itemValue="-1" />
                                                    <p:ajax event="valueChange"/>
                                                </h:selectOneMenu>
                                                <h:selectOneMenu id="chmp_caissier_reglement_fv" value="#{managedFactureVenteV2.reglement.caissier.id}" style="max-width: 150px;min-width: 140px" disabled="#{!accesRessource.compta_reg_fv_change_caissier}">
                                                    <f:selectItem itemLabel="" itemValue="0" />
                                                    <f:selectItems value="#{managedFactureVenteV2.caissiers}" var="iCaissier" itemLabel="#{iCaissier.nomUsers}" itemValue="#{iCaissier.id}" />
                                                    <p:ajax event="valueChange"/>
                                                </h:selectOneMenu>
                                                <h:selectOneMenu value="#{managedFactureVenteV2.reglement.statutPiece}" disabled="#{managedFactureVenteV2.reglement.statutPiece != constantes.STATUT_DOC_ATTENTE}">
                                                    <f:selectItem itemValue="#{constantes.STATUT_DOC_PAYER}" itemLabel="#{lab.LC_PFV_regler}" />
                                                    <f:selectItem itemValue="#{constantes.STATUT_DOC_ATTENTE}" itemLabel="#{lab.LC_PFV_en_attente}" />                                                    
                                                    <f:selectItem itemValue="#{constantes.STATUT_DOC_ENCOUR}" itemLabel="#{lab.LC_PFV_en_cours}" itemDisabled="true"/>                                                    
                                                </h:selectOneMenu>
                                                <h:panelGroup>
                                                    <h:inputText value="#{managedFactureVenteV2.reglement.numRefExterne}" style="width: 100px"/>
                                                    <p:commandButton id="save_mensualite_facture_vente" icon="ui-icon-circle-plus" value="#{lab.L_enregistrer}" style="float: right" oncomplete="collapseForm('mensualite_facture_vente')"
                                                                     update="form_mensualite_facture_vente :main_facture_vente:grp_btn_etat_facture_vente :main_facture_vente:chp_fv_net_a_payer" 
                                                                     actionListener="#{managedFactureVenteV2.saveNewReglement(false)}"/>
                                                </h:panelGroup> 
                                            </h:panelGrid>                                            
                                        </h:panelGrid>    
                                        <h:inputHidden id="input_hide_mensualite_facture_vente" value="#{managedFactureVenteV2.tabIds_mensualite}"/>
                                        <p:dataTable id="data_mensualite_facture_vente" value="#{managedFactureVenteV2.docVente.reglements}" var="men" rowKey="#{men.id}" 
                                                     rowIndexVar="menIdx" selectionMode="single" selection="#{managedReglementVente.selectedPiece}">
                                            <p:ajax event="rowSelect" global="false" listener="#{managedFactureVenteV2.loadOnViewMensualite}" oncomplete="collapseForm('mensualite_facture_vente')"
                                                    update=":main_facture_vente:tabview_facture_vente:blog_form_mensualite_facture_vente :main_facture_vente:tabview_facture_vente:zone_auteur_reg_fv"/>
                                            <p:ajax event="rowUnselect" global="false" listener="#{managedFactureVenteV2.unLoadOnViewMensualite}" oncomplete="collapseForm('mensualite_facture_vente')"
                                                    update=":main_facture_vente:tabview_facture_vente:blog_form_mensualite_facture_vente :main_facture_vente:tabview_facture_vente:zone_auteur_reg_fv"/>                                                                                           
                                            <p:column headerText="N°" width="20" style="text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                                                <f:facet name="header">
                                                    <p:contextMenu for="chp_view_id_pcr" event="left click" styleClass="context_menu">
                                                        <p:menuitem update="data_mensualite_facture_vente" global="false" value="#{lab.LC_PCV_voir_identifiant}" actionListener="#{men.setView_id(!men.view_id)}"/>
                                                    </p:contextMenu>
                                                    <h:outputText value="N°" id="chp_view_id_pcr" style="cursor: pointer"/>
                                                </f:facet>
                                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{men.new_}"/>
                                                <h:graphicImage library="icones" name="lock.png" width="15" height="15" rendered="#{men.verouille}"/>
                                                <h:outputText value="#{menIdx+1}" rendered="#{!men.view_id}"/>
                                                <h:outputText value="#{men.id}" rendered="#{men.view_id}"/>
                                                <h:panelGroup style="float: right">
                                                    <h:outputText title="#{lab.LC_PFV_comptabilise}" value="C" rendered="#{men.comptabilise}" styleClass="style_statut"/>
                                                </h:panelGroup>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PFV_mode_reglement}" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                                                <h:outputText value="#{men.model.designation}"/>
                                                <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_ATTENTE)?'inline-block':'none'}; width: 10px; height: 10px; background: #444;" title="#{lab.LC_PFV_en_attente_de_paiement}"></span>
                                                <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_ENCOUR)?'inline-block':'none'}; width: 10px; height: 10px; background: #f6a828" title="#{lab.LC_PFV_en_cours_paiement}"></span>
                                                <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_PAYER)?'inline-block':'none'}; width: 10px; height: 10px; background: #006666" title="#{lab.LC_PFA_piece_regler}"></span>
                                                <span style="display: #{(men.phasesReglement.size() gt 0)?'inline-block':'none'}; width: 10px; height: 10px; background: #99ccff" title="#{lab.LC_PFA_phase_reglement_generer}"></span>
                                                <h:graphicImage title="#{lab.LC_PFV_n_est_rattachee_aucune_retenue}" library="icones" name="alert.png" width="15" height="15" rendered="#{men.error()}" style="float: right"/>  
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PFV_piece_numero}" sortBy="#{men.datePiece}" style="text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                                                <h:outputText value="#{men.numeroPiece}"/>
                                                <h:outputText rendered="#{men.notifs.id gt 0}" value="A" styleClass="statut" title="#{lab.LC_PFV_paiement_lie_acompte} #{men.notifs.acompte.numRefrence}" style="float: right"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PFV_date_edition}" sortBy="#{men.datePiece}" style="text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}" rendered="#{!managedFactureVenteV2.displayDetailReglement}">
                                                <h:outputText value="#{men.datePiece}" converter="DDMMYYYY"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PFV_date_reglement}" sortBy="#{men.datePaimentPrevu}" style="text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}" rendered="#{!managedFactureVenteV2.displayDetailReglement}">
                                                <h:outputText value="#{(men.statutPiece eq constantes.STATUT_DOC_PAYER)?men.datePaiement:men.datePaimentPrevu}" converter="DATE"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PFV_caisses}" style="text-align: right" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}" rendered="#{!managedFactureVenteV2.displayDetailReglement}">
                                                <h:outputText value="#{men.caisse.intitule}" />
                                            </p:column>
                                            <p:column headerText="#{lab.L_montant}" style="text-align: right" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">                                                
                                                <h:outputText value="#{men.montant}" converter="#{managedFactureVenteV2.converter}"/>                                                
                                            </p:column>
                                            <p:column headerText="Auteur" style="width: 10%;text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}" rendered="#{managedFactureVenteV2.displayDetailReglement}">
                                                <h:outputText value="#{men.author.users.nomUsers}"/>
                                            </p:column>
                                            <p:column headerText="Date Save" style="width: 10%;text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}" rendered="#{managedFactureVenteV2.displayDetailReglement}">
                                                <h:outputText value="#{men.dateSave}" converter="DATETS"/>
                                            </p:column>
                                            <p:column headerText="Date Update" style="width: 10%;text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}" rendered="#{managedFactureVenteV2.displayDetailReglement}">
                                                <h:outputText value="#{men.dateUpdate}" converter="DATETS"/>
                                            </p:column>
                                            <p:column headerText="#{lab.L_reference}" style="text-align: right" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                                                <h:outputText value="#{men.referenceExterne}"/>
                                            </p:column>
                                            <p:column style="width: 5%;text-align: center" styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                                                <f:facet name="header">
                                                    <p:contextMenu for="btn_option_head_mensualite_facture_vente" event="left click" style="font-size: 0.8em;width: 220px">
                                                        <p:menuitem value="#{managedFactureVenteV2.displayDetailReglement?'Cacher':'Afficher'} l'auteur" icon="ui-icon-notice"
                                                                    actionListener="#{managedFactureVenteV2.setDisplayDetailReglement(!managedFactureVenteV2.displayDetailReglement)}"
                                                                    update="data_mensualite_facture_vente"/>
                                                    </p:contextMenu>
                                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_head_mensualite_facture_vente" type="button"/>
                                                </f:facet>
                                                <p:contextMenu for="btn_option_mensualite_facture_vente" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                                    <p:menuitem value="#{!men.comptabilise?lab.LCF_PMC_comptabiliser:lab.LC_PJV_annuler_comptabilise}" actionListener="#{managedFactureVenteV2.setSelectReglement(men)}" 
                                                                oncomplete="#{!men.comptabilise?'dlgComptabilisePiece.show()':'dlgUnComptabilisePiece.show()'}" icon="ui-icon-arrowthick-2-e-w" 
                                                                rendered="#{men.id gt 0 and (men.statutPiece==constantes.STATUT_DOC_PAYER)}"/> 
                                                    <p:menuitem icon="ui-icon-pin-s" value="#{lab.LC_PFV_lettre_piece}" actionListener="#{managedFactureVenteV2.lettrerCaisse(men)}" rendered="#{men.comptabilise}"/>
                                                    <p:menuitem value="#{((men.statutPiece==constantes.STATUT_DOC_PAYER) or (men.statutPiece==constantes.STATUT_DOC_ANNULE))?lab.LC_PFV_en_attente:lab.LCF_PRV_encaisser_valider}" 
                                                                icon="#{((men.statutPiece==constantes.STATUT_DOC_PAYER) or (men.statutPiece==constantes.STATUT_DOC_ANNULE))?'ui-icon-arrowreturnthick-1-s':'ui-icon-circle-check'}" rendered="#{men.id gt 0}"  
                                                                actionListener="#{managedFactureVenteV2.openConfirmPaiement(men, 'F', false)}" update=":main_facture_vente:grp_btn_etat_facture_vente data_mensualite_facture_vente"/>
                                                    <p:menuitem value="#{lab.LC_PFV_aller_retenue}" icon="ui-icon-arrowthick-1-e"   
                                                                actionListener="#{managedFactureVenteV2.onSelectDistantReglement(men)}"
                                                                rendered="#{accesPage.grh_prelvm_ret_ and men.model.typeReglement == constantes.MODE_PAIEMENT_SALAIRE}"/>
                                                    <p:menuitem value="#{lab.LC_PFV_aller_aux_cheques}" icon="ui-icon-arrowthick-1-e"  
                                                                actionListener="#{managedFactureVenteV2.onSelectDistantReglement(men)}"
                                                                rendered="#{accesPage.compta_view_reg_vente and men.model.typeReglement == constantes.MODE_PAIEMENT_BANQUE and men.phasesReglement.size() gt 0}"/>
                                                    <p:menuitem value="#{lab.LC_PFV_voir_compensation}" icon="ui-icon-arrowthick-1-e"  
                                                                actionListener="#{managedFactureVenteV2.onSelectDistantReglement(men)}"
                                                                rendered="#{accesPage.compta_view_reg_vente and men.model.typeReglement == constantes.MODE_PAIEMENT_COMPENSATION}"/>
                                                    <p:menuitem value="#{lab.LC_PFV_aller_acompte}" icon="ui-icon-arrowthick-1-e"  
                                                                actionListener="#{managedOperationClient.onSelectDistant(men.notifs.acompte)}"
                                                                rendered="#{accesPage.compta_ope_client and men.notifs.id gt 0}"/>
                                                    <p:menuitem value="#{lab.LC_PFV_annuler_phases}" icon="ui-icon-circle-close" title="#{lab.LC_PFV_annuler_toute_phases}"  
                                                                actionListener="#{managedReglementVente.openConfirmPaiement(men,'F', false)}"
                                                                rendered="#{men.model.typeReglement == constantes.MODE_PAIEMENT_BANQUE and men.phasesReglement.size() gt 0}"/>
                                                    <p:menuitem value="#{lab.LC_PFV_equilibrer}" icon="ui-icon-arrowthick-1-e" 
                                                                actionListener="#{managedCompensation.onSelectVente(men)}" update=":select_fv_compensation data_mensualite_facture_vente"
                                                                rendered="#{men.model.typeReglement == constantes.MODE_PAIEMENT_COMPENSATION}"/>
                                                    <p:separator style="width: 98%;margin: auto"/>
                                                    <p:menuitem value="#{lab.LC_PFV_dissocier}" icon="ui-icon-pin-w"
                                                                actionListener="#{managedReglementVente.dissocierNotif(men)}" rendered="#{men.notifs.id gt 0}"
                                                                update="data_mensualite_facture_vente"/>
                                                    <p:menuitem value="#{men.verouille?lab.LC_PA_deverouiller:lab.LC_PA_verouiller}" icon="#{men.verouille?'ui-icon-unlocked':'ui-icon-locked'}" 
                                                                actionListener="#{managedReglementVente.verouillerPieceReglementVente(men)}" update=":main_facture_vente:tabview_facture_vente:data_mensualite_facture_vente"/>
                                                    <p:separator />
                                                    <p:menuitem value="#{lab.LC_PFV_annuler_suspendre}" icon="ui-icon-circle-close" 
                                                                actionListener="#{managedReglementVente.setSelectedPiece(men)}" 
                                                                oncomplete="dlgAnnulerPcv.show()" />
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash"  
                                                                actionListener="#{managedFactureVenteV2.deleteBeanReglement_(men)}" oncomplete="dlgConfirmDeleteMensualite_.show()"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_mensualite_facture_vente" type="button"/>
                                            </p:column> 
                                            <p:column style="width: 5%;text-align: center"  styleClass="statut_#{managedFactureVenteV2.giveStringStatut(men.statutPiece)}">
                                                <f:facet name="header">
                                                    <h:selectBooleanCheckbox styleClass="chek_all_line_mensualite_facture_vente" value="false"
                                                                             onclick="selectionAllLineTab(#{managedFactureVenteV2.docVente.reglements.size()}, 'mensualite_facture_vente')">
                                                    </h:selectBooleanCheckbox>
                                                </f:facet>
                                                <h:selectBooleanCheckbox value="#{men.selectActif}" styleClass="chek_line_mensualite_facture_vente" 
                                                                         onclick="selectionLineTab(#{men.id}, 'mensualite_facture_vente')">
                                                </h:selectBooleanCheckbox>
                                            </p:column>
                                        </p:dataTable>
                                        <p:commandButton actionListener="#{managedFactureVenteV2.openDlgReglement()}" title="#{lab.LC_PFV_actualiser_liste_reglement}"
                                                         update="form_mensualite_facture_vente" icon="ui-icon-refresh" value="#{lab.L_actualiser}"/>
                                        <p:commandLink actionListener="#{managedFactureVenteV2.saveNewAllMensualite()}" update="form_mensualite_facture_vente" oncomplete="collapseForm('mensualite_facture_vente')" 
                                                       style="background: black;color: white;border: 2px solid #666; border-radius: 5px;margin-top: -15px;padding: 3px"
                                                       rendered="#{managedFactureVenteV2.newMensualite and managedFactureVenteV2.docVente.reglements.size() >0}" value="#{lab.LC_PFV_tout_enregistrer}"/>
                                    </p:outputPanel>
                                    <div style="clear: both"/>
                                    <div style="margin-bottom: -20px; font-size: 0.7em" align="right">
                                        <h:panelGroup  id="zone_auteur_reg_fv">
                                            <span>#{lab.L_par} </span>
                                            <h:outputText value="#{managedReglementVente.selectedPiece.author.users.nomUsers}" />
                                            <span>#{lab.L_le} </span>
                                            <h:outputText value="#{managedReglementVente.selectedPiece.dateUpdate}" converter="DATETIME" />
                                        </h:panelGroup>
                                    </div>
                                </p:tab>
                                <p:tab title="#{lab.LC_PFA_doc_lies} (#{managedFactureVenteV2.docVente.nbreLivraison+managedFactureVenteV2.docVente.nbreDocLie})" rendered="#{(managedFactureVenteV2.docVente.nbreLivraison+managedFactureVenteV2.docVente.nbreDocLie) gt 0}">                                    
                                    <p:dataTable value="#{managedFactureVenteV2.docVente.documents}" var="iLivr" rowKey="#{iLivr.id}" rowIndexVar="iLivrIdx"
                                                 id="data_livraison_facture_vente">
                                        <p:column width="35" headerText="N°" styleClass="statut_#{iLivr.statut}">
                                            <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{iLivr.cloturer}"/>  
                                            <span>#{iLivrIdx+1}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_reference}" styleClass="statut_#{iLivr.statut}">
                                            <span>#{iLivr.numDoc}</span>
                                            <h:outputText value="vide" style="float: right;color: blue;font-style: italic;font-size: 0.8em" rendered="#{0>=iLivr.contenus.size()}"/>                                   
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PCV_date_doc}" style="text-align: center" styleClass="statut_#{iLivr.statut}">
                                            <h:panelGroup rendered="#{iLivr.statut == constantes.ETAT_VALIDE}">
                                                <h:outputText value="#{iLivr.dateLivraison}" converter="DDMMYYYY"/>
                                                <span> #{lab.L_a} </span>
                                                <h:outputText value="#{iLivr.heureDoc}" converter="TIME"/>
                                            </h:panelGroup>
                                            <h:outputText value="#{lab.LC_PCV_non_livre}" rendered="#{iLivr.statut != constantes.ETAT_VALIDE}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.L_tranche}" style="text-align: center" styleClass="statut_#{iLivr.statut}">
                                            <h:outputText value="#{iLivr.trancheLivrer.heureDebut}" converter="TIME"/>
                                            <span> - </span>
                                            <h:outputText value="#{iLivr.trancheLivrer.heureFin}" converter="TIME"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PCV_depot}" styleClass="statut_#{iLivr.statut}"> 
                                            <span>#{iLivr.depotLivrer.designation}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_type}" styleClass="statut_#{iLivr.statut}" style="text-align: center">
                                            <span >#{iLivr.typeDoc}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PCV_auteur}" styleClass="statut_#{iLivr.statut}">
                                            <h:outputText value="#{iLivr.author.users.nomUsers}" rendered="#{iLivr.statut!=constantes.STATUT_DOC_VALIDE}"/>
                                            <h:outputText value="#{iLivr.livreur.nomUsers}" rendered="#{iLivr.statut==constantes.STATUT_DOC_VALIDE and iLivr.typeDoc==constantes.TYPE_BLV}"/>
                                            <h:outputText value="#{iLivr.validerBy.nomUsers}" rendered="#{iLivr.statut==constantes.STATUT_DOC_VALIDE and (iLivr.typeDoc==constantes.TYPE_FAV or iLivr.typeDoc==constantes.TYPE_BRV)}"/>
                                        </p:column>
                                        <p:column style="width: 5%;text-align: center" styleClass="statut_#{iLivr.statut}">
                                            <p:contextMenu for="btn_option_livraison_facture_vente" event="left click" style="font-size: 0.8em; width: 220px" styleClass="context_menu">                                 
                                                <p:menuitem value="#{lab.LC_PCV_valider}" icon="ui-icon-circle-check" actionListener="#{managedFactureVenteV2.onValideDistantLivraison(iLivr)}" 
                                                            update="data_livraison_facture_vente :main_facture_vente:data_facture_vente" rendered="#{iLivr.statut != constantes.ETAT_VALIDE and iLivr.typeDoc ne constantes.TYPE_BCV}"/>
                                                <p:menuitem value="#{lab.L_annuler}" icon="ui-icon-circle-triangle-w" actionListener="#{managedFactureVenteV2.onAnnulerDistantLivraison(iLivr)}" 
                                                            update="data_livraison_facture_vente :main_facture_vente:data_facture_vente" rendered="#{iLivr.statut != constantes.ETAT_EDITABLE and iLivr.typeDoc ne constantes.TYPE_BCV}"/>
                                                <p:menuitem value="#{lab.LC_PFV_suspendre}" icon="ui-icon-circle-close" actionListener="#{managedFactureVenteV2.onRefuserDistantLivraison(iLivr)}" 
                                                            update="data_livraison_facture_vente :main_facture_vente:data_facture_vente" rendered="#{false  and iLivr.typeDoc ne constantes.TYPE_BCV}"/>
                                                <p:separator style="width: 98%;margin: auto" rendered="#{iLivr.typeDoc ne constantes.TYPE_BCV}"/>
                                                <p:menuitem value="#{lab.L_aller_a}" icon="ui-icon-arrowthick-1-e" global="false" actionListener="#{managedFactureVenteV2.onSelectDistantLivraison(iLivr)}"/>
                                                <p:separator rendered="#{iLivr.typeDoc ne constantes.TYPE_BCV}"/>
                                                <p:separator />
                                                <p:menuitem value="#{lab.L_telecharger}" icon="ui-icon-circle-arrow-s" global="false"  actionListener="#{managedFactureVenteV2.onPrintDistant(iLivr)}" ajax="false"/>
                                                <p:menuitem value="#{lab.L_telecharger_sans_entete}" icon="ui-icon-circle-arrow-s" global="false"  actionListener="#{managedFactureVenteV2.onPrintDistant(iLivr, false)}" ajax="false"/>
                                                <p:separator rendered="#{iLivr.typeDoc ne constantes.TYPE_BCV}"/>
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanLie(iLivr)}" oncomplete="dlgConfirmDeleteLie.show()"
                                                            rendered="#{iLivr.typeDoc ne constantes.TYPE_BCV}"/>
                                            </p:contextMenu>                           
                                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_livraison_facture_vente" type="button"/>
                                        </p:column> 
                                    </p:dataTable>
                                    <p:commandButton actionListener="#{managedFactureVenteV2.openDocumentLies()}" title="#{lab.LC_PFV_actualiser_liste_reglement}"
                                                     update="data_livraison_facture_vente" icon="ui-icon-refresh" value="#{lab.L_actualiser}"/>

                                </p:tab>
                                <p:tab title="#{lab.LC_PFV_commerciaux} (#{managedFactureVenteV2.docVente.nbreCommerciaux})" id="blog_commerciaux_vente">
                                    <h:panelGrid id="form_commercial_vente" columns="4" cellpadding="0" cellspacing="0">
                                        <p:commandButton icon="ui-icon-person" style="width: 20px;height: 20px;float: left;margin-top: -2px;margin-right: 10px;background: white!important" 
                                                         title="#{lab.LC_PFV_inserer_vendeur_comme_commercial}" actionListener="#{managedFactureVenteV2.saveCurrentCommercial(true)}"
                                                         update=":main_facture_vente:tabview_facture_vente:data_commercial_vente"/>
                                        <h:panelGroup id="select_commercial_vente">
                                            <h:inputText value="#{managedFactureVenteV2.commercial.commercial.code}" style="color: #{managedFactureVenteV2.commercial.commercial.error?'red':''}"
                                                         title="#{lab.LC_PFV_saisir_entrer_commerciaux}">
                                                <p:ajax event="valueChange" listener="#{managedFactureVenteV2.searchCommercial()}" update="tabview_facture_vente:select_commercial_vente"/>
                                            </h:inputText> 
                                            <h:outputText id="txt_commercial_vente" value="#{managedFactureVenteV2.commercial.commercial.nomPrenom}" style="margin-left: 5px; color: #006666;font-weight: bold"/>
                                            <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PFV_liste_commerciaux}" global="false"
                                                             onclick="dlgListCommerciaux.show()"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <span>#{lab.L_valeur} </span>
                                            <h:inputText id="txt-taux_commercial_vente" value="#{managedFactureVenteV2.commercial.taux}" style="width: 100px;text-align: center" title="#{lab.LC_PFV_taux_participation}">
                                                <p:ajax event="valueChange" global="false" listener="#{managedFactureVenteV2.onTauxCommercialBlur()}"/>
                                            </h:inputText>%
                                        </h:panelGroup>
                                        <p:commandButton icon="ui-icon-circle-plus" value="#{lab.L_enregistrer}" style="float: right;margin-left: 10px" oncomplete="collapseForm('commercial_vente')"
                                                         actionListener="#{managedFactureVenteV2.saveNewCommercial()}"/>
                                    </h:panelGrid>
                                    <h:inputHidden id="input_hide_commercial_vente" value="#{managedFactureVenteV2.tabIds_commercial}"/>
                                    <p:dataTable id="data_commercial_vente" value="#{managedFactureVenteV2.docVente.commerciaux}" var="com" rowKey="#{com.id}" selectionMode="single">
                                        <p:ajax event="rowSelect" listener="#{managedFactureVenteV2.loadOnViewCommercialVente}" oncomplete="collapseForm('commercial_vente')"
                                                update=":main_facture_vente:tabview_facture_vente:form_commercial_vente :main_facture_vente:tabview_facture_vente:txt_commercial_vente"/>
                                        <p:ajax event="rowUnselect" listener="#{managedFactureVenteV2.unLoadOnViewCommercialVente}" oncomplete="collapseForm('commercial_vente')" 
                                                update=":main_facture_vente:tabview_facture_vente:form_commercial_vente :main_facture_vente:tabview_facture_vente:txt_commercial_vente"/>
                                        <p:column headerText="#{lab.LC_PFV_commercial}" >
                                            <span>#{com.commercial.nom_prenom}</span>
                                            <h:graphicImage library="img" name="connecte.png" rendered="#{com.responsable}" width="15" height="15" title="#{lab.LC_PFV_responsable_principale_facture}" style="float: right"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LC_PFV_taux}" style="text-align: right;width: 15%">
                                            <h:outputText value="#{com.taux}" converter="DNS"/>
                                            %
                                        </p:column>                             
                                        <p:column width="20" style="text-align: center">
                                            <p:contextMenu for="btn_option_commercial_vente" event="left click" style="font-size: 0.8em">
                                                <p:menuitem value="#{lab.LC_PFV_set_responsable}" icon="ui-icon-star" global="false" actionListener="#{managedFactureVenteV2.definedResponsable(com)}" update="data_commercial_vente"/>
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedFactureVenteV2.deleteBeanCommercial_(com)}" oncomplete="dlgConfirmDeleteCommercial_.show()"/>
                                            </p:contextMenu>                           
                                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_commercial_vente" type="button"/>
                                        </p:column> 
                                    </p:dataTable>
                                    <p:commandButton actionListener="#{managedFactureVenteV2.openDlgCommerciaux()}" title="#{lab.LC_PFV_actualiser_liste_commerciaux}"
                                                     update="data_commercial_vente" icon="ui-icon-refresh" value="#{lab.L_actualiser}"/>
                                </p:tab>  
                            </p:tabView>
                            <p:outputPanel id="form_avance_commande">
                                <p:outputPanel rendered="#{managedFactureVenteV2.checkAvance}" style="font-size: medium">
                                    <fieldset class="header-panel">
                                        <legend>#{lab.LC_PFV_avance} </legend>
                                        <span>#{managedFactureVenteV2.avance.numeroPiece}</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedFactureVenteV2.avance.montant}" converter="#{managedFactureVenteV2.converter}" style="font-weight: bold"/>
                                            <span> #{managedFactureVenteV2.currentScte.devise}</span>
                                        </h:panelGroup>
                                    </fieldset>
                                </p:outputPanel>
                            </p:outputPanel>
                        </h:panelGrid>
                    </p:outputPanel>
                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="part_list">
                    <div class="yvs_list_facture_vente" style="width: 99%; margin: auto; background: white">
                        <p:outputPanel id="data_facture_vente">
                            <ui:include src="../../gescom/vente/facture/list_facture.xhtml" />   
                            <span class="nbSelectfacture_vente" style="font-size: .8em; font-style: italic; color: #828c95;"></span>
                            <p:outputPanel autoUpdate="true" style="float: right;" layout="block" >
                                <p:commandButton actionListener="#{managedFactureVenteV2.init(false)}"  update="data_facture_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedFactureVenteV2.paginator.disPrev}"/>
                                <p:outputPanel >
                                    <p:inplace label="#{managedFactureVenteV2.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                        <pe:inputNumber value="#{managedFactureVenteV2.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                            <p:ajax event="valueChange" listener="#{managedFactureVenteV2.gotoPagePaginator()}" update="data_facture_vente"/>
                                        </pe:inputNumber>
                                    </p:inplace><p:outputLabel value="/#{managedFactureVenteV2.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                                </p:outputPanel>
                                <p:commandButton actionListener="#{managedFactureVenteV2.init(true)}"  update="data_facture_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedFactureVenteV2.paginator.disNext}"/>
                                <p:selectOneMenu value="#{managedFactureVenteV2.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedFactureVenteV2.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                    <f:selectItems value="#{managedFactureVenteV2.paginations}"/>
                                    <p:ajax event="valueChange"  update="data_facture_vente"  />
                                </p:selectOneMenu>
                            </p:outputPanel> 
                        </p:outputPanel>
                    </div>            

                    <!-->
                     *****************************************************************************
                     Vue Grid
                     *****************************************************************************
                    <-->
                    <div class="yvs_grid_facture_vente" style="width: 99%; margin: auto; background: white">
                        <p:dataTable id="data_contenu_fv" value="#{managedFactureVenteV2.all_contenus}" var="artf" rowKey="#{artf.id}" rowIndexVar="artfIdx"
                                     selectionMode="single">
                            <p:ajax event="rowSelect"  listener="#{managedFactureVenteV2.loadOnViewContent}" oncomplete="collapseForm('facture_vente');collapseForm('contenu_facture_vente');collapseForm('cout_facture_vente');collapseForm('mensualite_facture_vente')"/>                                
                            <p:column headerText="N°" style="width: 5%;" styleClass="statut_#{artf.statutLivree}">
                                <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{artf.new_}"/>
                                <span title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artfIdx+1}</span>
                                <h:panelGroup style="float: right">                                      
                                    <h:graphicImage library="icones" name="alert_info.png" width="15" height="15" rendered="#{navigations.isAlerte(artf.id, constantes.DOCUMENT_LOWER_MARGIN)}" style="float: right" title="Alerte sur cette ligne"/>
                                    <h:graphicImage library="img" name="danger.png" rendered="#{artf.errorComptabilise}" width="23" height="23" title="#{artf.messageError}"/>
                                    <h:graphicImage library="img" name="comment.png" width="15" height="15" rendered="#{artf.onComment}" title="#{lab.LC_PRA_commenté}"/>
                                </h:panelGroup>
                            </p:column>
                            <p:column headerText="#{lab.L_reference}" styleClass="statut_#{artf.statutLivree}">
                                [<span title="#{lab.LC_PCV_numero_serie}: #{artf.numSerie}" style="font-weight: bold">#{artf.article.refArt}</span>]
                                <h:outputText title="#{lab.LC_PFV_facture_consignee}" value="C" rendered="#{artf.idReservation ne null}"
                                              style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 1px;background: black;color: white; float: right"/>
                            </p:column>
                            <p:column headerText="#{lab.L_article}" styleClass="statut_#{artf.statutLivree}">
                                <span title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artf.article.designation}</span>
                            </p:column>
                            <p:column headerText="#{lab.L_qte}" style="width: 8%;" styleClass="statut_#{artf.statutLivree}">
                                <h:outputText value="#{artf.quantite}" converter="#{managedFactureVenteV2.converterStock}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}" style="margin-left: 2px"/>
                                <span title="#{artf.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{artf.conditionnement.unite.reference}</span>
                                <h:panelGroup style="float: right">
                                    <h:outputText value="#{artf.quantiteBonus}" converter="#{managedFactureVenteV2.converterStock}" title="#{lab.LC_PFA_quantite_bonus}" style="font-style: italic;color: blue;font-size: 0.9em;margin-right: 2px"/>
                                </h:panelGroup>
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_prix_u}" width="80" styleClass="statut_#{artf.statutLivree}">
                                <h:outputText value="#{artf.prix}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}" style="margin-left: 2px"/>                              
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_facture}" style="width: 18%;" styleClass="statut_#{artf.statutLivree}">
                                <span title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artf.docVente.numDoc}</span>
                                <h:panelGroup style="float: right">
                                    <h:outputText title="#{lab.LC_PBRA_facture_reglee}" value="R" rendered="#{artf.docVente.statutRegle == constantes.ETAT_REGLE}"
                                                  styleClass="style_statut"/>
                                    <p:spacer width="2" rendered="#{artf.docVente.statutLivre == constantes.ETAT_LIVRE}"/>
                                    <h:outputText title="#{lab.LC_PBRA_facture_livree}" value="L" rendered="#{artf.docVente.statutLivre == constantes.ETAT_LIVRE}"
                                                  styleClass="style_statut"/>
                                    <p:spacer width="2" rendered="#{artf.docVente.consigner}"/>
                                    <h:outputText title="#{lab.LC_PCV_stock_facture_consigne}" value="C" rendered="#{managedFactureVenteV2.isConsigner(artf.docVente)}"
                                                  styleClass="style_statut"/>
                                </h:panelGroup>
                            </p:column>
                            <p:column headerText="#{lab.LC_PCV_client}" style="width: 15%;" styleClass="statut_#{artf.statutLivree}">
                                <h:outputText value="#{artf.docVente.nom_client}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                            </p:column>
                            <p:column headerText="#{lab.LC_PFV_vendeur}" style="width: 15%;" styleClass="statut_#{artf.statutLivree}">
                                <h:outputText value="#{artf.docVente.enteteDoc.creneau.users.nomUsers}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                            </p:column>
                            <p:column headerText="#{lab.L_total}" style="width: 12%;text-align: right" styleClass="statut_#{artf.statutLivree}">
                                <h:outputText value="#{artf.prixTotal}" converter="#{managedFactureVenteV2.converter}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                            </p:column>
                            <p:column style="width: 5%;text-align: center">
                                <f:facet name="header">
                                    <p:contextMenu for="btn_option_head_contenu_fv" event="left click" style="font-size: 0.8em;width: 220px">
                                        <p:menuitem value="#{lab.LC_PFV_verifier_comptabilite}" icon="ui-icon-lightbulb" actionListener="#{managedFactureVenteV2.findAllContenusErrorComptabilite()}" update="data_contenu_fv"/>
                                    </p:contextMenu>
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_head_contenu_fv" type="button"/>
                                </f:facet>
                                <p:contextMenu for="btn_option_contenu_fv" event="left click" style="font-size: 0.8em;width: 220px">
                                    <p:menuitem value="Désactiver alerte" icon="ui-icon-cancel" actionListener="#{navigations.desactiveAlerte(artf.id, constantes.DOCUMENT_LOWER_MARGIN)}"
                                                rendered="#{navigations.isAlerte(artf.id, constantes.DOCUMENT_LOWER_MARGIN)}" update="data_contenu_fv"/>
                                    <p:menuitem value="#{lab.LC_PFV_taxes}" icon="ui-icon-copy" global="false" actionListener="#{managedFactureVenteV2.loadTaxesVente(artf)}" oncomplete="dlgListTaxesContenu.show()"/>
                                </p:contextMenu>                           
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_contenu_fv" type="button"/>
                            </p:column>
                        </p:dataTable>
                        <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                            <p:commandButton actionListener="#{managedFactureVenteV2.loadContenus(false, false)}" global="false" update="data_contenu_fv" icon="ui-icon-circle-triangle-w" disabled="#{managedFactureVenteV2.p_contenu.disPrev}"/>
                            <p:outputPanel >
                                <p:inplace label="#{managedFactureVenteV2.p_contenu.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                    <pe:inputNumber value="#{managedFactureVenteV2.p_contenu.page}" style="width: 30px;text-align: center" decimalPlaces="0">
                                        <p:ajax event="valueChange" listener="#{managedFactureVenteV2.gotoPagePaginatorContenu()}" update="data_contenu_fv"/>
                                    </pe:inputNumber>
                                </p:inplace><p:outputLabel value="/#{managedFactureVenteV2.p_contenu.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                            </p:outputPanel>
                            <p:commandButton actionListener="#{managedFactureVenteV2.loadContenus(true, false)}" global="false" update="data_contenu_fv" icon="ui-icon-circle-triangle-e" disabled="#{managedFactureVenteV2.p_contenu.disNext}"/>
                            <p:selectOneMenu value="#{managedFactureVenteV2.p_contenu.rows}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedFactureVenteV2.choosePaginatorContenu}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                <f:selectItems value="#{managedFactureVenteV2.paginations}"/>
                                <p:ajax event="valueChange" global="false" update="data_contenu_fv" />
                            </p:selectOneMenu>
                        </p:outputPanel>  
                    </div>
                </div> 
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">            
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative; bottom: -20px" width="20" height="20"
                            styleClass="img_slide" title="cacher"/>  
            <div class="zone_find">
                <div class="display_auteur" align="right"  style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedFactureVenteV2.selectDoc.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedFactureVenteV2.selectDoc.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedFactureVenteV2.selectDoc.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <ui:include src="../../gescom/vente/facture/search_v2.xhtml" />
            </div>
        </h:form>
    </ui:define>
</ui:composition>
