<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Commandes Vente','modGescom', 'smenBonCommandVente', true,managedBonVente)}
    </ui:define> 
    <ui:define name="contents"> 
        <style type="text/css">
            .part_fix{
                height: 70px !important;
            }
        </style>
        #{managedTiers.doNothing()}        
        #{navigations.doNothing()}
        #{managedFactureVente.doNothing()}
        #{managedFactureVenteV2.doNothing()}
        #{managedLivraisonVente.doNothing()}
        #{managedStockArticle.load(false)}

        #{managedPointVente.loadPointVenteByDroit(true, true)}
        #{managedBonVente.loadAll()}
        #{managedReglementVente.loadAll()}
        #{managedDepot.loadAllDepotActif(true)}
        #{managedCategorieClt.loadAllCategorie()}
        #{managedCaisses.loadAllCaisseActif(true)}  
        #{managedModeReglement.loadModels('C')}
        #{managedRemise.loadAllRemise()}
        #{managedCatCompt.loadAllCategorieVente()}
        #{managedClient.loadActifClient(true)}
        #{managedTiersTemplate.loadTemplate('C')}  
        #{managedVente.loadAll(constantes.TYPE_BCV)}
        #{Mdico.loadPays()}
        #{Mdico.loadVilles()}  
        <script type="text/javascript">
            $(function() {
                collapseForm('commande_vente');
                collapseForm('contenu_commande_vente');
                collapseForm('mensualite_commande_vente');
                collapseForm('reglement_vente');
                collapseForm('remise_vente');
                collapseList('livraison_vente_');
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
            });
        </script>

        <h:form>
            <p:remoteCommand name="updateBeanCaisse_" actionListener="#{managedBonVente.updateBean()}"/>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dgvTraitementLot" closeOnEscape="true" header="Traitement par lot" width="35%"
                      height="120">
                <h:panelGrid id="main-traitement-lot" columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:selectBooleanCheckbox value="#{managedBonVente.lotBC}"> 
                        <p:ajax event="valueChange" update="traitement-lot-bc"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-bc">
                        <span style="font-weight: bold">Commande </span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedBonVente.statutLotBC}" disabled="#{!managedBonVente.lotBC}">
                                <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                                <f:selectItem itemLabel="#{lab.L_livrer}" itemValue="#{constantes.ETAT_LIVRE}"/>
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:selectBooleanCheckbox value="#{managedBonVente.lotFV}"> 
                        <p:ajax event="valueChange" update="traitement-lot-fv"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-fv">
                        <span style="font-weight: bold">Facture </span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedBonVente.statutLotFV}" disabled="#{!managedBonVente.lotFV}">
                                <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_supprimer.toUpperCase()}" itemValue="D"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:selectBooleanCheckbox value="#{managedBonVente.lotBL}"> 
                        <p:ajax event="valueChange" update="traitement-lot-bl"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-bl">
                        <span style="font-weight: bold">Bon de livraison </span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedBonVente.statutLotBL}" disabled="#{!managedBonVente.lotBL}">
                                <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_supprimer.toUpperCase()}" itemValue="D"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                    <h:selectBooleanCheckbox value="#{managedBonVente.lotPiece}"> 
                        <p:ajax event="valueChange" update="traitement-lot-piece"/>
                    </h:selectBooleanCheckbox> 
                    <h:panelGroup id="traitement-lot-piece">
                        <span style="font-weight: bold">Pièce de règlement</span>
                        <h:panelGroup >
                            <span>--> </span>
                            <h:selectOneMenu value="#{managedBonVente.statutLotPiece}" disabled="#{!managedBonVente.lotPiece}">
                                <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.ETAT_REGLE}"/>
                                <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                                <f:selectItem itemLabel="#{lab.L_supprimer.toUpperCase()}" itemValue="D"/>
                            </h:selectOneMenu>
                        </h:panelGroup>
                    </h:panelGroup>
                </h:panelGrid>
                <f:facet name="footer">
                    <h:panelGroup style="float: right">
                        <p:commandButton value="#{lab.LC_PFV_lancer}" actionListener="#{managedBonVente.traitementLot()}" oncomplete="dgvTraitementLot.hide()"/>
                        <p:commandButton type="button"  value="#{lab.L_annuler}" onclick="dgvTraitementLot.hide()"/>
                    </h:panelGroup>
                </f:facet>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmValidAll" closeOnEscape="true" header="#{lab.L_confirmation}" message="Êtes vous sur de vouloir valider?">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedBonVente.validerOrderAll()}" oncomplete="dlgConfirmValidAll.hide()"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmValidAll.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog widgetVar="dlgConfirmLivrerAll" closeOnEscape="true" header="#{lab.L_confirmation}" message="Êtes vous sur de vouloir livrer?">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedBonVente.transmisOrderAll()}" oncomplete="dlgConfirmLivrerAll.hide()"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmLivrerAll.hide()"/>
            </p:confirmDialog>
            <p:dialog hideEffect="explode" widgetVar="dlgConfirmAnnulerCmde" closeOnEscape="true" header="#{lab.L_confirmation}" resizable="false">
                <span>#{lab.LC_PCV_text13}</span>
                <h:panelGrid id="blog-annule_bcv" columns="3" styleClass="yvs_nostyle">
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleCmde}" label="#{lab.LC_PCV_annuler_commande}" rendered="#{managedBonVente.visibleCmde}">
                        <p:ajax event="valueChange" global="false"/>
                    </p:selectBooleanCheckbox>
                    <h:outputText value="#{lab.LC_PCV_annuler_commande}" rendered="#{managedBonVente.visibleCmde}"/>
                    <p:outputLabel rendered="#{managedBonVente.visibleCmde}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleFact}" label="#{lab.LC_PCV_annuler_facture}" rendered="#{managedBonVente.visibleFact}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PCV_annuler_facture}" rendered="#{managedBonVente.visibleFact}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteFact}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleFact}">
                        <p:ajax event="valueChange" global="false"/>
                    </p:selectBooleanCheckbox>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleLivr}" label="#{lab.LC_PCV_annuler_livraison}" rendered="#{managedBonVente.visibleLivr}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PCV_annuler_livraison}" rendered="#{managedBonVente.visibleLivr}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteLivr}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleLivr}">
                        <p:ajax event="valueChange" global="false"/>
                    </p:selectBooleanCheckbox>
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleRegl}" label="#{lab.LC_PCV_annuler_reglement}" rendered="#{managedBonVente.visibleRegl}">
                        <p:ajax event="valueChange" global="false"/>
                    </p:selectBooleanCheckbox>
                    <h:outputText value="#{lab.LC_PCV_annuler_reglement}" rendered="#{managedBonVente.visibleRegl}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteRegl}" itemLabel="#{lab.L_supprimer} ?" rendered="#{managedBonVente.visibleRegl}">
                        <p:ajax event="valueChange" global="false"/>
                    </p:selectBooleanCheckbox>
                </h:panelGrid>
                <f:facet name="footer">
                    <div align="right">
                        <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.annulerOrderForce()}" oncomplete="dlgConfirmAnnulerCmde.hide();collapseForm('commande_vente')"/>
                        <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAnnulerCmde.hide()"/>                        
                    </div>
                </f:facet>
            </p:dialog>
            <p:dialog hideEffect="explode" widgetVar="dlgConfirmAnnulerCmdeAll" closeOnEscape="true" header="#{lab.L_confirmation}" resizable="false">
                <span>#{lab.LC_PCV_text13}</span>
                <h:panelGrid columns="3" styleClass="yvs_nostyle">
                    <p:selectBooleanCheckbox value="#{managedBonVente.annuleCmdeAll}" label="#{lab.LC_PCV_annuler_commande}"/>
                    <h:outputText value="#{lab.LC_PCV_annuler_commande}"/>
                    <p:outputLabel/>
                    <p:selectBooleanCheckbox value="true" label="#{lab.LC_PCV_annuler_facture}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PCV_annuler_facture}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteFactAll}" itemLabel="#{lab.L_supprimer} ?"/>
                    <p:selectBooleanCheckbox value="true" label="#{lab.LC_PCV_annuler_livraison}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PCV_annuler_livraison}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteLivrAll}" itemLabel="#{lab.L_supprimer} ?"/>
                    <p:selectBooleanCheckbox value="false" label="#{lab.LC_PCV_annuler_reglement}" disabled="true"/>
                    <h:outputText value="#{lab.LC_PCV_annuler_reglement}"/>
                    <p:selectBooleanCheckbox value="#{managedBonVente.deleteReglAll}" itemLabel="#{lab.L_supprimer} ?"/>
                </h:panelGrid>
                <f:facet name="footer">
                    <div align="right">
                        <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.annulerOrderForceAll()}" oncomplete="dlgConfirmAnnulerCmdeAll.hide()"/>
                        <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAnnulerCmdeAll.hide()"/>                        
                    </div>
                </f:facet>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_details_annulation}" widgetVar="dlgAnnuleCommande" modal="true" closeOnEscape="true"> 
                <h:panelGrid columns="3" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_date}"/>
                    <h:outputText value="#{lab.LC_PCV_caisse}"/>
                    <h:outputText value=""/>
                    <p:calendar value="#{managedBonVente.dateAnnule}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                    <h:selectOneMenu value="#{managedBonVente.caisseAnnule.id}" style="min-width: 160px">
                        <f:selectItem itemLabel="" itemValue="0" />
                        <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}" itemValue="#{icaiss.id}" />
                        <p:ajax event="valueChange" listener="#{managedBonVente.chooseCaisseAnnule()}"/>
                    </h:selectOneMenu>  
                    <p:commandButton icon="ui-icon-disk" value="#{lab.L_enregistrer}" actionListener="#{managedBonVente.refuserOrder()}" oncomplete="dlgAnnuleCommande.hide()"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false" id="main_zone_bcv">
            <p:dialog header="#{lab.LC_PCV_creation_zone}" widgetVar="dlgAddZone" modal="true" width="30%"  closeOnEscape="true"> 
                <h:panelGrid id="form_zone_bcv" columns="2" styleClass="yvs_table" style="width: 100%;margin: auto" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGroup style="float: left">
                            <span>Titre </span>
                            <h:selectOneMenu value="#{Mdico.dictionnaire.titre}">                   
                                <f:selectItem itemLabel="--" itemValue="#{null}"/>                    
                                <f:selectItem itemLabel="#{constantes.t_VILLES}" itemValue="#{constantes.t_VILLES}"/>                    
                                <f:selectItem itemLabel="#{constantes.t_SECTEURS}" itemValue="#{constantes.t_SECTEURS}"/>                    
                                <p:ajax event="valueChange" global="false" listener="#{Mdico.chooseTitre()}" update="txt_parent_zone_bcv"/>
                            </h:selectOneMenu>    
                        </h:panelGroup>
                    </f:facet>
                    <span>#{lab.LC_PCV_abbreviation}</span>
                    <h:inputText value="#{Mdico.dictionnaire.abreviation}" style="width: 100%"/>
                    <span>#{lab.L_libelle}</span>
                    <h:inputText value="#{Mdico.dictionnaire.libelle}" style="width: 100%"/> 
                    <span>#{lab.L_parent}</span>
                    <h:selectOneMenu value="#{Mdico.dictionnaire.parent.id}" id="txt_parent_zone_bcv" style="width: 100%">
                        <f:selectItem itemLabel="--" itemValue="0"/>                    
                        <f:selectItems value="#{Mdico.parents}" var="dP"
                                       itemLabel="#{dP.libele}" itemValue="#{dP.id}"/>                    
                    </h:selectOneMenu> 
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" update="form_zone_bcv :main_commande_vente:txt_zone_client_bcv"
                                 actionListener="#{managedBonVente.saveZone()}" oncomplete="dlgAddZone.hide()"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue des taxes d'un contenu
        *****************************************************************************
        <-->  
        <h:form id="data_taxes_contenu_commande_vente" prependId="false">
            <p:dialog header="#{lab.LC_PCV_taxes_sur_article} '#{managedBonVente.contenu.name}'" widgetVar="dlgListTaxesContenu" modal="true" width="50%"  closeOnEscape="true"> 
                <p:dataTable value="#{managedBonVente.contenu.taxes}" var="tx" rowKey="#{tx.id}">
                    <p:column headerText="#{lab.L_taxe}" >
                        <span>#{tx.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_taux}" style="text-align: right;width: 15%">
                        <h:outputText value="#{tx.taux}" converter="DNS"/>
                        %
                    </p:column>
                    <p:column headerText="#{lab.L_montant}" style="text-align: right;width: 35%">
                        <h:outputText value="#{tx.totalMontant}" converter="#{managedBonVente.converter}"/>
                        Fcfa
                    </p:column>
                </p:dataTable>  
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue d'ajout des commentaires
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_commentaire}" widgetVar="dlgAddCommentaire" modal="true" width="26%"  closeOnEscape="true"> 
                <h:inputTextarea value="#{managedBonVente.commentaire}" style="width: 99%" rows="5" id="txt_commentaire_contenu_commande_vente"/>
                <p:commandButton actionListener="#{managedBonVente.addCommentaireContenu()}" style="width: 99%"
                                 oncomplete="dlgAddCommentaire.hide()" value="Enregistrer"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PCV_numero_serie}" widgetVar="dlgAddNumSerie" modal="true" width="26%"  closeOnEscape="true"> 
                <h:inputText value="#{managedBonVente.numSerie}" style="width: 99%;text-align: center" id="txt_num_serie_contenu_commande_vente"/>
                <p:commandButton actionListener="#{managedBonVente.addNumSerieContenu()}" style="width: 99%"
                                 oncomplete="dlgAddNumSerie.hide()" value="Enregistrer"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PCV_montant_rabais}" widgetVar="dlgAddRabais" modal="true" width="40%"  closeOnEscape="true"> 
                <h:panelGrid id="txt_rabais_contenu_commande_vente" columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.LC_PCV_rabais_prix}"/>
                    <h:outputText value="#{lab.LC_PCV_rabais_total} "/>
                    <pe:inputNumber id="txt_rabais_contenu_bcv_1" value="#{managedBonVente.montant_rabais}" style="width: 99%;text-align: right">
                        <p:ajax event="blur" global="false" listener="#{managedBonVente.onRabaisBlur(false)}" update="txt_rabais_contenu_bcv_1"/>
                    </pe:inputNumber>
                    <pe:inputNumber id="txt_rabais_contenu_bcv_2" value="#{managedBonVente.montant_rabais_total}" style="width: 99%;text-align: right">
                        <p:ajax event="blur" global="false" listener="#{managedBonVente.onRabaisBlur(true)}" update="txt_rabais_contenu_bcv_1"/>
                    </pe:inputNumber>
                    <f:facet name="footer">
                        <h:inputTextarea value="#{managedBonVente.commentaire}" style="width: 99%" rows="5"/>
                    </f:facet>
                </h:panelGrid>
                <p:commandButton actionListener="#{managedBonVente.addRabaisContenu()}" style="width: 99%"
                                 oncomplete="dlgAddRabais.hide()" value="Enregistrer"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
            <p:dialog header="#{lab.LC_PCV_montant_remise}" widgetVar="dlgAddRemise" modal="true" width="25%"  closeOnEscape="true"> 
                <h:panelGrid id="txt_remise_contenu_commande_vente" columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <pe:inputNumber id="txt_remise_contenu_bcv_1" value="#{managedBonVente.montant_remise}" style="text-align: right"
                                    title="#{lab.LC_PCV_remise_valeur}">
                        <p:ajax event="blur" global="false" listener="#{managedBonVente.onRemiseBlur(false)}" update="txt_remise_contenu_bcv_2"/>
                    </pe:inputNumber>                    
                    <pe:inputNumber id="txt_remise_contenu_bcv_2" value="#{managedBonVente.taux_remise}" symbol="%" symbolPosition="suffixe" 
                                    style="margin-right: 2px;float: right;width: 90%;text-align: right" title="#{lab.LC_PCV_remise_pourcentage}">
                        <p:ajax event="blur" global="false" listener="#{managedBonVente.onRemiseBlur(true)}" update="txt_remise_contenu_bcv_1 @this"/>
                    </pe:inputNumber>                    
                </h:panelGrid>
                <p:commandButton actionListener="#{managedBonVente.addRemiseContenu()}" style="width: 99%"
                                 oncomplete="dlgAddRemise.hide()" value="#{lab.L_enregistrer}"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des tranches horaires
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_liste_tranches_depot}" widgetVar="dlgListTranche" modal="true" width="40%"  closeOnEscape="true"> 
                <p:dataTable id="data_tranche_bcv" value="#{managedBonVente.tranches}" var="trh" rowKey="#{trh.id}" selectionMode="single" rowIndexVar="line_trh">
                    <p:ajax event="rowSelect" global="false" listener="#{managedBonVente.loadOnViewTranche}" oncomplete="dlgListTranche.hide()"/>
                    <p:column headerText="N°" width="20">
                        <span>#{line_trh+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_titre}" width="130">
                        <span>#{trh.titre}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_heure_debut}" width="90">
                        <h:outputText value="#{trh.heureDebut}" converter="TIME"/>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_heure_fin}" width="90">
                        <h:outputText value="#{trh.heureFin}" converter="TIME"/>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *************************************BeanCaisse****************************************
        Boite de dialogue des articles
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_listes_articles}" widgetVar="dlgListArticle" modal="true" width="70%"  closeOnEscape="true" visible="false"> 
                <p:dataTable id="data_articles_commande_vente" value="#{managedStockArticle.articles}" var="art" rowKey="#{art.id}"
                             selectionMode="single" rowIndexVar="line_art">
                    <p:ajax event="rowSelect" global="false" listener="#{managedBonVente.loadOnViewArticle}" oncomplete="dlgListArticle.hide()"
                            update=":main_commande_vente:tabview_commande_vente:form_contenu_commande_vente"/>
                    <p:column headerText="N°" width="20">
                        <span title="#{art.designation}">#{line_art+1}</span>
                    </p:column>
                    <p:column filterBy="#{art.refArt}" width="80">
                        <span title="#{art.designation}">#{art.refArt}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_designation}" width="150">
                        <span title="#{art.designation}">#{art.designation}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_categorie}" width="80">
                        <span title="#{art.designation}">#{art.categorie}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_prix_a}" width="50" style="text-align: right">
                        <h:outputText value="#{art.pua}" title="#{art.designation}" converter="#{managedBonVente.converter}" />
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_prix_v}" width="50" style="text-align: right">
                        <h:outputText value="#{art.puv}" title="#{art.designation}" converter="#{managedBonVente.converter}" />
                    </p:column>
                </p:dataTable>
                <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                    <p:commandButton actionListener="#{managedStockArticle.loadActifArticleByPoint(false, false)}" global="false" update="data_articles_commande_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedStockArticle.pv.disPrev}"/>
                    <p:outputPanel ><p:outputLabel value="#{managedStockArticle.pv.currentPage}/#{managedStockArticle.pv.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                    <p:commandButton actionListener="#{managedStockArticle.loadActifArticleByPoint(true, false)}" global="false" update="data_articles_commande_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedStockArticle.pv.disNext}"/>
                    <p:selectOneMenu value="#{managedStockArticle.nbMax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedStockArticle._choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px">
                        <f:selectItems value="#{managedStockArticle.paginations}"/>
                        <p:ajax event="valueChange" global="false" update="data_articles_commande_vente"/>
                    </p:selectOneMenu>
                </p:outputPanel>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>


        <!-->
        *****************************************************************************
        Boite de dialogue de mode de paiement
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_creation_model}" widgetVar="dlgAddModePaiement" modal="true" width="25%"  closeOnEscape="true"> 
                <h:panelGrid id="form_mode_paiement_bcv" columns="1" cellpadding="0" cellspacing="0" style="width: 100%">
                    <span>#{lab.L_designation} </span>
                    <h:inputText value="#{managedModeReglement.mode.designation}" style="width: 100%"/>
                    <span>#{lab.L_description} </span>
                    <h:inputTextarea value="#{managedModeReglement.mode.description}" rows="5" style="width: 100%"/>
                    <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddModePaiement.hide()" actionListener="#{managedModeReglement.saveNew()}"/>
                </h:panelGrid>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des entetes de vente
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_plus_option}" width="40%"  closeOnEscape="true" widgetVar="dlgPlusOption" resizable="false"> 
                <h:panelGrid id="blog_entete_commande_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_agence}" rendered="#{acces.multiAgence}"/>
                    <h:selectOneMenu value="#{managedBonVente.agence_}" id="_select_agence_bcv" style="width: 100%" rendered="#{acces.multiAgence}">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedBonVente.agences_}" var="ag"
                                       itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                        <p:ajax event="valueChange" listener="#{managedBonVente._chooseAgence()}" oncomplete="collapseList('commande_vente')" 
                                update="blog_entete_commande_vente _select_entete_commande_vente :main_commande_vente:data_commande_vente"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.L_point_vente}"/>
                    <h:selectOneMenu value="#{managedBonVente.point_}" style="width: 100%">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedBonVente.points_}" var="po"
                                       itemLabel="#{po.libelle}" itemValue="#{po.id}"/>
                        <p:ajax event="valueChange" listener="#{managedBonVente._choosePoint()}" oncomplete="collapseList('commande_vente')"
                                update="_select_entete_commande_vente _select_tranche_commande_vente :main_commande_vente:data_commande_vente"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PCV_tranche}"/>
                    <h:selectOneMenu value="#{managedBonVente.tranche_}" id="_select_tranche_commande_vente" style="width: 100%">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedBonVente.tranches_point_}" var="tr"
                                       itemLabel="#{tr.titre}" itemValue="#{tr.id}"/>
                        <p:ajax event="valueChange" listener="#{managedBonVente._chooseTranche()}" oncomplete="collapseList('commande_vente')"
                                update="_select_entete_commande_vente :main_commande_vente:data_commande_vente"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PCV_livraison_automatique}"/>
                    <h:selectOneMenu value="#{managedBonVente.autoLivreSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" listener="#{managedBonVente.addParamAutoLivre()}" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PCV_statut_reg}"/>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{managedBonVente.egaliteStatutR}">
                            <f:selectItem itemLabel="#{lab.LC_PCV_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.LC_PCV_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" listener="#{managedBonVente.addParamStatutRegle()}" oncomplete="collapseList('commande_vente')"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedBonVente.statutRegle_}" valueChangeListener="#{managedBonVente.chooseStatutRegle}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.STATUT_DOC_PAYER}"/>
                            <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                        </h:selectOneMenu> 
                    </h:panelGroup>
                    <h:outputText value="#{lab.LC_PCV_etat_facturation}"/>                   
                    <h:selectOneMenu value="#{managedBonVente.statutLivre_}" valueChangeListener="#{managedBonVente.chooseFacturer}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.ETAT_ATTENTE}"/>
                        <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                        <f:selectItem itemLabel="#{lab.LC_PCV_facturer}" itemValue="#{constantes.ETAT_LIVRE}"/>
                        <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PCV_verrouille}"/>  
                    <h:selectOneMenu value="#{managedBonVente.cloturer_}" valueChangeListener="#{managedBonVente.chooseCloturer}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                    </h:selectOneMenu>
                    <h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_heures}"/>
                        <h:selectBooleanCheckbox value="#{managedBonVente.date_}" style="margin-top: 2px;float: right">
                            <p:ajax event="valueChange" listener="#{managedBonVente.chooseDateSearch()}" oncomplete="collapseList('commande_vente')"
                                    update="blog_date_search_commande_vente :main_commande_vente:data_commande_vente"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>



                    <h:panelGroup id="blog_date_search_commande_vente">
                        <pe:timePicker value="#{managedBonVente.dateDebut_}" disabled="#{!managedBonVente.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedBonVente.chooseDateSearch()}" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                        </pe:timePicker>
                        <p:spacer width="5px" style="background: black"/>
                        <pe:timePicker value="#{managedBonVente.dateFin_}" disabled="#{!managedBonVente.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedBonVente.chooseDateSearch()}" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                        </pe:timePicker>
                    </h:panelGroup>

                    <h:panelGroup>
                        <h:outputText value="#{lab.LDB_PC_dates}"  />
                        <h:selectBooleanCheckbox value="#{managedBonVente.date_up}" title="#{lab.LDB_PC_dates_last_modif}" style="float: right">
                            <p:ajax event="valueChange" global="false" update="blog_date_search_client" listener="#{managedBonVente.addParamDates()}"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>

                    <h:panelGroup id="blog_date_search_client">
                        <p:calendar value="#{managedBonVente.dateDebut_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedBonVente.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedBonVente.addParamDates}" update=":main_commande_vente:data_commande_vente"   />
                        </p:calendar>
                        <p:spacer style="width: 5px;background: black"/>
                        <p:calendar value="#{managedBonVente.dateFin_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedBonVente.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedBonVente.addParamDates}" update=":main_commande_vente:data_commande_vente"  />
                        </p:calendar>
                    </h:panelGroup>
                </h:panelGrid>


                <h:selectOneMenu value="#{managedBonVente.entete_}" style="width: 100%" id="_select_entete_commande_vente">
                    <f:selectItem itemLabel="" itemValue="0"/>
                    <f:selectItems value="#{managedVente.documents}" var="ent" itemLabel="#{ent.reference}" itemValue="#{ent.id}"/>
                    <p:ajax event="valueChange" listener="#{managedBonVente.chooseEntete(true)}" oncomplete="dlgPlusOption.hide();collapseList('commande_vente');collapseForm('article_commande_vente')"/>
                </h:selectOneMenu> 
                <f:facet name="footer"> 
                    <p:commandLink onclick="dlgCleanEntete.show()" global="false" style="border: 2px solid black; border-radius: 5px;padding: 2px;float: right" 
                                   title="#{lab.LC_PCV_nettoyage_entete_journal_vente}">
                        <h:graphicImage library="img" name="clean.png" width="15" height="15"/>  
                    </p:commandLink>
                </f:facet>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue details taxes
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_details_taxes}" widgetVar="dlgDetailTaxe" modal="true" width="50%"  closeOnEscape="true"> 
                <p:dataTable id="data_taxe_bcv" value="#{managedBonVente.docVente.taxes}" var="tax" rowKey="#{tax.id}">
                    <p:column headerText="#{lab.L_taxe}">
                        <span>#{tax.codeTaxe}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_base}" style="text-align:  right">
                        <h:outputText value="#{tax.totalMontant}" converter="#{managedBonVente.converter}"/>
                        <span> Fcfa</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_taux}" style="text-align:  right">
                        <h:outputText value="#{tax.taux}" converter="DNS"/>
                        <span> %</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_value}" style="text-align:  right">
                        <h:outputText value="#{tax.totalTaux}" converter="DNS"/>
                        <span> Fcfa</span>
                    </p:column>
                </p:dataTable>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue du contenu
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_infos_contenu}" widgetVar="dlgInfosContenu" modal="true" width="30%"  closeOnEscape="true"> 
                <p:panelGrid columns="2" id="blog_form_infos_contenu_bcv" style="width: 100%">
                    <span>#{lab.L_article}</span>
                    <h:inputText value="#{managedBonVente.entityContenu.article.designation}" readonly="true"/>
                    <span>#{lab.L_prix}</span>
                    <h:panelGroup>
                        <h:inputText value="#{managedBonVente.entityContenu.prix}" readonly="true" converter="#{managedBonVente.converter}"/>
                        <span> Fcfa</span>
                    </h:panelGroup>
                    <span>#{lab.L_quantite}</span>
                    <h:inputText value="#{managedBonVente.entityContenu.quantite}" readonly="true" converter="#{managedBonVente.converterStock}"/>
                    <span>#{lab.LC_PCV_remise}</span>
                    <h:panelGroup>
                        <h:inputText value="#{managedBonVente.entityContenu.remise}" readonly="true" converter="DNS"/>
                        <span> Fcfa</span>
                    </h:panelGroup>
                    <span>#{lab.LC_PCV_ristourne}</span>
                    <h:panelGroup>
                        <h:inputText value="#{managedBonVente.entityContenu.ristourne}" readonly="true" converter="#{managedBonVente.converter}"/>
                        <span> Fcfa</span>
                    </h:panelGroup>
                    <span>#{lab.LC_PCV_commission}</span>
                    <h:panelGroup>
                        <h:inputText value="#{managedBonVente.entityContenu.comission}" readonly="true" converter="#{managedBonVente.converter}"/>
                        <span> Fcfa</span>
                    </h:panelGroup>
                    <span>#{lab.L_taxe}</span>
                    <h:panelGroup>
                        <h:inputText value="#{managedBonVente.entityContenu.taxe}" readonly="true" converter="DNS"/>
                        <span> Fcfa</span>
                    </h:panelGroup>
                    <span>#{lab.LC_PCV_total_contenu}</span>
                    <h:panelGroup>
                        <h:inputText value="#{managedBonVente.entityContenu.prixTotal}" readonly="true" converter="#{managedBonVente.converter}"/>
                        <span> Fcfa</span>
                    </h:panelGroup>
                </p:panelGrid> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de montant versé
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.LC_PCV_montant_verse}" widgetVar="dlgAddVerse" modal="true" width="20%"  closeOnEscape="true"> 
                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%">
                    <pe:inputNumber value="#{managedBonVente.avance}" symbol=" Fcfa" symbolPosition="suffixe"/>
                    <p:commandLink title="#{lab.L_enregistrer}" actionListener="#{managedBonVente.regleFacture()}" oncomplete="dlgAddVerse.hide()" global="false">
                        <p:graphicImage library="icones" name="ok.png" width="50" height="30"/>
                    </p:commandLink>   
                </h:panelGrid>
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue de client
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="main_client_bcv">
            <p:dialog header="#{lab.LC_PCV_liste_template}" widgetVar="dlgListTemplate" modal="true" width="75%" closeOnEscape="true">
                <p:dataTable value="#{managedTiersTemplate.templates}" var="clt" rowKey="#{clt.id}" 
                             rowIndexVar="cltIdx" selectionMode="single" selection="#{managedClient.selectTemplate}">
                    <p:ajax event="rowSelect" global="false" listener="#{managedClient.loadOnViewTemplate}"  oncomplete="dlgListTemplate.hide()" update=":main_client_bcv:infos_tiers_commande_vente"/>
                    <p:ajax event="rowUnselect" global="false" listener="#{managedClient.unLoadOnViewTemplate}"/>
                    <p:column width="15">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_apercu}" width="100">
                        <span>#{clt.apercu}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_compte}" width="100">
                        <span>#{clt.compteCollectif.numCompte}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_pays}" width="100">
                        <span>#{clt.pays.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_ville}" width="100">
                        <span>#{clt.ville.libele}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_secteur}" width="100">
                        <span>#{clt.secteur.libele}</span>
                    </p:column>
                </p:dataTable>  
            </p:dialog>
            <p:dialog header="#{lab.LC_PCV_creation_client}" widgetVar="dlgAddClient" modal="true" width="40%" closeOnEscape="true"> 
                <h:panelGrid id="infos_tiers_commande_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <f:facet name="header">
                        <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%" cellpadding="0" cellspacing="0">
                            <h:panelGrid columns="2" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                <span>#{lab.LC_PCV_societe} </span>  
                                <h:selectBooleanCheckbox value="#{client.tiers.societe}" tabindex="1">
                                    <p:ajax event="valueChange" global="false" update="infos_tiers_commande_vente"/>
                                </h:selectBooleanCheckbox>                                                    
                            </h:panelGrid> 
                            <h:panelGroup id="txt_code_client_commande_vente" style="float: right">
                                <h:inputText  value="#{client.codeClient}" tabindex="3" style="background: #009999;font-weight: bold" title="#{lab.LC_PCV_code_client}">
                                    <p:ajax event="valueChange" global="false"/>
                                </h:inputText>
                                <p:commandLink title="#{lab.LC_PCV_template}" onclick="dlgListTemplate.show()" global="false" style="float: right">
                                    <p:graphicImage library="icones" name="ico_facture2.png" width="20" height="22" style="border: 2px solid #666; border-radius: 5px;"/>
                                </p:commandLink>  
                            </h:panelGroup>                            
                        </h:panelGrid>
                    </f:facet>
                    <h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_nom}" rendered="#{!client.tiers.societe}"/>
                        <h:outputText value="#{lab.L_designation}" rendered="#{client.tiers.societe}"/>    
                        <p:commandLink title="#{managedClient.generation?'Déactiver':'Activer'} #{lab.LC_PCV_generation_code_tiers}" actionListener="#{managedClient.activeGenerationCode()}" 
                                       global="false" style="float: right;margin-top: 4px" update="@this">
                            <p:graphicImage library="img" name="#{managedClient.generation?'connecte.png':'deconnecte.png'}" width="12" height="12"/>
                        </p:commandLink>                                                     
                    </h:panelGroup>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{client.tiers.civilite}" rendered="#{!client.tiers.societe}" tabindex="5">
                            <f:selectItem itemLabel="Mme" itemValue="Mme"/>
                            <f:selectItem itemLabel="M." itemValue="M."/>
                        </h:selectOneMenu>
                        <p:spacer width="2"/>
                        <h:inputText value="#{client.nom}" tabindex="7" style="width: 75%">
                            <p:ajax event="blur" global="false" listener="#{managedClient.changeName()}" update="txt_code_client_commande_vente"/>
                        </h:inputText>
                    </h:panelGroup>
                    <h:outputText value="#{lab.LC_PCV_prenom}" rendered="#{!client.tiers.societe}"/>  
                    <h:inputText value="#{client.prenom}" rendered="#{!client.tiers.societe}" tabindex="9">
                        <p:ajax event="blur" global="false" listener="#{managedClient.changeName()}" update="txt_code_client_commande_vente"/>
                    </h:inputText>
                    <span>#{lab.LC_PCV_categorie_comptable}</span>
                    <h:selectOneMenu value="#{client.categorieComptable.id}" tabindex="11">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{managedCatCompt.categoriesVente}" var="catC" itemLabel="#{catC.designation}" itemValue="#{catC.id}" />                                
                    </h:selectOneMenu> 
                    <span>#{lab.LC_PCV_adresse} </span>
                    <h:inputText value="#{client.tiers.adresse}" tabindex="13"/>
                    <span>#{lab.LC_PCV_email} </span>
                    <h:inputText value="#{client.tiers.email}" converter="EMAIL" tabindex="15"/>
                    <span>#{lab.LC_PCV_code_postal} </span>
                    <h:inputText value="#{client.tiers.codePostal}" tabindex="17"/>
                    <span>#{lab.LC_PCV_telephones} </span>
                    <h:inputText value="#{client.tiers.telephone}" style="width: 98%" tabindex="19" title="#{lab.LC_PCV_separer_numeros} (/)"/>
                    <span>#{lab.L_pays} </span>
                    <h:selectOneMenu value="#{client.tiers.pays.id}" id="pays_client_commande_vente" style="min-width: 120px" tabindex="21">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{Mdico.pays}" var="pys" itemLabel="#{pys.libele}" itemValue="#{pys.id}" />                                
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.choosePays()}" update="ville_client_commande_vente secteur_client_commande_vente"/>
                    </h:selectOneMenu>
                    <span>#{lab.L_ville} </span>
                    <h:selectOneMenu value="#{client.tiers.ville.id}" id="ville_client_commande_vente" style="min-width: 120px" tabindex="23">
                        <f:selectItem itemLabel="--" itemValue="0" noSelectionOption="true"/>
                        <f:selectItems value="#{Mdico.villes}" var="dic" itemLabel="#{dic.libele}" itemValue="#{dic.id}" />                          
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.chooseVille()}" update="secteur_client_commande_vente"/>
                    </h:selectOneMenu> 
                    <span>#{lab.L_secteur} </span>
                    <h:selectOneMenu value="#{client.tiers.secteur.id}" id="secteur_client_commande_vente" style="min-width: 120px" tabindex="25">
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{Mdico.secteurs}" var="sec"  itemLabel="#{sec.libele}" itemValue="#{sec.id}" />                                  
                        <p:ajax event="valueChange" global="false" listener="#{managedClient.chooseSecteur()}"/>
                    </h:selectOneMenu> 
                </h:panelGrid>
                <p:commandButton value="#{lab.L_enregistrer}" style="width: 100%" oncomplete="dlgAddClient.hide()"
                                 actionListener="#{managedClient.saveNewAll()}"  tabindex="27"/>
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des clients
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PCV_liste_clients}" widgetVar="dlgListClients" closeOnEscape="true" width="50%" modal="true" dynamic="true">       
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText value="#{managedClient.numSearch_}" style="float: left;text-align: center;margin-left: -10px">
                        <p:ajax event="blur" global="false" listener="#{managedClient.searchByNum()}" update="data_client_commande_vente"/>
                    </h:inputText> 
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedClient.init(false)}" global="false" update="data_client_commande_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedClient.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedClient.paginator.currentPage}/#{managedClient.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedClient.init(true)}" global="false" update="data_client_commande_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedClient.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedClient.max}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedClient.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedClient.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_client_commande_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>                             
                <p:dataTable id="data_client_commande_vente"  value="#{managedClient.clients}" var="clt_" rowKey="#{clt_.id}"
                             selectionMode="single" rowIndexVar="cltIdx">
                    <p:ajax event="rowSelect" global="false" listener="#{managedBonVente.loadOnViewClient}" oncomplete="dlgListClients.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{clt_.codeClient}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_nom}">
                        <span>#{clt_.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PCV_categorie_t}">
                        <span>#{clt_.categorie}</span>
                    </p:column>
                </p:dataTable>  
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAddClient" closeOnEscape="true"
                             message="#{lab.LC_PCV_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.saveDefautClient()}" oncomplete="dlgConfirmAddClient.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmAddClient.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.deleteBeanContenu()}" oncomplete="dlgConfirmDeleteArticle.hide();collapseForm('contenu_commande_vente')"
                                 update=":main_commande_vente:tabview_commande_vente:data_contenu_commande_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteArticle_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.deleteBeanContenu_()}" oncomplete="dlgConfirmDeleteArticle_.hide();collapseForm('contenu_commande_vente')"
                                 update=":main_commande_vente:tabview_commande_vente:data_contenu_commande_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteArticle_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog id="dlg_confirm_rabais_bcv" hideEffect="explode" widgetVar="dlgConfirmAlertRabais" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="Vous essayez de vendre l'article '#{managedBonVente.contenu.article.designation}' au prix '#{managedBonVente.contenu.prix}' inferieur au prix minimal '#{managedBonVente.contenu.prixMin}'. Appliquer un rabais?">
                <p:commandButton type="button" value="#{lab.L_oui}" onclick="dlgConfirmAlertRabais.hide();
                        dlgAddCommentaire.show()"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAlertRabais.hide()" actionListener="#{managedBonVente.saveNewContenu(true)}"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteMensualite" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.deleteBeanReglement()}" oncomplete="dlgConfirmDeleteMensualite.hide();collapseForm('mensualite_facture_vente')"
                                 update=":main_commande_vente:tabview_commande_vente:form_mensualite_commande_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteMensualite.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeleteMensualite_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.deleteBeanReglement_()}" oncomplete="dlgConfirmDeleteMensualite_.hide();collapseForm('mensualite_facture_vente')"
                                 update=":main_commande_vente:tabview_commande_vente:form_mensualite_commande_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDeleteMensualite_.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.deleteBean()}" oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete_" closeOnEscape="true"
                             message="#{lab.LC_PCV_text2}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.deleteBean_()}" oncomplete="dlgConfirmDelete_.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete_.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog id="id_confirm_close_bcv" hideEffect="explode" widgetVar="dlgConfirmClose" closeOnEscape="true"
                             message="Êtes-vous sûr de vouloir #{managedBonVente.selectDoc.cloturer?'dévérrouiller':'vérrouiller'}?" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.cloturer()}" oncomplete="dlgConfirmClose.hide()" update=":main_commande_vente:data_commande_vente"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmClose.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmLivraison" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="#{lab.LC_PCV_text3}">
                <div align="center">
                    <p:calendar value="#{managedBonVente.dateLivraison}" size="8" pattern="dd-MM-yyyy" navigator="true">
                        <p:ajax event="dateSelect" global="false"/>
                    </p:calendar>
                </div>
                <div align="center">
                    <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.transmisOrder()}" oncomplete="dlgConfirmLivraison.hide();collapseForm('commande_vente')"/>
                    <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmLivraison.hide()"/>
                </div>                
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmRefuser" closeOnEscape="true"
                             message="#{lab.LC_PCV_text4}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.refuserOrderForce()}" oncomplete="dlgConfirmRefuser.hide();collapseForm('commande_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmRefuser.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmSoumis" closeOnEscape="true"
                             message="#{lab.LC_PCV_text5}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.validerOrder(true)}" oncomplete="dlgConfirmSoumis.hide();collapseForm('commande_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmSoumis.hide()"/> 
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgSaveEntete" closeOnEscape="true"
                             message="#{lab.LC_PCV_text6}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.saveNewEntete()}" oncomplete="dlgSaveEntete.hide();collapseForm('commande_vente');collapseForm('article_commande_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgSaveEntete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgResetEntete" closeOnEscape="true"
                             message="#{lab.LC_PCV_text7}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.resetFicheEntete()}" oncomplete="dlgResetEntete.hide();collapseForm('commande_vente');collapseForm('article_commande_vente')"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgResetEntete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanEntete" closeOnEscape="true"
                             message="#{lab.LC_PCV_text8}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.cleanEnteteVente()}" oncomplete="dlgCleanEntete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanEntete.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog hideEffect="explode" widgetVar="dlgCleanVente" closeOnEscape="true"
                             message="#{lab.LC_PCV_text9}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.cleanVente()}" oncomplete="dlgCleanVente.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgCleanVente.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeMode" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="#{lab.LC_PCV_text10}">
                <span>#{lab.LC_PCV_text14}</span>
                <p:commandButton value="Ok" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmChangeMode.hide()"/>
            </p:confirmDialog>
            <p:confirmDialog widgetVar="dlgConfirmDeletePhase" closeOnEscape="true" header="#{lab.L_confirmation}"
                             message="#{lab.LC_PCV_text11} ">
                <span>#{lab.LC_PCV_text15}</span>
                <p:commandButton value="#{lab.LC_PCV_continuer}" icon="ui-icon-circle-check" actionListener="#{managedBonVente.saveNewReglement(true)}" 
                                 update=":main_commande_vente:tabview_commande_vente:form_mensualite_commande_vente" oncomplete="dlgConfirmDeletePhase.hide()"/>
                <p:commandButton value="Annuler" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmDeletePhase.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnulePiece" closeOnEscape="true"
                             message="#{lab.LC_PCV_text12}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedBonVente.openConfirmPaiement()}" oncomplete="dlgConfirmAnnulePiece.hide()" 
                                 update=":main_commande_vente:grp_btn_etat_commande_vente :main_commande_vente:data_commande_vente :main_commande_vente:tabview_commande_vente:data_mensualite_commande_vente"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnulePiece.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmChangeInventaireByCancel" closeOnEscape="true" header="#{lab.LC_PLV_attention}"
                             message="#{lab.LC_PLV_text8}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedLivraisonVente.annulerOrderByForce()}" oncomplete="dlgConfirmChangeInventaireByCancel.hide()"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" actionListener="#{managedLivraisonVente.setExistInventaire(null)}" oncomplete="dlgConfirmChangeInventaireByCancel.hide()" global="false"/>
            </p:confirmDialog>
            <p:confirmDialog widgetVar="dlgConfirmChangeInventaireByValid" closeOnEscape="true" header="#{lab.LC_PLV_attention}"
                             message="#{lab.LC_PLV_text8}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedLivraisonVente.validerOrderByForce()}" oncomplete="dlgConfirmChangeInventaireByValid.hide()"/>
                <p:commandButton value="#{lab.L_non}" icon="ui-icon-circle-close" actionListener="#{managedLivraisonVente.setExistInventaire(null)}" onclick="dlgConfirmChangeInventaireByValid.hide()" global="false"/>
            </p:confirmDialog>
        </h:form> 
        <!-->
       *****************************************************************************
       Début du formulaire
       *****************************************************************************
       <-->
        <h:form prependId="false" id="main_commande_vente">    
            <div class="part_fix">                
                <div style="float: left;width: 20%">
                    <p:splitButton value="#{lab.L_enregistrer}" id="save_commande_vente" actionListener="#{managedBonVente.saveNew()}">
                        <p:menuitem value="#{lab.L_nouveau}" id="cancel_commande_vente" global="false" actionListener="#{managedBonVente.resetFiche()}" icon="ui-icon-document" 
                                    update="blog_form_commande_vente" oncomplete="collapseForm('commande_vente');collapseForm('contenu_commande_vente')"/>
                        <p:separator/>                        
                        <p:menuitem icon="ui-icon-carat-2-e-w" value="Equilibrer Statut" actionListener="#{managedBonVente.equilibre(managedBonVente.selectDoc)}" global="false" update=":main_commande_vente:data_commande_vente"/>
                        <p:menuitem icon="ui-icon-carat-2-e-w" value="#{lab.LC_PFV_maitenance}" actionListener="#{managedBonVente.maintenance(managedBonVente.selectDoc, true)}" update=":main_commande_vente:data_commande_vente"/> 
                        <p:separator/>
                        <p:menuitem value="#{lab.L_modifier}" rendered="false" id="update_commande_vente" actionListener="#{managedBonVente.updateBean()}" oncomplete="collapseForm('commande_vente');return false"/>
                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" onclick="dlgConfirmDelete.show()" global="false"/>
                    </p:splitButton>
                    <p:splitButton type="button" value="#{lab.L_options}" id="option_commande_vente" style="font-size: 0.8em">
                        <p:menuitem value="Annuler" icon="ui-icon-check" global="false" onclick="dlgConfirmAnnulerCmdeAll.show()"/>
                        <p:menuitem value="Valider" icon="ui-icon-check" global="false" onclick="dlgConfirmValidAll.show()"/>
                        <p:menuitem value="Livrer" icon="ui-icon-check" global="false" onclick="dlgConfirmLivrerAll.show()"/>
                        <p:separator />
                        <p:menuitem value="#{lab.L_supprimer}" id="delete_commande_vente" icon="ui-icon-trash" global="false" onclick="dlgConfirmDelete.show()" />
                    </p:splitButton>
                </div>
                <div style="float: right">
                    <div style="float: right">
                        <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('commande_vente');
                                collapseList('livraison_vente_');
                                return false">
                            <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>               
                        <p:spacer />
                        <h:link title="#{lab.L_mode_liste}" onclick="collapseList('commande_vente');
                                collapseList('livraison_vente_');
                                return false" >
                            <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                        </h:link>   
                    </div>
                    <h:panelGroup style="float: right">
                        <p:commandButton actionListener="#{managedBonVente.parcoursInAllResult(false)}" update="txt_parc_linear_commande_vente" global="false"  icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('commande_vente')"/>
                        <h:inputText value="#{managedBonVente.offset}" style="width: 35px; text-align: center;"  title="Aller au N°..." id="txt_parc_linear_commande_vente"/>
                        <p:outputPanel autoUpdate="true">                        
                            <p:outputLabel value="/#{managedBonVente.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedBonVente.parcoursInAllResult(true)}" update="txt_parc_linear_commande_vente" global="false" icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('commande_vente')"/>
                    </h:panelGroup>  
                </div>
                <div style="width: 60%;float: right" title="#{lab.LC_PCV_entete_journal_vente}">
                    <h:panelGrid id="save_entete_commande_vente" columns="2" style="border: 2px solid black; border-radius: 5px;color: white;background: #CCC" cellpadding="0" cellspacing="0">
                        <h:panelGrid columns="4" style="font-size: 0.8em" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                            <h:outputText value="#{lab.L_date}"/>
                            <h:outputText value="#{lab.L_point_vente}"/>
                            <h:outputText value="#{lab.LC_PCV_tranche}"/>
                            <h:outputText value="#{lab.LC_PCV_vendeur}"/>
                            <p:calendar value="#{managedBonVente.entete.dateEntete}" navigator="true" pattern="dd-MM-yyyy" size="10" disabled="#{managedBonVente.entete.new_}">
                                <p:ajax event="dateSelect" global="false" listener="#{managedBonVente.chooseDate()}" update="infos_document_commande_vente"/>
                            </p:calendar> 
                            <h:selectOneMenu value="#{managedBonVente.entete.point.id}" disabled="#{managedBonVente.entete.new_}"
                                             id="select_point_bcv" style="min-width: 120px" valueChangeListener="#{managedBonVente.choosePoint_}">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedPointVente.pointsvente}" var="poi" 
                                               itemLabel="#{poi.libelle}" itemValue="#{poi.id}" />                                
                                <p:ajax event="valueChange" update="select_tranche_bcv select_auto_commande_vente select_vendeur_bcv"/>
                            </h:selectOneMenu> 
                            <h:selectOneMenu value="#{managedBonVente.entete.tranche.id}" disabled="#{managedBonVente.entete.new_}"
                                             id="select_tranche_bcv" style="min-width: 120px">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedPointVente.creneaux}" var="trh" 
                                               itemLabel="#{trh.tranche.titre}" itemValue="#{trh.tranche.id}" />                                
                                <p:ajax event="valueChange" global="false" listener="#{managedBonVente.chooseTranche()}"/>
                            </h:selectOneMenu> 
                            <h:selectOneMenu value="#{managedBonVente.entete.users.id}" disabled="#{managedBonVente.entete.id gt 0}"
                                             id="select_vendeur_bcv" style="min-width: 120px; max-width: 150px">
                                <f:selectItem itemLabel="--" itemValue="0"/>
                                <f:selectItems value="#{managedBonVente.vendeurs}" var="vend_" 
                                               itemLabel="#{vend_.nomUsers}" itemValue="#{vend_.id}" />                                
                                <p:ajax event="valueChange" global="false"/>
                            </h:selectOneMenu> 
                        </h:panelGrid>
                        <p:commandLink title="#{lab.LC_PCV_reinitialiser_entete_journal_vente}" onclick="dlgResetEntete.show()" global="false" rendered="#{accesRessource.fv_update_header}"
                                       style="float: right;border: 2px solid black; border-radius: 5px;padding: 2px;background: white">
                            <h:graphicImage library="icones" name="kedit.png" width="15" height="15"/>    
                        </p:commandLink>
                    </h:panelGrid>
                </div>
            </div>
            <div class="part_scroll">
                <!-->
                 *****************************************************************************
                 Vue Formulaire
                 *****************************************************************************
                <-->
                <div class="yvs_form_commande_vente">
                    <p:outputPanel id="blog_form_commande_vente" style="width: 99%; margin: auto; background: white">
                        <h:panelGrid columns="1" style="width: 100%">
                            <p:outputPanel id="form_entete_commande_vente">
                                <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%;margin-bottom: -10px;margin-top: -10px" cellpadding="0" cellspacing="0" rendered="#{managedBonVente.docVente.update}">
                                    <h:panelGrid columns="2" styleClass="yvs_nostyle" style="float: left;font-size: large;background: black;color: white">                                            
                                        <span style="font-size: initial">Numéro : </span>
                                        <h:outputText id="txt_reference_document_commande_vente" value="#{managedBonVente.docVente.numDoc}"/>
                                    </h:panelGrid>
                                    <h:panelGroup style="padding: 7px;float: right; position: relative; margin-top: 1%">                                        
                                        <p:outputPanel id="grp_btn_etat_commande_vente" styleClass="yvs_form_of">  
                                            <p:commandLink value="#{lab.L_editable}" styleClass="button-stateOF #{(managedBonVente.docVente.statut == constantes.ETAT_EDITABLE)?'button-stateOF_actif':''}" 
                                                           disabled="#{!(managedBonVente.docVente.statut == constantes.ETAT_VALIDE
                                                                       or managedBonVente.docVente.statut == constantes.ETAT_ANNULE)}" 
                                                           actionListener="#{managedBonVente.annulerOrder(false)}"
                                                           process="@this" update="grp_btn_etat_commande_vente"/>  
                                            <p:commandLink value="#{(managedBonVente.docVente.statut == constantes.ETAT_VALIDE)?'Validé':'VALIDER'}" styleClass="button-stateOF #{(managedBonVente.docVente.statut == constantes.ETAT_VALIDE)?'button-stateOF_actif':''}" 
                                                           disabled="#{!(managedBonVente.docVente.statut == constantes.ETAT_EDITABLE)}" 
                                                           onclick="dlgConfirmSoumis.show()"
                                                           process="@this" update="grp_btn_etat_commande_vente" global="false"/>
                                            <p:commandLink value="#{(managedBonVente.docVente.statutLivre == constantes.ETAT_LIVRE)?'Livrée':'LIVRER'}" styleClass="button-stateOF #{(managedBonVente.docVente.statutLivre == constantes.ETAT_LIVRE)?'button-stateOF_actif':''}" 
                                                           disabled="#{!(managedBonVente.docVente.statut == constantes.ETAT_VALIDE)}" 
                                                           onclick="dlgConfirmLivraison.show()"
                                                           process="@this" update="grp_btn_etat_commande_vente" global="false"/>
                                            <p:commandLink value="#{(managedBonVente.docVente.statut == constantes.ETAT_ANNULE)?'SUSPENDU':'SUSPENDRE'}" styleClass="button-stateOF #{(managedBonVente.docVente.statut==constantes.ETAT_ANNULE)?'button-stateOF_actif':''}" 
                                                           disabled="#{managedBonVente.docVente.statut == constantes.ETAT_ANNULE}" 
                                                           onclick="dlgAnnuleCommande.show()"
                                                           process="@this" update="grp_btn_etat_commande_vente" global="false"/>
                                        </p:outputPanel>                                                 
                                    </h:panelGroup>                                     
                                </h:panelGrid> 
                            </p:outputPanel>
                            <p:outputPanel style="width: 100%" id="form_commande_vente">
                                <div style="width: 60%;float: left">                                             
                                    <p:outputPanel id="infos_document_commande_vente" style="width: 100%">
                                        <p:outputPanel>
                                            <h:panelGrid id="infos_commande_vente" columns="2" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                                <f:facet name="header">
                                                    <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">                                                        
                                                        <h:panelGroup>
                                                            <p:commandLink id="btnMontantsBCV" global="false" style="border: 2px solid black; border-radius: 5px;padding: 3px;background: white" title="#{lab.L_montant}">
                                                                <h:graphicImage library="icones" name="ico_facture2.png" width="15" height="15"/>  
                                                            </p:commandLink>
                                                        </h:panelGroup>
                                                    </h:panelGrid>
                                                </f:facet>
                                                <span>#{lab.LC_PCV_client} </span>       
                                                <h:panelGroup id="select_client_commande_vente">
                                                    <h:inputText value="#{managedBonVente.docVente.client.codeClient}" style="color: #{managedBonVente.docVente.client.error?'red':''}"
                                                                 disabled="#{managedBonVente.docVente.statut != constantes.ETAT_EDITABLE}">
                                                        <p:ajax event="blur" global="false" listener="#{managedBonVente.searchClient()}" update="infos_commande_vente txt_zone_client_bcv"/>
                                                    </h:inputText>    
                                                    <h:outputText value="#{managedBonVente.docVente.client.nom_prenom}" style="margin-left: 10px;color: #009999"/>
                                                    <h:panelGroup style="float: right">
                                                        <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PCV_liste_clients}" global="false"
                                                                         disabled="#{managedBonVente.docVente.statut != constantes.ETAT_EDITABLE}"
                                                                         actionListener="#{managedBonVente.initClients()}" oncomplete="dlgListClients.show()"/>
                                                        <p:commandButton icon="ui-icon-circle-plus" type="button" style="width: 20px; height: 22px;" onclick="dlgAddClient.show()"
                                                                         rendered="#{accesRessource.fv_create_client}"/>   
                                                    </h:panelGroup>
                                                </h:panelGroup> 
                                                <span>#{lab.LC_PCV_categorie_comptable} </span>
                                                <h:selectOneMenu value="#{managedBonVente.docVente.categorieComptable.id}" id="select_categorie_comptable_commande_vente"
                                                                 disabled="#{managedBonVente.docVente.statut != constantes.ETAT_EDITABLE}" style="min-width: 120px">
                                                    <f:selectItem itemLabel="--" itemValue="0"/>
                                                    <f:selectItems value="#{managedCatCompt.categoriesVente}" var="cat" 
                                                                   itemLabel="#{cat.designation}" itemValue="#{cat.id}" />                               
                                                    <p:ajax event="valueChange" global="false" listener="#{managedBonVente.chooseCategorie()}"/>
                                                </h:selectOneMenu> 

                                                <span>#{lab.LC_PCV_heure_vente} </span>
                                                <pe:timePicker value="#{managedBonVente.docVente.heureDoc}" disabled="#{managedBonVente.docVente.statut != constantes.ETAT_EDITABLE}" style="width: 80px"/>
                                                <span>#{lab.LC_PCV_model_reglement} </span>
                                                <h:panelGroup>
                                                    <h:selectOneMenu value="#{managedBonVente.docVente.modeReglement.id}" id="select_model_commande_vente"
                                                                     disabled="#{managedBonVente.docVente.statut != constantes.ETAT_EDITABLE}" style="min-width: 120px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedModeReglement.models}" var="model" itemLabel="#{model.reference}" itemValue="#{model.id}" />                                
                                                    </h:selectOneMenu>  
                                                    <h:panelGroup style="float: right; font-size: 0.8em;margin-top: 4px" id="select_auto_commande_vente">
                                                        <p:selectBooleanCheckbox itemLabel="#{lab.LC_PCV_livre} " value="#{managedBonVente.docVente.livraisonAuto}"/>
                                                        <p:spacer width="5"/>
                                                        <p:selectBooleanCheckbox itemLabel="#{lab.LC_PCV_regler}" value="#{managedBonVente.docVente.validationReglement}"/>
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <h:panelGroup>
                                                    <span>#{lab.LC_PCV_adresse}</span>
                                                    <h:panelGroup style="float: right">
                                                        <p:commandButton icon="ui-icon-circle-plus"  style="width: 20px; height: 22px;" oncomplete="dlgAddZone.show()"
                                                                         actionListener="#{Mdico.resetFiche()}" update=":main_zone_bcv:form_zone_bcv"/>   
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <h:panelGroup id="txt_zone_client_bcv">
                                                    <h:selectOneMenu value="#{managedBonVente.docVente.ville.id}" style="min-width: 120px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{Mdico.villes}" var="vil" 
                                                                       itemLabel="#{vil.libele}" itemValue="#{vil.id}" />                                 
                                                        <p:ajax event="valueChange" global="false" listener="#{managedBonVente.chooseVille()}" update="txt_dresse_fv_bcv"/>
                                                    </h:selectOneMenu>
                                                    <h:selectOneMenu value="#{managedBonVente.docVente.adresse.id}" id="txt_dresse_fv_bcv" style="min-width: 120px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{Mdico.secteurs}" var="sec" 
                                                                       itemLabel="#{sec.libele}" itemValue="#{sec.id}" />                                 
                                                        <p:ajax event="valueChange" global="false" listener="#{managedBonVente.chooseAdresse()}"/>
                                                    </h:selectOneMenu>
                                                    <h:panelGroup style="float: right">
                                                        <span>#{lab.LC_PCV_telephone} : </span>
                                                        <h:inputText value="#{managedBonVente.docVente.telephone}" style="margin-left: 5px;text-align: center"/>
                                                    </h:panelGroup>
                                                </h:panelGroup> 
                                                <span>#{lab.LC_PCV_depot_livraison_prevu} </span>
                                                <h:panelGroup>
                                                    <h:selectOneMenu value="#{managedBonVente.docVente.depot.id}" id="select_depot_liv_prevu_bcv" style="min-width: 120px"
                                                                     disabled="#{managedBonVente.docVente.statut != constantes.ETAT_EDITABLE}">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedBonVente.depotsLivraison}" var="dpl" itemLabel="#{dpl.designation}" itemValue="#{dpl.id}" />  
                                                        <p:ajax event="valueChange" global="false" listener="#{managedBonVente.chooseDepot()}" update="select_tranche_livraison_bcv"/>                              
                                                    </h:selectOneMenu> 
                                                    <span>#{lab.L_le}</span>
                                                    <p:calendar value="#{managedBonVente.docVente.dateLivraisonPrevu}" pattern="dd-MM-yyyy" size="8" navigator="true"
                                                                disabled="#{managedBonVente.docVente.statut != constantes.ETAT_EDITABLE}"/>
                                                    <h:panelGroup id="select_tranche_livraison_bcv" style="float: right;margin-top: 3px;border: 2px solid black; border-radius: 5px;padding: 2px;background: #CCC">
                                                        <div onclick="dlgListTranche.show()" style="cursor: pointer" title="#{lab.LC_PCV_selectionner_tranche_livraison_prevu}">
                                                            <h:panelGroup rendered="#{managedBonVente.docVente.tranche.id > 0}">
                                                                <h:outputText value="#{managedBonVente.docVente.tranche.heureDebut}" converter="TIME" style="font-weight: bold;font-size: 0.7m"/>
                                                                <span>-</span>
                                                                <h:outputText value="#{managedBonVente.docVente.tranche.heureFin}" converter="TIME" style="font-weight: bold;font-size: 0.7m"/>
                                                            </h:panelGroup>  
                                                            <h:outputText value="#{lab.LC_PCV_tranche}" rendered="#{0 >= managedBonVente.docVente.tranche.id}" style="font-weight: bold;font-size: 0.7m"/>
                                                        </div>
                                                    </h:panelGroup>
                                                </h:panelGroup> 
                                            </h:panelGrid>
                                        </p:outputPanel>
                                        <p:overlayPanel for="btnMontantsBCV" hideEffect="fade" style="width: 35%;background: black;color: white">
                                            <p:outputPanel id="blog_form_montant_doc_bcv">
                                                <h:panelGrid columns="2" style="width: 100%;font-weight: bolder;margin-top: 5px;color: white">
                                                    <span>#{lab.LC_PCV_total_taxe}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedBonVente.docVente.montantTaxe}" converter="DNS"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PCV_total_ht}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedBonVente.docVente.montantHT}" converter="#{managedBonVente.converter}"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PCV_total_remise} </span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedBonVente.docVente.montantRemise}" converter="DNS"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #E9FBF9">#{lab.LC_PCV_total_ttc} </span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedBonVente.docVente.montantTTC}" converter="#{managedBonVente.converter}" style="color: #E9FBF9"/>
                                                        <span style="font-size: small;color: #E9FBF9"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span>#{lab.LC_PCV_total_facture} </span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedBonVente.docVente.montantTotal}" converter="#{managedBonVente.converter}"/>
                                                        <span style="font-size: small"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #0099ff">#{lab.LC_PCV_total_avance} </span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedBonVente.docVente.montantAvance}" converter="#{managedBonVente.converter}" style="color: #0099ff"/>
                                                        <span style="font-size: small;color: #0099ff"> Fcfa</span>
                                                    </h:panelGroup>
                                                    <span style="color: #009999">#{lab.LC_PCV_net_a_payer}</span>
                                                    <h:panelGroup style="float: right">
                                                        <h:outputText value="#{managedBonVente.docVente.montantResteApayer}" converter="#{managedBonVente.converter}" style="color: #009999"/>
                                                        <span style="font-size: small;color: #009999"> Fcfa</span>
                                                    </h:panelGroup>
                                                </h:panelGrid>
                                            </p:outputPanel>
                                        </p:overlayPanel>
                                    </p:outputPanel>
                                </div>
                                <div style="width: 39%;margin-left: 61%;background: white">
                                    <p:outputPanel id="desc_article_commande_vente" layout="block">
                                        <h1 style="padding-left: 10px">Détails du produit</h1>
                                        <div style="float: left; width: 59%; border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;
                                             border-bottom: 2px solid #bbb; padding-left: 10px; padding-bottom: 10px; padding-top: 5px">
                                            <span style="font-weight: bold;color: #000">
                                                #{managedBonVente.contenu.article.designation}
                                            </span>
                                            <p:outputPanel rendered="#{accesRessource.base_view_article_pua}" layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <h:outputText value="Prix d'achat = " />
                                                <h:outputText value="#{managedBonVente.contenu.conditionnement.prixAchat}" converter="#{managedBonVente.converter}" style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel>
                                            <p:outputPanel layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <h:outputText value="#{lab.LC_PFV_prix_minimum} = " />
                                                <h:outputText value="#{managedBonVente.contenu.article.puvMin}" converter="#{managedBonVente.converter}" style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel>
                                            <p:outputPanel layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <span>#{lab.LC_PFV_prix_recommander} = </span>
                                                <h:outputText value="#{managedBonVente.contenu.article.puv}" converter="#{managedBonVente.converter}" style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel> 
                                            <p:outputPanel rendered="#{accesRessource.base_view_article_pr}" layout="block" style="padding-top: 5px; padding-bottom: 5px">
                                                <h:outputText value="#{lab.LC_PFA_cout_unitaire_stock} = " /> 
                                                <h:outputText value="#{managedBonVente.contenu.article.pr}" converter="#{managedBonVente.converter}"  style="font-weight: bold;color: #000"/>
                                                <span style="font-size: 0.8em">#{managedFactureAchat.currentScte.devise}</span>
                                            </p:outputPanel>
                                            <p:outputPanel layout="block" rendered="#{managedBonVente.contenu.article.categorie ne constantes.CAT_SERVICE}" style="padding-top: 5px; padding-bottom: 5px">
                                                <h:outputText value="#{managedBonVente.contenu.article.stock}" converter="#{managedBonVente.converterStock}" style="font-weight: bold;color: #000"/>
                                                <h:outputText value=" #{managedBonVente.contenu.conditionnement.unite.reference} #{lab.LC_PFV_en_stock}"/>
                                            </p:outputPanel>
                                        </div>
                                        <div style="margin-left: 61%;" align="center">
                                            <h:graphicImage id="img_article" style="max-width: 100%;max-height: 180px" value="data:image/#{Marticle.photoArticle(managedBonVente.contenu.article)[1]};base64,#{Marticle.photoArticle(managedBonVente.contenu.article)[0]}"/>
                                        </div>                                        
                                    </p:outputPanel>                                   
                                    <p:outputPanel id="chp_bcv_net_a_payer" layout="block" style="background: #FFF;padding-top:5px">
                                        <h:panelGrid columns="3" style="font-size: 0.8em;width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                            <span style="float: left">TTC :</span>
                                            <h:outputText value="#{lab.LC_PFV_ristourne} :"  />
                                            <h:outputText value="#{lab.LC_PFV_reste_a_payer} :"/>
                                            <h:panelGroup  >
                                                <h:outputText value="#{managedBonVente.docVente.montantTotal}" converter="#{managedBonVente.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                <span style="font-size: 0.8em">#{managedBonVente.currentScte.devise}</span>
                                            </h:panelGroup>  
                                            <h:panelGroup >                                                            
                                                <h:outputText value="#{managedBonVente.docVente.montantRistourne}" converter="#{managedBonVente.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                <span style="font-size: 0.8em">#{managedBonVente.currentScte.devise}</span>
                                            </h:panelGroup>  
                                            <h:panelGroup  >
                                                <h:outputText value="#{managedBonVente.docVente.montantResteApayer}" converter="#{managedBonVente.converter}" style="color: dodgerblue;font-weight: bold"/>       
                                                <span style="font-size: 0.8em">#{managedBonVente.currentScte.devise}</span>
                                            </h:panelGroup>
                                        </h:panelGrid>  
                                    </p:outputPanel>
                                </div>
                            </p:outputPanel>
                            <p:outputPanel id="blog_form_contenu_commande_vente">
                                <p:tabView id="tabview_commande_vente">
                                    <p:tab title="#{lab.LC_PCV_cotenus}">      
                                        <p:focus id="fcs_prix_vente_commande_vente" for="txt_prix_vente_commande_vente"/>
                                        <p:outputPanel id="blog_form_contenu_commande_vente">
                                            <h:panelGrid id="form_contenu_commande_vente"  styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" columns="1"
                                                         style="width: 100%;background: white;border: 2px solid #045491!important; border-radius: 5px; font-size: 0.9em">  
                                                <h:panelGrid styleClass="yvs_nostyle" cellpadding="0" cellspacing="0"
                                                             columns="#{(composantsVisible.fv_conditionnement and composantsVisible.fv_depot_content)?7:((composantsVisible.fv_conditionnement or composantsVisible.fv_depot_content)?6:5)}" >  
                                                    <h:outputText value="#{lab.L_article}"/>
                                                    <h:outputText value="#{lab.L_conditionnement}" rendered="#{composantsVisible.fv_conditionnement}"  />
                                                    <h:outputText value="#{lab.L_quantite}" />
                                                    <h:outputText value="#{lab.L_prix}"/>
                                                    <h:outputText value="#{lab.L_total}"/>
                                                    <span>&nbsp;</span>
                                                    <h:panelGroup id="blog_article_commande_vente">
                                                        <h:inputText value="#{managedBonVente.contenu.article.refArt}" style="color: #{managedBonVente.contenu.article.error?'red':''};width: 80%" disabled="#{managedBonVente.contenu.update}" tabindex="10">
                                                            <p:ajax event="valueChange" listener="#{managedBonVente.searchArticle()}" update="form_contenu_commande_vente"/>
                                                        </h:inputText>    
                                                        <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px;background: white;margin-top: 5px" title="#{lab.LC_PCV_listes_articles}" global="false" 
                                                                         actionListener="#{managedBonVente.initArticles()}" oncomplete="dlgListArticle.show()" disabled="#{managedBonVente.contenu.update}"/>
                                                    </h:panelGroup> 

                                                    <h:selectOneMenu value="#{managedBonVente.contenu.conditionnement.id}" style="min-width: 120px" title="#{lab.LC_PRA_selectionner_conditionnement}" tabindex="15"
                                                                     rendered="#{composantsVisible.fv_conditionnement}" required="#{composantsObligatoire.fv_conditionnement}" disabled="#{!composantsEditable.fv_conditionnement}">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedBonVente.contenu.article.conditionnements}" var="un" 
                                                                       itemLabel="#{un.unite.reference}" itemValue="#{un.id}"/>
                                                        <p:ajax event="valueChange" listener="#{managedBonVente.chooseConditionnement()}" update=":main_commande_vente:desc_article_commande_vente txt_prix_vente_commande_vente txt_prix_total_commande_vente"/>
                                                    </h:selectOneMenu>
                                                    <h:inputText value="#{managedBonVente.contenu.quantite}" style="max-width: 100px;text-align: right" tabindex="20">
                                                        <p:ajax event="valueChange" global="false" listener="#{managedBonVente.onQuantiteBlur()}" update="txt_prix_total_commande_vente txt_prix_vente_commande_vente fcs_prix_vente_commande_vente"/>
                                                    </h:inputText>
                                                    <h:panelGroup id="txt_prix_vente_commande_vente"> 
                                                        <h:inputText value="#{managedBonVente.contenu.prix}" style="max-width: 120px;text-align: right" readonly="#{!managedBonVente.contenu.article.changePrix}" tabindex="30">
                                                            <p:ajax event="valueChange" global="false" listener="#{managedBonVente.onPrixBlur()}" update="txt_prix_total_commande_vente"/>
                                                        </h:inputText>
                                                        <span> Fcfa</span>
                                                    </h:panelGroup> 

                                                    <h:panelGroup id="txt_prix_total_commande_vente">
                                                        <h:inputText value="#{managedBonVente.contenu.prixTotal}" style="text-align: right" readonly="true" converter="#{managedBonVente.converterStock}"/>
                                                        <span> Fcfa</span>
                                                    </h:panelGroup>
                                                    <p:commandButton id="save_contenu_commande_vente" icon="ui-icon-circle-plus" style="width: 22px; height: 22px" oncomplete="collapseForm('contenu_commande_vente')" tabindex="40"
                                                                     update="blog_form_contenu_commande_vente" actionListener="#{managedBonVente.saveNewContenu(false)}"/>
                                                </h:panelGrid> 
                                            </h:panelGrid> 
                                            <p:outputPanel>
                                                <p:dataTable id="data_contenu_commande_vente" value="#{managedBonVente.docVente.contenus}" var="artf" rowKey="#{artf.id}" 
                                                             rowIndexVar="artfIdx" selectionMode="single">
                                                    <p:ajax event="rowSelect" listener="#{managedBonVente.loadOnViewContenu}" oncomplete="collapseForm('contenu_commande_vente')" update=":main_commande_vente:tabview_commande_vente:form_contenu_commande_vente"/>
                                                    <p:ajax event="rowUnselect" listener="#{managedBonVente.unLoadOnViewContenu}" oncomplete="collapseForm('contenu_commande_vente')" update=":main_commande_vente:tabview_commande_vente:form_contenu_commande_vente"/>
                                                    <p:column headerText="N°" style="width: 5%;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{artf.new_}"/>
                                                        <span title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artfIdx+1}</span>
                                                        <h:graphicImage library="img" name="comment.png" width="15" height="15" rendered="#{artf.onComment}" style="float: right" title="#{lab.LDB_PC_a_ete_commente}"/>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_article}" style="color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        [<span style="font-weight: bold" title="#{lab.LC_PCV_numero_serie}: #{artf.numSerie}">#{artf.article.refArt}</span>]
                                                        <span title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}">#{artf.article.designation}</span>
                                                        <h:outputText title="#{lab.LC_PCV_facture_consignee}" value="C" rendered="#{artf.idReservation ne null}"
                                                                      style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 1px;background: black;color: white; float: right"/>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_qte}" style="width: 8%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:outputText value="#{artf.quantite}" converter="#{managedBonVente.converterStock}" title="Plus #{artf.quantiteBonus} Bonus"/>
                                                        <span title="#{artf.conditionnement.unite.libelle}" style="font-size: 0.6em;color: #003399">#{artf.conditionnement.unite.reference}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.LDB_PC_bonus}" style="width: 8%;text-align: center;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:outputText value="#{artf.quantiteBonus}" converter="#{managedBonVente.converterStock}" title="Sur l'article #{artf.articleBonus.designation}"/>
                                                        <span title="#{artf.conditionnementBonus.unite.libelle}" style="font-size: 0.6em;color: #003399; display: #{(artf.quantiteBonus gt 0)?'inline':'none'}">#{artf.conditionnementBonus.unite.reference}</span>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_prix}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:outputText value="#{artf.prix}" converter="#{managedBonVente.converter}" title="#{lab.LC_PCV_numero_serie}: #{artf.numSerie}"/>
                                                    </p:column>
                                                    <p:column headerText="#{lab.LDB_PC_rem}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:outputText value="#{artf.remise}" converter="DNS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                    </p:column>
                                                    <p:column headerText="#{lab.LDB_PC_rabais}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:outputText value="#{artf.quantite*artf.rabais}" converter="#{managedBonVente.converter}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_taxe}" style="width: 10%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:outputText value="#{artf.taxe}" converter="DNS" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                    </p:column>
                                                    <p:column headerText="#{lab.L_total}" style="width: 12%;text-align: right;color: #{artf.etat()=='R'?'orange':(artf.etat()=='P'?'red':'')};font-style: #{artf.etat()!='E'?'italic':''}">
                                                        <h:outputText value="#{artf.prixTotal}" converter="#{managedBonVente.converter}" title="#{lab.LC_PCV_numero_serie} : #{artf.numSerie}"/>
                                                    </p:column>
                                                    <p:column style="width: 5%;text-align: center">
                                                        <p:contextMenu for="btn_option_contenu_commande_vente" event="left click" style="font-size: 0.8em;width: 220px">
                                                            <p:menuitem value="#{lab.LC_PCV_voir_detail}" icon="ui-icon-search" global="false" actionListener="#{managedBonVente.setEntityContenu(artf)}" oncomplete="dlgInfosContenu.show()"/>
                                                            <p:menuitem value="#{lab.LDB_PC_rabais}" icon="ui-icon-suitcase" global="false" actionListener="#{managedBonVente.addRabaisContenu(artf)}" oncomplete="dlgAddRabais.show()"/>
                                                            <p:menuitem value="#{lab.LC_PCV_remise}" icon="ui-icon-suitcase" global="false" actionListener="#{managedBonVente.addRemiseContenu(artf)}" oncomplete="dlgAddRemise.show()"/>                                                            
                                                            <p:menuitem value="#{lab.LC_PCV_voir_taxes}" icon="ui-icon-copy" global="false" actionListener="#{managedBonVente.loadTaxesVente(artf)}" oncomplete="dlgListTaxesContenu.show()"/>
                                                            <p:separator style="width: 98%;margin: auto"/>
                                                            <p:menuitem value="#{lab.LC_PCV_note}" icon="ui-icon-comment" global="false" actionListener="#{managedBonVente.addCommentaireContenu(artf)}" oncomplete="dlgAddCommentaire.show()"/>
                                                            <p:menuitem value="#{lab.LC_PCV_numero_serie}" icon="ui-icon-info" global="false" actionListener="#{managedBonVente.addNumSerieContenu(artf)}" oncomplete="dlgAddNumSerie.show()"/>
                                                            <p:separator style="width: 98%;margin: auto"/>
                                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedBonVente.deleteBeanContenu_(artf)}" oncomplete="dlgConfirmDeleteArticle_.show()"/>
                                                        </p:contextMenu>                           
                                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_contenu_commande_vente" type="button"/>
                                                    </p:column> 
                                                </p:dataTable>
                                                <p:commandButton id="delete_contenu_commande_vente" value="#{lab.L_supprimer}" style="float: right" rendered="false"
                                                                 onclick="dlgConfirmDeleteArticle.show()" global="false"/>
                                            </p:outputPanel>
                                        </p:outputPanel> 
                                        <div style="clear: both"/>
                                    </p:tab>
                                    <p:tab title="#{lab.LC_PCV_reglements} (#{managedBonVente.docVente.reglements.size()})">
                                        <p:outputPanel id="form_mensualite_commande_vente">
                                            <h:panelGrid columns="3" style="width: 100%;background: white;border: 2px solid #045491!important; border-radius: 5px" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" rendered="#{accesRessource.fv_create_reglement}"> 
                                                <h:panelGrid id="blog_form_mensualite_commande_vente" columns="7" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" style="padding-top: 2px;padding-bottom: -5px">
                                                    <h:outputText value="#{lab.LC_PCV_mode_reglement}" />
                                                    <h:outputText value="#{lab.L_montant}" />
                                                    <h:outputText value="#{lab.LC_PCV_date_paiement}" />
                                                    <h:outputText value="#{lab.LC_PCV_caisse}" />
                                                    <h:outputText value="#{lab.LC_PCV_caissier}" />
                                                    <h:outputText value="#{lab.LC_PCV_statut}"  />
                                                    <h:outputText value="#{lab.LC_PCV_ref_externe}" style="margin-left: 100px"/>
                                                    <h:selectOneMenu value="#{managedBonVente.reglement.mode.id}" id="select_model_mens_commande_vente" style="min-width: 120px">
                                                        <f:selectItem itemLabel="--" itemValue="0"/>
                                                        <f:selectItems value="#{managedModeReglement.modes}" var="modelm" itemLabel="#{modelm.designation}" itemValue="#{modelm.id}" />     
                                                    </h:selectOneMenu>  
                                                    <pe:inputNumber value="#{managedBonVente.reglement.montant}"  style="text-align: right"/>
                                                    <p:calendar value="#{managedBonVente.reglement.datePaiementPrevu}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                                                    <h:selectOneMenu value="#{managedBonVente.reglement.caisse.id}" valueChangeListener="#{managedBonVente.chooseCaisses}" style="min-width: 140px">
                                                        <f:selectItem itemLabel="" itemValue="0" />
                                                        <f:selectItems value="#{managedCaisses.caisses}" var="icaiss" itemLabel="#{icaiss.intitule}" itemValue="#{icaiss.id}" />
                                                        <p:ajax event="valueChange"/>
                                                    </h:selectOneMenu>
                                                    <h:selectOneMenu id="chmp_caissier_reglement_bcv" value="#{managedBonVente.reglement.caissier.id}" style="min-width: 140px" disabled="#{!accesRessource.compta_reg_fv_change_caissier}">
                                                        <f:selectItem itemLabel="" itemValue="0" />
                                                        <f:selectItems value="#{managedBonVente.caissiers}" var="iCaissier" itemLabel="#{iCaissier.nomUsers}" itemValue="#{iCaissier.id}" />
                                                        <p:ajax event="valueChange"/>
                                                    </h:selectOneMenu>
                                                    <h:selectOneMenu value="#{managedBonVente.reglement.statutPiece}" >
                                                        <f:selectItem itemValue="#{constantes.STATUT_DOC_PAYER}" itemLabel="#{lab.LC_PCV_regler}" />
                                                        <f:selectItem itemValue="#{constantes.STATUT_DOC_ATTENTE}" itemLabel="#{lab.LC_PCV_en_attente}" />                                                    
                                                    </h:selectOneMenu>
                                                    <h:panelGroup style="margin-left: 100px">
                                                        <h:inputText value="#{managedBonVente.reglement.numRefExterne}" />
                                                        <p:commandButton id="save_mensualite_commande_vente" icon="ui-icon-circle-plus" style="width: 22px; height: 22px;float: right" oncomplete="collapseForm('mensualite_commande_vente')"
                                                                         update="form_mensualite_commande_vente" actionListener="#{managedBonVente.saveNewReglement(false)}"/>
                                                    </h:panelGroup> 
                                                </h:panelGrid>                                            
                                            </h:panelGrid>    
                                            <p:dataTable id="data_mensualite_commande_vente" value="#{managedBonVente.docVente.reglements}" var="men" rowKey="#{men.id}" 
                                                         rowIndexVar="menIdx" selectionMode="single" selection="#{managedBonVente.selectedPiece}">
                                                <p:ajax event="rowSelect" global="false" listener="#{managedBonVente.loadOnViewMensualite}" oncomplete="collapseForm('mensualite_commande_vente')"
                                                        update=":main_commande_vente:tabview_commande_vente:blog_form_mensualite_commande_vente :main_commande_vente:tabview_commande_vente:zone_auteur_reg"/>
                                                <p:ajax event="rowUnselect" global="false" listener="#{managedBonVente.unLoadOnViewMensualite}" oncomplete="collapseForm('mensualite_commande_vente')"
                                                        update=":main_commande_vente:tabview_commande_vente:blog_form_mensualite_commande_vente"/>
                                                <p:column headerText="N°" width="20" style="text-align: center" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <f:facet name="header">
                                                        <p:contextMenu for="chp_view_id_pcr" event="left click" styleClass="context_menu">
                                                            <p:menuitem update="data_mensualite_commande_vente" global="false" value="#{lab.LC_PCV_voir_identifiant}" actionListener="#{men.setView_id(!men.view_id)}"/>
                                                        </p:contextMenu>
                                                        <h:outputText value="N°" id="chp_view_id_pcr" style="cursor: pointer"/>
                                                    </f:facet>
                                                    <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{men.new_}"/>
                                                    <h:outputText value="#{menIdx+1}" rendered="#{!men.view_id}"/>
                                                    <h:outputText value="#{men.id}" rendered="#{men.view_id}"/>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PCV_mode_reglement}" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <h:outputText value="#{men.model.designation}"/>
                                                    <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_ATTENTE)?'inline-block':'none'}; width: 10px; height: 10px; background: #444;" title="#{lab.LC_PCV_en_attente_paiement}"></span>
                                                    <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_ENCOUR)?'inline-block':'none'}; width: 10px; height: 10px; background: #f6a828" title="#{lab.LC_PCV_en_cours_paiement}"></span>
                                                    <span style="display: #{(men.statutPiece==constantes.STATUT_DOC_PAYER)?'inline-block':'none'}; width: 10px; height: 10px; background: #006666" title="#{lab.LC_PCV_piece_regle}"></span>
                                                    <span style="display: #{(men.phasesReglement.size() gt 0)?'inline-block':'none'}; width: 10px; height: 10px; background: #99ccff" title="#{lab.LC_PCV_phases_reglement_generer}"></span>
                                                    <h:graphicImage title="#{lab.LC_PCV_text16}" library="icones" name="alert.png" width="15" height="15" rendered="#{men.error()}" style="float: right"/>  
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PCV_piece_numero}" sortBy="#{men.datePiece}" style="text-align: center" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <h:outputText value="#{men.numeroPiece}"/>
                                                    <h:outputText rendered="#{men.notifs.id gt 0}" value="A" styleClass="statut" title="#{lab.LC_PCV_paiement_lie_acompte} #{men.notifs.acompte.numRefrence}" style="float: right"/>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PCV_date_edition}" sortBy="#{men.datePiece}" style="text-align: center" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <h:outputText value="#{men.datePiece}" converter="DDMMYYYY"/>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PCV_date_reglement}" sortBy="#{men.datePaimentPrevu}" style="text-align: center" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <h:outputText value="#{men.datePaimentPrevu}" converter="DDMMYYYY"/>
                                                </p:column>
                                                <p:column headerText="#{lab.LC_PCV_caisse}" style="width: 17%;text-align: right" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <h:outputText value="#{men.caisse.intitule}" />
                                                </p:column>
                                                <p:column headerText="#{lab.L_montant}" style="width: 17%;text-align: right" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <h:outputText value="#{men.montant}" converter="#{managedBonVente.converter}"/>
                                                </p:column>
                                                <p:column headerText="#{lab.L_reference}" style="width: 17%;text-align: right" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <h:outputText value="#{men.referenceExterne}"/>
                                                </p:column>
                                                <p:column style="text-align: center" width="20" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}" rendered="#{managedBonVente.docVente.statut eq constantes.ETAT_ANNULE}">
                                                    <h:graphicImage library="img/icones" name="#{(men.mouvement == 'R' )?'in.png':'out.png'}" width="15" height="15" title="#{(men.mouvement == 'R' )?'Recettes':'Dépenses'}"/>
                                                </p:column>
                                                <p:column style="width: 5%;text-align: center" styleClass="statut_#{managedBonVente.giveStringStatut(men.statutPiece)}">
                                                    <p:contextMenu for="btn_option_mensualite_commande_vente" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                                        <p:menuitem value="#{(men.statutPiece=='P')?'Annuler':'Encaisser/Valider'}" icon="#{(men.statutPiece=='P')?'ui-icon-circle-close':'ui-icon-circle-check'}" rendered="#{men.id gt 0 and men.phasesReglement.size() le 0}"  
                                                                    actionListener="#{managedBonVente.openConfirmPaiement(men, 'F', false)}" update=":main_commande_vente:grp_btn_etat_commande_vente data_mensualite_commande_vente"/>
                                                        <p:menuitem value="#{lab.LC_PCV_aller_aux_cheques}" icon="ui-icon-arrowthick-1-e"  actionListener="#{managedFactureVente.onSelectDistantReglement(men)}"
                                                                    rendered="#{accesPage.compta_view_reg_vente and men.model.typeReglement == constantes.MODE_PAIEMENT_BANQUE and men.phasesReglement.size() gt 0}"/>
                                                        <p:menuitem value="#{lab.LC_PCV_aller_acompte}" icon="ui-icon-arrowthick-1-e"  actionListener="#{managedOperationClient.onSelectDistant(men.notifs.acompte)}"
                                                                    rendered="#{accesPage.compta_ope_client and men.notifs.id gt 0}"/>
                                                        <p:menuitem value="#{lab.L_annuler}" icon="ui-icon-circle-close" title="#{lab.LC_PCV_annuler_toutes_phases_cheque}"  actionListener="#{managedReglementVente.openConfirmPaiement(men,'F', false)}"
                                                                    rendered="#{men.model.typeReglement == constantes.MODE_PAIEMENT_BANQUE and men.phasesReglement.size() gt 0}"/>
                                                        <p:separator style="width: 98%;margin: auto"/>
                                                        <p:menuitem value="#{lab.LC_PCV_dissocier}" icon="ui-icon-pin-w" actionListener="#{managedReglementVente.dissocierNotif(men)}" rendered="#{men.notifs.id gt 0}"
                                                                    update="data_mensualite_commande_vente"/>
                                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash"  actionListener="#{managedBonVente.deleteBeanReglement_(men)}" oncomplete="dlgConfirmDeleteMensualite_.show()"/>
                                                    </p:contextMenu>                           
                                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_mensualite_commande_vente" type="button"/>
                                                </p:column> 
                                            </p:dataTable>
                                            <br/>
                                        </p:outputPanel>
                                        <div style="clear: both"/>
                                        <div style="margin-bottom: -20px; font-size: 0.7em" align="right">
                                            <h:panelGroup  id="zone_auteur_reg">
                                                <span>#{lab.L_par} </span>
                                                <h:outputText value="#{managedReglementVente.selectedPiece.author.users.nomUsers}" />
                                                <span>#{lab.L_le} </span>
                                                <h:outputText value="#{managedReglementVente.selectedPiece.dateUpdate}" converter="DATETIME" />
                                            </h:panelGroup>
                                        </div>
                                    </p:tab>
                                    <p:tab title="#{lab.LC_PCV_doc_lies} (#{managedBonVente.docVente.documents.size()})">
                                        <p:dataTable value="#{managedBonVente.docVente.documents}" var="iLivr" rowKey="#{iLivr.id}" rowIndexVar="iLivrIdx" selectionMode="single"
                                                     id="data_livraison_commande_vente">
                                            <p:column width="35" headerText="N°" styleClass="statut_#{iLivr.statut}">
                                                <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{iLivr.cloturer}"/>  
                                                <span>#{iLivrIdx+1}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.L_reference}" styleClass="statut_#{iLivr.statut}">
                                                <span>#{iLivr.numDoc}</span>
                                                <h:outputText value="vide" style="float: right;color: blue;font-style: italic;font-size: 0.8em" rendered="#{0>=iLivr.contenus.size()}"/>                                   
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PCV_date_doc}" style="text-align: center" styleClass="statut_#{iLivr.statut}">
                                                <h:panelGroup rendered="#{iLivr.statut == constantes.ETAT_VALIDE}">
                                                    <h:outputText value="#{iLivr.dateLivraison}" converter="DDMMYYYY"/>
                                                    <span> #{lab.L_a} </span>
                                                    <h:outputText value="#{iLivr.heureDoc}" converter="TIME"/>
                                                </h:panelGroup>
                                                <h:outputText value="#{lab.LC_PCV_non_livre}" rendered="#{iLivr.statut != constantes.ETAT_VALIDE}"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PCV_tranche}" style="text-align: center" styleClass="statut_#{iLivr.statut}">
                                                <h:outputText value="#{iLivr.trancheLivrer.heureDebut}" converter="TIME"/>
                                                <span> - </span>
                                                <h:outputText value="#{iLivr.trancheLivrer.heureFin}" converter="TIME"/>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PCV_depot}" styleClass="statut_#{iLivr.statut}"> 
                                                <span>#{iLivr.depotLivrer.designation}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.L_type}" styleClass="statut_#{iLivr.statut}" style="text-align: center">
                                                <span >#{iLivr.typeDoc}</span>
                                            </p:column>
                                            <p:column headerText="#{lab.LC_PCV_auteur}" styleClass="statut_#{iLivr.statut}">
                                                <h:outputText value="#{iLivr.author.users.nomUsers}" rendered="#{iLivr.statut!=constantes.STATUT_DOC_VALIDE}"/>
                                                <h:outputText value="#{iLivr.livreur.nomUsers}" rendered="#{iLivr.statut==constantes.STATUT_DOC_VALIDE and iLivr.typeDoc==constantes.TYPE_BLV}"/>
                                                <h:outputText value="#{iLivr.validerBy.nomUsers}" rendered="#{iLivr.statut==constantes.STATUT_DOC_VALIDE and (iLivr.typeDoc==constantes.TYPE_FAV or iLivr.typeDoc==constantes.TYPE_BRV)}"/>
                                            </p:column>
                                            <p:column style="width: 5%;text-align: center" styleClass="statut_#{iLivr.statut}">
                                                <p:contextMenu for="btn_option_livraison_commande_vente" event="left click" style="font-size: 0.8em" styleClass="context_menu">                                 
                                                    <p:menuitem value="#{lab.L_valider}" icon="ui-icon-circle-check" actionListener="#{managedBonVente.onValideDistantLivraison(iLivr)}"  
                                                                update="data_livraison_commande_vente :main_commande_vente:data_commande_vente" rendered="#{iLivr.statut != constantes.ETAT_VALIDE}"/>
                                                    <p:menuitem value="#{lab.L_annuler}" icon="ui-icon-circle-triangle-w" actionListener="#{managedBonVente.onAnnulerDistantLivraison(iLivr)}"  
                                                                update="data_livraison_commande_vente :main_commande_vente:data_commande_vente" rendered="#{iLivr.statut != constantes.ETAT_EDITABLE}"/>
                                                    <p:menuitem value="#{lab.L_suspendre}" icon="ui-icon-circle-close" actionListener="#{managedBonVente.onRefuserDistantLivraison(iLivr)}" 
                                                                update="data_livraison_commande_vente :main_commande_vente:data_commande_vente" rendered="#{iLivr.statut != constantes.ETAT_ANNULE}"/>
                                                    <p:separator style="width: 98%;margin: auto"/>
                                                    <p:menuitem value="#{lab.L_aller_a}" icon="ui-icon-arrowthick-1-e" global="false" actionListener="#{managedBonVente.onSelectDistantLivraison(iLivr)}"/>
                                                    <p:menuitem value="#{lab.L_telecharger}" icon="ui-icon-circle-arrow-s" global="false"  actionListener="#{managedLivraisonVente.print(iLivr)}" ajax="false"/>
                                                </p:contextMenu>                           
                                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_livraison_commande_vente" type="button"/>
                                            </p:column> 
                                        </p:dataTable>
                                    </p:tab>
                                </p:tabView>
                            </p:outputPanel> 
                        </h:panelGrid>
                    </p:outputPanel>
                </div>
                <!-->
                 *****************************************************************************
                 Vue Liste
                 *****************************************************************************
                <-->
                <div class="yvs_list_commande_vente" style="width: 99%; margin: auto; background: white">
                    <div class="part_list">
                        <p:outputPanel id="data_commande_vente">
                            <h:inputHidden id="input_hide_commande_vente" value="#{managedBonVente.tabIds}"/>
                            <p:dataTable value="#{managedBonVente.documents}" var="bon" rowKey="#{bon.id}" rowIndexVar="bonIdx" selectionMode="single" >
                                <p:ajax event="rowSelect" listener="#{managedBonVente.loadOnView}" update=":main_commande_vente:input_hide_commande_vente"
                                        oncomplete="collapseForm('commande_vente');collapseForm('contenu_commande_vente');collapseForm('cout_commande_vente');collapseForm('mensualite_commande_vente');collapseForm('remise_vente')"/>
                                <p:column width="35" headerText="N°" styleClass="statut_#{bon.statut}">
                                    <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{bon.cloturer}"/>  
                                    <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{bon.id eq managedBonVente.docVente.id}"/>
                                    <span>#{bonIdx+1}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}">
                                    <span>#{bon.numDoc}</span>
                                    <h:panelGroup style="float: right">
                                        <h:outputText title="#{lab.LC_PCV_commande_reglee}" value="R" rendered="#{bon.statutRegle == constantes.ETAT_REGLE}" styleClass="style_statut"/>
                                        <p:spacer width="2" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE or bon.livraisonAuto}"/>
                                        <h:outputText title="#{lab.LC_PCV_livraison_automatique}" value="A" rendered="#{bon.livraisonAuto and bon.statutLivre != constantes.ETAT_LIVRE}" styleClass="style_statut" style="font-size: 0.8em"/>
                                        <h:outputText title="#{lab.LC_PCV_commande_livree}" value="L" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE}" styleClass="style_statut"/>
                                        <p:spacer width="2" rendered="#{bon.consigner and bon.statutLivre != constantes.ETAT_LIVRE}"/>
                                        <h:outputText title="#{lab.LC_PCV_stock_facture_consigne}" value="C" rendered="#{managedFactureVente.isConsigner(bon) and bon.statutLivre != constantes.ETAT_LIVRE}" styleClass="style_statut"/>
                                    </h:panelGroup>
                                </p:column>
                                <p:column headerText="#{lab.LC_PCV_date_commande}" style="text-align: center" styleClass="statut_#{bon.statut}">
                                    <h:outputText value="#{bon.enteteDoc.dateEntete}" converter="DDMMYYYY"/>
                                    <span> #{lab.L_a} </span>
                                    <h:outputText value="#{bon.heureDoc}" converter="TIME"/>
                                </p:column>
                                <p:column headerText="#{lab.LC_PCV_client}" styleClass="statut_#{bon.statut}">
                                    <span>#{bon.client.nom_prenom}</span>
                                </p:column>
                                <p:column headerText="#{lab.L_point_vente}" styleClass="statut_#{bon.statut}">
                                    <span>#{bon.enteteDoc.creneau.creneauPoint.point.libelle}</span>
                                </p:column>
                                <p:column headerText="#{lab.LC_PCV_vendeur}" styleClass="statut_#{bon.statut}">
                                    <span>#{bon.enteteDoc.creneau.users.nomUsers}</span>
                                </p:column>
                                <p:column width="20" style="text-align: center" styleClass="statut_#{bon.statut}">
                                    <f:facet name="header">
                                        <p:contextMenu for="btn_option_head_commande_vente" event="left click" styleClass="context_menu" style="width: 210px">   
                                            <p:menuitem icon="ui-icon-carat-2-e-w" value="#{lab.LC_PFV_maitenance}" actionListener="#{managedBonVente.maintenance()}"/>                                            
                                        </p:contextMenu>
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_head_commande_vente" type="button"/>
                                    </f:facet>
                                    <p:contextMenu for="btn_option_commande_vente" event="left click" style="font-size: 0.8em">
                                        <p:menuitem icon="ui-icon-carat-2-e-w" value="Equilibrer Statut" actionListener="#{managedBonVente.equilibre(bon)}" update=":main_commande_vente:data_commande_vente"/>
                                        <p:menuitem icon="ui-icon-carat-2-e-w" value="#{lab.LC_PFV_maitenance}" actionListener="#{managedBonVente.maintenance(bon, true)}" update=":main_commande_vente:data_commande_vente"/>  
                                        <p:separator style="width: 98%;margin: auto"/>
                                        <p:menuitem value="#{bon.cloturer?'Dévérrouiller':'Vérrouiller'}" icon="#{bon.cloturer?'ui-icon-unlocked':'ui-icon-locked'}" 
                                                    global="false" actionListener="#{managedBonVente.cloturer(bon)}" oncomplete="dlgConfirmClose.show()"/>
                                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedBonVente.deleteBean_(bon)}" oncomplete="dlgConfirmDelete_.show()"/>
                                        <p:separator style="width: 98%;margin: auto"/>
                                        <p:menuitem value="#{lab.L_telecharger}" icon="ui-icon-print" global="false" actionListener="#{managedFactureVente.print(bon)}" ajax="false" disabled="true"/>
                                    </p:contextMenu>                           
                                    <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_commande_vente" type="button"/>
                                </p:column> 
                                <p:column width="25" style="text-align: center" styleClass="statut_#{bon.statut}">
                                    <f:facet name="header">
                                        <h:selectBooleanCheckbox styleClass="chek_all_line_commande_vente" value="false"
                                                                 onclick="selectionAllLineTab(#{managedBonVente.documents.size()}, 'commande_vente')">
                                        </h:selectBooleanCheckbox>
                                    </f:facet>
                                    <h:selectBooleanCheckbox  value="#{bon.selectActif}" styleClass="chek_line_commande_vente" 
                                                              onclick="selectionLineTab(#{bonIdx}, 'commande_vente')">
                                    </h:selectBooleanCheckbox>
                                </p:column>
                            </p:dataTable>      
                            <span class="nbSelectcommande_vente" style="font-size: .8em; font-style: italic; color: #828c95;"></span>
                            <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                                <p:commandButton actionListener="#{managedBonVente.init(false)}" update="data_commande_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedBonVente.paginator.disPrev}"/>
                                <p:outputPanel >
                                    <p:inplace label="#{managedBonVente.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                        <pe:inputNumber value="#{managedBonVente.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                            <p:ajax event="blur" listener="#{managedBonVente.gotoPagePaginator()}" update="data_commande_vente"/>
                                        </pe:inputNumber>
                                    </p:inplace><p:outputLabel value="/#{managedBonVente.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                                </p:outputPanel>
                                <p:commandButton actionListener="#{managedBonVente.init(true)}" update="data_commande_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedBonVente.paginator.disNext}"/>
                                <p:selectOneMenu value="#{managedBonVente.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedBonVente.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                                    <f:selectItems value="#{managedBonVente.paginations}"/>
                                    <p:ajax event="valueChange"  update="data_commande_vente"/>
                                </p:selectOneMenu>
                            </p:outputPanel>   
                        </p:outputPanel>
                    </div>                                          
                </div> 
                <!-->
                 *****************************************************************************
                 Vue Grid
                 *****************************************************************************
                <-->
                <div class="yvs_grid_commande_vente">
                    <p:outputPanel id="blog_grid_commande_vente">

                    </p:outputPanel>
                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">            
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative; bottom: -20px" width="20" height="20"
                            styleClass="img_slide" title="cacher"/>  
            <div class="zone_find">
                <div class="display_auteur" align="right"  style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">Enregistré Le <h:outputText value="#{managedBonVente.selectDoc.dateSave}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                        <span>Modifier Le <h:outputText value="#{managedBonVente.selectDoc.dateUpdate}" styleClass="valeur" converter="DTL" style="font-weight: bold"/></span>
                        <span>Par <h:outputText value="#{managedBonVente.selectDoc.author.users.nomUsers}" styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <h:panelGrid id="blog_search_bcv" columns="2" style="width: 100%; font-size: 0.8em" cellpadding="0" cellspacing="0">
                    <h:panelGrid columns="9" style="float: left; font-size: 1.0em" cellpadding="0" cellspacing="0">
                        <h:outputText value="" />
                        <h:panelGroup>
                            <h:selectBooleanCheckbox value="#{managedBonVente.date}">
                                <p:ajax event="valueChange" listener="#{managedBonVente._chooseDateSearch()}" oncomplete="collapseList('commande_vente')"
                                        update="blog_date_search_entete_commande_vente :main_commande_vente:data_commande_vente"/>
                            </h:selectBooleanCheckbox>
                            <h:outputText value="#{lab.L_date}" /> 
                        </h:panelGroup>
                        <h:outputText value="#{lab.LC_PCV_vendeur}" />
                        <h:outputText value="#{lab.LC_PCV_client}"/>
                        <h:panelGroup>
                            <h:outputText value="#{lab.LC_PCV_statut}" style="float:left;margin-top: 2px"/>
                            <h:selectOneMenu value="#{managedBonVente.egaliteStatut}" style="float:right;margin-right: 5px;">
                                <f:selectItem itemLabel="#{lab.LC_PCV_egale}" itemValue="="/>
                                <f:selectItem itemLabel="#{lab.LC_PCV_different}" itemValue="!="/>
                                <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" listener="#{managedBonVente.addParamStatut()}" oncomplete="collapseList('commande_vente')"/>
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <h:panelGroup> 
                            <h:outputText value="#{lab.LC_PCV_statut_liv}" style="float:left;margin-top: 2px"/>
                            <h:selectOneMenu value="#{managedBonVente.egaliteStatutL}" style="float:right;margin-right: 5px;">
                                <f:selectItem itemLabel="#{lab.LC_PCV_egale}" itemValue="="/>
                                <f:selectItem itemLabel="#{lab.LC_PCV_different}" itemValue="!="/>
                                <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" listener="#{managedBonVente.addParamStatutLivre()}" oncomplete="collapseList('commande_vente')"/>
                            </h:selectOneMenu> 
                        </h:panelGroup> 
                        <h:outputText value="#{lab.L_reference}" />
                        <h:outputText value="" />
                        <span>&nbsp;</span>
                        <p:commandButton icon="ui-icon-bullet" actionListener="#{managedBonVente.clearParams()}" title="#{lab.L_reset_param}" style="width: 20px; height: 22px" 
                                         update="blog_search_bcv :main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')" />
                        <h:panelGroup id="blog_date_search_entete_commande_vente">
                            <p:calendar value="#{managedBonVente.dateDebut}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedBonVente.date}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" listener="#{managedBonVente._chooseDateSearch()}" update=":main_commande_vente:data_commande_vente"
                                        oncomplete="collapseList('commande_vente')"/>
                            </p:calendar>
                            <p:spacer width="5px" style="background: black"/>
                            <p:calendar value="#{managedBonVente.dateFin}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedBonVente.date}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" listener="#{managedBonVente._chooseDateSearch()}" update=":main_commande_vente:data_commande_vente"
                                        oncomplete="collapseList('commande_vente')"/>
                            </p:calendar>
                        </h:panelGroup>
                        <h:inputText value="#{managedBonVente.codeVendeur_}" style="min-width: 120px">
                            <p:ajax event="valueChange" listener="#{managedBonVente._searchVendeur()}" oncomplete="collapseList('commande_vente')"
                                    update=":main_commande_vente:data_commande_vente"/>
                        </h:inputText>
                        <h:inputText value="#{managedBonVente.codeClient_}" style="width: 100%">
                            <p:ajax event="valueChange" listener="#{managedBonVente.searchByClient()}" oncomplete="collapseList('commande_vente')"
                                    update=":main_commande_vente:data_commande_vente"/>
                        </h:inputText>  
                        <h:selectOneMenu value="#{managedBonVente.statut}" valueChangeListener="#{managedBonVente.chooseStatut}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            <f:selectItem itemLabel="#{lab.L_annuler}" itemValue="#{constantes.ETAT_ANNULE}"/>
                            <f:selectItem itemLabel="#{lab.L_valider}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{managedBonVente.statutLivre_}" valueChangeListener="#{managedBonVente.chooseStatutLivre}" style="min-width: 150px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_en_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_livrer}" itemValue="#{constantes.STATUT_DOC_LIVRER}"/>
                            <p:ajax event="valueChange" update=":main_commande_vente:data_commande_vente" oncomplete="collapseList('commande_vente')"/>
                        </h:selectOneMenu>
                        <h:inputText value="#{managedBonVente.numSearch_}">
                            <p:ajax event="valueChange" listener="#{managedBonVente.searchByNum()}"
                                    oncomplete="collapseList('commande_vente')" update=":main_commande_vente:data_commande_vente"/>
                        </h:inputText>
                        <p:commandLink style="border: 2px solid black; border-radius: 5px;padding: 2px;font-size: 0.8em" 
                                       onclick="dlgPlusOption.show()" global="false" value="Avancées"/>
                    </h:panelGrid>
                    <h:panelGroup style="float: right">
                        <p:commandLink onclick="dlgCleanVente.show()" global="false" style="border: 2px solid black; border-radius: 5px;padding: 3px;" 
                                       title="#{lab.LC_PRA_nettoyage_stock}" rendered="#{accesRessource.fv_clean}">
                            <h:graphicImage library="img" name="clean.png" width="15" height="18"/>  
                        </p:commandLink>
                    </h:panelGroup>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>