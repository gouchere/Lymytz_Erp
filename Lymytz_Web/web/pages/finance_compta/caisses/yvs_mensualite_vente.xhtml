<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets">     
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Mensualit√©s ventes','modCompta', 'smenMenVente', true)}
    </ui:define>        
    <ui:define name="contents">
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 135);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('mens_vente');
            });
        </script>       
        #{managedVente.doNothing()}
        #{managedMensualiteVente.loadAll()}
        #{managedFactureVente.loadAll()}
        #{managedPointVente.loadPointVenteByDroit(true, true)}    
        #{managedModeReglement.loadModels('C')}

        <!-->
        *****************************************************************************
        Boite de dialogue des entetes de vente
        *****************************************************************************
        <-->  
        <h:form prependId="false">
            <p:dialog header="#{lab.L_plus_option}" width="40%"  closeOnEscape="true" widgetVar="dlgPlusOption" resizable="false"> 
                <h:panelGrid id="blog_entete_mens_vente" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_agence}" rendered="#{acces.multiAgence}"/>
                    <h:selectOneMenu value="#{managedFactureVente.agence_}" id="_select_agence2" style="width: 100%" rendered="#{acces.multiAgence}">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedFactureVente.agences_}" var="ag"
                                       itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVente._chooseAgence()}" oncomplete="collapseList('mens_vente')" 
                                update="blog_entete_mens_vente :main-mens_vente:data_mens_vente"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.L_point_vente}"/>
                    <h:selectOneMenu value="#{managedFactureVente.point_}" style="width: 100%">
                        <f:selectItem itemLabel="--#{lab.LDB_PPC_precedent}--" itemValue="-1"/>
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItems value="#{managedPointVente.pointsvente}" var="_po" 
                                       itemLabel="#{_po.libelle}" itemValue="#{_po.id}" />  
                        <f:selectItem itemLabel="--" itemValue="0"/>
                        <f:selectItem itemLabel="--#{lab.LDB_PPC_suivant}--" itemValue="-2"/>  
                        <p:ajax event="valueChange" listener="#{managedFactureVente._choosePoint()}" oncomplete="collapseList('mens_vente')"
                                update="_select_tranche_mens_vente :main-mens_vente:data_mens_vente @this"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LCF_PMV_statut_liv}"/>
                    <h:panelGroup> 
                        <h:selectOneMenu value="#{managedFactureVente.egaliteStatutL}">
                            <f:selectItem itemLabel="#{lab.L_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.L_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente.addParamStatutLivre()}" oncomplete="collapseList('mens_vente')"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVente.statutLivre_}" valueChangeListener="#{managedFactureVente.chooseStatutLivre}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_livrer}" itemValue="#{constantes.STATUT_DOC_LIVRER}"/>
                            <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                        </h:selectOneMenu>
                    </h:panelGroup>
                    <h:outputText value="#{lab.LCF_PMV_statut_reg}."/>
                    <h:panelGroup>
                        <h:selectOneMenu value="#{managedFactureVente.egaliteStatutR}">
                            <f:selectItem itemLabel="#{lab.L_egale}" itemValue="="/>
                            <f:selectItem itemLabel="#{lab.L_different}" itemValue="!="/>
                            <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente.addParamStatutRegle()}" oncomplete="collapseList('mens_vente')"/>
                        </h:selectOneMenu>  
                        <h:selectOneMenu value="#{managedFactureVente.statutRegle_}" valueChangeListener="#{managedFactureVente.chooseStatutRegle}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_attente}" itemValue="#{constantes.STATUT_DOC_ATTENTE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.STATUT_DOC_ENCOUR}"/>
                            <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.STATUT_DOC_PAYER}"/>
                            <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                        </h:selectOneMenu> 
                    </h:panelGroup>
                    <h:outputText value="#{lab.L_tranche}"/>
                    <h:selectOneMenu value="#{managedFactureVente.tranche_}" id="_select_tranche_mens_vente" style="width: 100%">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedFactureVente.tranches_point_}" var="tr"
                                       itemLabel="#{tr.titre}" itemValue="#{tr.id}"/>
                        <p:ajax event="valueChange" listener="#{managedFactureVente._chooseTranche()}" oncomplete="collapseList('mens_vente')"
                                update=":main-mens_vente:data_mens_vente"/>
                    </h:selectOneMenu>                     
                    <h:outputText value="#{lab.LCF_PMV_verrouille}"/>
                    <h:selectOneMenu value="#{managedFactureVente.cloturer_}" valueChangeListener="#{managedFactureVente.chooseCloturer}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_oui.toUpperCase()}" itemValue="#{true}"/>
                        <f:selectItem itemLabel="#{lab.L_non.toUpperCase()}" itemValue="#{false}"/>
                        <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                    </h:selectOneMenu>                    
                    <h:panelGroup>
                        <h:outputText value="#{lab.LCF_PMV_heures}"/>
                        <h:selectBooleanCheckbox value="#{managedFactureVente.date_}" style="margin-top: 2px;float: right">
                            <p:ajax event="valueChange" listener="#{managedFactureVente.chooseDateSearch()}" oncomplete="collapseList('mens_vente')"
                                    update="blog_date_search_mens_vente :main-mens_vente:data_mens_vente"/>
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_search_mens_vente">
                        <pe:timePicker value="#{managedFactureVente.dateDebut_}" disabled="#{!managedFactureVente.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedFactureVente.chooseDateSearch()}" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                        </pe:timePicker>
                        <p:spacer width="5px" style="background: black"/>
                        <pe:timePicker value="#{managedFactureVente.dateFin_}" disabled="#{!managedFactureVente.date_}" style="width: 80px;text-align: left">
                            <p:ajax event="timeSelect" listener="#{managedFactureVente.chooseDateSearch()}" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                        </pe:timePicker>
                    </h:panelGroup>                  
                    <h:outputText value="#{lab.LCF_PMV_reprensentant}" />
                    <h:inputText value="#{managedFactureVente.otherSearch_}" style="width: 100%">
                        <p:ajax event="valueChange" listener="#{managedFactureVente.searchByRepr()}" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                    </h:inputText>  
                    <h:outputText value="#{lab.LCF_PMV_commande}"/>
                    <h:inputText value="#{managedFactureVente.numBon}" style="width: 100%" title="#{lab.LC_PFV_text16}">
                        <p:ajax event="valueChange" listener="#{managedFactureVente.chooseCommande()}" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                    </h:inputText>
                </h:panelGrid>                
                <f:facet name="footer"> 

                </f:facet>
            </p:dialog>
        </h:form>

        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LCF_PMV_text}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedMensualiteVente.deleteBean()}" oncomplete="dlgConfirmDelete.hide()"/>
                <p:commandButton type="button"  value="#{lab.L_non}" onclick="dlgConfirmDelete.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false" id="main-mens_vente">             
            <div class="part_fix">
                <div align="left" style="float: left">
                    <p:commandButton value="#{lab.L_nouveau}" id="cancel_mens_vente" actionListener="#{managedMensualiteVente.resetFiche()}" oncomplete="collapseForm('mens_vente')" />
                </div>
                <p:outputPanel style="margin-left: 40%"  autoUpdate="true">
                    <p:commandButton actionListener="#{managedMensualiteVente.parcoursInAllResult(false)}" update="txt_parc_linear_mens_vente data_mens_vente" 
                                     icon="ui-icon-circle-triangle-w" oncomplete="collapseForm('mens_vente')"/>
                    <h:inputText value="#{managedFactureVente.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_mens_vente"/>
                    <p:outputLabel value="/#{managedFactureVente.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                    <p:commandButton actionListener="#{managedMensualiteVente.parcoursInAllResult(true)}" update="txt_parc_linear_mens_vente data_mens_vente" 
                                     icon="ui-icon-circle-triangle-e" oncomplete="collapseForm('mens_vente')"/>
                    <h:outputText value="#{managedMensualiteVente.docVente.id}" title="#{lab.LDB_PPC_identifiant_element_courant}" styleClass="style_identifiant" rendered="#{managedMensualiteVente.docVente.id gt 0}" />                 
                </p:outputPanel> 
                <div style="float: right">                     
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('mens_vente');

                            return false;">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>          
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('mens_vente');

                            return false;" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>                                   
                </div> 
                <div style="clear: right"/>                
            </div>
            <div class="part_scroll">
                <div class="yvs_form_mens_vente" style="margin: auto; background: white;">
                    <h:panelGrid id="blog_mens_vente" columns="1" style="width: 100%" cellpadding="0" cellspacing="0">
                        <f:facet name="header">
                            <div align="left" style="padding: 5px;background: #ccc;padding-bottom: 10px">
                                <span style="margin-left: 5px;font-weight: normal; font-size: 0.9em">Facture N¬∞ </span>
                                <span>#{managedMensualiteVente.docVente.numDoc}</span>
                                <h:panelGroup style="float: right">
                                    <span style="font-weight: normal; font-size: 0.9em">Model Reglement : </span>
                                    <h:selectOneMenu value="#{managedMensualiteVente.docVente.modelReglement.id}" style="min-width: 120px">
                                        <f:selectItem itemLabel="-- #{lab.LCF_PGG_aucun} --" itemValue="0"/>
                                        <f:selectItems value="#{managedModeReglement.models}" var="model" itemLabel="#{model.reference}" itemValue="#{model.id}" />                                
                                        <p:ajax event="valueChange" global="false" listener="#{managedMensualiteVente.chooseModelReglement()}"/>
                                    </h:selectOneMenu>
                                    <p:commandButton title="#{lab.LCF_PMV_generer_plan_reglement}" icon="ui-icon-arrowthickstop-1-s" style="width: 22px; height: 22px;background: white!important" update="@this"
                                                     actionListener="#{managedMensualiteVente.generatedEcheancierReg()}" disabled="#{managedMensualiteVente.docVente.mensualites.size() gt 0}"/>
                                </h:panelGroup>
                                <p:commandButton value="#{lab.LCF_PMV_equilibrer}" actionListener="#{managedMensualiteVente.equilibre()}" update="data_mensualite_mens_vente"
                                                 style="float: right;margin-right: 27%;margin-top: -5px;background: white!important"/>
                            </div>
                        </f:facet>
                        <p:outputPanel>
                            <div style="width: 25%;float: left">
                                <h:panelGrid id="form_mens_vente" columns="1" styleClass="yvs_table" style="width: 100%" cellpadding="0" cellspacing="0">
                                    <h:outputText value="#{lab.LCF_PMV_date_mensualite}"/>
                                    <p:calendar value="#{managedMensualiteVente.mensualite.dateMensualite}" pattern="dd-MM-yyyy" style="width: 100%"/>
                                    <h:outputText value="#{lab.L_montant}"/>
                                    <h:inputText value="#{managedMensualiteVente.mensualite.montant}" style="width: 100%"/>
                                    <h:panelGroup>
                                        <p:commandButton value="#{lab.L_nouveau}" actionListener="#{managedMensualiteVente.resetFiche(false)}"/>
                                        <p:commandButton value="#{lab.L_enregistrer}" style="float: right" actionListener="#{managedMensualiteVente.saveNew()}"/>
                                    </h:panelGroup>
                                </h:panelGrid>
                                <div align="left" style="margin-top: 2px;padding: 5px;background: #ccc;display: #{managedMensualiteVente.docVente.id gt 0?'':'none'}">
                                    <h:panelGrid columns="2" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                                        <span>#{lab.LCF_PMV_montant_cout} :</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedMensualiteVente.docVente.montantCS}" converter="DN" style="font-weight: bold"/>
                                            <span style="font-size: 0.7em">Fcfa </span>
                                        </h:panelGroup>
                                        <span>#{lab.LC_PFV_montant_ht}:</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedMensualiteVente.docVente.montantHT}" converter="DN" style="font-weight: bold"/>
                                            <span style="font-size: 0.7em">Fcfa </span>
                                        </h:panelGroup>
                                        <span>#{lab.LCF_PMV_montant_taxe} :</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedMensualiteVente.docVente.montantTaxe}" converter="DN" style="font-weight: bold"/>
                                            <span style="font-size: 0.7em">Fcfa </span>
                                        </h:panelGroup>
                                        <p:separator style="width: 100%"/>
                                        <p:separator style="width: 100%"/>
                                        <span>#{lab.LC_PFV_montant_ttc} :</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedMensualiteVente.docVente.montantTTC}" converter="DN" style="font-weight: bold"/>
                                            <span style="font-size: 0.7em">Fcfa </span>
                                        </h:panelGroup>
                                        <span>#{lab.LCF_PMV_avances} :</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedMensualiteVente.docVente.montantAvance}" converter="DN" style="font-weight: bold"/>
                                            <span style="font-size: 0.7em">Fcfa </span>
                                        </h:panelGroup>
                                        <p:separator style="width: 100%"/>
                                        <p:separator style="width: 100%"/>
                                        <span>#{lab.LC_PFA_net_a_payer} :</span>
                                        <h:panelGroup style="float: right">
                                            <h:outputText value="#{managedMensualiteVente.docVente.montantNetAPayer}" converter="DN" style="font-weight: bold"/>
                                            <span style="font-size: 0.7em">Fcfa </span>
                                        </h:panelGroup>
                                    </h:panelGrid>
                                </div>
                            </div>
                            <div style="width: 74%;margin-left: 26%">
                                <p:dataTable id="data_mensualite_mens_vente" value="#{managedMensualiteVente.docVente.mensualites}" var="mens" rowKey="#{mens.id}" rowIndexVar="mIdx"
                                             selectionMode="single">
                                    <p:ajax event="rowSelect"  listener="#{managedMensualiteVente.loadOnViewMensualite}"/>                              
                                    <p:ajax event="rowUnselect"  listener="#{managedMensualiteVente.unLoadOnViewMensualite}"/>                              
                                    <p:column width="20" styleClass="statut_#{mens.etat}">
                                        <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{mens.id eq managedMensualiteVente.mensualite.id}"/>
                                        <h:outputText value="#{mIdx+1}"/>
                                    </p:column>
                                    <p:column headerText="#{lab.L_reference}" styleClass="statut_#{managedFactureVente.giveStringStatut(mens.etat)}">
                                        <h:outputText value="#{mens.nameMens}"/>
                                    </p:column>
                                    <p:column headerText="#{lab.L_date}" styleClass="statut_#{managedFactureVente.giveStringStatut(mens.etat)}">
                                        <h:outputText value="#{mens.dateMensualite}" converter="DATE"/>
                                    </p:column>
                                    <p:column headerText="#{lab.L_montant}" style="text-align: right" styleClass="statut_#{managedFactureVente.giveStringStatut(mens.etat)}">
                                        <h:outputText value="#{mens.montant}" converter="DN"/>
                                    </p:column>
                                    <p:column headerText="#{lab.LCF_PMV_reste}" style="text-align: right" styleClass="statut_#{managedFactureVente.giveStringStatut(mens.etat)}">
                                        <h:outputText value="#{mens.reste}" converter="DN"/>
                                    </p:column>
                                    <p:column style="width: 5%;text-align: center" styleClass="statut_#{managedFactureVente.giveStringStatut(mens.etat)}">
                                        <p:contextMenu for="btn_option_mensualite_mens_vente" event="left click" style="font-size: 0.8em" styleClass="context_menu">
                                            <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedMensualiteVente.setEntity(mens)}" oncomplete="dlgConfirmDelete.show()"/>
                                        </p:contextMenu>                           
                                        <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_mensualite_mens_vente" type="button"/>
                                    </p:column> 
                                </p:dataTable>
                            </div>
                        </p:outputPanel>
                    </h:panelGrid>
                </div>
                <div class="yvs_list_mens_vente" style="background: white;">
                    <p:dataTable id="data_mens_vente" value="#{managedFactureVente.documents}" var="bon" rowKey="#{bon.id}" rowIndexVar="bonIdx" selectionMode="single">
                        <p:ajax event="rowSelect"  listener="#{managedMensualiteVente.loadOnView}" oncomplete="collapseForm('mens_vente');" update="data_mens_vente"/>                                
                        <p:column width="35" styleClass="statut_#{bon.statut}">
                            <f:facet name="header">
                                <p:contextMenu for="f_head_tgv_id" event="left click" styleClass="context_menu">
                                    <p:menuitem value="Voir l'id" icon="ui-icon-info" actionListener="#{managedFactureVente.setDisplayId(!managedFactureVente.displayId)}" />
                                </p:contextMenu>                                        
                                <h:outputText value="N¬∞" id="f_head_tgv_id" />
                            </f:facet>
                            <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{bon.id eq managedMensualiteVente.docVente.id}"/>
                            <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{bon.cloturer}"/>  
                            <h:outputText value="#{bonIdx+1}" rendered="#{!managedFactureVente.displayId}"/>
                            <h:outputText value="#{bon.id}" rendered="#{managedFactureVente.displayId}"/>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}" sortBy="#{bon.numDoc}">
                            <span>#{bon.numDoc}</span>
                            <h:outputText value="#{lab.LC_PFA_vide}" style="float: right;color: blue;font-style: italic;font-size: 0.8em" rendered="#{0>=bon.contenus.size()}"/>
                            <h:panelGroup style="float: right">
                                <h:outputText title="#{lab.LC_PFA_facture_regler}" value="R" rendered="#{bon.statutRegle == constantes.ETAT_REGLE}" styleClass="style_statut"/>
                                <p:spacer width="2" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE or bon.livraisonAuto}"/>
                                <h:outputText title="#{lab.LC_PCV_livraison_automatique}" value="A" rendered="#{bon.livraisonAuto and bon.statutLivre != constantes.ETAT_LIVRE}" styleClass="style_statut" style="font-size: 0.8em"/>
                                <h:outputText title="#{lab.LDB_PU_facture_livree}" value="L" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE}" styleClass="style_statut"/>
                                <p:spacer width="2" rendered="#{bon.consigner and bon.statutLivre != constantes.ETAT_LIVRE}"/>
                                <h:outputText title="#{lab.LDB_PU_stock_facture_consigne}" value="C" rendered="#{managedFactureVente.isConsigner(bon) and bon.statutLivre != constantes.ETAT_LIVRE}" styleClass="style_statut"/>
                            </h:panelGroup>
                        </p:column>
                        <p:column headerText="#{lab.LC_PFA_date_fournisseur}" style="text-align: center" styleClass="statut_#{bon.statut}" sortBy="#{bon.enteteDoc.dateEntete}">
                            <h:outputText value="#{bon.enteteDoc.dateEntete}" converter="DDMMYYYY"/>
                            <span> #{lab.L_a} </span>
                            <h:outputText value="#{bon.heureDoc}" converter="TIME"/>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PMV_client}" styleClass="statut_#{bon.statut}" sortBy="#{bon.nom_client}">
                            <span>#{bon.nom_client}</span>
                            <h:outputText value="cmd" title="#{lab.LC_PCC_rattacher_commande}" style="color: blue;float: right;font-size: 0.7em;font-style: italic"
                                          rendered="#{bon.documentLie.id > 0}"/>
                        </p:column>
                        <p:column headerText="#{lab.L_point_vente}" styleClass="statut_#{bon.statut}" sortBy="#{bon.enteteDoc.creneau.creneauPoint.point.libelle}">
                            <span>#{bon.enteteDoc.creneau.creneauPoint.point.libelle}</span>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PMV_vendeur}" styleClass="statut_#{bon.statut}" sortBy="#{bon.enteteDoc.creneau.users.nomUsers}">
                            <span>#{bon.enteteDoc.creneau.users.nomUsers}</span>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PMV_etapes}"  width="60" styleClass="statut_#{bon.statut}" style="font-size: 0.8em">
                            <h:outputText value="#{bon.libEtapes}" />
                        </p:column>
                    </p:dataTable>      
                    <p:outputPanel autoUpdate="true" style="float: right;" layout="block" >
                        <p:commandButton actionListener="#{managedFactureVente.init(false)}"  update="data_mens_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedFactureVente.paginator.disPrev}"/>
                        <p:outputPanel >
                            <p:inplace label="#{managedFactureVente.paginator.currentPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold">
                                <pe:inputNumber value="#{managedFactureVente.paginator.gotoPage}" style="width: 30px;text-align: center" decimalPlaces="0">
                                    <p:ajax event="valueChange" listener="#{managedFactureVente.gotoPagePaginator()}" update="data_mens_vente"/>
                                </pe:inputNumber>
                            </p:inplace><p:outputLabel value="/#{managedFactureVente.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        </p:outputPanel>
                        <p:commandButton actionListener="#{managedFactureVente.init(true)}"  update="data_mens_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedFactureVente.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedFactureVente.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedFactureVente.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedFactureVente.paginations}"/>
                            <p:ajax event="valueChange"  update="data_mens_vente"  />
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">  
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative; bottom: -20px" width="20" height="20"
                            styleClass="img_slide" title="#{lab.L_cacher}"/>  
            <div class="zone_find">
                <h:panelGrid id="blog_search_mens_vente" columns="2" style="width: 100%; font-size: 0.8em" cellpadding="0" cellspacing="0">
                    <h:panelGrid columns="9" style="float: left; font-size: 1.0em" cellpadding="0" cellspacing="0">
                        <h:outputText value="" />
                        <h:panelGroup>
                            <h:selectBooleanCheckbox value="#{managedFactureVente.date_}" valueChangeListener="#{managedFactureVente._chooseDateSearch}" style="float: left;margin-left: 5px">
                                <p:ajax event="valueChange" oncomplete="collapseList('mens_vente')"
                                        update="blog_date_search_entete_mens_vente blog_other_option_search_fv :main-mens_vente:data_mens_vente"/>
                            </h:selectBooleanCheckbox>
                            <h:outputText value="#{lab.L_date}" />
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputText value="#{lab.LCF_PMV_vendeur}" style="float:left;margin-top: 2px" />
                            <h:selectOneMenu value="#{managedFactureVente.operateurVend}" style="float:right;margin-right: 5px;height: 20px"
                                             valueChangeListener="#{managedFactureVente.changeOperateurVendeur}">
                                <f:selectItem itemLabel="#{lab.L_egale}" itemValue="LIKE"/>
                                <f:selectItem itemLabel="#{lab.L_different}" itemValue="NOT LIKE"/>
                                <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputText value="#{lab.LCF_PMV_client}" style="float:left;margin-top: 2px"/>
                            <h:selectOneMenu value="#{managedFactureVente.operateuClt}" style="float:right;margin-right: 5px;height: 20px"
                                             valueChangeListener="#{managedFactureVente.changeOperateurClient}">
                                <f:selectItem itemLabel="#{lab.L_egale}" itemValue="LIKE"/>
                                <f:selectItem itemLabel="#{lab.L_different}" itemValue="NOT LIKE"/>
                                <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputText value="#{lab.L_statut}" style="float:left;margin-top: 2px"/>
                            <h:selectOneMenu value="#{managedFactureVente.egaliteStatut}" style="float:right;margin-right: 5px;height: 20px">
                                <f:selectItem itemLabel="#{lab.L_egale}" itemValue="="/>
                                <f:selectItem itemLabel="#{lab.L_different}" itemValue="!="/>
                                <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente.addParamStatut()}" oncomplete="collapseList('mens_vente')"/>
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputText value="#{lab.L_reference}" style="float:left;margin-top: 2px"/>
                            <h:selectOneMenu value="#{managedFactureVente.operateurRef}" style="float:right;margin-right: 5px;height: 20px"
                                             valueChangeListener="#{managedFactureVente.changeOperateurRef}">
                                <f:selectItem itemLabel="#{lab.L_egale}" itemValue="LIKE"/>
                                <f:selectItem itemLabel="#{lab.L_different}" itemValue="NOT LIKE"/>
                                <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                            </h:selectOneMenu>  
                        </h:panelGroup>
                        <h:outputText value="#{lab.LCF_PMV_a_faire}" />
                        <h:outputText value="" />
                        <span>&nbsp;</span>
                        <p:commandButton icon="ui-icon-bullet" actionListener="#{managedFactureVente.clearParams()}" title="#{lab.L_reset_param}" style="width: 20px; height: 22px" 
                                         update="blog_search_mens_vente"/>
                        <h:panelGroup id="blog_date_search_entete_mens_vente">
                            <p:calendar value="#{managedFactureVente.dateDebut}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedFactureVente.paramDate}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente.addParamDate1}" oncomplete="collapseList('mens_vente')"/>
                                <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente.addParamDate2()}" oncomplete="collapseList('mens_vente')"/>
                            </p:calendar>
                            <p:spacer width="5px" style="background: black"/>
                            <p:calendar value="#{managedFactureVente.dateFin}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedFactureVente.paramDate}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente.addParamDate1}" oncomplete="collapseList('mens_vente')"/>
                                <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente.addParamDate2()}" oncomplete="collapseList('mens_vente')"/>
                            </p:calendar>
                        </h:panelGroup>
                        <h:inputText value="#{managedFactureVente.codeVendeur_}" style="min-width: 120px">
                            <p:ajax event="valueChange"  update=":main-mens_vente:data_mens_vente" listener="#{managedFactureVente._searchVendeur()}" oncomplete="collapseList('mens_vente')"/>
                        </h:inputText>                            
                        <h:inputText value="#{managedFactureVente.codeClient_}" style="width: 100%">
                            <p:ajax event="valueChange" listener="#{managedFactureVente.searchByClient()}" oncomplete="collapseList('mens_vente')"
                                    update=":main-mens_vente:data_mens_vente"/>
                        </h:inputText> 
                        <h:selectOneMenu value="#{managedFactureVente.statut}"  valueChangeListener="#{managedFactureVente.chooseStatut}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                            <f:selectItem itemLabel="#{lab.L_annule}" itemValue="#{constantes.ETAT_ANNULE}"/>
                            <f:selectItem itemLabel="#{lab.L_valide}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            <p:ajax event="valueChange" update=":main-mens_vente:data_mens_vente" oncomplete="collapseList('mens_vente')"/>
                        </h:selectOneMenu>                            
                        <h:inputText value="#{managedFactureVente.numSearch_}">
                            <p:ajax event="valueChange" listener="#{managedFactureVente.searchByNum()}"
                                    oncomplete="collapseList('mens_vente')" update=":main-mens_vente:data_mens_vente"/>
                        </h:inputText>
                        <h:selectOneMenu value="#{managedFactureVente.toValideLoad}" style="min-width: 80px">
                            <f:selectItem itemLabel="#{lab.L_oui.toUpperCase()}" itemValue="#{true}"/>
                            <f:selectItem itemLabel="#{lab.L_non.toUpperCase()}" itemValue="#{false}"/>
                            <p:ajax event="valueChange" listener="#{managedFactureVente.addParamToValide()}"
                                    oncomplete="collapseList('mens_vente')" update=":main-mens_vente:data_mens_vente"/>
                        </h:selectOneMenu> 
                        <p:commandLink style="border: 2px solid black; border-radius: 5px;padding: 2px;font-size: 0.8em" 
                                       onclick="dlgPlusOption.show()" global="false" value="#{lab.L_avancees}"/>
                    </h:panelGrid>
                    <h:panelGroup id="blog_other_option_search_fv" style="float: right">

                    </h:panelGroup>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
