<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="./../../../WEB-INF/template/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"> 
    <ui:define name="breadcumb">
        #{navigations.naviguationApps('Acompte Client','modCompta', 'smenAcompteClient', true)}
    </ui:define>         
    <ui:define name="contents">
        <script type="text/javascript">
            $(function() {
//                $('body').find('.part_scroll').height($('body').height() - $('body').find('.part_fix').height() - $('body').find('.zone_find').height() - 135);
                $('body').find('.part_scroll').height($('body').height() - $('body').find('#top').height() - $('body').find('.zone_find').height() - $('body').find('.part_fix').height() - $('body').find('#bottom').height() - 30);
                collapseForm('acompte_client');
//                slideShow('zone_show_acompte_client', 250);
            });

            function _slideShow() {
            }
            ;
        </script>              
        #{managedSaisiePiece.doNothing()}
        #{managedReglementVente.doNothing()}
        #{managedDocDivers.doNothing()}
        #{managedFactureVente.doNothing()}
        #{managedModeReglement.loadModeForAcompte()}  
        #{managedCaisses.loadAllCaisseActif(true)}  
        #{managedOperationClient.loadAll('A')}     
        #{managedAgence.loadAgence()}   

        <p:dialog header="#{lab.LC_PFA_lettrage_document}" widgetVar="dlgLettrage" width="80%" style="max-height: 400px">
            <ui:include src="../../finance_compta/compta_general/liste_contenu_journal.xhtml" />
            <f:facet name="footer">

            </f:facet>
        </p:dialog>
        <h:form prependId="false">
            <p:dialog header="#{lab.L_plus_option}" width="40%"  closeOnEscape="true" widgetVar="dlgPlusOption" resizable="false"> 
                <h:panelGrid id="blog_more_acompte_client" columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.LCF_PAF_nature}" />
                    <h:selectOneMenu value="#{managedOperationClient.natureSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_depot.toUpperCase()}" itemValue="D"/>
                        <f:selectItem itemLabel="#{lab.LC_PFV_avance.toUpperCase()}" itemValue="A"/>
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamNature()}" oncomplete="collapseList('acompte_client')"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PPG_notifier}" />
                    <h:selectOneMenu value="#{managedOperationClient.notifSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_attente}" itemValue="#{constantes.ETAT_ATTENTE}"/>
                        <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                        <f:selectItem itemLabel="#{lab.LC_PPG_notifier.toUpperCase()}" itemValue="#{constantes.ETAT_REGLE}"/>
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamNotif()}" oncomplete="collapseList('acompte_client')"/>
                    </h:selectOneMenu>
                    <h:outputText value="#{lab.LC_PFA_comptabiliser} ?"/>
                    <h:selectOneMenu value="#{managedOperationClient.comptaSearch}" style="width: 100%">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_non.toUpperCase()}" itemValue="#{false}"/>
                        <f:selectItem itemLabel="#{lab.L_oui.toUpperCase()}" itemValue="#{true}"/>
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamComptabilised()}" oncomplete="collapseList('acompte_client')"/>
                    </h:selectOneMenu>                    
                    <h:outputText value="#{lab.LCF_PRV_mode_paiement}" />                    
                    <h:selectOneMenu value="#{managedOperationClient.modeSearch}" style="min-width: 140px">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{constantes.MODE_PAIEMENT_ESPECE}" itemValue="#{constantes.MODE_PAIEMENT_ESPECE}"/>
                        <f:selectItem itemLabel="#{constantes.MODE_PAIEMENT_BANQUE}" itemValue="#{constantes.MODE_PAIEMENT_BANQUE}"/>
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamTypeMode()}" oncomplete="collapseList('acompte_client')"/>
                    </h:selectOneMenu>

                    <h:panelGroup>
                        <h:outputText value="#{lab.LDB_PC_dates}"  />
                        <h:selectBooleanCheckbox value="#{managedOperationClient.date_up}" title="#{lab.LDB_PC_dates_last_modif}" style="float: right">
                            <p:ajax event="valueChange" global="false" update="blog_date_search_client"  listener="#{managedOperationClient.addParamDates()}" oncomplete="collapseList('acompte_client')" />
                        </h:selectBooleanCheckbox>
                    </h:panelGroup>
                    <h:panelGroup id="blog_date_search_client">
                        <p:calendar value="#{managedOperationClient.dateDebut_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedOperationClient.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedOperationClient.addParamDates}"  oncomplete="collapseList('acompte_client')"/>
                        </p:calendar>
                        <p:spacer style="width: 5px;background: black"/>
                        <p:calendar value="#{managedOperationClient.dateFin_}" pattern="dd-MM-yyyy" navigator="true" size="10" disabled="#{!managedOperationClient.date_up}">
                            <p:ajax event="dateSelect" global="false" listener="#{managedOperationClient.addParamDates}" oncomplete="collapseList('acompte_client')"/>
                        </p:calendar>
                    </h:panelGroup>
                </h:panelGrid>                
                <f:facet name="footer"> 

                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="main-notif_reg_vente">
            <p:dialog header="#{lab.L_confirmation} !" widgetVar="dlgConfirNotifRegVente" width="30%" 
                      footer="&copy;Lymytz 2014" >
                <div style="margin-bottom: 15px;">
                    <span>Cette opération consiste à répartir le montant intégrale de l'acompte  sur l'ensemble des factures non réglé du client</span><br/><br/>
                    <b>Selectionner l'agence : </b><br/>
                    <h:selectOneMenu disabled="#{!accesRessource.compta_ope_client_change_agence_equilibre}" value="#{managedOperationClient.agenceRegle}"
                                     style="min-width: 200px; max-width: 400px">
                        <f:selectItem itemLabel="---" itemValue="0"/>
                        <f:selectItems value="#{managedAgence.agences}" var="ag" itemLabel="#{ag.designation}" itemValue="#{ag.id}"/>
                        <p:ajax event="valueChange" global="false"/>
                    </h:selectOneMenu>    
                </div>                                
                <div style="float: left">
                    <p:selectBooleanCheckbox value="#{managedOperationClient.displayConfirm}" itemLabel="#{lab.LCF_PPC_ne_plus_rappeler}" style="font-size: 0.8em"/>
                </div>
                <div style="float: right">
                    <p:commandButton icon="ui-icon-circle-close" value="#{lab.L_annuler}" onclick="dlgConfirNotifRegVente.hide()" />
                    <p:commandButton icon="ui-icon-circle-check" value="#{lab.L_continuer}" actionListener="#{managedOperationClient.findAndRegleFacture()}"
                                     oncomplete="dlgConfirNotifRegVente.hide()"  update=":main_acompte_client:data_reglement_acompte"/>                    
                </div>
            </p:dialog>
        </h:form>
        <h:form prependId="false">
            <p:dialog hideEffect="explode" widgetVar="dglEtatComptabilised" closeOnEscape="true" resizable="false" width="25%">
                <p:commandButton value="#{lab.LCF_PAF_tous_acomptes}" actionListener="#{managedOperationClient.verifyComptabilised(null)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LCF_PAF_acomptes_comptabilise}" actionListener="#{managedOperationClient.verifyComptabilised(true)}" style="width: 99%"/>
                <p:commandButton value="#{lab.LCF_PAF_acomptes_non_comptabilise}" actionListener="#{managedOperationClient.verifyComptabilised(false)}" style="width: 99%"/>
            </p:dialog>
        </h:form>
        <h:form prependId="false" id="form_ppte_valid_client">
            <p:dialog header="#{lab.LC_PA_propriete_validation}" widgetVar="dlgppteValid" width="60%" id="table_ppte_valid_client">
                <p:dataTable id="data-table_ppte_valid_client" value="#{managedOperationClient.compte.phasesReglement}" var="iValid">
                    <p:column headerText="#{lab.LCF_PBP_etapes}" >
                        #{iValid.phaseReg.libelle}
                    </p:column>
                    <p:column headerText="#{lab.LC_PA_valide_par}" >
                        <h:outputText value="#{iValid.author.users.nomUsers}" rendered="#{iValid.phaseOk}" />
                    </p:column>
                    <p:column headerText="#{lab.L_caisse} " style="text-align: center">
                        <h:outputText value="#{iValid.caisse.intitule}" rendered="#{iValid.phaseOk}"/>
                    </p:column>
                    <p:column headerText="#{lab.L_dates} " style="text-align: center">
                        <h:outputText value="#{iValid.dateValider}" converter="DATE" rendered="#{iValid.phaseOk}"/>
                    </p:column>
                    <p:column style="text-align: center">
                        <p:commandButton icon="ui-icon-arrowthickstop-1-s" title="#{lab.LC_PFV_comptabiliser}" actionListener="#{managedOperationClient.comptabiliserPhaseAcompteVente(iValid)}"
                                         update=":main_acompte_client:grp_btn_etat_acompte_client data-table_ppte_valid_client" disabled="#{!iValid.phaseOk}"
                                         rendered="#{!managedOperationClient.isComptabilisePhaseAcompte(iValid)}" style="width: 22px;height: 22px"/>
                        <p:commandButton icon="ui-icon-arrowthickstop-1-n" title="#{lab.LC_PJV_annuler_comptabilise}" actionListener="#{managedSaisiePiece.unComptabiliserPhaseAcompteVente(iValid, true)}" 
                                         update=":main_acompte_client:grp_btn_etat_acompte_client data-table_ppte_valid_client" disabled="#{!iValid.phaseOk}"
                                         rendered="#{iValid.comptabilise}" style="width: 22px;height: 22px"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>
        <!-->
        *****************************************************************************
        Boite de dialogue des clients
        *****************************************************************************
        <-->  
        <h:form prependId="false" id="form_pptes_compta">
            <p:dialog  width="60%" widgetVar="dlgPpteCompta" closeOnEscape="true" header="Pièces comptable">
                <ui:include src="../../finance_compta/compta_general/yvs_schema_compta.xhtml" />
                <f:facet name="footer">
                    &copy;Lymytz 2014
                </f:facet>
            </p:dialog>
        </h:form>
        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PC_liste_clients}" widgetVar="dlgListClients" closeOnEscape="true" width="50%" height="450" modal="true" dynamic="true">   
                <p:watermark for="txt_search_client_operation_acompte" value="#{lab.LC_POV_code_client}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:inputText id="txt_search_client_operation_acompte" value="#{managedClient.numSearch_}" style="float: left;text-align: center;margin-left: -10px">
                        <p:ajax event="valueChange" listener="#{managedClient.searchByNum()}" update="data_client_operation_acompte"/>
                    </h:inputText>   
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedClient.init(false)}" global="false" update="data_client_operation_acompte" icon="ui-icon-circle-triangle-w" disabled="#{managedClient.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedClient.paginator.currentPage}/#{managedClient.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedClient.init(true)}" global="false" update="data_client_operation_acompte" icon="ui-icon-circle-triangle-e" disabled="#{managedClient.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedClient.max}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedClient.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedClient.paginations}"/>
                            <p:ajax event="valueChange" global="false" update="data_client_operation_acompte"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>                               
                <p:dataTable id="data_client_operation_acompte"  value="#{managedClient.clients}" var="clt_" rowKey="#{clt_.id}"
                             selectionMode="single" rowIndexVar="cltIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" global="false" listener="#{managedOperationClient.loadOnViewClient}" oncomplete="dlgListClients.hide()"/>
                    <p:column headerText="N°" style="width: 10%;">
                        <span>#{cltIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_code}" style="width: 20%">
                        <span>#{clt_.codeClient}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_nom}">
                        <span>#{clt_.nom_prenom}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_POV_zone}">
                        <span>#{clt_.tiers.region}</span>
                    </p:column>
                </p:dataTable> 
                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <!-->
        *****************************************************************************
        Boite de dialogue des factures
        *****************************************************************************
        <-->  

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LC_PRA_liste_facture}" widgetVar="dlgListFactures" closeOnEscape="true" width="70%" height="450" modal="true" dynamic="true">   
                <p:watermark for="txt_search_facture_reglement_acompte" value="#{lab.LCF_PAF_numero_reference}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:panelGroup style="float: left;margin-left: -10px">
                        <h:inputText id="txt_search_facture_reglement_acompte" value="#{managedFactureVente.numSearch_}" style="text-align: center">
                            <p:ajax event="valueChange" global="false" listener="#{managedFactureVente.searchByNum()}" update="data_facture_reglement_vente"/>
                        </h:inputText>  
                        <h:selectOneMenu value="#{managedFactureVente.statut}"  valueChangeListener="#{managedFactureVente._chooseStatut}" style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                            <f:selectItem itemLabel="#{lab.L_annule}" itemValue="#{constantes.STATUT_DOC_ANNULE}"/>
                            <f:selectItem itemLabel="#{lab.L_valide}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            <p:ajax event="valueChange" global="false" update="data_facture_reglement_vente"/>
                        </h:selectOneMenu> 
                    </h:panelGroup>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedFactureVente.init(false)}" update="data_facture_reglement_vente" icon="ui-icon-circle-triangle-w" disabled="#{managedFactureVente.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedFactureVente.paginator.currentPage}/#{managedFactureVente.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedFactureVente.init(true)}" update="data_facture_reglement_vente" icon="ui-icon-circle-triangle-e" disabled="#{managedFactureVente.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedFactureVente.imax}" label="Nombre max Résultat" valueChangeListener="#{managedFactureVente.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedFactureVente.paginations}"/>
                            <p:ajax event="valueChange" update="data_facture_reglement_vente"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid>                               
                <p:dataTable id="data_facture_reglement_vente" value="#{managedFactureVente.documents}" var="bon" rowKey="#{bon.id}"
                             selectionMode="single" rowIndexVar="bonIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" listener="#{managedOperationClient.loadOnViewFacture}" oncomplete="dlgListFactures.hide()"/>
                    <p:column  style="width: 5%;" headerText="N°" styleClass="statut_#{bon.statut}">
                        <h:graphicImage title="#{lab.L_cloturer}" library="img" name="blocked.png" width="15" height="15" rendered="#{bon.cloturer}"/>  
                        <span>#{bonIdx+1}</span>
                    </p:column>
                    <p:column headerText="#{lab.L_reference}" styleClass="statut_#{bon.statut}" style="width: 25%">
                        <span>#{bon.numDoc}</span>
                        <h:outputText value="#{lab.LC_PFA_vide}" style="float: right;color: blue;font-style: italic;font-size: 0.8em" rendered="#{0>=bon.contenus.size()}"/>
                        <h:panelGroup style="float: right">
                            <h:outputText title="#{lab.LC_PFA_facture_regler}" value="R" rendered="#{bon.statutRegle == constantes.ETAT_REGLE}"
                                          style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                            <p:spacer width="2" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE or bon.livraisonAuto}"/>
                            <h:outputText title="#{lab.LC_PCV_livraison_automatique}" value="A" rendered="#{bon.livraisonAuto and bon.statutLivre != constantes.ETAT_LIVRE}"
                                          style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                            <h:outputText title="#{lab.LDB_PU_facture_livree}" value="L" rendered="#{bon.statutLivre == constantes.ETAT_LIVRE}"
                                          style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                            <p:spacer width="2" rendered="#{bon.consigner}"/>
                            <h:outputText title="#{lab.LDB_PU_stock_facture_consigne}" value="C" rendered="#{managedFactureVente.isConsigner(bon)}"
                                          style="font-weight: bold;border: 2px solid #666; border-radius: 5px;padding: 2px;background: black;color: white"/>
                        </h:panelGroup>
                    </p:column>
                    <p:column headerText="#{lab.LC_PFA_date_fournisseur}" style="text-align: center" styleClass="statut_#{bon.statut}">
                        <h:outputText value="#{bon.enteteDoc.dateEntete}" converter="DDMMYYYY"/>
                        <span> #{lab.L_a} </span>
                        <h:outputText value="#{bon.heureDoc}" converter="TIME"/>
                    </p:column>
                    <p:column headerText="#{lab.L_client}" styleClass="statut_#{bon.statut}">
                        <span>#{bon.nom_client}</span>
                        <h:outputText value="cmd" title="#{lab.LC_PCC_rattacher_commande}" style="color: blue;float: right;font-size: 0.7em;font-style: italic"
                                      rendered="#{bon.documentLie.id > 0}"/>
                    </p:column>
                    <p:column headerText="#{lab.LCF_PRV_vendeur}" styleClass="statut_#{bon.statut}">
                        <span>#{bon.enteteDoc.creneau.users.nomUsers}</span>
                    </p:column>
                </p:dataTable> 

                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>

        <h:form prependId="false">                    
            <p:dialog header="#{lab.LCF_PAF_liste_documents}" widgetVar="dlgListDoc" closeOnEscape="true" width="70%" height="450" modal="true" dynamic="true">   
                <p:watermark for="txt_search_doc_reglement_acompte" value="#{lab.LCF_PAF_numero_reference}..." />
                <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0">
                    <h:panelGroup style="float: left;margin-left: -10px">
                        <h:inputText id="txt_search_doc_reglement_acompte" value="#{managedDocDivers.numSearch}" style="text-align: center">
                            <p:ajax event="valueChange" global="false" listener="#{managedDocDivers.searchByNum()}" update="data_facture_reglement_doc_divers"/>
                        </h:inputText>  
                        <h:selectOneMenu value="#{managedDocDivers.statutSearch}"   style="min-width: 120px">
                            <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                            <f:selectItem itemLabel="#{lab.L_editable}" itemValue="#{constantes.ETAT_EDITABLE}"/>
                            <f:selectItem itemLabel="#{lab.L_en_cours}" itemValue="#{constantes.ETAT_ENCOURS}"/>
                            <f:selectItem itemLabel="#{lab.L_annule}" itemValue="#{constantes.STATUT_DOC_ANNULE}"/>
                            <f:selectItem itemLabel="#{lab.L_valide}" itemValue="#{constantes.ETAT_VALIDE}"/>
                            <p:ajax event="valueChange" listener="#{managedDocDivers.addParamStatut()}" global="false" update="data_facture_reglement_doc_divers"/>
                        </h:selectOneMenu> 
                    </h:panelGroup>
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedDocDivers.init(false)}" update="data_facture_reglement_doc_divers" icon="ui-icon-circle-triangle-w" disabled="#{managedDocDivers.paginator.disPrev}"/>
                        <p:outputPanel ><p:outputLabel value="#{managedDocDivers.paginator.currentPage}/#{managedDocDivers.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" /></p:outputPanel>
                        <p:commandButton actionListener="#{managedDocDivers.init(true)}" update="data_facture_reglement_doc_divers" icon="ui-icon-circle-triangle-e" disabled="#{managedDocDivers.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedDocDivers.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedDocDivers.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedDocDivers.paginations}"/>
                            <p:ajax event="valueChange" update="data_facture_reglement_doc_divers"/>
                        </p:selectOneMenu>
                    </p:outputPanel> 
                </h:panelGrid> 


                <!--tableau de doc divers-->
                <p:dataTable id="data_facture_reglement_doc_divers" value="#{managedDocDivers.documents}" var="doc" rowKey="#{doc.id}"
                             selectionMode="single" rowIndexVar="bonIdx" scrollable="true" scrollHeight="385">
                    <p:ajax event="rowSelect" listener="#{managedOperationClient.loadOnViewDocDivers}" oncomplete="dlgListDoc.hide()"/>

                    <p:column headerText="#{lab.LC_PFA_numero_piece}" styleClass="statut_#{doc.statutDoc}" width="100">
                        <span title="#{doc.description}">#{doc.numPiece}</span>
                    </p:column>
                    <p:column headerText="#{lab.LCF_PBP_numero_ref}" styleClass="statut_#{doc.statutDoc}" width="100">
                        <span title="#{doc.description}" style="float: left">#{managedDocDivers.resumeText(doc.referenceExterne, 30)}</span>
                        <h:panelGroup style="float: right;margin-top: 4px">
                            <h:graphicImage library="img" name="P.png" width="12" height="12" rendered="#{doc.statutRegle eq constantes.ETAT_REGLE}" title="Opération réglée"/>
                        </h:panelGroup>
                    </p:column>
                    <p:column headerText="#{lab.L_tiers}" styleClass="statut_#{doc.statutDoc}" width="100">
                        <span title="#{doc.description}">#{managedDocDivers.findNameTiers(doc.idTiers, doc.tableTiers)}</span>
                    </p:column>
                    <p:column headerText="#{lab.LC_PPG_compte_g}" styleClass="statut_#{doc.statutDoc}" width="100">
                        <span title="#{doc.compteGeneral.intitule}">#{doc.compteGeneral.numCompte}</span>
                    </p:column>

                </p:dataTable> 

                <f:facet name="footer" class="yvs-dialog-footer">
                    #{lab.L_copy}
                </f:facet> 
            </p:dialog>
        </h:form>


        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmAnnuleDoc" closeOnEscape="true"
                             message="#{lab.LCF_PAF_text5}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOperationClient.forceCancelCompte()}" oncomplete="dlgConfirmAnnuleDoc.hide()"
                                 update=":main_acompte_client:grp_btn_etat_acompte_client"/>
                <p:commandButton type="button" value="#{lab.L_non}" onclick="dlgConfirmAnnuleDoc.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog widgetVar="dlgConfirmCancel" closeOnEscape="true"
                             message="#{lab.LCF_PAF_text3} ">
                <span>#{lab.LCF_PAF_text4}</span>
                <p:commandButton value="#{lab.L_continuer}" icon="ui-icon-circle-check" actionListener="#{managedOperationClient.cancelAllEtapesAcompte(true)}" oncomplete="dlgConfirmCancel.hide()" />
                <p:commandButton value="#{lab.L_annuler}" onclick="dlgConfirmCancel.hide()"  type="button" icon="ui-icon-circle-close"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabilisePhaseByForce" message="#{lab.LCF_PAF_text}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.comptabiliserPhaseAcompteVente(managedOperationClient.etapeCompte, true, true)}"
                                 update=":main_acompte_client:data_acompte_client :main_acompte_client:grp_btn_etat_acompte_client" oncomplete="dlgComptabilisePhaseByForce.hide()"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabilisePhaseByForce.hide()"/>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabiliseDoc" message="#{lab.LCF_PAF_text1}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.comptabiliserAcompteClient(managedOperationClient.selectCompte, true, true)}"
                                 update=":main_acompte_client:data_acompte_client :main_acompte_client:grp_btn_etat_acompte_client :main_acompte_client:data_reglement_acompte" oncomplete="dlgComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabiliseDoc.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabiliseDoc" message="#{lab.LCF_PAF_text2}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedSaisiePiece.unComptabiliserAcompteClient(managedOperationClient.selectCompte)}"
                                 update=":main_acompte_client:data_acompte_client :main_acompte_client:grp_btn_etat_acompte_client :main_acompte_client:data_reglement_acompte" oncomplete="dlgUnComptabiliseDoc.hide()"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabiliseDoc.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabilisePieceAll" message="Voulez-vous comptabiliser tous les reglements?">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedOperationClient.comptabilisePieceAll()}"
                                 update=":main_acompte_client:data_reglement_acompte" oncomplete="dlgComptabilisePieceAll.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabilisePieceAll.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgComptabilisePiece" message="#{lab.LC_PFV_text19}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedOperationClient.comptabilisePiece(managedOperationClient.selectNotif, true)}"
                                 update=":main_acompte_client:data_reglement_acompte" oncomplete="dlgComptabilisePiece.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgComptabilisePiece.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog  header="#{lab.L_confirmation}" width="40%" widgetVar="dlgUnComptabilisePiece" message="#{lab.LC_PFV_text18}">
                <p:commandButton value="#{lab.L_oui}" icon="ui-icon-circle-check" actionListener="#{managedOperationClient.unComptabilisePiece(managedOperationClient.selectNotif, true)}"
                                 update=":main_acompte_client:data_reglement_acompte" oncomplete="dlgUnComptabilisePiece.hide()"/>
                <p:commandButton value="#{lab.LC_PFV_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgUnComptabilisePiece.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDelete" closeOnEscape="true"
                             message="#{lab.LCF_PAF_text6}" header="#{lab.L_confirmation}">
                <p:selectBooleanCheckbox value="#{managedOperationClient.memory_choix_delete_acompte}" itemLabel="#{lab.LCF_PAC_text}" style="float: left"/>
                <h:panelGroup style="float: right">
                    <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOperationClient.deleteBeanCompte()}" oncomplete="dlgConfirmDelete.hide();"/>
                    <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmDelete.hide()" />
                </h:panelGroup>
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePiece" closeOnEscape="true"
                             message="#{lab.LCF_PAC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOperationClient.confirmDeletePiece(true)}" oncomplete="dlgConfirmDeletePiece.hide();"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedOperationClient.confirmDeletePiece(false)}" oncomplete="dlgConfirmDeletePiece.hide();"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmDeletePiece.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false">
            <p:confirmDialog hideEffect="explode" widgetVar="dlgConfirmDeletePieces" closeOnEscape="true"
                             message="#{lab.LCF_PAC_text1}" header="#{lab.L_confirmation}">
                <p:commandButton value="#{lab.L_oui}" actionListener="#{managedOperationClient.confirmDeletePieces(true)}" oncomplete="dlgConfirmDeletePieces.hide();"/>
                <p:commandButton value="#{lab.L_non}" actionListener="#{managedOperationClient.confirmDeletePieces(false)}" oncomplete="dlgConfirmDeletePieces.hide();"/>
                <p:commandButton value="#{lab.L_annuler}" icon="ui-icon-circle-close" type="button" onclick="dlgConfirmDeletePieces.hide()" />
            </p:confirmDialog>
        </h:form>
        <h:form prependId="false" id="main_acompte_client"> 
            <div class="part_fix">
                <div style="float: left;width: 20%">
                    <p:splitButton value="#{lab.L_enregistrer}" id="save_acompte_client" actionListener="#{managedOperationClient.saveNew()}" 
                                   oncomplete="collapseForm('acompte_client'); slideShow('zone_show_acompte_client', 250)" icon="ui-icon-disk">
                        <p:menuitem value="#{lab.L_nouveau}" id="cancel_acompte_client" actionListener="#{managedOperationClient.resetFiche()}" 
                                    oncomplete="collapseForm('acompte_client'); slideShow('zone_show_acompte_client', 250)" icon="ui-icon-document"/>
                        <p:separator />
                        <p:menuitem value="#{lab.L_supprimer}" onclick="dlgConfirmDelete.show()" global="false" icon="ui-icon-trash"/>
                    </p:splitButton>
                    <p:splitButton value="Options" id="delete_acompte_client" icon="ui-icon-gear" type="button" style="font-size: 0.8em">
                        <p:menuitem value="#{lab.LC_PA_equilibrer_statut}" icon="ui-icon-carat-2-e-w" actionListener="#{managedOperationClient.equilibreAll()}"/>  
                        <p:menuitem value="Modifier la nature" icon="ui-icon-refresh" actionListener="#{managedOperationClient.changeNatureMany()}"
                                    update=":main_acompte_client:data_acompte_client"/>  
                        <p:separator/>
                        <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" onclick="dlgConfirmDelete.show()"/>
                    </p:splitButton>
                </div> 
                <p:outputPanel autoUpdate="true" style="margin-left: 25%">
                    <p:commandButton actionListener="#{managedOperationClient.parcoursInAllResult(false)}" update="txt_parc_linear_acompte_client data_acompte_client"  icon="ui-icon-circle-triangle-w"
                                     oncomplete="collapseForm('acompte_client'); slideShow('zone_show_acompte_client', 250)"/>
                    <h:inputText value="#{managedOperationClient.offset}" style="width: 35px; text-align: center;"  title="#{lab.L_aller_au}" id="txt_parc_linear_acompte_client"/>
                    <p:outputLabel value="/#{managedOperationClient.paginator.nbResult}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold"/>
                    <p:commandButton actionListener="#{managedOperationClient.parcoursInAllResult(true)}" update="txt_parc_linear_acompte_client data_acompte_client" icon="ui-icon-circle-triangle-e"
                                     oncomplete="collapseForm('acompte_client'); slideShow('zone_show_acompte_client', 250)"/>
                </p:outputPanel> 
                <div style="float: right">                     
                    <h:link title="#{lab.L_mode_creation}" onclick="collapseForm('acompte_client');
                            return false;">
                        <p:graphicImage library="icones" name="newDoc.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>          
                    <h:link title="#{lab.L_mode_liste}" onclick="collapseList('acompte_client');
                            return false;" >
                        <p:graphicImage library="icones" name="ico_formulaire.png" width="18" height="25" style="border: 2px solid #666; border-radius: 5px;"/>
                    </h:link>                                   
                </div> 
                <div style="clear: right"/>                
            </div>
            <div class="part_scroll">
                <div class="yvs_form_acompte_client" style="margin: auto; background: white;">
                    <p:outputPanel id="blog_entete_acompte_client">
                        <h:panelGrid columns="2" styleClass="yvs_nostyle" style="width: 100%;margin-bottom: 0px;margin-top: 0px" cellpadding="0" cellspacing="0" rendered="#{managedOperationClient.compte.id gt 0}">
                            <h:panelGrid columns="2" id="txt_reference_document_acompte_client" styleClass="yvs_nostyle">                                            
                                <h:outputText  value="#{managedOperationClient.compte.numRefrence}" styleClass="style_reference"/>
                                <h:outputText value="#{managedOperationClient.compte.id}" styleClass="style_identifiant"/>
                            </h:panelGrid>
                            <h:panelGroup id="grp_btn_etat_acompte_client" style="position: relative; margin-top: 1%; float: right">
                                <p:outputPanel style="float: left" rendered="#{managedOperationClient.compte.phasesReglement.size() gt 0}">
                                    <ui:repeat value="#{managedOperationClient.compte.phasesReglement}" var="phs">
                                        <p:contextMenu for="btn_option_cancel_acompte_client" style="font-size: 0.8em; color: #790000" styleClass="context_menu">
                                            <p:menuitem icon="ui-icon-newwin" value="#{lab.LC_PFA_proprietes}" title="#{lab.LC_PFA_voir_proprietes_validations}" oncomplete="dlgppteValid.show()"
                                                        update=":form_ppte_valid_client:table_ppte_valid_client" actionListener="#{managedOperationClient.setEtapeCompte(phs)}"/>
                                            <p:menuitem value="#{lab.LCF_PAF_annuler_etape}" icon="ui-icon-cancel" style="color: #790000" actionListener="#{managedOperationClient.cancelValidEtapesAcompte(phs)}"
                                                        update=":main_acompte_client:grp_btn_etat_acompte_client" rendered="#{phs.phaseOk}"/>
                                            <p:menuitem value="#{lab.LC_PFV_comptabiliser}" icon="ui-icon-arrowthick-2-e-w" actionListener="#{managedOperationClient.comptabiliserPhaseAcompteVente(phs)}"
                                                        update=":main_acompte_client:grp_btn_etat_acompte_client" rendered="#{!managedOperationClient.isComptabilisePhaseAcompte(phs)}"/>
                                            <p:menuitem value="#{lab.LC_PJV_annuler_comptabilise}" icon="ui-icon-arrowthick-2-e-w" actionListener="#{managedSaisiePiece.unComptabiliserPhaseAcompteVente(phs, true)}" 
                                                        update=":main_acompte_client:grp_btn_etat_acompte_client" rendered="#{phs.comptabilise}"/>
                                        </p:contextMenu>
                                        <p:commandLink value="#{phs.phaseReg.phase}" style="color: #FFF" id="btn_option_cancel_acompte_client" actionListener="#{managedOperationClient.validEtapesAcompte(phs)}"
                                                       styleClass="#{(phs.phaseOk)?'statut_valide':'etat_formation_true'}" disabled="#{!phs.etapeActive and !phs.phaseOk}" update=":main_acompte_client:grp_btn_etat_acompte_client"/>
                                    </ui:repeat>
                                </p:outputPanel>
                                <p:outputPanel styleClass="yvs_form_of" rendered="#{managedOperationClient.compte.phasesReglement.size() lt 1}">  
                                    <p:commandLink value="#{lab.L_en_attente}" styleClass="#{(managedOperationClient.compte.statut == constantes.STATUT_DOC_ATTENTE)?'statut_valide':'etat_formation_true'}" 
                                                   disabled="#{!(managedOperationClient.compte.statut == constantes.STATUT_DOC_PAYER
                                                               or managedOperationClient.compte.statut == constantes.STATUT_DOC_ANNULE)}" 
                                                   actionListener="#{managedOperationClient.annulerAcompte(false)}"
                                                   process="@this" update="grp_btn_etat_acompte_client" />                                 
                                    <p:commandLink value="#{(managedOperationClient.compte.mode.typeReglement eq constantes.MODE_PAIEMENT_BANQUE)?((managedOperationClient.compte.phasesReglement.size() gt 0)?lab.L_valide:lab.L_valider):((managedOperationClient.compte.statut eq constantes.STATUT_DOC_PAYER)?lab.LCF_PAC_encaisser:lab.LCF_PC_encaisser.toUpperCase())}" styleClass="#{(managedOperationClient.compte.statut == constantes.STATUT_DOC_PAYER)?'statut_valide':'etat_formation_true'}" 
                                                   disabled="#{!(managedOperationClient.compte.statut == constantes.STATUT_DOC_ATTENTE)}" 
                                                   actionListener="#{managedOperationClient.encaisserAcompte()}"
                                                   process="@this" update="grp_btn_etat_acompte_client" />
                                </p:outputPanel> 
                                <h:panelGroup style="float: right"> 
                                    <p:commandLink value="#{(managedOperationClient.compte.statut == constantes.STATUT_DOC_ANNULE)?lab.L_annule:lab.L_annulers}" styleClass="#{(managedOperationClient.compte.statut==constantes.STATUT_DOC_ANNULE)?'statut_valide':'etat_formation_true'}" 
                                                   disabled="#{managedOperationClient.compte.statut == constantes.STATUT_DOC_ANNULE}" 
                                                   actionListener="#{managedOperationClient.annulerAcompte(true)}"
                                                   process="@this" update="grp_btn_etat_acompte_client" />
                                    <p:commandLink value="#{managedOperationClient.writeEtape(((managedOperationClient.isComptabiliseBeanAcompte(managedOperationClient.compte))?lab.L_comptabilise:lab.L_comptabiliser), managedOperationClient.compte.firstEtape)}"
                                                   type="button" styleClass="#{(managedOperationClient.compte.comptabilise)?'statut_valide':'etat_formation_true'}"
                                                   onclick="dlgComptabiliseDoc.show()" rendered="#{managedOperationClient.compte.statut==constantes.STATUT_DOC_PAYER}" global="false" id="btn_comptabilised_acompte_client"/>
                                    <p:contextMenu for="btn_comptabilised_acompte_client" style="font-size: 0.7em">
                                        <p:menuitem icon="ui-icon-eject" value="#{lab.LC_PFA_proprietes}" actionListener="#{managedSaisiePiece.displayPieceComptable(managedOperationClient.compte.id, constantes.SCR_ACOMPTE_VENTE)}" 
                                                    update=":form_pptes_compta:table_pptes_compta" oncomplete="dlgPpteCompta.show()"/>
                                        <p:separator style="width: 100%" />  
                                        <p:menuitem icon="ui-icon-circle-arrow-w" value="#{lab.L_annuler}" onclick="dlgUnComptabiliseDoc.show()" disabled="#{!managedOperationClient.compte.comptabilise}"/>
                                    </p:contextMenu>
                                </h:panelGroup>                                               
                            </h:panelGroup> 
                        </h:panelGrid>
                        <div  style="clear: both"/>                      
                    </p:outputPanel>
                    <p:outputPanel id="blog_acompte_client">
                        <div style="width: 40%;float: left ">
                            <h:panelGrid columns="2" style="width: 100%" styleClass="yvs_table" cellpadding="0" cellspacing="0">
                                <f:facet name="header">
                                    <div align="right">
                                        <span>#{lab.LCF_PAF_nature} </span>                           
                                        <h:selectOneMenu value="#{managedOperationClient.compte.nature}">
                                            <f:selectItem itemLabel="#{lab.LC_PTBC_avance.toUpperCase()}" itemValue="#{'A'}"/>
                                            <f:selectItem itemLabel="#{lab.L_depot.toUpperCase()}" itemValue="#{'D'}"/>
                                        </h:selectOneMenu>  
                                    </div>
                                </f:facet>
                                <span>#{lab.L_client} </span>
                                <h:panelGroup id="select_client_operation_acompte">
                                    <h:inputText value="#{managedOperationClient.compte.client.codeClient}" style="color: #{managedOperationClient.compte.client.error?'red':''}">
                                        <p:ajax event="blur" global="false" listener="#{managedOperationClient.searchClient()}" update="select_client_operation_acompte"/>
                                    </h:inputText>    
                                    <h:outputText value="#{managedOperationClient.compte.client.nom_prenom}" style="margin-left: 5px"/>
                                    <h:panelGroup style="float: right">
                                        <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LC_PPL_liste_client}" global="false"
                                                         actionListener="#{managedOperationClient.initClients()}" oncomplete="dlgListClients.show()"/>
                                    </h:panelGroup>
                                </h:panelGroup> 
                                <span>#{lab.L_date} </span>
                                <p:calendar value="#{managedOperationClient.compte.dateAcompte}" pattern="dd-MM-yyyy" size="10"/>
                                <span>#{lab.L_montant} </span> 
                                <h:panelGroup>
                                    <pe:inputNumber value="#{managedOperationClient.compte.montant}" style="font-size: 0.9em;width: 170px"/>
                                    <p:selectBooleanCheckbox value="#{managedOperationClient.compte.repartirAutomatique}" itemLabel="#{lab.LCF_PAF_repartition_automatique}" style="float: right;margin-top: 5px"/>
                                </h:panelGroup>
                                <span>#{lab.L_caisse} </span>                            
                                <h:selectOneMenu value="#{managedOperationClient.compte.caisse.id}" style="min-width: 170px">
                                    <f:selectItem itemLabel="" itemValue="0"/>
                                    <f:selectItems value="#{managedCaisses.caisses}" var="ca" itemLabel="#{ca.intitule}" itemValue="#{ca.id}"/>
                                    <p:ajax event="valueChange" global="false" listener="#{managedOperationClient.chooseCaisseCompte()}" />
                                </h:selectOneMenu>  
                                <span>#{lab.LCF_PAF_mode} </span>                            
                                <h:selectOneMenu value="#{managedOperationClient.compte.mode.id}" style="min-width: 170px">
                                    <f:selectItem itemLabel="" itemValue="0"/>
                                    <f:selectItems value="#{managedModeReglement.modes}" var="mo" itemLabel="#{mo.designation}" itemValue="#{mo.id}"/>
                                    <p:ajax event="valueChange" global="false" listener="#{managedOperationClient.chooseModeCompte()}" />
                                </h:selectOneMenu>  
                                <span>#{lab.LCF_PAF_num_externe}</span>
                                <h:inputText value="#{managedOperationClient.compte.referenceExterne}"/>    
                                <f:facet name="footer">  
                                    <span>#{lab.LCF_PAF_commentaire} </span>
                                    <h:inputTextarea value="#{managedOperationClient.compte.commentaire}" rows="4" style="width: 100%; margin-bottom: 3px"/>                                
                                </f:facet>
                            </h:panelGrid>                                
                        </div>
                        <div style="width: 59%;margin-left: 41%">
                            <div style="border: solid 2px; height: 285px; padding: 2px; border-radius: 5px;margin-top: 5px">
                                <span style="display: inline-block; background: #CCC; width: 100%">
                                    #{lab.LDB_PC_soldes} (<p:commandLink value="#{lab.L_actualiser}" actionListener="#{managedOperationClient.calculerSoldes()}" update="data_historique_acompte_client"/>)
                                    <div style="float: right">#{lab.LCF_PAC_actuel} : 
                                        <div style="float: right">
                                            <h:outputText id="txt_solde_acompte_client" value="#{managedOperationClient.compte.solde}" converter="DNA" styleClass="montantTotal"/> Fcfa
                                        </div>
                                    </div>
                                </span>
                                <div style="width: 99.5%; border: solid 1px; height:255px; margin: auto;overflow-y: auto">
                                    <p:dataTable value="#{managedOperationClient.soldes}" var="sld" 
                                                 rowIndexVar="Idx" id="data_historique_acompte_client">
                                        <p:column headerText="N°" style="width: 7%">
                                            <span>#{Idx+1}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_libelle}">
                                            <h:outputText value="#{sld[0]}"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LCF_PAF_solde}" style="width: 17%;text-align: right">
                                            <h:outputText value="#{managedOperationClient.abs(sld[1])}" style="color: #{sld[1] lt 0? 'red' : (sld[1] gt 0? 'green':'')}"  converter="DNS"/>
                                        </p:column>
                                    </p:dataTable>
                                </div>
                            </div>
                        </div>
                        <div style="clear: left"/>
                        <div id="zone_show_acompte_client" style="border: solid 2px; height: 250px; padding: 2px; border-radius: 5px;margin-top: 5px">
                            <span style="display: inline-block; background: #CCC; width: 100%;cursor: pointer" >
                                <span class="button_slide" onclick="slideShow('zone_show_acompte_client', 250)">[-]</span>

                                <h:outputText value="#{lab.LCF_PAF_reglements_facture_doc_divers} "  title="#{lab.LCF_PAF_reglements_par_acompte} "></h:outputText>
                                <p:commandButton  icon="ui-icon-refresh" id="btn_type_facture"  global="false" type="button" styleClass="button_gear"/>
                                <p:contextMenu for="btn_type_facture" event="left click">
                                    <p:menuitem value="#{lab.LCF_PAC_facture_vente}" actionListener="#{managedOperationClient.changeLabel(true)}"  icon="ui-icon-arrowthickstop-1-e" />
                                    <p:menuitem value="#{lab.LCF_PAF_autre_facture}" actionListener="#{managedOperationClient.changeLabel(false)}"  icon="ui-icon-arrowthickstop-1-e" />
                                </p:contextMenu>
                                <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px; float: right" type="button" id="btn_opt_find_save_reg"/>
                                <p:contextMenu for="btn_opt_find_save_reg" event="left click">
                                    <p:menuitem value="Répartir le montant total" icon="ui-icon-arrowthickstop-1-e" 
                                                actionListener="#{managedOperationClient.openOrfindAndRegleFacture()}" />
                                </p:contextMenu>
                            </span>
                            <div class="zone_slide" style="width: 99.5%; border: solid 1px; height: 210px; margin: auto;overflow-y: auto">
                                <p:outputPanel style="width: 100%; margin: auto; background: white" id="blog_reglement_acompte">
                                    <h:panelGrid id="form_reglement_acompte" columns="5" styleClass="yvs_nostyle" cellpadding="0" cellspacing="0" style="padding-top: 2px;padding-bottom: -5px">
                                        <h:outputText value="#{managedOperationClient.isFacture ? lab.LCF_PAF_facture :lab.LCF_PBP_document}"/>
                                        <h:outputText value="#{managedOperationClient.isFacture ? lab.L_client : lab.L_tiers}"/>
                                        <h:outputText value="#{lab.L_montant}" />
                                        <h:outputText value="#{lab.LCF_PAF_date_paiement}" />
                                        <h:outputText value="" style="margin-left: 100px"/>
                                        <h:panelGroup id="select_facture_reglement_vente">
                                            <h:inputText value="#{managedOperationClient.piece.docVente.numDoc}" style="color: #{managedOperationClient.piece.docVente.error?'red':''}" rendered="#{managedOperationClient.isFacture}">
                                                <p:ajax event="blur" global="false" listener="#{managedOperationClient.searchFacture()}" update="select_facture_reglement_vente txt_mode_acompte_reglement_vente"/>
                                            </h:inputText>
                                            <h:inputText value="#{managedOperationClient.piece.docDivers.numPiece}" style="color: #{managedOperationClient.trouver ?'red':''}"  rendered="#{!managedOperationClient.isFacture}" >
                                                <p:ajax event="blur"  listener="#{managedOperationClient.searchFacture()}" update="select_facture_reglement_vente txt_mode_acompte_reglement_vente"/>
                                            </h:inputText>
                                            <h:outputText value="#{managedOperationClient.piece.docVente.montantTotal}" rendered="#{managedOperationClient.isFacture}" converter="DNA" style="font-weight: bold"/> 
                                            <h:outputText value="#{managedOperationClient.piece.docDivers.montantTotal}" rendered="#{!managedOperationClient.isFacture}" converter="DNA" style="font-weight: bold"/> Fcfa
                                            <h:panelGroup style="float: right">
                                                <p:commandButton icon="ui-icon-note" style="width: 20px;height: 22px" title="#{lab.LCF_PRV_liste_facture}" global="false"
                                                                 actionListener="#{managedOperationClient.initFacture()}" oncomplete="#{managedOperationClient.isFacture?'dlgListFactures.show()' : 'dlgListDoc.show()'}"/>
                                            </h:panelGroup>
                                        </h:panelGroup> 
                                        <h:panelGroup id="fr_element">
                                            <h:inputText id="txt_mode_acompte_reglement_vente" value="#{managedOperationClient.piece.docVente.nom_client}" rendered="#{managedOperationClient.isFacture}" disabled="true"/>
                                            <h:inputText id="txt_mode_acompte_reglement_doc_divers" value="#{managedDocDivers.findNameTiers(managedOperationClient.piece.docDivers.idTiers, managedOperationClient.piece.docDivers.tableTiers)}" rendered="#{!managedOperationClient.isFacture}" disabled="true"/>
                                        </h:panelGroup>
                                        <h:inputText id="txt_montant_reglement_vente" value="#{managedOperationClient.piece.montant}"  style="text-align: right" readonly="true" >
                                            <f:convertNumber/>
                                        </h:inputText>
                                        <p:calendar value="#{managedOperationClient.piece.datePaiementPrevu}" navigator="true" pattern="dd-MM-yyyy" size="10"/>
                                        <h:panelGroup style="margin-left: 100px">
                                            <p:commandButton id="save_reglement_acompte" icon="ui-icon-circle-plus" value="#{lab.L_enregistrer}" 
                                                             title="#{lab.LC_PFA_cliquer_pour_ajouter}" update="blog_reglement_acompte" actionListener="#{managedOperationClient.savePiece()}"/>
                                        </h:panelGroup> 
                                    </h:panelGrid> 

                                    <p:dataTable id="data_reglement_acompte" value="#{managedOperationClient.compte.venteDiverses}" var="acom" rowKey="#{acom.id}" 
                                                 rowIndexVar="Idx" selection="#{managedOperationClient.selectNotifs}">
                                        <p:ajax event="rowSelect" listener="#{managedOperationClient.loadOnViewPiece}"/>
                                        <p:ajax event="rowUnselect" listener="#{managedOperationClient.unLoadOnViewPiece}"/>
                                        <p:column headerText="N°" style="width: 7%" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <span>#{Idx+1}</span>
                                            <h:panelGroup style="float: right">
                                                <h:outputText title="#{lab.LC_PFA_comptabiliser}" value="C" rendered="#{managedOperationClient.isComptabilisePiece(acom)}" styleClass="style_statut"/>
                                            </h:panelGroup>
                                        </p:column>
                                        <p:column headerText="ID" style="width: 30px" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <span>#{acom.id}</span>
                                        </p:column>
                                        <p:column headerText="#{lab.L_montant}" width="100" style="text-align: right" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <h:outputText value="#{acom.montant}" converter="DNS"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LCF_PAC_clients}" width="150" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <h:outputText value="#{acom.client}"  />
                                        </p:column>
                                        <p:column headerText="#{lab.L_numero}"  style="text-align: center" styleClass="statut_#{managedOperationFournisseur.giveStringStatut(acom.statutPiece)}">
                                            <h:outputText value="#{acom.piece}" />
                                        </p:column>
                                        <p:column headerText="#{lab.LCF_PAF_factures}" width="150" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <h:outputText value="#{acom.numero}" />
                                        </p:column>
                                        <p:column headerText="#{lab.LCF_PAF_mode_reglement}" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <h:outputText value="#{acom.mode.designation}"/>
                                            <span style="display: #{(acom.statutPiece==constantes.STATUT_DOC_ATTENTE)?'inline-block':'none'}; width: 10px; height: 10px; background: #444;" title="#{lab.LC_PFA_en_attente_paiment}"></span>
                                            <span style="display: #{(acom.statutPiece==constantes.STATUT_DOC_ENCOUR)?'inline-block':'none'}; width: 10px; height: 10px; background: #f6a828" title="#{lab.LC_PFA_en_cours_paiment}"></span>
                                            <span style="display: #{(acom.statutPiece==constantes.STATUT_DOC_PAYER)?'inline-block':'none'}; width: 10px; height: 10px; background: #006666" title="#{lab.LC_PCV_piece_regle}"></span>
                                        </p:column>
                                        <p:column headerText="#{lab.LCF_PBAV_date_edition}" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <h:outputText value="#{acom.datePiece}" converter="DDMMYYYY"/>
                                        </p:column>
                                        <p:column headerText="#{lab.LCF_PRV_date_reglement}" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <h:outputText value="#{acom.dateReglement}" converter="DDMMYYYY"/>
                                        </p:column>
                                        <p:column style="width: 5%;text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(acom.statutPiece)}">
                                            <f:facet name="header">
                                                <p:contextMenu for="btn_option_reglement_acompte_head" event="left click" style="font-size: 0.8em">               
                                                    <p:menuitem icon="ui-icon-arrowthick-2-e-w" value="#{lab.LC_PFV_comptabiliser}" global="false" onclick="dlgComptabilisePieceAll.show()"/>
                                                    <p:menuitem value="#{lab.LCF_PRV_encaisser_valider}" actionListener="#{managedOperationClient.encaisserPiecesAll()}" icon="ui-icon-circle-check" />
                                                        <p:menuitem value="#{lab.LP_PSO_mettre_en_attente}" actionListener="#{managedOperationClient.annulerPiecesAll(false)}" icon="ui-icon-circle-close" />
                                                    <p:separator />
                                                    <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" oncomplete="dlgConfirmDeletePieces.show()"/>
                                                </p:contextMenu>
                                                <p:commandButton icon="ui-icon-gear" style="width: 21px; height: 21px;" id="btn_option_reglement_acompte_head" type="button"/>
                                            </f:facet>
                                            <p:contextMenu for="btn_option_reglement_acompte" event="left click" style="font-size: 0.8em">
                                                <p:menuitem value="#{!acom.comptabilise?lab.LC_PFV_comptabiliser:lab.LC_PJV_annuler_comptabilise}" actionListener="#{managedOperationClient.setSelectNotif(acom)}" 
                                                            oncomplete="#{!acom.comptabilise?'dlgComptabilisePiece.show()':'dlgUnComptabilisePiece.show()'}" icon="ui-icon-arrowthick-2-e-w" 
                                                            rendered="#{acom.statutPiece==constantes.STATUT_DOC_PAYER}"/>  
                                                <p:menuitem value="#{lab.LCF_PRV_encaisser_valider}" rendered="#{acom.statutPiece== 'W'}"  update="data_reglement_acompte"
                                                            actionListener="#{managedOperationClient.encaisserPieces(acom)}" icon="ui-icon-circle-check" />
                                                <p:menuitem value="#{lab.LP_PSO_mettre_en_attente}" rendered="#{acom.statutPiece == 'P' or acom.statutPiece == 'A'}"  update="data_reglement_acompte"
                                                            actionListener="#{managedOperationClient.annulerPieces(acom, false)}" icon="ui-icon-circle-close" />
                                                <p:menuitem value="#{lab.LCF_PAF_aller_a_facture}" icon="ui-icon-arrowthick-1-e" global="false" actionListener="#{managedOperationClient.onSelectDistantFactures(acom)}"/>
                                                <p:separator />
                                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedOperationClient.deleteBeanPieces(acom)}"
                                                            oncomplete="dlgConfirmDeletePiece.show()"/>
                                            </p:contextMenu>                           
                                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_reglement_acompte" type="button"/>
                                        </p:column> 
                                        <p:column selectionMode="multiple" style="width:16px;text-align:center"/>  
                                    </p:dataTable>
                                </p:outputPanel>
                            </div>
                            <div class="zone_bottom">

                            </div>
                        </div>
                    </p:outputPanel>  
                </div>
                <div class="yvs_list_acompte_client" style="background: white;">
                    <h:inputHidden id="input_hide_acompte_client" value="#{managedOperationClient.tabIds}"/>
                    <p:dataTable value="#{managedOperationClient.acomptes}" var="rec" rowKey="#{rec.id}" 
                                 rowIndexVar="Idx" selectionMode="single" id="data_acompte_client">
                        <p:ajax event="rowSelect" listener="#{managedOperationClient.loadOnView}" oncomplete="collapseForm('acompte_client');" update="data_acompte_client"/>
                        <p:column headerText="N°" width="15" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}" style="text-align: center">
                            <h:graphicImage library="img" name="redo.png" width="15" height="15" rendered="#{rec.new_}"/>                            
                            <span>#{Idx+1}</span>
                            <h:graphicImage library="img" name="pointe.png" width="17" height="15" rendered="#{rec.id eq managedOperationClient.compte.id}"/>
                        </p:column>
                        <p:column headerText="#{lab.L_reference}" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.numRefrence}"/>
                            <h:panelGroup style="float: right">
                                <h:outputText title="#{lab.LC_PFA_comptabiliser}" value="C" rendered="#{rec.comptabilise}" styleClass="style_statut"/>
                            </h:panelGroup>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PAF_date_acompte}" sortBy="#{rec.dateAcompte}" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.dateAcompte}" converter="DDMMYYYY"/>
                            <h:outputText title="#{lab.LCF_PAF_acompte} #{rec.statutNotif eq 'W'?lab.LCF_PAF_en_attente_notification: (rec.statutNotif eq 'R'?lab.LCF_PAF_en_cours_notification:lab.LCF_PAF_completement_notifier)}"
                                          value="#{rec.statutNotif}" styleClass="style_statut" style="float: right" rendered="#{rec.statutNotif eq 'P'}"/>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PAF_date_paiement}" sortBy="#{rec.dateAcompte}" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.datePaiement}" converter="DDMMYYYY"/>
                        </p:column>
                        <p:column headerText="#{lab.L_client}" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.client.nom_prenom}"/>
                        </p:column>
                        <p:column headerText="#{lab.L_caisse}" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.caisse.intitule}"/>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PAF_mode_paiement}" styleClass="statut_#{managedOperationFournisseur.giveStringStatut(rec.statut)}" style="text-align: center">
                            <h:outputText value="#{rec.model.designation}"/>
                        </p:column>
                        <p:column headerText="#{lab.L_montant}" style="width: 17%;text-align: right" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.montant}" converter="DNS"/>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PAF_nature}" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.nature eq 'A' ? lab.LC_PTBC_avance.toUpperCase() : lab.L_depot.toUpperCase()}"/>
                        </p:column>
                        <p:column headerText="#{lab.LCF_PMV_etapes}" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <h:outputText value="#{rec.libphases}"/>
                        </p:column>                                                                                     
                        <p:column width="20" style="text-align: center">
                            <h:graphicImage library="img" name="#{(rec.repartirAutomatique)?'vu.png':'vu_non.png'}" width="16" height="16" title="#{lab.LCF_PAF_repartition_automatique} #{(rec.repartirAutomatique)?'activée':'desactivée'}"/>
                        </p:column>
                        <p:column width="20" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <f:facet name="header">
                                <p:contextMenu for="btn_option_acompte_client_head" event="left click" style="font-size: 0.8em">               
                                    <p:menuitem icon="ui-icon-link" value="#{lab.LC_PFA_etat_comptabiliser}" global="false" onclick="dglEtatComptabilised.show()"/>
                                </p:contextMenu>
                                <p:commandButton icon="ui-icon-gear" style="width: 21px; height: 21px;" id="btn_option_acompte_client_head" type="button"/>
                            </f:facet>
                            <p:contextMenu for="btn_option_acompte_client" event="left click" style="font-size: 0.8em">            
                                <p:menuitem icon="ui-icon-pin-s" value="Lettrer l'acompte" actionListener="#{managedOperationClient.lettrer(rec)}" rendered="#{rec.comptabilise}"/>                            
                                <p:menuitem value="Modifier la nature" icon="ui-icon-refresh" actionListener="#{managedOperationClient.changeNatureAcompte(rec)}" rendered="#{!rec.comptabilise}" />  
                                <p:menuitem value="#{lab.LC_PFV_equilibre_statut}" icon="ui-icon-carat-2-e-w" actionListener="#{managedOperationClient.equilibre(rec)}"/>
                                <p:menuitem value="#{lab.L_aller_a}" icon="ui-icon-arrowthick-1-e" global="false" actionListener="#{managedOperationClient.onSelectDistantCheque(rec)}"
                                            rendered="#{rec.model.typeReglement == constantes.MODE_PAIEMENT_BANQUE}"/>
                                <p:menuitem value="#{lab.LCF_PRV_encaisser_valider}" rendered="#{rec.statut == 'W' and rec.phasesReglement.size() lt 1}" 
                                            actionListener="#{managedOperationClient.encaisserAcompte(rec)}" icon="ui-icon-circle-check" />
                                <p:menuitem value="#{lab.L_annuler}" rendered="#{rec.statut == 'P'}"  
                                            actionListener="#{managedOperationClient.annulerAcompte(rec, true)}" icon="ui-icon-circle-close" />
                                <p:menuitem value="#{lab.LP_PSO_mettre_en_attente}" rendered="#{rec.statut == 'A' and rec.phasesReglement.size() lt 1}" 
                                            actionListener="#{managedOperationClient.annulerAcompte(rec, false)}" icon="ui-icon-circle-close" />
                                <p:separator />
                                <p:menuitem value="#{lab.L_supprimer}" icon="ui-icon-trash" global="false" actionListener="#{managedOperationClient.deleteBeanCompte(rec)}"/>
                            </p:contextMenu>                           
                            <p:commandButton icon="ui-icon-gear" style="width: 22px; height: 22px" id="btn_option_acompte_client" type="button"/>
                        </p:column> 
                        <p:column width="25" style="text-align: center" styleClass="statut_#{managedOperationClient.giveStringStatut(rec.statut)}">
                            <f:facet name="header">
                                <h:selectBooleanCheckbox styleClass="chek_all_line_acompte_client" value="false"
                                                         onclick="selectionAllLineTab(#{managedOperationClient.acomptes.size()}, 'acompte_client')">
                                    <p:ajax event="valueChange" global="false"/>
                                </h:selectBooleanCheckbox>
                            </f:facet>
                            <h:selectBooleanCheckbox value="false" styleClass="chek_line_acompte_client" 
                                                     onclick="selectionLineTab(#{Idx}, 'acompte_client')">
                                <p:ajax event="valueChange" global="false"/>
                            </h:selectBooleanCheckbox>
                        </p:column>
                    </p:dataTable>                        
                    <p:outputPanel autoUpdate="true" style="float: right" layout="block">
                        <p:commandButton actionListener="#{managedOperationClient.paginer(false)}" update="data_acompte_client" icon="ui-icon-circle-triangle-w" disabled="#{managedOperationClient.paginator.disPrev}"/>
                        <p:outputLabel value="#{managedOperationClient.paginator.currentPage}/#{managedOperationClient.paginator.nbPage}" style="margin-top: 15px; font-size: 0.8em; font-weight: bold" />
                        <p:commandButton actionListener="#{managedOperationClient.paginer(true)}" update="data_acompte_client" icon="ui-icon-circle-triangle-e" disabled="#{managedOperationClient.paginator.disNext}"/>
                        <p:selectOneMenu value="#{managedOperationClient.imax}" label="#{lab.L_nombre_max_resultat}" valueChangeListener="#{managedOperationClient.choosePaginator}" style="float: right; font-size: 0.9em;margin-top: 3px;min-width: 50px" >
                            <f:selectItems value="#{managedOperationClient.paginations}"/>
                            <p:ajax event="valueChange"   update="data_acompte_client"/>
                        </p:selectOneMenu>
                    </p:outputPanel>
                </div>
            </div>
        </h:form>
    </ui:define>
    <ui:define name="zone_search">
        <script type="text/javascript">
            $(document).ready(function() {
                slideZoneSearche();
            });
        </script>
        <h:form prependId="false" style="background: #CCC">  
            <h:graphicImage library="img"  name="pointe_.png" style="border: none; position: relative; bottom: -20px" width="20" height="20"
                            styleClass="img_slide" title="#{lab.L_cacher}"/>  
            <div class="zone_find">
                <div class="display_auteur" align="right"  style="font-style: italic;">
                    <p:outputPanel autoUpdate="true">
                        <span style="float: left">#{lab.L_enregistrer_le} <h:outputText value="#{managedOperationClient.selectCompte.dateSave}" converter="LD"  styleClass="valeur" style="font-weight: bold"/></span> 
                        <span>#{lab.L_modifier_le} <h:outputText value="#{managedOperationClient.selectCompte.dateUpdate}" converter="LD" styleClass="valeur" style="font-weight: bold"/></span>
                        <span>#{lab.L_par} <h:outputText value="#{managedOperationClient.selectCompte.author.users.nomUsers}"  styleClass="valeur" style="font-weight: bold"/></span>
                    </p:outputPanel>
                </div>
                <h:panelGrid columns="7" style="font-size: 0.9em" cellpadding="0" cellspacing="0">
                    <h:outputText value="#{lab.L_date}" />
                    <h:outputText value="#{lab.L_statut}" />
                    <h:outputText value="#{lab.L_client}" />
                    <h:outputText value="#{lab.L_caisse}" />
                    <h:outputText value="#{lab.L_reference}" />
                    <h:outputText value="" />
                    <span>&nbsp;</span>
                    <h:panelGrid columns="2" >
                        <h:selectBooleanCheckbox value="#{managedOperationClient.addDate}" style="margin-top: 2px;float: right">
                            <p:ajax event="valueChange" listener="#{managedOperationClient.addParamDate()}" oncomplete="collapseList('acompte_client')" update="date_search_acompte_client"/>
                        </h:selectBooleanCheckbox>
                        <h:panelGroup id="date_search_acompte_client">
                            <p:calendar value="#{managedOperationClient.dateDebut}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedOperationClient.addDate}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" listener="#{managedOperationClient.addParamDate()}" oncomplete="collapseList('acompte_client')"/>
                            </p:calendar>
                            <p:spacer width="5px" style="background: black"/>
                            <p:calendar value="#{managedOperationClient.dateFin}" navigator="true" pattern="dd-MM-yyyy" disabled="#{!managedOperationClient.addDate}" size="10" style="font-size: 0.8em">
                                <p:ajax event="dateSelect" listener="#{managedOperationClient.addParamDate()}" oncomplete="collapseList('acompte_client')" />
                            </p:calendar>
                        </h:panelGroup>
                    </h:panelGrid>
                    <h:selectOneMenu value="#{managedOperationClient.statutSearch}" style="min-width: 120px">
                        <f:selectItem itemLabel="#{lab.L_tout}" itemValue="#{null}"/>
                        <f:selectItem itemLabel="#{lab.L_attente}" itemValue="#{constantes.ETAT_ATTENTE}"/>
                        <f:selectItem itemLabel="#{lab.L_annulers}" itemValue="#{constantes.STATUT_DOC_ANNULE}"/>
                        <f:selectItem itemLabel="#{lab.L_regler}" itemValue="#{constantes.ETAT_REGLE}"/>
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamStatut()}" oncomplete="collapseList('acompte_client')"/>
                    </h:selectOneMenu>
                    <h:inputText value="#{managedOperationClient.codeClient}" style="width: 100%">
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamClient()}" oncomplete="collapseList('acompte_client')"/>
                    </h:inputText> 
                    <h:selectOneMenu value="#{managedOperationClient.caisseSearch}" style="min-width: 120px; max-width: 200px">
                        <f:selectItem itemLabel="" itemValue="0"/>
                        <f:selectItems value="#{managedCaisses.caisses}" var="ca" itemLabel="#{ca.intitule}" itemValue="#{ca.id}"/>
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamCaisse()}" oncomplete="collapseList('acompte_client')" />
                    </h:selectOneMenu>                          
                    <h:inputText value="#{managedOperationClient.numSearch}">
                        <p:ajax event="valueChange" listener="#{managedOperationClient.addParamReference()}" oncomplete="collapseList('acompte_client')"/>
                    </h:inputText>
                    <p:commandLink style="border: 2px solid black; border-radius: 5px;padding: 2px;font-size: 0.8em" 
                                   onclick="dlgPlusOption.show()" global="false" value="#{lab.L_avancees}"/>
                </h:panelGrid>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
